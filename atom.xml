<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>ç‹ç¾çš„ä¸ªäººåšå®¢</title>
  
  
  <link href="https://hard-workingrookie.github.io/atom.xml" rel="self"/>
  
  <link href="https://hard-workingrookie.github.io/"/>
  <updated>2021-06-12T16:36:50.528Z</updated>
  <id>https://hard-workingrookie.github.io/</id>
  
  <author>
    <name>ç‹ç¾</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>é¡µé¢æ¨ªå‘æ»šåŠ¨</title>
    <link href="https://hard-workingrookie.github.io/2021/06/13/%E9%A1%B5%E9%9D%A2%E6%A8%AA%E5%90%91%E6%BB%9A%E5%8A%A8/"/>
    <id>https://hard-workingrookie.github.io/2021/06/13/%E9%A1%B5%E9%9D%A2%E6%A8%AA%E5%90%91%E6%BB%9A%E5%8A%A8/</id>
    <published>2021-06-12T16:26:20.000Z</published>
    <updated>2021-06-12T16:36:50.528Z</updated>
    
    <content type="html"><![CDATA[<p>ä»£ç ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">      * &#123;</span><br><span class="line">        padding: 0;</span><br><span class="line">        margin: 0;</span><br><span class="line">      &#125;</span><br><span class="line"><span class="css">      <span class="selector-class">.container</span> &#123;</span></span><br><span class="line">        display: flex;</span><br><span class="line">        overflow-x: scroll;</span><br><span class="line">      &#125;</span><br><span class="line"><span class="css">      <span class="selector-class">.page</span> &#123;</span></span><br><span class="line">        width: 100vw;</span><br><span class="line">        height: 100vh;</span><br><span class="line">        flex-shrink: 0;</span><br><span class="line">      &#125;</span><br><span class="line"><span class="css">      <span class="selector-class">.page</span><span class="selector-pseudo">:nth-child(1)</span> &#123;</span></span><br><span class="line">        background-color: red;</span><br><span class="line">      &#125;</span><br><span class="line"><span class="css">      <span class="selector-class">.page</span><span class="selector-pseudo">:nth-child(2)</span> &#123;</span></span><br><span class="line">        background-color: aqua;</span><br><span class="line">      &#125;</span><br><span class="line"><span class="css">      <span class="selector-class">.page</span><span class="selector-pseudo">:nth-child(3)</span> &#123;</span></span><br><span class="line">        background-color: blueviolet;</span><br><span class="line">      &#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;page&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;page&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;page&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">     <span class="keyword">let</span> box= <span class="built_in">document</span>.querySelector(<span class="string">&#x27;.container&#x27;</span>);</span></span><br><span class="line"><span class="javascript">     box.addEventListener(<span class="string">&#x27;wheel&#x27;</span>,<span class="function">(<span class="params">e</span>)=&gt;</span>&#123;</span></span><br><span class="line">         e.preventDefault();</span><br><span class="line">         box.scrollLeft+=e.deltaY;</span><br><span class="line">     &#125;)</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;ä»£ç ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;</summary>
      
    
    
    
    <category term="js" scheme="https://hard-workingrookie.github.io/categories/js/"/>
    
    
    <category term="js" scheme="https://hard-workingrookie.github.io/tags/js/"/>
    
  </entry>
  
  <entry>
    <title>jsé¢è¯•é¢˜</title>
    <link href="https://hard-workingrookie.github.io/2021/03/14/js%E9%9D%A2%E8%AF%95%E9%A2%98/"/>
    <id>https://hard-workingrookie.github.io/2021/03/14/js%E9%9D%A2%E8%AF%95%E9%A2%98/</id>
    <published>2021-03-14T07:37:45.000Z</published>
    <updated>2021-03-14T07:41:28.737Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æœ‰ä¸€ä¸ªæ•°ç»„ä¸­å­˜ç€RGBä¸‰ç§é¢œè‰²çš„çƒï¼Œéœ€è¦æŒ‰RGBçš„é¡ºåºæ’åºæ•°ç»„"><a href="#æœ‰ä¸€ä¸ªæ•°ç»„ä¸­å­˜ç€RGBä¸‰ç§é¢œè‰²çš„çƒï¼Œéœ€è¦æŒ‰RGBçš„é¡ºåºæ’åºæ•°ç»„" class="headerlink" title="æœ‰ä¸€ä¸ªæ•°ç»„ä¸­å­˜ç€RGBä¸‰ç§é¢œè‰²çš„çƒï¼Œéœ€è¦æŒ‰RGBçš„é¡ºåºæ’åºæ•°ç»„"></a>æœ‰ä¸€ä¸ªæ•°ç»„ä¸­å­˜ç€RGBä¸‰ç§é¢œè‰²çš„çƒï¼Œéœ€è¦æŒ‰RGBçš„é¡ºåºæ’åºæ•°ç»„</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">let</span> RGBData = [<span class="string">&#x27;R&#x27;</span>, <span class="string">&#x27;G&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;R&#x27;</span>, <span class="string">&#x27;R&#x27;</span>, <span class="string">&#x27;G&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;R&#x27;</span>, <span class="string">&#x27;R&#x27;</span>, <span class="string">&#x27;G&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;R&#x27;</span>]</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">sortRGB</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> i,</span><br><span class="line">      j,</span><br><span class="line">      len,</span><br><span class="line">      rear,</span><br><span class="line">      front = <span class="number">0</span></span><br><span class="line">    rear = arr.length - <span class="number">1</span></span><br><span class="line">    len= rear + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (i = front, j = <span class="number">0</span>; j &lt; len; ) &#123;</span><br><span class="line">      <span class="keyword">if</span> (arr[i] == <span class="string">&#x27;R&#x27;</span>) &#123;</span><br><span class="line">        swap(i, front)</span><br><span class="line">        <span class="comment">//å½“è°ƒæ¢å›æ¥çš„è¿˜æ˜¯R</span></span><br><span class="line">        <span class="keyword">while</span> (arr[front] == <span class="string">&#x27;R&#x27;</span>) &#123;</span><br><span class="line">          i++</span><br><span class="line">          front++</span><br><span class="line">          j++</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (arr[i] == <span class="string">&#x27;B&#x27;</span>) &#123;</span><br><span class="line">        swap(i, rear)</span><br><span class="line">         <span class="comment">//å½“è°ƒæ¢å›æ¥çš„è¿˜æ˜¯B</span></span><br><span class="line">        <span class="keyword">while</span> (arr[rear] == <span class="string">&#x27;B&#x27;</span>) &#123;</span><br><span class="line">          rear--</span><br><span class="line">          j++</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        i++</span><br><span class="line">        j++</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> arr</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// äº¤æ¢</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">swap</span>(<span class="params">index1, index2</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> temp</span><br><span class="line">    temp = RGBData[index1]</span><br><span class="line">    RGBData[index1] = RGBData[index2]</span><br><span class="line">    RGBData[index2] = temp</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(sortRGB(RGBData))</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="ä¸¤ä¸ªæœ‰åºæ•°ç»„a-bï¼Œè¯·å°†a-båˆæˆä¸ºä¸€ä¸ªæ–°çš„æœ‰åºæ•°ç»„"><a href="#ä¸¤ä¸ªæœ‰åºæ•°ç»„a-bï¼Œè¯·å°†a-båˆæˆä¸ºä¸€ä¸ªæ–°çš„æœ‰åºæ•°ç»„" class="headerlink" title="ä¸¤ä¸ªæœ‰åºæ•°ç»„a,bï¼Œè¯·å°†a,båˆæˆä¸ºä¸€ä¸ªæ–°çš„æœ‰åºæ•°ç»„"></a>ä¸¤ä¸ªæœ‰åºæ•°ç»„a,bï¼Œè¯·å°†a,båˆæˆä¸ºä¸€ä¸ªæ–°çš„æœ‰åºæ•°ç»„</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> merge=<span class="function">(<span class="params">a,b</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> arr=[]</span><br><span class="line">        <span class="keyword">let</span> i=<span class="number">0</span>,j=<span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span>(i&lt;a.length&amp;&amp;j&lt;b.length)&#123;</span><br><span class="line">            <span class="keyword">if</span>(a[i]&lt;b[j])&#123;</span><br><span class="line">                arr.push(a[i])</span><br><span class="line">                i++</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                arr.push(b[j])</span><br><span class="line">                j++</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span>(i&lt;a.length)&#123;</span><br><span class="line">            arr.push(a[i++])</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span>(j&lt;b.length)&#123;</span><br><span class="line">            arr.push(b[j++])</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> arr</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> arr1=[<span class="number">1</span>,<span class="number">100</span>,<span class="number">500</span>,<span class="number">700</span>,<span class="number">100000</span>]</span><br><span class="line">    <span class="keyword">let</span> arr2=[<span class="number">100</span>,<span class="number">3000</span>,<span class="number">6000</span>]</span><br><span class="line">    <span class="built_in">console</span>.log(merge(arr1,arr2))</span><br><span class="line">    </span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;æœ‰ä¸€ä¸ªæ•°ç»„ä¸­å­˜ç€RGBä¸‰ç§é¢œè‰²çš„çƒï¼Œéœ€è¦æŒ‰RGBçš„é¡ºåºæ’åºæ•°ç»„&quot;&gt;&lt;a href=&quot;#æœ‰ä¸€ä¸ªæ•°ç»„ä¸­å­˜ç€RGBä¸‰ç§é¢œè‰²çš„çƒï¼Œéœ€è¦æŒ‰RGBçš„é¡ºåºæ’åºæ•°ç»„&quot; class=&quot;headerlink&quot; title=&quot;æœ‰ä¸€ä¸ªæ•°ç»„ä¸­å­˜ç€RGBä¸‰ç§é¢œè‰²çš„çƒï¼Œéœ€è¦æŒ‰RGBçš„é¡ºåºæ’åºæ•°</summary>
      
    
    
    
    
    <category term="jsé¢è¯•é¢˜" scheme="https://hard-workingrookie.github.io/tags/js%E9%9D%A2%E8%AF%95%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>DevOpsæ€»ç»“</title>
    <link href="https://hard-workingrookie.github.io/2021/03/09/DevOps%E6%80%BB%E7%BB%93/"/>
    <id>https://hard-workingrookie.github.io/2021/03/09/DevOps%E6%80%BB%E7%BB%93/</id>
    <published>2021-03-09T13:42:24.000Z</published>
    <updated>2021-03-09T14:06:29.896Z</updated>
    
    <content type="html"><![CDATA[<p><img src= "/img/loading.gif" data-lazy-src="http://tvshow.date/images/1175964-20191105059673.png"></p><h1 id="DevOps-æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#DevOps-æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="DevOps æ˜¯ä»€ä¹ˆï¼Ÿ"></a>DevOps æ˜¯ä»€ä¹ˆï¼Ÿ</h1><p>DevOpsæ¥è‡ª<code>Development</code>å’Œ<code>Operations</code>çš„ç»“åˆ,çªå‡ºé‡è§†<strong>è½¯ä»¶å¼€å‘äººå‘˜</strong>å’Œ<strong>è¿ç»´äººå‘˜</strong>çš„æ²Ÿé€šåˆä½œ<br>DevOps æ˜¯ä¸€ç§è½¯ä»¶å¼€å‘æ–¹æ³•ã€‚å®ƒå°†æŒç»­å¼€å‘ã€æŒç»­æµ‹è¯•ã€æŒç»­é›†æˆã€æŒç»­éƒ¨ç½²å’ŒæŒç»­ç›‘æ§è´¯ç©¿äºè½¯ä»¶å¼€å‘çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸã€‚å½“å‰å‡ ä¹æ‰€æœ‰çš„é¡¶å°–å…¬å¸å‡é‡‡ç”¨äº†è¯¥æ–¹æ³•ï¼Œç”¨ä»¥æé«˜è½¯ä»¶å¼€å‘è´¨é‡ï¼Œå¹¶ç¼©çŸ­è½¯ä»¶å¼€å‘ç”Ÿå‘½å‘¨æœŸã€‚ä»è€Œä»¥è¾¾åˆ°æ¯ä¸ªå…¬å¸å¯¹è½¯ä»¶äº§å“çš„æœŸæœ›ï¼Œäº¤ä»˜å‡ºå®¢æˆ·æœ€æ»¡æ„çš„äº§å“ã€‚</p><h1 id="DevOpsæµç¨‹"><a href="#DevOpsæµç¨‹" class="headerlink" title="DevOpsæµç¨‹"></a>DevOpsæµç¨‹</h1><p><img src= "/img/loading.gif" data-lazy-src="http://tvshow.date/images/1391569032.png"><br>è®¡åˆ’ï¼ˆplanï¼‰ã€ç¼–ç (code)ã€ç¼–è¯‘(build)ã€æµ‹è¯•(test)ã€å‘å¸ƒ(release)ã€éƒ¨ç½²(deploy)ã€è¿è¥(operate)ã€ç›‘æ§ï¼ˆmonitorï¼‰</p><h1 id="DevOpså·¥å…·é“¾"><a href="#DevOpså·¥å…·é“¾" class="headerlink" title="DevOpså·¥å…·é“¾"></a>DevOpså·¥å…·é“¾</h1><p><img src= "/img/loading.gif" data-lazy-src="http://tvshow.date/images/v2-c371a2b21c503a0fef8c271070778edf_720w.jpg"></p><ol><li>Puppet<br>Puppet æ˜¯ä½¿ç”¨æœ€å¹¿æ³›çš„ DevOps å·¥å…·ã€‚å…è®¸å¿«é€Ÿã€é¢‘ç¹åœ°äº¤ä»˜å’Œå‘å¸ƒæŠ€æœ¯æ›´æ”¹ã€‚å…·æœ‰ç‰ˆæœ¬æ§åˆ¶ã€è‡ªåŠ¨æµ‹è¯•å’Œè¿ç»­äº¤ä»˜çš„åŠŸèƒ½ã€‚å¯ä»¥å°†æ•´ä¸ªåŸºç¡€æ¶æ„ä½œä¸ºä»£ç è¿›è¡Œç®¡ç†ï¼Œè€Œæ— éœ€æ‰©å¤§å›¢é˜Ÿè§„æ¨¡ã€‚<br>ç‰¹æ€§</li></ol><ol start="2"><li>Ansible<br>Ansible æ˜¯é¢†å…ˆçš„ DevOps å·¥å…·ã€‚Ansible æ˜¯ä¸€ä¸ªå¼€æº IT å¼•æ“ï¼Œå¯è‡ªåŠ¨æ‰§è¡Œåº”ç”¨éƒ¨ç½²ã€äº‘ä¾›åº”ã€å†…éƒ¨æœåŠ¡ç¼–æ’å’Œå…¶ä»– IT å·¥å…·ã€‚DevOps å›¢é˜Ÿå¯ä»¥æ›´è½»æ¾åœ°æ‰©å±•è‡ªåŠ¨åŒ–è§„æ¨¡å¹¶æé«˜ç”Ÿäº§ç‡ã€‚<br>Ansible æ˜“äºéƒ¨ç½²ï¼Œå› ä¸ºå®ƒåœ¨å®¢æˆ·ç«¯ä¸ä½¿ç”¨ä»»ä½•ä»£ç†æˆ–è‡ªå®šä¹‰å®‰å…¨æ€§åŸºç¡€ç»“æ„ã€ä¹Ÿä¸é€šè¿‡å°†æ¨¡å—æ¨é€åˆ°å®¢æˆ·ç«¯ã€‚è¿™äº›æ¨¡å—åœ¨å®¢æˆ·ç«¯æœ¬åœ°æ‰§è¡Œï¼Œå¹¶å°†è¾“å‡ºæ¨å› Ansible æœåŠ¡å™¨ã€‚</li></ol><ol start="3"><li>Docker<br>Docker æ˜¯é«˜ç«¯ DevOps å·¥å…·ï¼Œå…è®¸åœ¨å¤šä¸ªç³»ç»Ÿä¸Šæ„å»ºã€äº¤ä»˜å’Œè¿è¡Œåˆ†å¸ƒå¼åº”ç”¨ç¨‹åºã€‚æœ‰åŠ©äºä»ç»„ä»¶å¿«é€Ÿç»„è£…åº”ç”¨ï¼Œé€šå¸¸é€‚ç”¨äºå®¹å™¨ç®¡ç†ã€‚</li></ol><ol start="4"><li>Nagios<br>Nagios æ˜¯ DevOps çš„æ›´æœ‰ç”¨çš„å·¥å…·ä¹‹ä¸€ã€‚å®ƒå¯ä»¥ç¡®å®šé”™è¯¯å¹¶åœ¨ç½‘ç»œã€åŸºç¡€æ¶æ„ã€æœåŠ¡å™¨å’Œæ—¥å¿—ç›‘è§†ç³»ç»Ÿçš„å¸®åŠ©ä¸‹è¿›è¡Œçº æ­£ã€‚</li></ol><ol start="5"><li><p>CHEF<br>Chef æ˜¯å®ç°è§„æ¨¡ã€é€Ÿåº¦å’Œä¸€è‡´æ€§çš„æœ‰ç”¨å·¥å…·ã€‚Chef æ˜¯åŸºäºäº‘çš„ç³»ç»Ÿå’Œå¼€æºæŠ€æœ¯ã€‚è¿™é¡¹æŠ€æœ¯ä½¿ç”¨ Ruby ç¼–ç æ¥å¼€å‘å¿…ä¸å¯å°‘çš„æ„å»ºåŸºå—ï¼Œä¾‹å¦‚èœè°±å’Œçƒ¹é¥ªä¹¦ã€‚Chef ç”¨äºåŸºç¡€æ¶æ„è‡ªåŠ¨åŒ–ï¼Œå¹¶æœ‰åŠ©äºå‡å°‘ç”¨äºåŸºç¡€æ¶æ„ç®¡ç†çš„æ‰‹åŠ¨å’Œé‡å¤æ€§ä»»åŠ¡ã€‚</p></li><li><p>Jenkins<br>Jenkins æ˜¯ä¸€ä¸ª DevOps å·¥å…·ï¼Œç”¨äºç›‘è§†é‡å¤ä»»åŠ¡çš„æ‰§è¡Œã€‚Jenkins æ˜¯å…è®¸æŒç»­é›†æˆçš„è½¯ä»¶ã€‚Jenkins å°†å®‰è£…åœ¨å°†è¿›è¡Œé›†ä¸­æ„å»ºçš„æœåŠ¡å™¨ä¸Šã€‚é€šè¿‡å¿«é€Ÿå‘ç°é—®é¢˜ï¼Œå®ƒæœ‰åŠ©äºæ›´æœ‰æ•ˆåœ°é›†æˆé¡¹ç›®å˜æ›´ã€‚</p></li></ol><p>å‡ ä¹ä¸éœ€è¦ç»´æŠ¤ï¼Œå¹¶å…·æœ‰å†…ç½®çš„ GUI å·¥å…·ï¼Œå¯è½»æ¾è¿›è¡Œæ›´æ–°ã€‚<br>7) Git<br>Git æ˜¯ä¸€ä¸ªå¼€æºçš„åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Œæ¯ä¸ªäººéƒ½å¯ä»¥å…è´¹ä½¿ç”¨ã€‚å®ƒæ—¨åœ¨å¿«é€Ÿé«˜æ•ˆåœ°å¤„ç†ä»å°åˆ°å¤§çš„é¡¹ç›®ã€‚å¼€å‘å®ƒæ˜¯ä¸ºäº†åè°ƒç¨‹åºå‘˜ä¹‹é—´çš„å·¥ä½œã€‚ç‰ˆæœ¬æ§ä»¶ä½¿æ‚¨å¯ä»¥åœ¨åŒä¸€å·¥ä½œåŒºä¸­è·Ÿè¸ªå›¢é˜Ÿæˆå‘˜å¹¶ä¸ä¹‹ä¸€èµ·å·¥ä½œã€‚å®ƒç”¨ä½œ DevOps å·¥å…·çš„å…³é”®åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ã€‚</p><ol start="8"><li><p>SALTSTACK<br>Stackify æ˜¯è½»é‡çº§çš„ DevOps å·¥å…·ã€‚å®ƒæ˜¾ç¤ºå®æ—¶é”™è¯¯æŸ¥è¯¢æ—¥å¿—å¹¶ä¸”æ›´ç›´æ¥åœ°æ˜¾ç¤ºåˆ°å·¥ä½œç«™ä¸­ã€‚SALTSTACK æ˜¯é’ˆå¯¹è½¯ä»¶å®šä¹‰çš„æ•°æ®ä¸­å¿ƒè¿›è¡Œæ™ºèƒ½ç¼–æ’çš„ç†æƒ³è§£å†³æ–¹æ¡ˆã€‚</p></li><li><p>Splunk<br>Splunk æ˜¯ä½¿æœºå™¨æ•°æ®å¯¹æ‰€æœ‰äººå¯ç”¨ã€å¯è®¿é—®ä¸”æœ‰ä»·å€¼çš„å·¥å…·ã€‚ä¸º DevOps å›¢é˜Ÿæä¾›è¿è¥æƒ…æŠ¥ã€‚å¸®åŠ©å…¬å¸æé«˜å®‰å…¨æ€§ã€ç”Ÿäº§ç‡å’Œç«äº‰åŠ›ã€‚</p></li><li><p>Selenium<br>Selenium æ˜¯ç”¨äºWebåº”ç”¨ç¨‹åºçš„ä¾¿æºå¼è½¯ä»¶æµ‹è¯•æ¡†æ¶ã€‚å®ƒä¸ºå¼€å‘è‡ªåŠ¨åŒ–æµ‹è¯•æä¾›äº†ç®€å•çš„ç•Œé¢ã€‚</p></li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;img src= &quot;/img/loading.gif&quot; data-lazy-src=&quot;http://tvshow.date/images/1175964-20191105059673.png&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;DevOps-æ˜¯ä»€ä¹ˆï¼Ÿ&quot;&gt;&lt;a href=&quot;#Dev</summary>
      
    
    
    
    <category term="DevOps" scheme="https://hard-workingrookie.github.io/categories/DevOps/"/>
    
    
    <category term="DevOps" scheme="https://hard-workingrookie.github.io/tags/DevOps/"/>
    
  </entry>
  
  <entry>
    <title>electronçª—å£ç®¡ç†</title>
    <link href="https://hard-workingrookie.github.io/2021/01/07/electron%E7%AA%97%E5%8F%A3%E7%AE%A1%E7%90%86/"/>
    <id>https://hard-workingrookie.github.io/2021/01/07/electron%E7%AA%97%E5%8F%A3%E7%AE%A1%E7%90%86/</id>
    <published>2021-01-07T07:32:15.000Z</published>
    <updated>2021-03-09T14:07:44.053Z</updated>
    
    <content type="html"><![CDATA[<h1 id="çª—å£"><a href="#çª—å£" class="headerlink" title="çª—å£"></a>çª—å£</h1><h2 id="ä¸»çª—å£éšè—å’Œæ¢å¤"><a href="#ä¸»çª—å£éšè—å’Œæ¢å¤" class="headerlink" title="ä¸»çª—å£éšè—å’Œæ¢å¤"></a>ä¸»çª—å£éšè—å’Œæ¢å¤</h2><h3 id="ä¸»çª—å£"><a href="#ä¸»çª—å£" class="headerlink" title="ä¸»çª—å£"></a>ä¸»çª—å£</h3><h4 id="ä¸ºä»€ä¹ˆéœ€è¦-ä¸»çª—å£"><a href="#ä¸ºä»€ä¹ˆéœ€è¦-ä¸»çª—å£" class="headerlink" title="ä¸ºä»€ä¹ˆéœ€è¦ ä¸»çª—å£?"></a>ä¸ºä»€ä¹ˆéœ€è¦ <strong>ä¸»çª—å£</strong>?</h4><p>ä¸€ä¸ªåº”ç”¨å­˜åœ¨ç€è®¸å¤šçš„çª—å£ï¼Œéœ€è¦ä¸€ä¸ªçª—å£ä½œä¸º __ä¸»çª—å£__ï¼Œå¦‚æœè¯¥çª—å£å…³é—­ï¼Œåˆ™æ„å‘³ç€æ•´ä¸ªåº”ç”¨è¢«å…³é—­ã€‚</p><p>åœºæ™¯ï¼šåœ¨åº”ç”¨åªæœ‰ä¸€ä¸ªé¡µé¢çš„æ—¶ï¼Œç”¨æˆ·ç‚¹å‡»å…³é—­æŒ‰é’®ï¼Œä¸æƒ³è®©æ•´ä¸ªåº”ç”¨å…³é—­ï¼Œè€Œæ˜¯éšè—ï¼›<br>ä¾‹å¦‚ï¼šå…¶ä»–çš„appï¼Œåƒå¾®ä¿¡ï¼ŒQQç­‰æ¡Œé¢ç«¯ã€‚  </p><p>ä¸»è¿›ç¨‹ä»£ç ç¤ºä¾‹ï¼Œå®Œæ•´ä»£ç åœ¨æœ¬åº”ç”¨çš„<code>app/browser-window/index.ts</code>å¤„</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> mainWindowId: number</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> browserWindow = <span class="keyword">new</span> BrowserWindow()</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®°å½•ä¸‹ä¸»çª—å£id</span></span><br><span class="line"><span class="keyword">if</span> (!mainWindowId) &#123;</span><br><span class="line">  mainWindowId = browserWindow.id</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">browserWindow.on(<span class="string">&#x27;close&#x27;</span>, <span class="function"><span class="params">event</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// å¦‚æœå…³é—­çš„æ˜¯ä¸»çª—å£ï¼Œé˜»æ­¢</span></span><br><span class="line">  <span class="keyword">if</span> (browserWindow.id === mainWindowId) &#123;</span><br><span class="line">    event.preventDefault()</span><br><span class="line">    browserWindow.hide()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="æ¢å¤ä¸»çª—å£æ˜¾ç¤º"><a href="#æ¢å¤ä¸»çª—å£æ˜¾ç¤º" class="headerlink" title="æ¢å¤ä¸»çª—å£æ˜¾ç¤º"></a>æ¢å¤ä¸»çª—å£æ˜¾ç¤º</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mainWindow = BrowserWindowsMap.get(mainWindowId)</span><br><span class="line"><span class="keyword">if</span> (mainWindow) &#123;</span><br><span class="line">  mainWindow.restore()</span><br><span class="line">  <span class="comment">// windowsä¸‹å¦‚æœhideä¹‹åä¸è°ƒç”¨showæ–¹æ³•è€Œæ˜¯åªè°ƒç”¨restoreæ–¹æ³•å°±ä¼šå¯¼è‡´é¡µé¢æŒ‚ä½ä¸èƒ½ç”¨</span></span><br><span class="line">  mainWindow.show()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å¼ºåˆ¶å…³é—­ä¸»çª—å£"><a href="#å¼ºåˆ¶å…³é—­ä¸»çª—å£" class="headerlink" title="å¼ºåˆ¶å…³é—­ä¸»çª—å£"></a>å¼ºåˆ¶å…³é—­ä¸»çª—å£</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mainWindow = BrowserWindowsMap.get(mainWindowId)</span><br><span class="line"><span class="keyword">if</span> (mainWindow) &#123;</span><br><span class="line">  mainWindowId = <span class="number">-1</span></span><br><span class="line">  mainWindow.close()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å­˜åœ¨çš„é—®é¢˜"><a href="#å­˜åœ¨çš„é—®é¢˜" class="headerlink" title="å­˜åœ¨çš„é—®é¢˜"></a>å­˜åœ¨çš„é—®é¢˜</h3><h4 id="å› ä¸ºé˜»æ­¢äº†closeäº‹ä»¶ï¼Œå¯¼è‡´-å…³æœº-æ—¶æ— æ³•å…³é—­-ä¸»çª—å£-ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹ä»£ç ï¼š"><a href="#å› ä¸ºé˜»æ­¢äº†closeäº‹ä»¶ï¼Œå¯¼è‡´-å…³æœº-æ—¶æ— æ³•å…³é—­-ä¸»çª—å£-ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹ä»£ç ï¼š" class="headerlink" title="å› ä¸ºé˜»æ­¢äº†closeäº‹ä»¶ï¼Œå¯¼è‡´ å…³æœº æ—¶æ— æ³•å…³é—­ __ä¸»çª—å£__ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹ä»£ç ï¼š"></a>å› ä¸ºé˜»æ­¢äº†closeäº‹ä»¶ï¼Œå¯¼è‡´ <strong>å…³æœº</strong> æ—¶æ— æ³•å…³é—­ __ä¸»çª—å£__ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹ä»£ç ï¼š</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">app.on(<span class="string">&#x27;before-quit&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    closeMainWindow()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p><em>æ³¨ï¼š<code>macOS</code> <code>Linux</code> <code>Windows</code> <a href="https://www.electronjs.org/docs/api/app#%E4%BA%8B%E4%BB%B6%EF%BC%9Abefore-quit">å®Œæ•´æ–‡æ¡£</a></em>  </p><h4 id="ä¸ºé¿å…å¯åŠ¨-å¤šä¸ªåº”ç”¨-ï¼›"><a href="#ä¸ºé¿å…å¯åŠ¨-å¤šä¸ªåº”ç”¨-ï¼›" class="headerlink" title="ä¸ºé¿å…å¯åŠ¨ __å¤šä¸ªåº”ç”¨__ï¼›"></a>ä¸ºé¿å…å¯åŠ¨ __å¤šä¸ªåº”ç”¨__ï¼›</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">app.on(<span class="string">&#x27;second-instance&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> mainWindow = BrowserWindowsMap.get(mainWindowId)</span><br><span class="line">  <span class="keyword">if</span> (mainWindow) &#123;</span><br><span class="line">    mainWindow.restore()</span><br><span class="line">    mainWindow.show()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p><em>æ³¨ï¼š<code>macOS</code> <code>Linux</code> <code>Windows</code> <a href="https://www.electronjs.org/docs/api/app#%E4%BA%8B%E4%BB%B6-second-instance">å®Œæ•´æ–‡æ¡£</a></em>  </p><h4 id="é¦–æ¬¡å¯åŠ¨åº”ç”¨ç¨‹åºã€å°è¯•åœ¨åº”ç”¨ç¨‹åºå·²è¿è¡Œæ—¶æˆ–å•å‡»-åº”ç”¨ç¨‹åº-çš„-åç«™-æˆ–-ä»»åŠ¡æ å›¾æ ‡-æ—¶é‡æ–°æ¿€æ´»å®ƒï¼›"><a href="#é¦–æ¬¡å¯åŠ¨åº”ç”¨ç¨‹åºã€å°è¯•åœ¨åº”ç”¨ç¨‹åºå·²è¿è¡Œæ—¶æˆ–å•å‡»-åº”ç”¨ç¨‹åº-çš„-åç«™-æˆ–-ä»»åŠ¡æ å›¾æ ‡-æ—¶é‡æ–°æ¿€æ´»å®ƒï¼›" class="headerlink" title="é¦–æ¬¡å¯åŠ¨åº”ç”¨ç¨‹åºã€å°è¯•åœ¨åº”ç”¨ç¨‹åºå·²è¿è¡Œæ—¶æˆ–å•å‡» åº”ç”¨ç¨‹åº çš„ åç«™ æˆ– ä»»åŠ¡æ å›¾æ ‡ æ—¶é‡æ–°æ¿€æ´»å®ƒï¼›"></a>é¦–æ¬¡å¯åŠ¨åº”ç”¨ç¨‹åºã€å°è¯•åœ¨åº”ç”¨ç¨‹åºå·²è¿è¡Œæ—¶æˆ–å•å‡» <strong>åº”ç”¨ç¨‹åº</strong> çš„ <strong>åç«™</strong> æˆ– <strong>ä»»åŠ¡æ å›¾æ ‡</strong> æ—¶é‡æ–°æ¿€æ´»å®ƒï¼›</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">app.on(<span class="string">&#x27;activate&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (mainWindow) &#123;</span><br><span class="line">    mainWindow.restore()</span><br><span class="line">    mainWindow.show()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p><em>æ³¨ï¼š<code>macOS</code> <a href="https://www.electronjs.org/docs/api/app#%E4%BA%8B%E4%BB%B6-second-instance">æ–‡æ¡£</a></em></p><h4 id="åŒå‡»æ‰˜ç›˜å›¾æ ‡-æ‰“å¼€appï¼Œå®Œæ•´ä»£ç è§app-trayã€‚"><a href="#åŒå‡»æ‰˜ç›˜å›¾æ ‡-æ‰“å¼€appï¼Œå®Œæ•´ä»£ç è§app-trayã€‚" class="headerlink" title="åŒå‡»æ‰˜ç›˜å›¾æ ‡ æ‰“å¼€appï¼Œå®Œæ•´ä»£ç è§app/trayã€‚"></a><strong>åŒå‡»æ‰˜ç›˜å›¾æ ‡</strong> æ‰“å¼€<code>app</code>ï¼Œå®Œæ•´ä»£ç è§<code>app/tray</code>ã€‚</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">tray.on(<span class="string">&#x27;double-click&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (mainWindow) &#123;</span><br><span class="line">    mainWindow.restore()</span><br><span class="line">    mainWindow.show()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p><em>æ³¨ï¼š<code>macOS</code>  <code>Windows</code> <a href="https://www.electronjs.org/docs/api/tray#event-double-click-macos-windows">æ–‡æ¡£</a></em></p><h3 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h3><blockquote><p>ä½ å¯ä»¥æ“ä½œæœ¬åº”ç”¨çš„ä¸»çª—å£</p></blockquote><h3 id="æ–‡æ¡£"><a href="#æ–‡æ¡£" class="headerlink" title="æ–‡æ¡£"></a>æ–‡æ¡£</h3><p>å¦‚æœä½ è¿˜æ˜¯æ–°æ‰‹ï¼Œæˆ–è€…æ²¡æœ‰å¼€å‘è¿‡<code>electron</code>åº”ç”¨ï¼Œæµè§ˆå™¨æ‰“å¼€ <a href="https://www.electronjs.org/docs/tutorial/first-app#%E6%89%93%E9%80%A0%E4%BD%A0%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AA-electron-%E5%BA%94%E7%94%A8">æ‰“é€ ä½ çš„ç¬¬ä¸€ä¸ª Electron åº”ç”¨</a></p><h2 id="å…¨å±ã€æœ€å¤§åŒ–ã€æœ€å°åŒ–ã€å…³é—­"><a href="#å…¨å±ã€æœ€å¤§åŒ–ã€æœ€å°åŒ–ã€å…³é—­" class="headerlink" title="å…¨å±ã€æœ€å¤§åŒ–ã€æœ€å°åŒ–ã€å…³é—­"></a>å…¨å±ã€æœ€å¤§åŒ–ã€æœ€å°åŒ–ã€å…³é—­</h2><h3 id="å…¨å±"><a href="#å…¨å±" class="headerlink" title="å…¨å±"></a>å…¨å±</h3><h4 id="åˆ›å»ºæ—¶è¿›å…¥å…¨å±"><a href="#åˆ›å»ºæ—¶è¿›å…¥å…¨å±" class="headerlink" title="åˆ›å»ºæ—¶è¿›å…¥å…¨å±"></a>åˆ›å»ºæ—¶è¿›å…¥å…¨å±</h4><blockquote><p>é…ç½®<code>new BrowserWindow(&#123; fullscreen:true &#125;)</code>  </p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @@code-renderer: runner</span></span><br><span class="line"><span class="comment">// @@code-props: &#123; hideRight: true, height:&#x27;100px&#x27; &#125;</span></span><br><span class="line"><span class="keyword">const</span> &#123; BrowserWindow &#125; = <span class="built_in">require</span>(<span class="string">&#x27;electron&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> win = <span class="keyword">new</span> BrowserWindow(&#123; <span class="attr">fullscreen</span>:<span class="literal">true</span>,<span class="attr">fullscreenable</span>:<span class="literal">true</span> &#125;)</span><br><span class="line">win.loadURL(<span class="string">&#x27;https://github.com&#x27;</span>)</span><br></pre></td></tr></table></figure><h4 id="ä½¿ç”¨APIè¿›å…¥å…¨å±"><a href="#ä½¿ç”¨APIè¿›å…¥å…¨å±" class="headerlink" title="ä½¿ç”¨APIè¿›å…¥å…¨å±"></a>ä½¿ç”¨<code>API</code>è¿›å…¥å…¨å±</h4><blockquote><p>ç¡®ä¿å½“å‰çª—å£çš„<code>fullscreenable:true</code>ï¼Œä»¥ä¸‹<code>API</code>æ‰èƒ½ä½¿ç”¨</p></blockquote><ol><li><code>win.setFullScreen(flag)</code>ï¼Œè®¾ç½®å…¨å±çŠ¶æ€ï¼›</li><li><code>win.setSimpleFullScreen(flag)</code>ï¼Œ<code>macOS</code>ä¸‹ç‹¬æœ‰ï¼Œè®¾ç½®ç®€å•å…¨å±ã€‚</li></ol><h4 id="å…¨å±çŠ¶æ€çš„è·å–"><a href="#å…¨å±çŠ¶æ€çš„è·å–" class="headerlink" title="å…¨å±çŠ¶æ€çš„è·å–"></a>å…¨å±çŠ¶æ€çš„è·å–</h4><ol><li><code>win.fullScreen</code>ï¼Œæ¥åˆ¤æ–­å½“å‰çª—å£æ˜¯å¦å…¨å±ï¼›</li><li><code>win.isFullScreen()</code>ï¼Œ<code>macOS</code>ç‹¬æœ‰ï¼›</li><li><code>win.isSimpleFullScreen()</code>ï¼Œ<code>macOS</code>ç‹¬æœ‰ã€‚</li></ol><h4 id="å…¨å±äº‹ä»¶çš„ç›‘å¬"><a href="#å…¨å±äº‹ä»¶çš„ç›‘å¬" class="headerlink" title="å…¨å±äº‹ä»¶çš„ç›‘å¬"></a>å…¨å±äº‹ä»¶çš„ç›‘å¬</h4><ol><li><code>rezise</code> è°ƒæ•´çª—å£å¤§å°åè§¦å‘;</li><li><code>enter-full-screen</code> çª—å£è¿›å…¥å…¨å±çŠ¶æ€æ—¶è§¦å‘;</li><li><code>leave-full-screen</code> çª—å£ç¦»å¼€å…¨å±çŠ¶æ€æ—¶è§¦å‘;</li><li><code>enter-html-full-screen</code> çª—å£è¿›å…¥ç”±HTML API è§¦å‘çš„å…¨å±çŠ¶æ€æ—¶è§¦å‘;</li><li><code>leave-html-full-screen</code> çª—å£ç¦»å¼€ç”±HTML APIè§¦å‘çš„å…¨å±çŠ¶æ€æ—¶è§¦å‘ã€‚</li></ol><h4 id="HTML-APIæ— æ³•å’Œçª—å£è”åŠ¨"><a href="#HTML-APIæ— æ³•å’Œçª—å£è”åŠ¨" class="headerlink" title="HTML APIæ— æ³•å’Œçª—å£è”åŠ¨"></a><code>HTML</code> <code>API</code>æ— æ³•å’Œçª—å£è”åŠ¨</h4><p><strong>è¯•ä¸€è¯•</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @@code-renderer: runner</span></span><br><span class="line"><span class="comment">// @@code-props: &#123; hideRight: true, height:&#x27;200px&#x27; &#125;</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> &#123; BrowserWindow &#125; = <span class="built_in">require</span>(<span class="string">&#x27;electron&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> BaseWebPreferences = &#123; </span><br><span class="line">    nodeIntegration: <span class="literal">true</span>,</span><br><span class="line">    preload: path.resolve(__dirname, <span class="string">&#x27;./fullScreen.js&#x27;</span>), </span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> win = <span class="keyword">new</span> BrowserWindow(&#123; <span class="attr">webPreferences</span>: BaseWebPreferences &#125;)</span><br><span class="line">win.loadURL(<span class="string">&#x27;file:///&#x27;</span> + path.resolve(__dirname, <span class="string">&#x27;../playground/index.html#/demo/full-screen&#x27;</span>))</span><br></pre></td></tr></table></figure><blockquote><p>ä½¿ç”¨æŒ‰é’®å…¨å±å’Œé€€å‡ºå…¨å±æ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯å…ˆç‚¹å‡»å·¦ä¸Šè§’ğŸš¥å…¨å±ï¼Œå†ä½¿ç”¨æŒ‰é’®é€€å‡ºå…¨å±ï¼Œæ˜¯ä¸è¡Œçš„ã€‚å› ä¸ºæ— æ³•çŸ¥é“å½“å‰çš„çŠ¶æ€æ˜¯å…¨å±ï¼Œè¿˜æ˜¯ä¸æ˜¯å…¨å±ã€‚</p></blockquote><p>è§£å†³åŠæ³•ï¼šï¼Œå°†<code>win.setFullScreen(flag)</code>æ–¹æ³•æŒ‚è½½åˆ°çª—å£çš„<code>window</code>ä¸Š</p><h3 id="æœ€å¤§åŒ–ã€æœ€å°åŒ–"><a href="#æœ€å¤§åŒ–ã€æœ€å°åŒ–" class="headerlink" title="æœ€å¤§åŒ–ã€æœ€å°åŒ–"></a>æœ€å¤§åŒ–ã€æœ€å°åŒ–</h3><h4 id="åˆ›å»ºçª—å£é…ç½®"><a href="#åˆ›å»ºçª—å£é…ç½®" class="headerlink" title="åˆ›å»ºçª—å£é…ç½®"></a>åˆ›å»ºçª—å£é…ç½®</h4><blockquote><p><a href="https://www.electronjs.org/docs/api/browser-window#new-browserwindowoptions">å®Œæ•´APIæ–‡æ¡£</a></p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @@code-renderer: runner</span></span><br><span class="line"><span class="comment">// @@code-props: &#123; hideRight: true, height:&#x27;100px&#x27; &#125;</span></span><br><span class="line"><span class="keyword">const</span> &#123; BrowserWindow &#125; = <span class="built_in">require</span>(<span class="string">&#x27;electron&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> win = <span class="keyword">new</span> BrowserWindow(&#123; <span class="attr">minWidth</span>:<span class="number">300</span>,<span class="attr">minHeight</span>:<span class="number">300</span>,<span class="attr">maxWidth</span>:<span class="number">500</span>,<span class="attr">maxHeight</span>:<span class="number">500</span>,<span class="attr">width</span>:<span class="number">600</span>,<span class="attr">height</span>:<span class="number">600</span> &#125;)</span><br><span class="line">win.loadURL(<span class="string">&#x27;https://github.com&#x27;</span>)</span><br></pre></td></tr></table></figure><p><em>å½“ä½¿ç”¨ <code>minWidth/maxWidth/minHeight/maxHeight</code> è®¾ç½®æœ€å°æˆ–æœ€å¤§çª—å£å¤§å°æ—¶, å®ƒåªé™åˆ¶ç”¨æˆ·ã€‚ å®ƒä¸ä¼šé˜»æ­¢æ‚¨å°†ä¸ç¬¦åˆå¤§å°é™åˆ¶çš„å€¼ä¼ é€’ç»™ <code>setBounds/setSize</code> æˆ– <code>BrowserWindow</code> çš„æ„é€ å‡½æ•°ã€‚</em></p><h4 id="ç›¸å…³äº‹ä»¶"><a href="#ç›¸å…³äº‹ä»¶" class="headerlink" title="ç›¸å…³äº‹ä»¶"></a>ç›¸å…³äº‹ä»¶</h4><table><thead><tr><th>äº‹ä»¶åç§°</th><th>è§¦å‘æ¡ä»¶</th></tr></thead><tbody><tr><td><code>maximize</code></td><td>çª—å£æœ€å¤§åŒ–æ—¶è§¦å‘</td></tr><tr><td><code>unmaximize</code></td><td>å½“çª—å£ä»æœ€å¤§åŒ–çŠ¶æ€é€€å‡ºæ—¶è§¦å‘</td></tr><tr><td><code>minimize</code></td><td>çª—å£æœ€å°åŒ–æ—¶è§¦å‘</td></tr><tr><td><code>restore</code></td><td>å½“çª—å£ä»æœ€å°åŒ–çŠ¶æ€æ¢å¤æ—¶è§¦å‘</td></tr></tbody></table><h4 id="ç›¸å…³çŠ¶æ€API"><a href="#ç›¸å…³çŠ¶æ€API" class="headerlink" title="ç›¸å…³çŠ¶æ€API"></a>ç›¸å…³çŠ¶æ€API</h4><ol><li><code>win.minimizable</code> çª—å£æ˜¯å¦å¯ä»¥æœ€å°åŒ–</li><li><code>win.maximizable</code> çª—å£æ˜¯å¦å¯ä»¥æœ€å¤§åŒ–</li><li><code>win.isMaximized()</code> æ˜¯å¦æœ€å¤§åŒ–</li><li><code>win.isMinimized()</code> æ˜¯å¦æœ€å°åŒ–</li></ol><h4 id="æ§åˆ¶API"><a href="#æ§åˆ¶API" class="headerlink" title="æ§åˆ¶API"></a>æ§åˆ¶API</h4><ol><li><code>win.maximize()</code> ä½¿çª—å£æœ€å¤§åŒ–</li><li><code>win.unmaximize()</code> é€€å‡ºæœ€å¤§åŒ–</li><li><code>win.minimize()</code> ä½¿çª—å£æœ€å°åŒ–</li><li><code>win.unminimize()</code> é€€å‡ºæœ€å°åŒ–</li></ol><h3 id="çª—å£æ¢å¤"><a href="#çª—å£æ¢å¤" class="headerlink" title="çª—å£æ¢å¤"></a>çª—å£æ¢å¤</h3><p><code>win.restore()</code> å°†çª—å£ä»æœ€å°åŒ–çŠ¶æ€æ¢å¤åˆ°ä»¥å‰çš„çŠ¶æ€ã€‚</p><h2 id="åˆ›å»ºå’Œç®¡ç†çª—å£"><a href="#åˆ›å»ºå’Œç®¡ç†çª—å£" class="headerlink" title="åˆ›å»ºå’Œç®¡ç†çª—å£"></a>åˆ›å»ºå’Œç®¡ç†çª—å£</h2><p>é€šè¿‡<code>electron</code>çš„<code>BrowserWindow</code>æ¨¡å—ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾ <strong>åˆ›å»º</strong> å’Œ <strong>ç®¡ç†</strong> çª—å£ã€‚</p><p>åœ¨æµè§ˆå™¨æ‰“å¼€ <a href="https://www.electronjs.org/docs/api/browser-window">å®Œæ•´çš„APIæ–‡æ¡£</a></p><p>æ¯ä¸ªåº”ç”¨ï¼Œå› ä¸ºä¸šåŠ¡çš„ä¸åŒï¼›åˆ›å»ºå’Œç®¡ç†çª—å£çš„æ–¹å¼å’Œæµç¨‹ä¹Ÿå¤§ä¸ç›¸åŒï¼›è¿™é‡Œæˆ‘ä»¬ä»¥ä¸‹æµç¨‹ä¸ºä¾‹ï¼š</p><img src= "/img/loading.gif" data-lazy-src="http://mei160.cn/images/window-create.png" alt="window create"><h3 id="åˆ›å»ºçª—å£"><a href="#åˆ›å»ºçª—å£" class="headerlink" title="åˆ›å»ºçª—å£"></a>åˆ›å»ºçª—å£</h3><p>é€šè¿‡<code>BrowserWindow</code>ï¼Œæ¥ <strong>åˆ›å»º</strong> æˆ–è€… <strong>ç®¡ç†</strong> æ–°çš„æµè§ˆå™¨çª—å£ï¼Œæ¯ä¸ªæµè§ˆå™¨çª—å£éƒ½æœ‰ä¸€ä¸ªè¿›ç¨‹æ¥ç®¡ç†ã€‚</p><p>è¿™é‡Œï¼Œæˆ‘ä»¬æŠŠ <strong>åˆ›å»º</strong> å’Œ <strong>ç®¡ç†__ï¼Œåˆ†ä¸º __ç”¨æˆ·è¡Œä¸º</strong> å’Œ __åº”ç”¨æœ¬èº«__ã€‚</p><p><strong>åº”ç”¨æœ¬èº«</strong> å³æ˜¯ï¼šåº”ç”¨å¯åŠ¨ â€”â€”&gt; çª—å£åˆ›å»º â€“&gt; çª—å£å±•ç¤º<br><strong>ç”¨æˆ·è¡Œä¸º</strong> å³æ˜¯ï¼šçª—å£å·²ç»åˆ›å»ºå®Œæ¯•ï¼Œç”¨æˆ·ç‚¹å‡»<code>a</code>é“¾æ¥è€Œåˆ›å»ºçš„çª—å£çš„è¡Œä¸º</p><h4 id="ç®€å•åˆ›å»ºä¸€ä¸ªçª—å£"><a href="#ç®€å•åˆ›å»ºä¸€ä¸ªçª—å£" class="headerlink" title="ç®€å•åˆ›å»ºä¸€ä¸ªçª—å£"></a>ç®€å•åˆ›å»ºä¸€ä¸ªçª—å£</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @@code-renderer: runner</span></span><br><span class="line"><span class="comment">// @@code-props: &#123; hideRight: false, height:&#x27;100px&#x27; &#125;</span></span><br><span class="line"><span class="keyword">const</span> &#123; BrowserWindow &#125; = <span class="built_in">require</span>(<span class="string">&#x27;electron&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> win = <span class="keyword">new</span> BrowserWindow();</span><br><span class="line">win.loadURL(<span class="string">&#x27;https://github.com&#x27;</span>);</span><br></pre></td></tr></table></figure><h4 id="ä¼˜åŒ–"><a href="#ä¼˜åŒ–" class="headerlink" title="ä¼˜åŒ–"></a>ä¼˜åŒ–</h4><p>__é—®é¢˜__ï¼š<code>electron</code>çš„<code>BrowserWindow</code>æ¨¡å—åœ¨åˆ›å»ºæ—¶ï¼Œå¦‚æœæ²¡æœ‰é…ç½®<code>show:false</code>ï¼Œåœ¨åˆ›å»ºä¹‹æ—¶å°±ä¼šæ˜¾ç¤ºå‡ºæ¥ï¼Œä¸”é»˜è®¤çš„èƒŒæ™¯æ˜¯ç™½è‰²ï¼›ç„¶åçª—å£è¯·æ±‚<code>HTML</code>ï¼Œä¼šå‡ºç°é—ªçƒã€‚   </p><p><a href="https://www.electronjs.org/docs/api/browser-window#%E4%BD%BF%E7%94%A8ready-to-show%E4%BA%8B%E4%BB%B6">å®Œæ•´apiæ–‡æ¡£</a></p><p><strong>è§£å†³</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @@code-renderer: runner</span></span><br><span class="line"><span class="comment">// @@code-props: &#123; hideRight: true, height:&#x27;200px&#x27; &#125;</span></span><br><span class="line"><span class="keyword">const</span> &#123; BrowserWindow &#125; = <span class="built_in">require</span>(<span class="string">&#x27;electron&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> win = <span class="keyword">new</span> BrowserWindow(&#123; <span class="attr">show</span>:<span class="literal">false</span>,<span class="attr">x</span>:<span class="number">100</span>,<span class="attr">y</span>:<span class="number">100</span> &#125;);</span><br><span class="line"></span><br><span class="line">win.loadURL(<span class="string">&#x27;https://github.com&#x27;</span>);</span><br><span class="line"></span><br><span class="line">win.on(<span class="string">&#x27;ready-to-show&#x27;</span>,<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    win.show();</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>__å¯¹æ¯”ä¸Šé¢ç®€å•åˆ›å»ºçª—å£__ï¼Œå¯ä»¥æ˜æ˜¾çœ‹å‡º2è€…çš„åŒºåˆ«</p><p><code>new BrowserWindow(options)</code>ï¼Œ<a href="https://www.electronjs.org/docs/api/browser-window#new-browserwindowoptions">optionsé…ç½®æ–‡æ¡£</a>  </p><h3 id="ç®¡ç†çª—å£"><a href="#ç®¡ç†çª—å£" class="headerlink" title="ç®¡ç†çª—å£"></a>ç®¡ç†çª—å£</h3><h4 id="ç®¡ç†åº”ç”¨åˆ›å»ºçš„çª—å£"><a href="#ç®¡ç†åº”ç”¨åˆ›å»ºçš„çª—å£" class="headerlink" title="ç®¡ç†åº”ç”¨åˆ›å»ºçš„çª—å£"></a>ç®¡ç†åº”ç”¨åˆ›å»ºçš„çª—å£</h4><p><code>BrowserWindow</code>æ¨¡å—åœ¨åˆ›å»ºçª—å£æ—¶ï¼Œä¼šè¿”å› <strong>çª—å£å®ä¾‹</strong></p><p>åœ¨è¿™é‡Œä½¿ç”¨<code>Map</code>å¯¹è±¡æ¥å­˜å‚¨è¿™äº› <strong>çª—å£å®ä¾‹</strong></p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> BrowserWindowsMap = <span class="keyword">new</span> <span class="built_in">Map</span>&lt;<span class="built_in">number</span>, BrowserWindow&gt;()</span><br><span class="line"><span class="keyword">let</span> mainWindowId: <span class="built_in">number</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> browserWindows = <span class="keyword">new</span> BrowserWindow(&#123; show:<span class="literal">false</span> &#125;)</span><br><span class="line">browserWindows.loadURL(<span class="string">&#x27;https://github.com&#x27;</span>)</span><br><span class="line">browserWindows.once(<span class="string">&#x27;ready-to-show&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  browserWindows.show()</span><br><span class="line">&#125;)</span><br><span class="line">BrowserWindowsMap.set(browserWindow.id, browserWindow)</span><br><span class="line">mainWindowId = browserWindow.id  <span class="comment">// è®°å½•å½“å‰çª—å£ä¸ºä¸»çª—å£</span></span><br></pre></td></tr></table></figure><blockquote><p>ä»£ç ä¸­æåˆ° __ä¸»çª—å£__ï¼Œä»€ä¹ˆæ˜¯ä¸»çª—å£ï¼Ÿ<a href="./index.html#/browser/awaken">ä¸»çª—å£éšè—å’Œæ¢å¤</a>ç« èŠ‚</p></blockquote><p>__çª—å£è¢«å…³é—­__ï¼Œå¾—æŠŠ<code>Map</code>ä¸­çš„å®ä¾‹åˆ é™¤ã€‚</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">browserWindow.on(<span class="string">&#x27;closed&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  BrowserWindowsMap?.delete(browserWindowID)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="ç®¡ç†ç”¨æˆ·åˆ›å»ºçš„çª—å£"><a href="#ç®¡ç†ç”¨æˆ·åˆ›å»ºçš„çª—å£" class="headerlink" title="ç®¡ç†ç”¨æˆ·åˆ›å»ºçš„çª—å£"></a>ç®¡ç†ç”¨æˆ·åˆ›å»ºçš„çª—å£</h4><p>ä¸€ä¸ªçª—å£ä¸­å­˜åœ¨è®¸å¤šçš„é“¾æ¥ï¼Œä¸ç®¡æ˜¯é“¾æ¥è·³è½¬ï¼Œæˆ–æ˜¯åˆ›å»ºæ–°çš„çª—å£ï¼Œæˆ‘ä»¬éƒ½éœ€è¦ç®¡ç†è¿™äº›çª—å£ã€‚</p><p><strong>ä½¿ç”¨<code>new-window</code>ç›‘å¬çª—å£åˆ›å»º</strong><br>ä½¿ç”¨<code>new-window</code>å¯ç›‘å¬ <strong>æ–°çª—å£</strong> çš„åˆ›å»ºã€‚æµè§ˆå™¨æ‰“å¼€<a href="https://www.electronjs.org/docs/api/web-contents#event-new-window">å®Œæ•´æ–‡æ¡£</a></p><p>æ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ›å»ºçª—å£ç›‘å¬</span></span><br><span class="line">browserWindow.webContents.on(<span class="string">&#x27;new-window&#x27;</span>, <span class="function">(<span class="params">event, url, frameName, disposition</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">/** <span class="doctag">@params <span class="type">&#123;string&#125;</span> <span class="variable">disposition</span></span></span></span><br><span class="line"><span class="comment">  *  new-window : window.openè°ƒç”¨</span></span><br><span class="line"><span class="comment">  *  background-tab: command+click</span></span><br><span class="line"><span class="comment">  *  foreground-tab: å³é”®ç‚¹å‡»æ–°æ ‡ç­¾æ‰“å¼€æˆ–ç‚¹å‡»aæ ‡ç­¾target _blankæ‰“å¼€</span></span><br><span class="line"><span class="comment">  * /</span></span><br><span class="line"><span class="comment">&#125;)</span></span><br></pre></td></tr></table></figure><blockquote><p>æ³¨ï¼šå…³äº<code>disposition</code>å­—æ®µçš„è§£é‡Šï¼Œç§»æ­¥<a href="https://www.electronjs.org/docs/api/web-contents#webcontents">electronæ–‡æ¡£</a>ã€<a href="https://github.com/electron/electron/blob/72a089262e31054eabd342294ccdc4c414425c99/shell/browser/api/electron_api_web_contents.cc">electronæºç </a>ã€<a href="https://chromium.googlesource.com/chromium/src/+/66.0.3359.158/ui/base/mojo/window_open_disposition_struct_traits.h">chrome æºç </a></p></blockquote><p><strong>æ‰©å±•<code>new-window</code></strong></p><ul><li>å¯ä»¥è¢« å½“å‰çª—å£çš„ <code>new-window</code>äº‹ä»¶æ•æ‰åˆ°çš„</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.open(<span class="string">&#x27;https://github.com&#x27;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&#x27;https://github.com&#x27;</span> <span class="attr">target</span>=<span class="string">&#x27;__blank&#x27;</span>&gt;</span>é“¾æ¥<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>ä¸å¯è¢« å½“å‰çª—å£çš„ <code>new-window</code>äº‹ä»¶æ•æ‰åˆ°çš„<br>ä»¥ä¸‹apiéœ€è¦çª—å£ é›†æˆnodeï¼Œå³ <strong>ä¸»è¿›ç¨‹</strong> åˆ›å»ºæ—¶éœ€é…ç½®<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; BrowserWindow &#125; = <span class="built_in">require</span>(<span class="string">&#x27;electron&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> parent = <span class="keyword">new</span> BrowserWindow(&#123; <span class="attr">webPreferences</span>:&#123;<span class="attr">nodeIntegration</span>: <span class="literal">true</span>&#125;&#125;);</span><br></pre></td></tr></table></figure><strong>æ¸²æŸ“è¿›ç¨‹</strong> ä½¿ç”¨<code>BrowserWindow</code>åˆ›å»ºçª—å£<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; BrowserWindow &#125; = <span class="built_in">require</span>(<span class="string">&#x27;electron&#x27;</span>).remote</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> win = <span class="keyword">new</span> BrowserWindow()</span><br><span class="line">win.loadURL(<span class="string">&#x27;https://github.com&#x27;</span>)</span><br></pre></td></tr></table></figure><strong>åº”ç”¨<code>new-window</code></strong><br><strong>é€šè¿‡ __é»˜è®¤æµè§ˆå™¨</strong> æ¥æ‰“å¼€ __ç¬¬ä¸‰æ–¹é“¾æ¥<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; shell &#125; <span class="keyword">from</span> <span class="string">&#x27;electron&#x27;</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">openExternal</span>(<span class="params">url: <span class="built_in">string</span></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> HTTP_REGEXP = <span class="regexp">/^https?:\/\//</span></span><br><span class="line">  <span class="comment">// éhttpåè®®ä¸æ‰“å¼€ï¼Œé˜²æ­¢å‡ºç°è‡ªå®šä¹‰åè®®ç­‰å¯¼è‡´çš„å®‰å…¨é—®é¢˜</span></span><br><span class="line">  <span class="keyword">if</span> (!HTTP_REGEXP) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">await</span> shell.openExternal(url, options)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">  &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">    <span class="built_in">console</span>.error(<span class="string">&#x27;open external error: &#x27;</span>, error)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åˆ›å»ºçª—å£ç›‘å¬</span></span><br><span class="line">browserWindow.webContents.on(<span class="string">&#x27;new-window&#x27;</span>, <span class="function">(<span class="params">event, url, frameName, disposition</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (disposition === <span class="string">&#x27;foreground-tab&#x27;</span>) &#123;</span><br><span class="line">      <span class="comment">// é˜»æ­¢é¼ æ ‡ç‚¹å‡»é“¾æ¥</span></span><br><span class="line">      event.preventDefault()</span><br><span class="line">      openExternal(url)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li></ul><h3 id="å…³é—­çª—å£"><a href="#å…³é—­çª—å£" class="headerlink" title="å…³é—­çª—å£"></a>å…³é—­çª—å£</h3><p>å…³é—­çª—å£æˆ–è€…éšè—çš„<code>API</code></p><h4 id="win-close"><a href="#win-close" class="headerlink" title="win.close()"></a><code>win.close()</code></h4><ol><li>å…³é—­é¡µé¢ï¼Œå¦‚æœé˜»æ­¢<code>close</code>äº‹ä»¶ï¼Œå°†ä¸ä¼šå…³é—­é¡µé¢ï¼Œè¿™ä¼š __é˜»æ­¢è®¡ç®—æœºå…³é—­__ï¼›</li><li>å…³é—­é¡µé¢çš„æœåŠ¡ï¼Œå¦‚<code>websocket</code>ï¼Œä¸‹æ¬¡æ‰“å¼€çª—å£ï¼Œçª—å£ä¸­çš„é¡µé¢ä¼š __é‡æ–°æ¸²æŸ“__ï¼›</li><li>é€šè¿‡è¿™ä¸ª<code>API</code>è§¦å‘çš„<code>close</code>äº‹ä»¶åœ¨ <code>unload</code> å’Œ <code>beforeunload</code>ä¹‹å‰è§¦å‘ï¼Œé€šè¿‡è¿™ç‚¹å¯ä»¥å®ç° __å…³é—­æ—¶è§¦å‘å¼¹çª—__ï¼›</li><li>ä¼šè¢«<code>closed</code>äº‹ä»¶æ•æ‰åˆ°ã€‚</li></ol><p>__ä¾‹å­__ï¼šå®ç°å…³é—­çª—å£ä¹‹å‰è§¦å‘å¼¹çª—<br>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @@code-renderer: runner</span></span><br><span class="line"><span class="comment">// @@code-props: &#123; hideRight: true, height:&#x27;100px&#x27; &#125;</span></span><br><span class="line"><span class="keyword">const</span> &#123; BrowserWindow &#125; = <span class="built_in">require</span>(<span class="string">&#x27;electron&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> browserWindows = <span class="keyword">new</span> BrowserWindow(&#123;<span class="attr">webPreferences</span>:&#123;<span class="attr">nodeIntegration</span>: <span class="literal">true</span>,<span class="attr">webSecurity</span>: <span class="literal">false</span>&#125;&#125;)</span><br><span class="line">browserWindows.loadURL(<span class="string">&#x27;file:///&#x27;</span> + path.resolve(__dirname, <span class="string">&#x27;../playground/index.html#/demo/window-close&#x27;</span>))</span><br></pre></td></tr></table></figure><p>æ³¨ï¼š</p><ul><li>ä¸Šé¢ä»£ç ï¼Œåªèƒ½åº”ç”¨äºelectronç«¯ï¼Œåœ¨webç«¯åˆ·æ–°ä¸èµ·ä½œç”¨ï¼›webç«¯æ— æ³•åœ¨é¡µé¢å…³é—­æˆ–è€…åˆ·æ–°ä¹‹å‰é˜»å¡æµè§ˆå™¨ï¼›<img src= "/img/loading.gif" data-lazy-src="http://mei160.cn/images/close-window-model.png" alt="close-window-model" /><img src= "/img/loading.gif" data-lazy-src="http://mei160.cn/images/close-window-model2.png" alt="close-window-model" /></li><li>é˜»æ­¢å…³é—­çª—å£å‡ºç°çš„å¼¹çª—ï¼Œ<code>img</code>å…ƒç´ å¤–é“¾<code>url</code>ä¸èµ·ä½œç”¨ï¼Œä¼šå‘å‡ºè¯·æ±‚ï¼Œä½†æ˜¯ä¸ä¼šæ¸²æŸ“å‡ºæ¥ï¼Œå¯ä»¥ä½¿ç”¨<code>div+background</code>çš„æ–¹å¼ï¼›</li><li>å…³äº<code>beforeunload</code><a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/beforeunload_event">å®Œæ•´<code>API</code>æ–‡æ¡£</a></li></ul><h4 id="win-destroy"><a href="#win-destroy" class="headerlink" title="win.destroy()"></a><code>win.destroy()</code></h4><ol><li>å¼ºåˆ¶é€€å‡ºï¼Œæ— è§†<code>close</code>äº‹ä»¶ï¼›</li><li>å…³é—­é¡µé¢ï¼Œä»¥åŠé¡µé¢å†…çš„æœåŠ¡ï¼Œä¸‹æ¬¡æ‰“å¼€çª—å£ï¼Œçª—å£ä¸­çš„é¡µé¢ä¼šé‡æ–°æ¸²æŸ“ï¼›</li><li>ä¼šè¢«<code>closed</code>äº‹ä»¶æ•æ‰åˆ°ã€‚</li></ol><h4 id="win-hide"><a href="#win-hide" class="headerlink" title="win.hide()"></a><code>win.hide()</code></h4><blockquote><p>è¿™ä¸ªéšè—çª—å£ã€‚</p></blockquote><ol><li>éšè—çª—å£ï¼Œä¼šè§¦å‘<code>hide</code>å’Œ<code>blur</code>äº‹ä»¶ï¼ŒåŒæ ·ä¹Ÿæ˜¯å¯ä»¥é€šè¿‡<code>event.preventDefault()</code>æ¥é˜»æ­¢</li><li>åªæ˜¯éšè—çª—å£ï¼Œé€šè¿‡<code>win.show()</code>ï¼Œå¯ä»¥å°†çª—å£æ˜¾ç°ï¼Œå¹¶ä¸”ä¼šä¿æŒåŸæ¥çš„çª—å£ï¼Œé‡Œé¢çš„æœåŠ¡ä¹Ÿä¸ä¼šæŒ‚æ–­</li></ol><h3 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h3><ul><li>å…³äºé¡µé¢å¯è§æ€§ï¼Œå¯å‚è§<a href="https://www.electronjs.org/docs/API/browser-window#%E9%A1%B5%E9%9D%A2%E5%8F%AF%E8%A7%81%E6%80%A7">æ–‡æ¡£</a>ï¼›</li><li><strong>ä¸»çª—å£çš„éšè—å’Œå”¤é†’</strong> çš„å…·ä½“ç»†èŠ‚ï¼Œå¯å‚è§æœ¬ç« çš„ <a href="./index.html#/browser/awaken">ä¸»çª—å£éšè—å’Œæ¢å¤</a>ç« èŠ‚ï¼›</li><li>çª—å£åœ¨è¢«åˆ›å»ºä¹‹åï¼Œçª—å£å®ä¾‹å„ç§ <strong>äº‹ä»¶è§¦å‘é¡ºåº</strong> å¯å‚è§ <a href="./index.html#/browser/window-event">çª—å£è§¦å‘é¡ºåº</a>ç« èŠ‚ï¼›</li><li>__çª—å£é€šä¿¡__ï¼Œå¯å‚è§ <a href="./index.html#/browser/communication">çª—å£é€šä¿¡</a>ç« èŠ‚ï¼›</li><li>__æ— è¾¹æ¡†çª—å£__ã€__çˆ¶å­çª—å£__ã€__æ¨¡æ€çª—å£__ï¼Œå‚è§<a href="./index.html#/browser/window-type">çª—å£ç±»å‹</a>ç« èŠ‚ï¼›</li></ul><h2 id="çª—å£ä¹‹é—´çš„é€šä¿¡"><a href="#çª—å£ä¹‹é—´çš„é€šä¿¡" class="headerlink" title="çª—å£ä¹‹é—´çš„é€šä¿¡"></a>çª—å£ä¹‹é—´çš„é€šä¿¡</h2><h3 id="ä¸»è¿›ç¨‹å¹²é¢„æ–¹å¼"><a href="#ä¸»è¿›ç¨‹å¹²é¢„æ–¹å¼" class="headerlink" title="ä¸»è¿›ç¨‹å¹²é¢„æ–¹å¼"></a>ä¸»è¿›ç¨‹å¹²é¢„æ–¹å¼</h3><p>ä¸»è¿›ç¨‹æ˜¯å¯ä»¥å¹²é¢„æ¸²æŸ“è¿›ç¨‹ç”Ÿæˆæ–°çš„çª—å£çš„ï¼Œåªéœ€è¦åœ¨åˆ›å»ºçª—å£æ—¶ï¼Œ<code>webContents</code> ç›‘å¬ <code>new-window</code> </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> path <span class="keyword">from</span> <span class="string">&#x27;path&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; PRELOAD_FILE &#125; <span class="keyword">from</span> <span class="string">&#x27;app/config&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; browserWindow &#125; <span class="keyword">from</span> <span class="string">&#x27;electron&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> BaseWebPreferences: Electron.BrowserWindowConstructorOptions[<span class="string">&#x27;webPreferences&#x27;</span>] = &#123;</span><br><span class="line">  nodeIntegration: <span class="literal">true</span>,</span><br><span class="line">  webSecurity: <span class="literal">false</span>,</span><br><span class="line">  preload: path.resolve(__dirname, PRELOAD_FILE),</span><br><span class="line">  enableRemoteModule:<span class="literal">true</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºçª—å£ç›‘å¬</span></span><br><span class="line">browserWindow.webContents.on(<span class="string">&#x27;new-window&#x27;</span>, <span class="function">(<span class="params">event, url, frameName, disposition</span>) =&gt;</span> &#123;</span><br><span class="line">    event.preventDefault()</span><br><span class="line">    <span class="comment">// åœ¨é€šè¿‡BrowserWindowåˆ›å»ºçª—å£</span></span><br><span class="line">    <span class="keyword">const</span> win = <span class="keyword">new</span> BrowserWindow(&#123; </span><br><span class="line">      show:<span class="literal">false</span>, </span><br><span class="line">      webPreferences: &#123;</span><br><span class="line">        ...BaseWebPreferences,</span><br><span class="line">        additionalArguments:[<span class="string">`--parentWindow=<span class="subst">$&#123;browserWindow.id&#125;</span>`</span>] <span class="comment">// æŠŠçˆ¶çª—å£çš„idä¼ è¿‡å»</span></span><br><span class="line">        enableRemoteModule:<span class="literal">true</span></span><br><span class="line">      &#125; </span><br><span class="line">    &#125;);</span><br><span class="line">    win.loadURl(url);</span><br><span class="line">    win.once(<span class="string">&#x27;ready-to-show&#x27;</span>,<span class="function">()=&gt;</span>&#123;</span><br><span class="line">        win.show()</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>åœ¨preload.jsæ–‡ä»¶<code>window.process.argv</code>ï¼Œä¾¿èƒ½æ‹¿åˆ°çˆ¶çª—å£çš„idï¼Œ<code>window.process.argv</code>æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ï¼Œå¯ä»¥ä½¿ç”¨<a href='https://github.com/yargs/yargs'>yargs</a>æ¥è§£æ</p><p>preload.js ä»£ç </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; argv &#125; <span class="keyword">from</span> <span class="string">&#x27;yargs&#x27;</span></span><br><span class="line"><span class="built_in">console</span>.log(argv);</span><br></pre></td></tr></table></figure><img src= "/img/loading.gif" data-lazy-src='http://mei160.cn/images/yargv-parse.png'/>æ‹¿åˆ°çˆ¶çª—å£çš„idï¼Œä¾¿å¯ä»¥é€šä¿¡äº†<p><strong>è¯•ä¸€è¯•</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @@code-renderer: runner</span></span><br><span class="line"><span class="comment">// @@code-props: &#123; hideRight: true, height:&#x27;600px&#x27; &#125;</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> &#123; BrowserWindow &#125; = <span class="built_in">require</span>(<span class="string">&#x27;electron&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> BaseWebPreferences = &#123;</span><br><span class="line">  <span class="comment">// // é›†æˆnode</span></span><br><span class="line">  nodeIntegration: <span class="literal">true</span>,</span><br><span class="line">  <span class="comment">// // ç¦ç”¨åŒæºç­–ç•¥</span></span><br><span class="line">  <span class="comment">// webSecurity: false,</span></span><br><span class="line">  <span class="comment">// é¢„åŠ è½½è„šæœ¬ é€šè¿‡ç»å¯¹åœ°å€æ³¨å…¥</span></span><br><span class="line">  preload: path.resolve(__dirname, <span class="string">&#x27;./communication1.js&#x27;</span>),</span><br><span class="line">  enableRemoteModule:<span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸»çª—å£ä»£ç </span></span><br><span class="line"><span class="keyword">const</span> parent = <span class="keyword">new</span> BrowserWindow(&#123; <span class="attr">webPreferences</span>: BaseWebPreferences, <span class="attr">x</span>: <span class="number">100</span>, <span class="attr">y</span>: <span class="number">0</span> &#125;)</span><br><span class="line">parent.loadURL(</span><br><span class="line">  <span class="string">&#x27;file:///&#x27;</span> + path.resolve(__dirname, <span class="string">&#x27;../playground/index.html#/demo/communication-part1/main&#x27;</span>)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">parent.webContents.on(<span class="string">&#x27;new-window&#x27;</span>, <span class="function">(<span class="params">event, url, frameName, disposition</span>) =&gt;</span> &#123;</span><br><span class="line">  event.preventDefault()</span><br><span class="line"></span><br><span class="line">  <span class="comment">// åœ¨é€šè¿‡BrowserWindowåˆ›å»ºçª—å£ // å­çª—å£ä»£ç </span></span><br><span class="line">  <span class="keyword">const</span> son = <span class="keyword">new</span> BrowserWindow(&#123;</span><br><span class="line">    webPreferences: &#123;</span><br><span class="line">      ...BaseWebPreferences,</span><br><span class="line">      additionalArguments: [<span class="string">&#x27;--parentWindowId=&#x27;</span> + parent.id],</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;)</span><br><span class="line">  son.webContents.openDevTools()</span><br><span class="line">  son.loadURL(</span><br><span class="line">    <span class="string">&#x27;file:///&#x27;</span> +</span><br><span class="line">      path.resolve(__dirname, <span class="string">&#x27;../playground/index.html#/demo/communication-part1/client&#x27;</span>),</span><br><span class="line">  )</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p><strong>å…¶ä½™ä»£ç å¦‚ä¸‹</strong>:<br>ä¸»çª—å£ä»£ç </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; ReactElement, useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> style <span class="keyword">from</span> <span class="string">&#x27;../style.module.less&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">Communication</span>(<span class="params"></span>): <span class="title">ReactElement</span> </span>&#123;</span><br><span class="line">  useEffect(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">document</span>.title = <span class="string">&#x27;çˆ¶çª—å£&#x27;</span></span><br><span class="line">  &#125;, [])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div className=&#123;style.wrap&#125;&gt;</span><br><span class="line">      &lt;a href=<span class="string">&#x27;http://www.github.com&#x27;</span> target=<span class="string">&#x27;__blank&#x27;</span>&gt;</span><br><span class="line">        é€šè¿‡aæ ‡ç­¾target=__blankæ‰“å¼€æ–°çš„çª—å£</span><br><span class="line">      &lt;/a&gt;</span><br><span class="line">      &lt;div</span><br><span class="line">        onClick=&#123;<span class="function">() =&gt;</span> &#123;</span><br><span class="line">          <span class="built_in">window</span>.open(<span class="string">&#x27;http://www.github.com&#x27;</span>)</span><br><span class="line">        &#125;&#125;&gt;</span><br><span class="line">        é€šè¿‡<span class="built_in">window</span>.openæ‰“å¼€æ–°çš„çª—å£</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å­çª—å£ä»£ç </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; ReactElement, useEffect, useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> style <span class="keyword">from</span> <span class="string">&#x27;../style.module.less&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> COUNT_NUM = <span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">Communication</span>(<span class="params"></span>): <span class="title">ReactElement</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> [num, setNum] = useState(COUNT_NUM)</span><br><span class="line"></span><br><span class="line">  useEffect(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">document</span>.title = <span class="string">&#x27;å­çª—å£&#x27;</span></span><br><span class="line">    <span class="keyword">let</span> timer: NodeJS.Timeout</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (num &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      timer = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        setNum(num - <span class="number">1</span>)</span><br><span class="line">      &#125;, <span class="number">1000</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// @ts-ignore</span></span><br><span class="line">      <span class="built_in">window</span>.send(<span class="string">&#x27;hello&#x27;</span>)</span><br><span class="line">      <span class="built_in">window</span>.close()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      timer &amp;&amp; <span class="built_in">clearTimeout</span>(timer)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, [num])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#123;style.countDown&#125;</span>&gt;</span>å­çª—å£ &#123;num&#125; ç§’ä¹‹åï¼Œè¯·çœ‹ä¸»çª—å£<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="çˆ¶å­çª—å£é€šä¿¡"><a href="#çˆ¶å­çª—å£é€šä¿¡" class="headerlink" title="çˆ¶å­çª—å£é€šä¿¡"></a>çˆ¶å­çª—å£é€šä¿¡</h3><p>å’Œä¸»è¿›ç¨‹å¹²é¢„ï¼Œé€šè¿‡<code>ipc</code>é€šä¿¡æ–¹å¼å·®ä¸å¤šï¼Œåªæ˜¯åˆ©ç”¨çˆ¶å­çª—å£è¿™ç‚¹ï¼Œä¸ç”¨é€šè¿‡<code>additionalArguments</code>ä¼ é€’çˆ¶çª—å£<code>id</code>ï¼Œåœ¨å­çª—å£é€šè¿‡<code>window.parent</code>ï¼Œå°±å¯ä»¥æ‹¿åˆ°çˆ¶çª—å£</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">browserWindow.webContents.on(<span class="string">&#x27;new-window&#x27;</span>, <span class="function">(<span class="params">event, url, frameName, disposition</span>) =&gt;</span> &#123;</span><br><span class="line">    event.preventDefault()</span><br><span class="line">      </span><br><span class="line">    <span class="comment">// åœ¨é€šè¿‡BrowserWindowåˆ›å»ºçª—å£</span></span><br><span class="line">    <span class="keyword">const</span> win = <span class="keyword">new</span> BrowserWindow(&#123; </span><br><span class="line">        show:<span class="literal">false</span>, </span><br><span class="line">        webPreferences:BaseWebPreferences,</span><br><span class="line">        parent:browserWindow <span class="comment">// æ·»åŠ çˆ¶çª—å£</span></span><br><span class="line">      &#125;);</span><br><span class="line">    win.loadURl(url);</span><br><span class="line">    win.once(<span class="string">&#x27;ready-to-show&#x27;</span>,<span class="function">()=&gt;</span>&#123;</span><br><span class="line">        win.show()</span><br><span class="line">    &#125;)</span><br><span class="line">    </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>å¼Šç«¯ï¼šå­çª—å£æ°¸è¿œåœ¨çˆ¶çª—å£ä¹‹ä¸Šã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @@code-renderer: runner</span></span><br><span class="line"><span class="comment">// @@code-props: &#123; hideRight: true, height:&#x27;600px&#x27; &#125;</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> &#123; BrowserWindow &#125; = <span class="built_in">require</span>(<span class="string">&#x27;electron&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> BaseWebPreferences = &#123;</span><br><span class="line">  <span class="comment">// // é›†æˆnode</span></span><br><span class="line">  nodeIntegration: <span class="literal">true</span>,</span><br><span class="line">  <span class="comment">// // ç¦ç”¨åŒæºç­–ç•¥</span></span><br><span class="line">  <span class="comment">// webSecurity: false,</span></span><br><span class="line">  <span class="comment">// é¢„åŠ è½½è„šæœ¬ é€šè¿‡ç»å¯¹åœ°å€æ³¨å…¥</span></span><br><span class="line">  preload: path.resolve(__dirname, <span class="string">&#x27;./communication2.js&#x27;</span>),</span><br><span class="line">  enableRemoteModule:<span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸»çª—å£ä»£ç </span></span><br><span class="line"><span class="keyword">const</span> parent = <span class="keyword">new</span> BrowserWindow(&#123; <span class="attr">webPreferences</span>: BaseWebPreferences, <span class="attr">left</span>: <span class="number">100</span>, <span class="attr">top</span>: <span class="number">0</span> &#125;)</span><br><span class="line">parent.loadURL(</span><br><span class="line">  <span class="string">&#x27;file:///&#x27;</span> + path.resolve(__dirname, <span class="string">&#x27;../playground/index.html#/demo/communication-part2/main&#x27;</span>),</span><br><span class="line">)</span><br><span class="line">parent.webContents.on(<span class="string">&#x27;new-window&#x27;</span>, <span class="function">(<span class="params">event, url, frameName, disposition</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// é˜»æ­¢é»˜è®¤äº‹ä»¶</span></span><br><span class="line">  event.preventDefault()</span><br><span class="line">  <span class="comment">// åœ¨é€šè¿‡BrowserWindowåˆ›å»ºçª—å£</span></span><br><span class="line">  <span class="comment">// å­çª—å£ä»£ç </span></span><br><span class="line">  <span class="keyword">const</span> son = <span class="keyword">new</span> BrowserWindow(&#123;</span><br><span class="line">    webPreferences: BaseWebPreferences,</span><br><span class="line">    parent,</span><br><span class="line">    width: <span class="number">400</span>,</span><br><span class="line">    height: <span class="number">400</span>,</span><br><span class="line">    alwaysOnTop: <span class="literal">false</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="comment">// son.webContents.openDevTools();</span></span><br><span class="line">  son.loadURL(</span><br><span class="line">    <span class="string">&#x27;file:///&#x27;</span> +</span><br><span class="line">      path.resolve(__dirname, <span class="string">&#x27;../playground/index.html#/demo/communication-part2/client&#x27;</span>),</span><br><span class="line">  )</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p><strong>å…¶ä½™ä»£ç å¦‚ä¸‹</strong>:</p><p>ä¸»çª—å£ä»£ç </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; ReactElement, useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> style <span class="keyword">from</span> <span class="string">&#x27;../style.module.less&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">Communication</span>(<span class="params"></span>): <span class="title">ReactElement</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  useEffect(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">document</span>.title = <span class="string">&#x27;çˆ¶çª—å£&#x27;</span></span><br><span class="line">  &#125;, [])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div className=&#123;style.wrap&#125;&gt;</span><br><span class="line">      &lt;a href=<span class="string">&#x27;http://www.github.com&#x27;</span> target=<span class="string">&#x27;__blank&#x27;</span>&gt;</span><br><span class="line">        é€šè¿‡aæ ‡ç­¾target=__blankæ‰“å¼€æ–°çš„çª—å£</span><br><span class="line">      &lt;/a&gt;</span><br><span class="line">      &lt;div</span><br><span class="line">        onClick=&#123;<span class="function">() =&gt;</span> &#123;</span><br><span class="line">          <span class="built_in">window</span>.open(<span class="string">&#x27;http://www.github.com&#x27;</span>)</span><br><span class="line">        &#125;&#125;&gt;</span><br><span class="line">        é€šè¿‡<span class="built_in">window</span>.openæ‰“å¼€æ–°çš„çª—å£</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å­çª—å£ä»£ç </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; ReactElement, useEffect, useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> style <span class="keyword">from</span> <span class="string">&#x27;../style.module.less&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> COUNT_NUM = <span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">Communication</span>(<span class="params"></span>): <span class="title">ReactElement</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> [num, setNum] = useState(COUNT_NUM)</span><br><span class="line"></span><br><span class="line">  useEffect(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">document</span>.title = <span class="string">&#x27;å­çª—å£&#x27;</span></span><br><span class="line">    <span class="keyword">let</span> timer: NodeJS.Timeout</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (num &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      timer = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        setNum(num - <span class="number">1</span>)</span><br><span class="line">      &#125;, <span class="number">1000</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// @ts-ignore</span></span><br><span class="line">      <span class="built_in">window</span>.sendToParent(<span class="string">&#x27;hello&#x27;</span>)</span><br><span class="line">      <span class="built_in">window</span>.close()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      timer &amp;&amp; <span class="built_in">clearTimeout</span>(timer)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, [num])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#123;style.countDown&#125;</span>&gt;</span>å­çª—å£ &#123;num&#125; ç§’ä¹‹åï¼Œè¯·çœ‹ä¸»çª—å£<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="ä½¿ç”¨window-open"><a href="#ä½¿ç”¨window-open" class="headerlink" title="ä½¿ç”¨window.open"></a>ä½¿ç”¨<code>window.open</code></h3><h2 id="çª—å£äº‹ä»¶"><a href="#çª—å£äº‹ä»¶" class="headerlink" title="çª—å£äº‹ä»¶"></a>çª—å£äº‹ä»¶</h2><img src= "/img/loading.gif" data-lazy-src='http://mei160.cn/images/window-event.png'/><h3 id="çª—å£åŠ è½½æ—¶"><a href="#çª—å£åŠ è½½æ—¶" class="headerlink" title="çª—å£åŠ è½½æ—¶"></a>çª—å£åŠ è½½æ—¶</h3><blockquote><p>ä»ä¸Šåˆ°ä¸‹ï¼Œä¾æ¬¡æ‰§è¡Œ</p></blockquote><table><thead><tr><th>ç¯å¢ƒ</th><th>äº‹ä»¶</th><th>è§¦å‘æ—¶æœº</th></tr></thead><tbody><tr><td>webPreferencesçš„preload</td><td>-</td><td>åœ¨é¡µé¢è¿è¡Œå…¶ä»–è„šæœ¬ä¹‹å‰é¢„å…ˆåŠ è½½æŒ‡å®šçš„è„šæœ¬ æ— è®ºé¡µé¢æ˜¯å¦é›†æˆNode, æ­¤è„šæœ¬éƒ½å¯ä»¥è®¿é—®æ‰€æœ‰Node API è„šæœ¬è·¯å¾„ä¸ºæ–‡ä»¶çš„ç»å¯¹è·¯å¾„ã€‚</td></tr><tr><td>webContents</td><td><code>did-start-loading</code></td><td>å½“tabä¸­çš„æ—‹è½¬æŒ‡é’ˆï¼ˆspinnerï¼‰å¼€å§‹æ—‹è½¬æ—¶ï¼Œå°±ä¼šè§¦å‘è¯¥äº‹ä»¶</td></tr><tr><td>webContents</td><td><code>did-start-navigation</code></td><td>å½“çª—å£å¼€å§‹å¯¼èˆªæ˜¯ï¼Œè§¦å‘è¯¥äº‹ä»¶</td></tr><tr><td>çª—å£ä¸­çš„<code>JavaScript</code></td><td><code>DOMContentLoaded</code></td><td>åˆå§‹çš„ HTML æ–‡æ¡£è¢«å®Œå…¨åŠ è½½å’Œè§£æå®Œæˆ</td></tr><tr><td>çª—å£ä¸­çš„<code>JavaScript</code></td><td><code>load</code></td><td>é¡µé¢èµ„æºå…¨éƒ¨åŠ è½½å®Œæˆä¹‹æ—¶</td></tr><tr><td><code>BrowserWindow</code>å®ä¾‹</td><td><code>show</code></td><td>çª—å£æ˜¾ç¤ºæ—¶è§¦å‘æ—¶</td></tr><tr><td><code>webContents</code></td><td><code>did-frame-navigate</code></td><td><code>frame</code>å¯¼èˆªç»“æŸæ—¶æ—¶</td></tr><tr><td><code>webContents</code></td><td><code>did-navigate</code></td><td><code>main frame</code>å¯¼èˆªç»“æŸæ—¶æ—¶</td></tr><tr><td><code>BrowserWindow</code>å®ä¾‹</td><td><code>page-title-updated</code></td><td>æ–‡æ¡£æ›´æ”¹æ ‡é¢˜æ—¶è§¦å‘</td></tr><tr><td><code>webContents</code></td><td><code>page-title-updated</code></td><td>æ–‡æ¡£æ›´æ”¹æ ‡é¢˜æ—¶è§¦å‘</td></tr><tr><td><code>webContents</code></td><td><code>dom-ready</code></td><td>ä¸€ä¸ªæ¡†æ¶ä¸­çš„æ–‡æœ¬åŠ è½½å®Œæˆåè§¦å‘è¯¥äº‹ä»¶</td></tr><tr><td><code>webContents</code></td><td><code>did-frame-finish-load</code></td><td>å½“æ¡†æ¶å®Œæˆå¯¼èˆªï¼ˆnavigationï¼‰æ—¶è§¦å‘</td></tr><tr><td><code>webContents</code></td><td><code>did-finish-load</code></td><td>å¯¼èˆªå®Œæˆæ—¶è§¦å‘ï¼Œå³é€‰é¡¹å¡çš„æ—‹è½¬å™¨å°†åœæ­¢æ—‹è½¬</td></tr><tr><td><code>webContents</code></td><td><code>did-stop-loading</code></td><td>å½“tabä¸­çš„æ—‹è½¬æŒ‡é’ˆï¼ˆspinnerï¼‰ç»“æŸæ—‹è½¬æ—¶ï¼Œå°±ä¼šè§¦å‘è¯¥äº‹ä»¶</td></tr></tbody></table><p>##. çª—å£åŠ è½½å®Œæ¯•ï¼Œç”¨æˆ·è§¦å‘äº‹ä»¶ï¼ˆä¸åŒ…æ‹¬resizeå’Œmoveï¼‰</p><table><thead><tr><th>äº‹ä»¶</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td><code>page-title-updated</code></td><td>æ–‡æ¡£æ›´æ”¹æ ‡é¢˜æ—¶è§¦å‘</td></tr><tr><td><code>blur</code></td><td>å½“çª—å£å¤±å»ç„¦ç‚¹æ—¶è§¦å‘</td></tr><tr><td><code>focus</code></td><td>å½“çª—å£è·å¾—ç„¦ç‚¹æ—¶è§¦å‘</td></tr><tr><td><code>hide</code></td><td>çª—å£éšè—</td></tr><tr><td><code>show</code></td><td>çª—å£æ˜¾ç¤º</td></tr><tr><td><code>maximize</code></td><td>çª—å£æœ€å¤§åŒ–æ—¶è§¦å‘ï¼ˆmacæ˜¯åŒå‡»titleï¼‰</td></tr><tr><td><code>unmaximize</code></td><td>å½“çª—å£ä»æœ€å¤§åŒ–çŠ¶æ€é€€å‡ºæ—¶è§¦å‘</td></tr><tr><td><code>enter-full-screen</code></td><td>çª—å£è¿›å…¥å…¨å±çŠ¶æ€æ—¶è§¦å‘</td></tr><tr><td><code>leave-full-screen</code></td><td>çª—å£ç¦»å¼€å…¨å±çŠ¶æ€æ—¶è§¦å‘</td></tr><tr><td><code>enter-html-full-screen</code></td><td>çª—å£è¿›å…¥ç”±HTML API è§¦å‘çš„å…¨å±çŠ¶æ€æ—¶è§¦å‘</td></tr><tr><td><code>leave-html-full-screen</code></td><td>çª—å£ç¦»å¼€ç”±HTML APIè§¦å‘çš„å…¨å±çŠ¶æ€æ—¶è§¦å‘</td></tr><tr><td><code>always-on-top-changed</code></td><td>è®¾ç½®æˆ–å–æ¶ˆè®¾ç½®çª—å£æ€»æ˜¯åœ¨å…¶ä»–çª—å£çš„é¡¶éƒ¨æ˜¾ç¤ºæ—¶è§¦å‘ã€‚</td></tr><tr><td><code>app-command</code></td><td><code>window</code> <code>linux</code>ç‹¬æœ‰</td></tr></tbody></table><h3 id="ç”¨æˆ·ç§»åŠ¨çª—å£"><a href="#ç”¨æˆ·ç§»åŠ¨çª—å£" class="headerlink" title="ç”¨æˆ·ç§»åŠ¨çª—å£"></a>ç”¨æˆ·ç§»åŠ¨çª—å£</h3><ol><li>ç§»åŠ¨çª—å£ä¹‹å‰ <code>will-move</code>ï¼›</li><li>ç§»åŠ¨çª—å£ä¸­ <code>move</code>ï¼›</li><li>ç§»åŠ¨ä¹‹å <code>moved</code>ï¼›</li></ol><h3 id="ç”¨æˆ·æ”¹å˜çª—å£å¤§å°"><a href="#ç”¨æˆ·æ”¹å˜çª—å£å¤§å°" class="headerlink" title="ç”¨æˆ·æ”¹å˜çª—å£å¤§å°"></a>ç”¨æˆ·æ”¹å˜çª—å£å¤§å°</h3><ol><li>æ”¹å˜ä¹‹å‰ <code>will-resize</code>ï¼›</li><li>æ”¹å˜ä¹‹å <code>resize</code></li></ol><h3 id="çª—å£çš„å†…å®¹å¼‚å¸¸äº‹ä»¶ï¼ˆwebContentäº‹ä»¶ï¼‰"><a href="#çª—å£çš„å†…å®¹å¼‚å¸¸äº‹ä»¶ï¼ˆwebContentäº‹ä»¶ï¼‰" class="headerlink" title="çª—å£çš„å†…å®¹å¼‚å¸¸äº‹ä»¶ï¼ˆwebContentäº‹ä»¶ï¼‰"></a>çª—å£çš„å†…å®¹å¼‚å¸¸äº‹ä»¶ï¼ˆ<code>webContent</code>äº‹ä»¶ï¼‰</h3><table><thead><tr><th>äº‹ä»¶å</th><th>é”™è¯¯ç±»å‹</th></tr></thead><tbody><tr><td><code>unresponsive</code></td><td>ç½‘é¡µå˜å¾—æœªå“åº”æ—¶è§¦å‘</td></tr><tr><td><code>responsive</code></td><td>æœªå“åº”çš„é¡µé¢å˜æˆå“åº”æ—¶è§¦å‘</td></tr><tr><td><code>did-fail-load</code></td><td>åŠ è½½å¤±è´¥ï¼Œ<a href="https://code.google.com/p/chromium/codesearch#chromium/src/net/base/net_error_list.h">é”™è¯¯ç </a></td></tr><tr><td><code>did-fail-provisional-load</code></td><td>é¡µé¢åŠ è½½è¿‡ç¨‹ä¸­ï¼Œæ‰§è¡Œäº†<code>window.stop()</code></td></tr><tr><td><code>did-frame-finish-load</code></td><td></td></tr><tr><td><code>crashed</code></td><td>æ¸²æŸ“è¿›ç¨‹å´©æºƒæˆ–è¢«ç»“æŸæ—¶è§¦å‘</td></tr><tr><td><code>render-process-gone</code></td><td>æ¸²æŸ“è¿›ç¨‹æ„å¤–å¤±è´¥æ—¶å‘å‡º</td></tr><tr><td><code>plugin-crashed</code></td><td>æœ‰æ’ä»¶è¿›ç¨‹å´©æºƒæ—¶è§¦å‘</td></tr><tr><td><code>certificate-error</code></td><td>è¯ä¹¦çš„é“¾æ¥éªŒè¯å¤±è´¥</td></tr><tr><td><code>preload-error</code></td><td><code>preload.js</code>æŠ›å‡ºé”™è¯¯</td></tr></tbody></table><h3 id="çª—å£å…³é—­ï¼ˆåŒ…æ‹¬æ„å¤–å…³é—­ï¼‰"><a href="#çª—å£å…³é—­ï¼ˆåŒ…æ‹¬æ„å¤–å…³é—­ï¼‰" class="headerlink" title="çª—å£å…³é—­ï¼ˆåŒ…æ‹¬æ„å¤–å…³é—­ï¼‰"></a>çª—å£å…³é—­ï¼ˆåŒ…æ‹¬æ„å¤–å…³é—­ï¼‰</h3><p>æŒ‰è§¦å‘é¡ºåºä¾æ¬¡ï¼šï¼ˆå¸¦windowçš„æ˜¯æ¸²æŸ“è¿›ç¨‹ä¸­çš„ï¼‰</p><ul><li>å…³é—­ä¹‹å‰ï¼šclose</li><li>window.onbeforeunload</li><li>window.onunload</li><li>å…³é—­ä¹‹åï¼šclosed</li></ul><h3 id="æ–‡æ¡£-1"><a href="#æ–‡æ¡£-1" class="headerlink" title="æ–‡æ¡£"></a>æ–‡æ¡£</h3><ol><li><a href="https://www.electronjs.org/docs/api/browser-window">BrowserWindow</a>;</li><li><a href="https://www.electronjs.org/docs/api/web-contents">webContents</a>;</li><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/Events/DOMContentLoaded">DOMContended</a></li></ol><h2 id="çª—å£çš„èšç„¦å’Œå¤±ç„¦"><a href="#çª—å£çš„èšç„¦å’Œå¤±ç„¦" class="headerlink" title="çª—å£çš„èšç„¦å’Œå¤±ç„¦"></a>çª—å£çš„èšç„¦å’Œå¤±ç„¦</h2><h3 id="èšç„¦"><a href="#èšç„¦" class="headerlink" title="èšç„¦"></a>èšç„¦</h3><h4 id="åˆ›å»ºçª—å£æ—¶é…ç½®ï¼š"><a href="#åˆ›å»ºçª—å£æ—¶é…ç½®ï¼š" class="headerlink" title="åˆ›å»ºçª—å£æ—¶é…ç½®ï¼š"></a>åˆ›å»ºçª—å£æ—¶é…ç½®ï¼š</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @@code-renderer: runner</span></span><br><span class="line"><span class="comment">// @@code-props: &#123; hideRight: true, height:&#x27;150px&#x27; &#125;</span></span><br><span class="line"><span class="keyword">const</span> &#123; BrowserWindow &#125; = <span class="built_in">require</span>(<span class="string">&#x27;electron&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> win = <span class="keyword">new</span> BrowserWindow();</span><br><span class="line">win.loadURL(<span class="string">&#x27;https://github.com&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> win2 = <span class="keyword">new</span> BrowserWindow(&#123;<span class="attr">x</span>:<span class="number">100</span>,<span class="attr">y</span>:<span class="number">100</span>&#125;)</span><br><span class="line">    win2.loadURL(<span class="string">&#x27;https://www.baidu.com&#x27;</span>)</span><br><span class="line">&#125;,<span class="number">3000</span>)</span><br></pre></td></tr></table></figure><p><code>focusable:true</code>  çª—å£ä¾¿å¯èšç„¦ï¼Œä¾¿å¯ä»¥ä½¿ç”¨èšç„¦çš„<code>api</code></p><p><code>focusable:false</code> åœ¨ <code>Windows</code> ä¸­è®¾ç½® <code>focusable: false</code> ä¹Ÿæ„å‘³ç€è®¾ç½®äº†<code>skipTaskbar: true</code>. åœ¨ <code>Linux</code> ä¸­è®¾ç½® <code>focusable: false</code> æ—¶çª—å£åœæ­¢ä¸ <code>wm</code> äº¤äº’, å¹¶ä¸”çª—å£å°†å§‹ç»ˆç½®é¡¶ã€‚</p><p>ä»¥ä¸‹è®¨è®ºçš„æƒ…å†µä»…ä¸º<code>focusable:true</code>æƒ…å†µä¸‹</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; BrowserWindow &#125; = <span class="built_in">require</span>(<span class="string">&#x27;electron&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> win = <span class="keyword">new</span> BrowserWindow() <span class="comment">// focusable:true ä¸ºé»˜è®¤é…ç½®</span></span><br></pre></td></tr></table></figure><h4 id="å…³äºèšç„¦çš„api"><a href="#å…³äºèšç„¦çš„api" class="headerlink" title="å…³äºèšç„¦çš„api"></a>å…³äºèšç„¦çš„<code>api</code></h4><table><thead><tr><th>api</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td><code>BrowserWindow.getFocusedWindow()</code></td><td>æ¥è·å–èšç„¦çš„çª—å£</td></tr><tr><td><code>win.isFocused()</code></td><td>åˆ¤æ–­çª—å£æ˜¯å¦èšç„¦</td></tr><tr><td><code>win.on(&#39;focus&#39;,cb)</code></td><td>æ¥ç›‘å¬çª—å£æ˜¯å¦èšç„¦</td></tr><tr><td><code>win.focus()</code></td><td>æ‰‹åŠ¨èšç„¦çª—å£</td></tr></tbody></table><h4 id="å…¶ä»–apiå‰¯ä½œç”¨å’Œèšç„¦æœ‰å…³çš„ï¼š"><a href="#å…¶ä»–apiå‰¯ä½œç”¨å’Œèšç„¦æœ‰å…³çš„ï¼š" class="headerlink" title="å…¶ä»–apiå‰¯ä½œç”¨å’Œèšç„¦æœ‰å…³çš„ï¼š"></a>å…¶ä»–<code>api</code>å‰¯ä½œç”¨å’Œèšç„¦æœ‰å…³çš„ï¼š</h4><table><thead><tr><th>api</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td><code>win.show()</code></td><td>æ˜¾ç¤ºçª—å£ï¼Œå¹¶ä¸”èšç„¦äºçª—å£</td></tr><tr><td><code>win.showInactive()</code></td><td>æ˜¾ç¤ºçª—å£ï¼Œä½†æ˜¯ä¸ä¼šèšç„¦äºçª—å£</td></tr></tbody></table><h3 id="å¤±ç„¦"><a href="#å¤±ç„¦" class="headerlink" title="å¤±ç„¦"></a>å¤±ç„¦</h3><h4 id="å…³äºå¤±ç„¦çš„api"><a href="#å…³äºå¤±ç„¦çš„api" class="headerlink" title="å…³äºå¤±ç„¦çš„api"></a>å…³äºå¤±ç„¦çš„<code>api</code></h4><table><thead><tr><th>api</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td><code>win.blur()</code></td><td>å–æ¶ˆçª—å£èšç„¦</td></tr><tr><td><code>win.on(&#39;blur&#39;,cb)</code></td><td>ç›‘å¬å¤±ç„¦</td></tr></tbody></table><h4 id="å…¶ä»–apiå‰¯ä½œç”¨å’Œå¤±ç„¦æœ‰å…³çš„ï¼š"><a href="#å…¶ä»–apiå‰¯ä½œç”¨å’Œå¤±ç„¦æœ‰å…³çš„ï¼š" class="headerlink" title="å…¶ä»–apiå‰¯ä½œç”¨å’Œå¤±ç„¦æœ‰å…³çš„ï¼š"></a>å…¶ä»–<code>api</code>å‰¯ä½œç”¨å’Œå¤±ç„¦æœ‰å…³çš„ï¼š</h4><table><thead><tr><th>api</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td><code>win.hide()</code></td><td>éšè—çª—å£ï¼Œå¹¶ä¸”ä¼šè§¦å‘å¤±ç„¦äº‹ä»¶</td></tr></tbody></table><h2 id="çª—å£ç±»å‹"><a href="#çª—å£ç±»å‹" class="headerlink" title="çª—å£ç±»å‹"></a>çª—å£ç±»å‹</h2><h3 id="æ— è¾¹æ¡†çª—å£"><a href="#æ— è¾¹æ¡†çª—å£" class="headerlink" title="æ— è¾¹æ¡†çª—å£"></a>æ— è¾¹æ¡†çª—å£</h3><h4 id="æè¿°ï¼š"><a href="#æè¿°ï¼š" class="headerlink" title="æè¿°ï¼š"></a>æè¿°ï¼š</h4><p>æ— è¾¹æ¡†çª—å£æ˜¯ä¸å¸¦å¤–å£³ï¼ˆåŒ…æ‹¬çª—å£è¾¹æ¡†ã€å·¥å…·æ ç­‰ï¼‰ï¼Œåªå«æœ‰ç½‘é¡µå†…å®¹çš„çª—å£</p><h4 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h4><p><code>Windows</code> <code>macOS</code> <code>Linux</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @@code-renderer: runner</span></span><br><span class="line"><span class="comment">// @@code-props: &#123; hideRight: true, height:&#x27;100px&#x27; &#125;</span></span><br><span class="line"><span class="keyword">const</span> &#123; BrowserWindow &#125; = <span class="built_in">require</span>(<span class="string">&#x27;electron&#x27;</span>)</span><br><span class="line"><span class="keyword">let</span> win = <span class="keyword">new</span> BrowserWindow(&#123; <span class="attr">width</span>: <span class="number">800</span>, <span class="attr">height</span>: <span class="number">600</span>, <span class="attr">frame</span>: <span class="literal">false</span> &#125;)</span><br><span class="line">win.loadURL(<span class="string">&#x27;https://github.com&#x27;</span>)</span><br></pre></td></tr></table></figure><p>åœ¨<code>macOS</code>ä¸‹ï¼Œè¿˜æœ‰ä¸åŒçš„å®ç°æ–¹å¼ï¼Œ<a href="https://www.electronjs.org/docs/api/frameless-window#macos-%E4%B8%8A%E7%9A%84%E5%85%B6%E4%BB%96%E6%96%B9%E6%A1%88">å®Œæ•´æ–‡æ¡£</a></p><h4 id="macOS-ä¸‹ç‹¬æœ‰çš„æ— è¾¹æ¡†"><a href="#macOS-ä¸‹ç‹¬æœ‰çš„æ— è¾¹æ¡†" class="headerlink" title="macOS ä¸‹ç‹¬æœ‰çš„æ— è¾¹æ¡†"></a><code>macOS</code> ä¸‹ç‹¬æœ‰çš„æ— è¾¹æ¡†</h4><ul><li>é…ç½®<code>titleBarStyle: &#39;hidden&#39;</code><blockquote><p>è¿”å›ä¸€ä¸ªéšè—æ ‡é¢˜æ çš„å…¨å°ºå¯¸å†…å®¹çª—å£ï¼Œåœ¨å·¦ä¸Šè§’ä»ç„¶æœ‰æ ‡å‡†çš„çª—å£æ§åˆ¶æŒ‰é’®ï¼ˆä¿—ç§°â€œçº¢ç»¿ç¯â€ï¼‰</p></blockquote></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @@code-renderer: runner</span></span><br><span class="line"><span class="comment">// @@code-props: &#123; hideRight: true, height:&#x27;100px&#x27; &#125;</span></span><br><span class="line"><span class="comment">// åˆ›å»ºä¸€ä¸ªæ— è¾¹æ¡†çš„çª—å£</span></span><br><span class="line"><span class="keyword">const</span> &#123; BrowserWindow &#125; = <span class="built_in">require</span>(<span class="string">&#x27;electron&#x27;</span>)</span><br><span class="line"><span class="keyword">let</span> win = <span class="keyword">new</span> BrowserWindow(&#123; <span class="attr">titleBarStyle</span>: <span class="string">&#x27;hidden&#x27;</span> &#125;)</span><br><span class="line">win.loadURL(<span class="string">&#x27;https://github.com&#x27;</span>)</span><br></pre></td></tr></table></figure><p>æ•ˆæœå¦‚ä¸‹ï¼š<br><img src= "/img/loading.gif" data-lazy-src="http://mei160.cn/images/window-type-frame.gif" alt="window-type-frame"></p><ul><li>é…ç½®<code>titleBarStyle: &#39;hiddenInset&#39;</code><blockquote><p>è¿”å›ä¸€ä¸ªå¦ä¸€ç§éšè—äº†æ ‡é¢˜æ çš„çª—å£ï¼Œå…¶ä¸­æ§åˆ¶æŒ‰é’®åˆ°çª—å£è¾¹æ¡†çš„è·ç¦»æ›´å¤§ã€‚</p></blockquote></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @@code-renderer: runner</span></span><br><span class="line"><span class="comment">// @@code-props: &#123; hideRight: true, height:&#x27;100px&#x27; &#125;</span></span><br><span class="line"><span class="comment">// åˆ›å»ºä¸€ä¸ªæ— è¾¹æ¡†çš„çª—å£</span></span><br><span class="line"><span class="keyword">const</span> &#123; BrowserWindow &#125; = <span class="built_in">require</span>(<span class="string">&#x27;electron&#x27;</span>)</span><br><span class="line"><span class="keyword">let</span> win = <span class="keyword">new</span> BrowserWindow(&#123; <span class="attr">titleBarStyle</span>: <span class="string">&#x27;hiddenInset&#x27;</span> &#125;)</span><br><span class="line">win.loadURL(<span class="string">&#x27;https://github.com&#x27;</span>)</span><br></pre></td></tr></table></figure><p>æ•ˆæœå¦‚ä¸‹ï¼š<br><img src= "/img/loading.gif" data-lazy-src="http://mei160.cn/images/window-type-frame2.gif" alt="window-type-frame2"></p><h5 id="1-1-0-3-3-é…ç½®titleBarStyle-39-customButtonsOnHover-39"><a href="#1-1-0-3-3-é…ç½®titleBarStyle-39-customButtonsOnHover-39" class="headerlink" title="1.1.0.3.3. é…ç½®titleBarStyle: &#39;customButtonsOnHover&#39;"></a>1.1.0.3.3. é…ç½®<code>titleBarStyle: &#39;customButtonsOnHover&#39;</code></h5><p>æ•ˆæœå¦‚ä¸‹ï¼š<br><img src= "/img/loading.gif" data-lazy-src="http://mei160.cn/images/window-type-frame3.gif" alt="window-type-frame2"></p><h4 id="æ— è¾¹æ¡†çª—å£å¸¸è§çš„é—®é¢˜"><a href="#æ— è¾¹æ¡†çª—å£å¸¸è§çš„é—®é¢˜" class="headerlink" title="æ— è¾¹æ¡†çª—å£å¸¸è§çš„é—®é¢˜"></a>æ— è¾¹æ¡†çª—å£å¸¸è§çš„é—®é¢˜</h4><ul><li>çª—å£é¡¶éƒ¨æ— æ³•æ‹–æ‹½çš„é—®é¢˜<br>é»˜è®¤æƒ…å†µä¸‹, æ— è¾¹æ¡†çª—å£æ˜¯ä¸å¯æ‹–æ‹½çš„ã€‚ åº”ç”¨ç¨‹åºéœ€è¦åœ¨ <code>CSS</code> ä¸­æŒ‡å®š <code>-webkit-app-region: drag</code> æ¥å‘Šè¯‰ <code>Electron</code> å“ªäº›åŒºåŸŸæ˜¯å¯æ‹–æ‹½çš„ï¼ˆå¦‚æ“ä½œç³»ç»Ÿçš„æ ‡å‡†æ ‡é¢˜æ ï¼‰ï¼Œåœ¨å¯æ‹–æ‹½åŒºåŸŸå†…éƒ¨ä½¿ç”¨ <code>-webkit-app-region: no-drag</code> åˆ™å¯ä»¥å°†å…¶ä¸­éƒ¨åˆ†åŒºåŸŸæ’é™¤ã€‚ è¯·æ³¨æ„, å½“å‰åªæ”¯æŒçŸ©å½¢å½¢çŠ¶ã€‚<a href="https://www.electronjs.org/docs/api/frameless-window#%E5%8F%AF%E6%8B%96%E6%8B%BD%E5%8C%BA">å®Œæ•´æ–‡æ¡£</a></li></ul><p>ä½¿ç”¨<code>-webkit-app-region: drag</code> æ¥å®ç°æ‹–æ‹½ï¼Œä½†æ˜¯ä¼šå¯¼è‡´å†…éƒ¨çš„<code>click</code>äº‹ä»¶å¤±æ•ˆã€‚è¿™ä¸ªæ—¶å€™å¯ä»¥å°†éœ€è¦<code>click</code>å…ƒç´ è®¾ç½®ä¸º<code>-webkit-app-region: no-drag</code>ã€‚å…·ä½“çš„ç»†èŠ‚å¯çœ‹<a href="https://github.com/electron/electron/issues/3647">issues</a></p><p>ä¸ºäº†ä¸å½±å“çª—å£ï¼Œè¿™é‡Œæ‹–æ‹½çš„ä»£ç ï¼Œåº”è¯¥åœ¨<code>preload</code>è§¦å‘ã€‚<br>æ ¸å¿ƒä»£ç ï¼š</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœ¨é¡¶éƒ¨æ’å…¥ä¸€ä¸ªå¯ä»¥ç§»åŠ¨çš„dom</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">initTopDrag</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> topDiv = <span class="built_in">document</span>.createElement(<span class="string">&#x27;div&#x27;</span>) <span class="comment">// åˆ›å»ºèŠ‚ç‚¹</span></span><br><span class="line">  topDiv.style.position = <span class="string">&#x27;fixed&#x27;</span> <span class="comment">// ä¸€ç›´åœ¨é¡¶éƒ¨</span></span><br><span class="line">  topDiv.style.top = <span class="string">&#x27;0&#x27;</span></span><br><span class="line">  topDiv.style.left = <span class="string">&#x27;0&#x27;</span></span><br><span class="line">  topDiv.style.height = <span class="string">&#x27;20px&#x27;</span> <span class="comment">// é¡¶éƒ¨20pxæ‰å¯æ‹–åŠ¨</span></span><br><span class="line">  topDiv.style.width = <span class="string">&#x27;100%&#x27;</span> <span class="comment">// å®½åº¦100%</span></span><br><span class="line">  topDiv.style.zIndex = <span class="string">&#x27;9999&#x27;</span> <span class="comment">// æ‚¬æµ®äºæœ€å¤–å±‚</span></span><br><span class="line">  topDiv.style.pointerEvents = <span class="string">&#x27;none&#x27;</span> <span class="comment">// ç”¨äºç‚¹å‡»ç©¿é€</span></span><br><span class="line">  <span class="comment">// @ts-ignore</span></span><br><span class="line">  topDiv.style[<span class="string">&#x27;-webkit-user-select&#x27;</span>] = <span class="string">&#x27;none&#x27;</span> <span class="comment">// ç¦æ­¢é€‰æ‹©æ–‡å­—</span></span><br><span class="line">  <span class="comment">// @ts-ignore</span></span><br><span class="line">  topDiv.style[<span class="string">&#x27;-webkit-app-region&#x27;</span>] = <span class="string">&#x27;drag&#x27;</span> <span class="comment">// æ‹–åŠ¨</span></span><br><span class="line">  <span class="built_in">document</span>.body.appendChild(topDiv) <span class="comment">// æ·»åŠ èŠ‚ç‚¹</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">&#x27;DOMContentLoaded&#x27;</span>, <span class="function"><span class="keyword">function</span> <span class="title">onDOMContentLoaded</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    initTopDrag()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>è¯•ä¸€è¯•</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @@code-renderer: runner</span></span><br><span class="line"><span class="comment">// @@code-props: &#123; hideRight: true, height:&#x27;200px&#x27; &#125;</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> &#123; BrowserWindow &#125; = <span class="built_in">require</span>(<span class="string">&#x27;electron&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> BaseWebPreferences = &#123;</span><br><span class="line">  nodeIntegration: <span class="literal">true</span>,</span><br><span class="line">  preload: path.resolve(__dirname, <span class="string">&#x27;./windowType.js&#x27;</span>),</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸»çª—å£ä»£ç </span></span><br><span class="line"><span class="keyword">const</span> win = <span class="keyword">new</span> BrowserWindow(&#123; <span class="attr">webPreferences</span>: BaseWebPreferences, <span class="attr">frame</span>: <span class="literal">false</span> &#125;)</span><br><span class="line">win.loadURL(<span class="string">&#x27;https://github.com&#x27;</span>)</span><br></pre></td></tr></table></figure><h3 id="çˆ¶å­çª—å£"><a href="#çˆ¶å­çª—å£" class="headerlink" title="çˆ¶å­çª—å£"></a>çˆ¶å­çª—å£</h3><p>å­çª—å£å§‹ç»ˆåœ¨çˆ¶çª—å£ä¹‹ä¸Šï¼Œåœ¨ <strong>çª—å£ä¹‹é—´é€šä¿¡</strong> ç« èŠ‚ä¸­ä»‹ç»åˆ°çˆ¶å­çª—å£ä¹‹é—´çš„é€šä¿¡ï¼Œ<a href="./index.html#/browser/communication"><strong>çª—å£ä¹‹é—´é€šä¿¡</strong></a>ç« èŠ‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @@code-renderer: runner</span></span><br><span class="line"><span class="comment">// @@code-props: &#123; hideRight: true, height:&#x27;100px&#x27; &#125;</span></span><br><span class="line"><span class="keyword">const</span> &#123; BrowserWindow &#125; = <span class="built_in">require</span>(<span class="string">&#x27;electron&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> top = <span class="keyword">new</span> BrowserWindow()</span><br><span class="line"><span class="keyword">let</span> child = <span class="keyword">new</span> BrowserWindow(&#123; <span class="attr">parent</span>: top &#125;)</span><br><span class="line">child.show()</span><br><span class="line">top.show()</span><br></pre></td></tr></table></figure><h3 id="æ¨¡æ€çª—å£"><a href="#æ¨¡æ€çª—å£" class="headerlink" title="æ¨¡æ€çª—å£"></a>æ¨¡æ€çª—å£</h3>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;çª—å£&quot;&gt;&lt;a href=&quot;#çª—å£&quot; class=&quot;headerlink&quot; title=&quot;çª—å£&quot;&gt;&lt;/a&gt;çª—å£&lt;/h1&gt;&lt;h2 id=&quot;ä¸»çª—å£éšè—å’Œæ¢å¤&quot;&gt;&lt;a href=&quot;#ä¸»çª—å£éšè—å’Œæ¢å¤&quot; class=&quot;headerlink&quot; title=&quot;ä¸»çª—å£éšè—å’Œæ¢å¤&quot;</summary>
      
    
    
    
    <category term="electron" scheme="https://hard-workingrookie.github.io/categories/electron/"/>
    
    
    <category term="electron" scheme="https://hard-workingrookie.github.io/tags/electron/"/>
    
  </entry>
  
  <entry>
    <title>electronåº”ç”¨</title>
    <link href="https://hard-workingrookie.github.io/2021/01/07/electron%E5%BA%94%E7%94%A8/"/>
    <id>https://hard-workingrookie.github.io/2021/01/07/electron%E5%BA%94%E7%94%A8/</id>
    <published>2021-01-07T07:30:23.000Z</published>
    <updated>2021-03-09T14:08:41.531Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h1><h2 id="Dialogä¸æ–‡ä»¶é€‰æ‹©"><a href="#Dialogä¸æ–‡ä»¶é€‰æ‹©" class="headerlink" title="Dialogä¸æ–‡ä»¶é€‰æ‹©"></a>Dialogä¸æ–‡ä»¶é€‰æ‹©</h2><p>æ˜¾ç¤ºç³»ç»Ÿå¯¹è¯æ¡†, æä¾›äº†æ¶ˆæ¯æç¤ºã€æ¶ˆæ¯æç¤ºæ“ä½œä»¥åŠé€‰æ‹©æ–‡ä»¶ã€ä¿å­˜æ–‡ä»¶ç­‰æ“ä½œ.</p><h3 id="æ¶ˆæ¯æç¤º-dialog-showMessageBoxSync"><a href="#æ¶ˆæ¯æç¤º-dialog-showMessageBoxSync" class="headerlink" title="æ¶ˆæ¯æç¤º dialog.showMessageBoxSync"></a>æ¶ˆæ¯æç¤º dialog.showMessageBoxSync</h3><h4 id="æ¶ˆæ¯æç¤º"><a href="#æ¶ˆæ¯æç¤º" class="headerlink" title="æ¶ˆæ¯æç¤º"></a>æ¶ˆæ¯æç¤º</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @@code-renderer: runner</span></span><br><span class="line"><span class="comment">// @@code-props: &#123; height: &#x27;130px&#x27; &#125;</span></span><br><span class="line"><span class="keyword">const</span> &#123; dialog &#125; = <span class="built_in">require</span>(<span class="string">&#x27;electron&#x27;</span>)</span><br><span class="line">dialog.showMessageBoxSync(&#123;</span><br><span class="line">  type: <span class="string">&#x27;info&#x27;</span>,</span><br><span class="line">  title: <span class="string">&#x27;è¿™é‡Œæ˜¯æ ‡é¢˜&#x27;</span>,</span><br><span class="line">  message: <span class="string">&#x27;æç¤ºå†…å®¹&#x27;</span>,</span><br><span class="line">  detail: <span class="string">&#x27;é¢å¤–ä¿¡æ¯&#x27;</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="æ¶ˆæ¯æç¤ºä¸ç¡®è®¤"><a href="#æ¶ˆæ¯æç¤ºä¸ç¡®è®¤" class="headerlink" title="æ¶ˆæ¯æç¤ºä¸ç¡®è®¤"></a>æ¶ˆæ¯æç¤ºä¸ç¡®è®¤</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @@code-renderer: runner</span></span><br><span class="line"><span class="comment">// @@code-props: &#123; height: &#x27;240px&#x27; &#125;</span></span><br><span class="line"><span class="keyword">const</span> &#123; dialog &#125; = <span class="built_in">require</span>(<span class="string">&#x27;electron&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> res = dialog.showMessageBoxSync(&#123;</span><br><span class="line">  type: <span class="string">&#x27;info&#x27;</span>,</span><br><span class="line">  title: <span class="string">&#x27;è¿™é‡Œæ˜¯æ ‡é¢˜&#x27;</span>,</span><br><span class="line">  message: <span class="string">&#x27;æç¤ºå†…å®¹&#x27;</span>,</span><br><span class="line">  detail: <span class="string">&#x27;é¢å¤–ä¿¡æ¯&#x27;</span>,</span><br><span class="line">  cancelId: <span class="number">1</span>, <span class="comment">// æŒ‰escé»˜è®¤ç‚¹å‡»ç´¢å¼•æŒ‰é’®</span></span><br><span class="line">  defaultId: <span class="number">0</span>, <span class="comment">// é»˜è®¤é«˜äº®çš„æŒ‰é’®ä¸‹æ ‡</span></span><br><span class="line">  buttons: [<span class="string">&#x27;ç¡®è®¤æŒ‰é’®&#x27;</span>, <span class="string">&#x27;å–æ¶ˆæŒ‰é’®&#x27;</span>], <span class="comment">// æŒ‰é’®æŒ‰ç´¢å¼•ä»å³å¾€å·¦æ’åº</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;æ“ä½œç»“æœ&#x27;</span>, res, res === <span class="number">0</span> ? <span class="string">&#x27;ç‚¹å‡»ç¡®è®¤æŒ‰é’®&#x27;</span> : <span class="string">&#x27;ç‚¹å‡»å–æ¶ˆæŒ‰é’®&#x27;</span>) <span class="comment">// æ ¹æ®æŒ‰é’®æ•°ç»„ä¸­çš„ä¸‹æ ‡æ¥åˆ¤æ–­</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;æ“ä½œä¸­è¿˜æœ‰ä¸ªcheckboxLabelçš„å•é€‰æ¡†éœ€è¦ä½¿ç”¨showMessageBox apiæ‰å¯ä»¥è·å–åˆ°è¿”å›å€¼&#x27;</span>)</span><br></pre></td></tr></table></figure><h4 id="APIè¯´æ˜"><a href="#APIè¯´æ˜" class="headerlink" title="APIè¯´æ˜"></a>APIè¯´æ˜</h4><h4 id="dialog-showMessageBoxSync-browserWindow-options"><a href="#dialog-showMessageBoxSync-browserWindow-options" class="headerlink" title="dialog.showMessageBoxSync(browserWindow, options)"></a>dialog.showMessageBoxSync(browserWindow, options)</h4><p>æ˜¾ç¤ºä¸€ä¸ªæ¶ˆæ¯æ¡†ï¼Œå®ƒå°†é˜»æ­¢è¿›ç¨‹ï¼Œç›´åˆ°æ¶ˆæ¯æ¡†è¢«å…³é—­ã€‚è¿”å›å€¼ä¸ºç‚¹å‡»çš„æŒ‰é’®çš„ç´¢å¼•ã€‚</p><p>å‚æ•°ï¼š</p><ul><li><p><code>browserWindow</code></p><p>å¯ä»¥æŒ‡å®šä¸€ä¸ªçˆ¶çª—å£ï¼Œä½œä¸ºæ¨¡æ€çª—å£é™„åŠ åˆ°è¯¥çª—å£ã€‚</p></li><li><p><code>options</code></p><ul><li><p><code>type</code>: String (å¯é€‰) - â€œnoneâ€ ï½œ â€œinfoâ€ ï½œ â€œerrorâ€ ï½œ â€œquestionâ€ ä¸åŒçš„typeæç¤ºçš„å›¾æ ‡ä¸åŒï¼›</p></li><li><p><code>title</code>: String (å¯é€‰) - message box çš„æ ‡é¢˜ï¼Œä¸€äº›å¹³å°ä¸æ˜¾ç¤ºï¼Œå»ºè®®ä½¿ç”¨messageå’Œdetailï¼›</p></li><li><p><code>message</code>:  String - message box çš„å†…å®¹.</p></li><li><p><code>detail</code>: String (å¯é€‰) - é¢å¤–ä¿¡æ¯</p></li><li><p><code>buttons</code> String[] - å­—ç¬¦ä¸²æŒ‰é’®æ•°ç»„ï¼ŒæŒ‰é’®æŒ‰ç´¢å¼•ä»å³å¾€å·¦æ’åºï¼Œå¦‚æœæœªæŒ‡å®šé»˜è®¤æœ‰ä¸€ä¸ªâ€OKâ€çš„æŒ‰é’®ã€‚</p></li><li><p><code>defaultId</code>: Integer (å¯é€‰) - é»˜è®¤é«˜äº®çš„æŒ‰é’®ä¸‹æ ‡ï¼Œå›è½¦çš„æ—¶å€™è‡ªåŠ¨é€‰ä¸­è¯¥é¡¹</p></li><li><p><code>cancelId</code>: Integer (å¯é€‰)  æŒ‰escé»˜è®¤ç‚¹å‡»ç´¢å¼•æŒ‰é’®</p></li></ul></li></ul><p>è¿”å›å€¼ç±»å‹ï¼š</p><ul><li><code>number</code>: æ‰€ç‚¹å‡»çš„æŒ‰é’®çš„ç´¢å¼•</li></ul><h4 id="dialog-showMessageBox-browserWindow-options"><a href="#dialog-showMessageBox-browserWindow-options" class="headerlink" title="dialog.showMessageBox(browserWindow, options)"></a>dialog.showMessageBox(browserWindow, options)</h4><p>ä¸dialog.showMessageBoxSyncç±»ä¼¼ï¼Œä¸åŒç‚¹åœ¨äºï¼š</p><ol><li>è¿™æ˜¯ä¸€ä¸ªå¼‚æ­¥æ–¹æ³•ï¼Œè¿”å›å€¼ä¸ºPromiseç±»å‹ï¼›</li><li>æ˜¾ç¤ºçš„å¯¹è¯æ¡†å¯ä»¥æŒ‡å®šä¸€ä¸ªå¤é€‰æ¡†ï¼Œè¿”å›å€¼ä¸­ä¹Ÿå¢åŠ äº†å¯¹åº”çš„å­—æ®µï¼›</li></ol><p>ä¸‹é¢æ˜¯å¸¦å¤é€‰æ¡†çš„ç¤ºä¾‹ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @@code-renderer: runner</span></span><br><span class="line"><span class="comment">// @@code-props: &#123; height: &#x27;280px&#x27; &#125;</span></span><br><span class="line"><span class="keyword">const</span> &#123; dialog &#125; = <span class="built_in">require</span>(<span class="string">&#x27;electron&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> res = dialog.showMessageBox(&#123;</span><br><span class="line">  type: <span class="string">&#x27;info&#x27;</span>,</span><br><span class="line">  title: <span class="string">&#x27;è¿™é‡Œæ˜¯æ ‡é¢˜&#x27;</span>,</span><br><span class="line">  message: <span class="string">&#x27;æç¤ºå†…å®¹&#x27;</span>,</span><br><span class="line">  detail: <span class="string">&#x27;é¢å¤–ä¿¡æ¯&#x27;</span>,</span><br><span class="line">  cancelId: <span class="number">1</span>, <span class="comment">// æŒ‰escé»˜è®¤ç‚¹å‡»ç´¢å¼•æŒ‰é’®</span></span><br><span class="line">  defaultId: <span class="number">0</span>, <span class="comment">// é»˜è®¤é«˜äº®çš„æŒ‰é’®ä¸‹æ ‡</span></span><br><span class="line">  checkboxLabel: <span class="string">&#x27;å•é€‰æ¡†å†…å®¹&#x27;</span>,</span><br><span class="line">  checkboxChecked: <span class="literal">false</span>, <span class="comment">// æ˜¯å¦é€‰ä¸­å•é€‰æ¡†</span></span><br><span class="line">  buttons: [<span class="string">&#x27;ç¡®è®¤æŒ‰é’®&#x27;</span>, <span class="string">&#x27;å–æ¶ˆæŒ‰é’®&#x27;</span>], <span class="comment">// æŒ‰é’®æŒ‰ç´¢å¼•ä»å³å¾€å·¦æ’åº</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;æ“ä½œç»“æœ promise&#x27;</span>, res) <span class="comment">// è¿”å›ä¸€ä¸ªpromiseå¯ä»¥é€šè¿‡å®ƒåˆ¤æ–­ç»“æœ</span></span><br></pre></td></tr></table></figure><h3 id="é€‰æ‹©æ–‡ä»¶å’Œæ–‡ä»¶å¤¹"><a href="#é€‰æ‹©æ–‡ä»¶å’Œæ–‡ä»¶å¤¹" class="headerlink" title="é€‰æ‹©æ–‡ä»¶å’Œæ–‡ä»¶å¤¹"></a>é€‰æ‹©æ–‡ä»¶å’Œæ–‡ä»¶å¤¹</h3><h4 id="é€‰æ‹©æ–‡ä»¶å®ä¾‹"><a href="#é€‰æ‹©æ–‡ä»¶å®ä¾‹" class="headerlink" title="é€‰æ‹©æ–‡ä»¶å®ä¾‹"></a>é€‰æ‹©æ–‡ä»¶å®ä¾‹</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @@code-renderer: runner</span></span><br><span class="line"><span class="comment">// @@code-props: &#123; height: &#x27;320px&#x27; &#125;</span></span><br><span class="line"><span class="keyword">const</span> &#123; dialog, app &#125; = <span class="built_in">require</span>(<span class="string">&#x27;electron&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> res = dialog.showOpenDialogSync(&#123;</span><br><span class="line">  title: <span class="string">&#x27;å¯¹è¯æ¡†çª—å£çš„æ ‡é¢˜&#x27;</span>,</span><br><span class="line">  <span class="comment">// é»˜è®¤æ‰“å¼€çš„è·¯å¾„ï¼Œæ¯”å¦‚è¿™é‡Œé»˜è®¤æ‰“å¼€ä¸‹è½½æ–‡ä»¶å¤¹</span></span><br><span class="line">  defaultPath: app.getPath(<span class="string">&#x27;downloads&#x27;</span>), </span><br><span class="line">  buttonLabel: <span class="string">&#x27;ç¡®è®¤æŒ‰é’®æ–‡æ¡ˆ&#x27;</span>,</span><br><span class="line">  <span class="comment">// é™åˆ¶èƒ½å¤Ÿé€‰æ‹©çš„æ–‡ä»¶ç±»å‹</span></span><br><span class="line">  filters: [</span><br><span class="line">    <span class="comment">// &#123; name: &#x27;Images&#x27;, extensions: [&#x27;jpg&#x27;, &#x27;png&#x27;, &#x27;gif&#x27;] &#125;,</span></span><br><span class="line">    <span class="comment">// &#123; name: &#x27;Movies&#x27;, extensions: [&#x27;mkv&#x27;, &#x27;avi&#x27;, &#x27;mp4&#x27;] &#125;,</span></span><br><span class="line">    <span class="comment">// &#123; name: &#x27;Custom File Type&#x27;, extensions: [&#x27;as&#x27;] &#125;,</span></span><br><span class="line">    <span class="comment">// &#123; name: &#x27;All Files&#x27;, extensions: [&#x27;*&#x27;] &#125;, </span></span><br><span class="line">  ],</span><br><span class="line">  properties: [ <span class="string">&#x27;openFile&#x27;</span>, <span class="string">&#x27;openDirectory&#x27;</span>, <span class="string">&#x27;multiSelections&#x27;</span>, <span class="string">&#x27;showHiddenFiles&#x27;</span> ],</span><br><span class="line">  message: <span class="string">&#x27;macæ–‡ä»¶é€‰æ‹©å™¨title&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;res&#x27;</span>, res)</span><br></pre></td></tr></table></figure><h3 id="APIè¯´æ˜-1"><a href="#APIè¯´æ˜-1" class="headerlink" title="APIè¯´æ˜"></a>APIè¯´æ˜</h3><p><code>dialog.showOpenDialogSync(browserWindow,options)</code></p><p>å‚æ•°ï¼š</p><p><code>options</code></p><ul><li><p><code>defaultPath</code>  String (å¯é€‰) - è®¾ç½®å¯¹è¯æ¡†é»˜è®¤æ‰“å¼€å“ªä¸ªè·¯å¾„ï¼Œéœ€è¦è®¾ç½®ä¸€ä¸ªæœ‰æ•ˆè·¯å¾„å¦åˆ™å°†ä¸ç”Ÿæ•ˆã€‚</p></li><li><p><code>buttonLabel</code>  String (å¯é€‰) - ç¡®è®¤æŒ‰é’®çš„æ–‡æ¡ˆ, å½“ä¸ºç©ºæ—¶, å°†ä½¿ç”¨é»˜è®¤æ ‡ç­¾</p></li><li><p><code>filters</code> é»˜è®¤æ‰€æœ‰æ–‡ä»¶ç±»å‹éƒ½å¯ä»¥é€‰æ‹©ï¼Œè®¾ç½®å,åªèƒ½é€‰æ‹©å…è®¸çš„æ–‡ä»¶ç±»å‹</p></li><li><p><code>properties</code> String[] (å¯é€‰)</p><ul><li><code>openFile</code> - å…è®¸é€‰æ‹©æ–‡ä»¶</li><li><code>openDirectory</code> - å…è®¸é€‰æ‹©æ–‡ä»¶å¤¹</li><li><code>multiSelections</code> - å…è®¸å¤šé€‰ã€‚</li><li><code>showHiddenFiles</code> - æ˜¾ç¤ºå¯¹è¯æ¡†ä¸­çš„éšè—æ–‡ä»¶</li></ul></li></ul><ul><li><code>message</code> String (å¯é€‰) -  macæ–‡ä»¶é€‰æ‹©å™¨çš„title</li></ul><blockquote><p>tips: å°è¯•ä¿®æ”¹optionsä¸­çš„å‚æ•°æ¥æŸ¥çœ‹æ•ˆæœï¼›</p></blockquote><p>è¿”å›å€¼ç±»å‹ï¼š</p><p><code>String[] | undefined</code> - ç”¨æˆ·é€‰æ‹©çš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹è·¯å¾„;å¦‚æœå–æ¶ˆå¯¹è¯æ¡†ï¼Œåˆ™è¿”å›undefined</p><p><a href="https://www.electronjs.org/docs/api/dialog#dialogshowopendialogsyncbrowserwindow-options">å®Œæ•´APIè§£é‡Šå‚è€ƒæ–‡æ¡£</a></p><h3 id="ä¿å­˜æ–‡ä»¶"><a href="#ä¿å­˜æ–‡ä»¶" class="headerlink" title="ä¿å­˜æ–‡ä»¶"></a>ä¿å­˜æ–‡ä»¶</h3><h4 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @@code-renderer: runner</span></span><br><span class="line"><span class="comment">// @@code-props: &#123; height: &#x27;300px&#x27; &#125;</span></span><br><span class="line"><span class="keyword">const</span> &#123; dialog &#125; = <span class="built_in">require</span>(<span class="string">&#x27;electron&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> res = dialog.showSaveDialogSync(&#123;</span><br><span class="line">  title: <span class="string">&#x27;å¯¹è¯æ¡†çª—å£çš„æ ‡é¢˜&#x27;</span>,</span><br><span class="line">  defaultPath: <span class="string">&#x27;&#x27;</span>, <span class="comment">// æ‰“å¼€æ–‡ä»¶é€‰æ‹©å™¨çš„å“ªä¸ªè·¯å¾„ éœ€è¦è¾“å…¥ä¸€ä¸ªæœ‰æ•ˆè·¯å¾„</span></span><br><span class="line">  buttonLabel: <span class="string">&#x27;ç¡®è®¤æŒ‰é’®æ–‡æ¡ˆ&#x27;</span>,</span><br><span class="line">  <span class="comment">// é™åˆ¶èƒ½å¤Ÿé€‰æ‹©çš„æ–‡ä»¶ä¸ºæŸäº›ç±»å‹</span></span><br><span class="line">  filters: [</span><br><span class="line">    <span class="comment">// &#123; name: &#x27;Images&#x27;, extensions: [&#x27;jpg&#x27;, &#x27;png&#x27;, &#x27;gif&#x27;] &#125;,</span></span><br><span class="line">    <span class="comment">// &#123; name: &#x27;Movies&#x27;, extensions: [&#x27;mkv&#x27;, &#x27;avi&#x27;, &#x27;mp4&#x27;] &#125;,</span></span><br><span class="line">    <span class="comment">// &#123; name: &#x27;Custom File Type&#x27;, extensions: [&#x27;as&#x27;] &#125;,</span></span><br><span class="line">    <span class="comment">// &#123; name: &#x27;All Files&#x27;, extensions: [&#x27;*&#x27;] &#125;, </span></span><br><span class="line">  ],</span><br><span class="line">  nameFieldLabel: <span class="string">&#x27;æ›¿æ¢æ–‡ä»¶&#x27;</span>, <span class="comment">// â€œæ–‡ä»¶åâ€æ–‡æœ¬å­—æ®µå‰é¢æ˜¾ç¤ºçš„æ–‡æœ¬è‡ªå®šä¹‰æ ‡ç­¾</span></span><br><span class="line">  showsTagField: <span class="literal">true</span>, <span class="comment">// æ˜¾ç¤ºæ ‡ç­¾è¾“å…¥æ¡†ï¼Œé»˜è®¤å€¼ä¸ºtrue</span></span><br><span class="line">  properties: [ <span class="string">&#x27;showHiddenFiles&#x27;</span> ],</span><br><span class="line">  message: <span class="string">&#x27;macæ–‡ä»¶é€‰æ‹©å™¨title&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;res&#x27;</span>, res)</span><br></pre></td></tr></table></figure><h4 id="APIè¯´æ˜-2"><a href="#APIè¯´æ˜-2" class="headerlink" title="APIè¯´æ˜"></a>APIè¯´æ˜</h4><p><code>dialog.showSaveDialogSync(browserWindow,options)</code></p><p>å‚æ•°ï¼š</p><p><code>options</code></p><ul><li><p><code>defaultPath</code>  String (å¯é€‰) - è®¾ç½®å¯¹è¯æ¡†é»˜è®¤æ‰“å¼€å“ªä¸ªè·¯å¾„ï¼Œéœ€è¦è®¾ç½®ä¸€ä¸ªæœ‰æ•ˆè·¯å¾„å¦åˆ™å°†ä¸ç”Ÿæ•ˆã€‚</p></li><li><p><code>buttonLabel</code>  String (å¯é€‰) - ç¡®è®¤æŒ‰é’®çš„æ–‡æ¡ˆ, å½“ä¸ºç©ºæ—¶, å°†ä½¿ç”¨é»˜è®¤æ ‡ç­¾</p></li><li><p><code>filters</code> é»˜è®¤æ‰€æœ‰æ–‡ä»¶ç±»å‹éƒ½å¯ä»¥é€‰æ‹©ï¼Œè®¾ç½®å,åªèƒ½é€‰æ‹©å…è®¸çš„æ–‡ä»¶ç±»å‹</p></li><li><p><code>properties</code> String[] (å¯é€‰)</p><ul><li><code>openFile</code> - å…è®¸é€‰æ‹©æ–‡ä»¶</li><li><code>openDirectory</code> - å…è®¸é€‰æ‹©æ–‡ä»¶å¤¹</li><li><code>multiSelections</code> - å…è®¸å¤šé€‰ã€‚</li><li><code>showHiddenFiles</code> - æ˜¾ç¤ºå¯¹è¯æ¡†ä¸­çš„éšè—æ–‡ä»¶</li></ul></li></ul><ul><li><code>message</code> String (å¯é€‰) -  macæ–‡ä»¶é€‰æ‹©å™¨çš„title</li></ul><p>è¿”å›å€¼ç±»å‹ï¼š</p><p><code>String[] | undefined</code> - ç”¨æˆ·é€‰æ‹©çš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹è·¯å¾„;å¦‚æœå–æ¶ˆå¯¹è¯æ¡†ï¼Œåˆ™è¿”å›undefinedï¼›</p><p>å®Œæ•´APIè§£é‡Šå‚è€ƒ<a href="https://www.electronjs.org/docs/api/dialog#dialogshowsavedialogsyncbrowserwindow-options">æ–‡æ¡£</a></p><h4 id="ä¸åŒåœºæ™¯è¡¨ç°"><a href="#ä¸åŒåœºæ™¯è¡¨ç°" class="headerlink" title="ä¸åŒåœºæ™¯è¡¨ç°"></a>ä¸åŒåœºæ™¯è¡¨ç°</h4><ol><li><p>é€‰æ‹©äº†ä¸€ä¸ªå­˜åœ¨çš„æ–‡ä»¶ </p><p> æç¤ºâ€<strong>æ–‡ä»¶å¤¹ä¸­å·²æœ‰ç›¸åŒåç§°çš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ã€‚æ›¿æ¢å®ƒå°†è¦†ç›–å…¶å½“å‰å†…å®¹ã€‚</strong>â€œï¼Œç‚¹å‡»ç¡®è®¤åè¿”å›è¯¥æ–‡ä»¶åœ°å€</p></li><li><p>é€‰æ‹©äº†ä¸€ä¸ªä¸å­˜åœ¨çš„æ–‡ä»¶</p><p> è¿”å›è¯¥ä¸å­˜åœ¨çš„æ–‡ä»¶åœ°å€</p></li></ol><h3 id="é”™è¯¯ä¿¡æ¯å¼¹çª—"><a href="#é”™è¯¯ä¿¡æ¯å¼¹çª—" class="headerlink" title="é”™è¯¯ä¿¡æ¯å¼¹çª—"></a>é”™è¯¯ä¿¡æ¯å¼¹çª—</h3><h2 id="ä¸‹è½½ç®¡ç†å™¨"><a href="#ä¸‹è½½ç®¡ç†å™¨" class="headerlink" title="ä¸‹è½½ç®¡ç†å™¨"></a>ä¸‹è½½ç®¡ç†å™¨</h2><h3 id="ä¸‹è½½ç®¡ç†å™¨-1"><a href="#ä¸‹è½½ç®¡ç†å™¨-1" class="headerlink" title="ä¸‹è½½ç®¡ç†å™¨"></a>ä¸‹è½½ç®¡ç†å™¨</h3><p>ç‚¹å‡»â€œè¯•ä¸€è¯•â€æŒ‰é’®ä½“éªŒä¸€ä¸‹ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @@code-renderer: runner</span></span><br><span class="line"><span class="comment">// @@code-props: &#123;hideRight: true, mProcess: false&#125;</span></span><br><span class="line"><span class="keyword">const</span> &#123;ipcRenderer&#125; = <span class="built_in">require</span>(<span class="string">&#x27;electron&#x27;</span>)</span><br><span class="line">ipcRenderer.invoke(<span class="string">&#x27;openDownloadManager&#x27;</span>, <span class="string">&#x27;/download-manager/demo&#x27;</span>)</span><br></pre></td></tr></table></figure><p>æ–‡ä»¶ä¸‹è½½æ˜¯æˆ‘ä»¬å¼€å‘ä¸­æ¯”è¾ƒå¸¸è§çš„ä¸šåŠ¡éœ€æ±‚ï¼Œæ¯”å¦‚ï¼šå¯¼å‡º excelã€‚</p><p>web åº”ç”¨æ–‡ä»¶ä¸‹è½½å­˜åœ¨ä¸€äº›å±€é™æ€§ï¼Œé€šå¸¸æ˜¯è®©åç«¯å°†å“åº”çš„å¤´ä¿¡æ¯æ”¹æˆ <code>Content-Disposition: attachment; filename=xxx.pdf</code>ï¼Œè§¦å‘æµè§ˆå™¨çš„ä¸‹è½½è¡Œä¸ºã€‚</p><p>åœ¨ electron ä¸­çš„ä¸‹è½½è¡Œä¸ºï¼Œéƒ½ä¼šè§¦å‘ session çš„ <a href="https://www.electronjs.org/docs/api/session#instance-events">will-download</a> äº‹ä»¶ã€‚åœ¨è¯¥äº‹ä»¶é‡Œé¢å¯ä»¥è·å–åˆ° <a href="https://www.electronjs.org/docs/api/download-item">downloadItem</a> å¯¹è±¡ï¼Œé€šè¿‡ <a href="https://www.electronjs.org/docs/api/download-item">downloadItem</a> å¯¹è±¡å®ç°ä¸€ä¸ªç®€å•çš„æ–‡ä»¶ä¸‹è½½ç®¡ç†å™¨ï¼š</p><p><img src= "/img/loading.gif" data-lazy-src="http://mei160.cn/images/demo.gif" alt="æ•ˆæœå›¾"></p><h3 id="å¦‚ä½•è§¦å‘ä¸‹è½½"><a href="#å¦‚ä½•è§¦å‘ä¸‹è½½" class="headerlink" title="å¦‚ä½•è§¦å‘ä¸‹è½½"></a>å¦‚ä½•è§¦å‘ä¸‹è½½</h3><p>ç”±äº electron æ˜¯åŸºäº chromium å®ç°çš„ï¼Œé€šè¿‡è°ƒç”¨ webContents çš„ <a href="https://www.electronjs.org/docs/api/web-contents#contentsdownloadurlurl">downloadURL</a> æ–¹æ³•ï¼Œç›¸å½“äºè°ƒç”¨äº† chromium åº•å±‚å®ç°çš„ä¸‹è½½ï¼Œä¼šå¿½ç•¥å“åº”å¤´ä¿¡æ¯ï¼Œè§¦å‘ <a href="https://www.electronjs.org/docs/api/session#instance-events">will-download</a> äº‹ä»¶ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è§¦å‘ä¸‹è½½</span></span><br><span class="line">win.webContents.downloadURL(url)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç›‘å¬ will-download</span></span><br><span class="line">session.defaultSession.on(<span class="string">&#x27;will-download&#x27;</span>, <span class="function">(<span class="params">event, item, webContents</span>) =&gt;</span> &#123;&#125;)</span><br></pre></td></tr></table></figure><h3 id="ä¸‹è½½æµç¨‹å›¾"><a href="#ä¸‹è½½æµç¨‹å›¾" class="headerlink" title="ä¸‹è½½æµç¨‹å›¾"></a>ä¸‹è½½æµç¨‹å›¾</h3><p><img src= "/img/loading.gif" data-lazy-src="http://mei160.cn/images/flow_chart.png" alt="æµç¨‹å›¾"></p><h3 id="åŠŸèƒ½è®¾è®¡"><a href="#åŠŸèƒ½è®¾è®¡" class="headerlink" title="åŠŸèƒ½è®¾è®¡"></a>åŠŸèƒ½è®¾è®¡</h3><p>åœ¨ä¸Šé¢çš„æ•ˆæœå›¾ä¸­ï¼Œå®ç°çš„ç®€å•æ–‡ä»¶ä¸‹è½½ç®¡ç†å™¨åŠŸèƒ½åŒ…å«ï¼š</p><ul><li>è®¾ç½®ä¿å­˜è·¯å¾„</li><li>æš‚åœ/æ¢å¤å’Œå–æ¶ˆ</li><li>ä¸‹è½½è¿›åº¦</li><li>ä¸‹è½½é€Ÿåº¦</li><li>ä¸‹è½½å®Œæˆ</li><li>æ‰“å¼€æ–‡ä»¶å’Œæ‰“å¼€æ–‡ä»¶æ‰€åœ¨ä½ç½®</li><li>æ–‡ä»¶å›¾æ ‡</li><li>ä¸‹è½½è®°å½•</li></ul><h4 id="è®¾ç½®ä¿å­˜è·¯å¾„"><a href="#è®¾ç½®ä¿å­˜è·¯å¾„" class="headerlink" title="è®¾ç½®ä¿å­˜è·¯å¾„"></a>è®¾ç½®ä¿å­˜è·¯å¾„</h4><p>å¦‚æœæ²¡æœ‰è®¾ç½®ä¿å­˜è·¯å¾„ï¼Œelectron ä¼šè‡ªåŠ¨å¼¹å‡ºç³»ç»Ÿçš„ä¿å­˜å¯¹è¯æ¡†ã€‚ä¸æƒ³ä½¿ç”¨ç³»ç»Ÿçš„ä¿å­˜å¯¹è¯æ¡†ï¼Œå¯ä»¥ä½¿ç”¨ <a href="https://www.electronjs.org/docs/api/download-item#downloaditemsetsavepathpath">setSavePath</a> æ–¹æ³•ï¼Œå½“æœ‰é‡åæ–‡ä»¶æ—¶ï¼Œä¼šç›´æ¥è¦†ç›–ä¸‹è½½ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">item.setSavePath(path)</span><br></pre></td></tr></table></figure><p>ä¸ºäº†æ›´å¥½çš„ç”¨æˆ·ä½“éªŒï¼Œå¯ä»¥è®©ç”¨æˆ·è‡ªå·±é€‰æ‹©ä¿å­˜ä½ç½®æ“ä½œã€‚å½“ç‚¹å‡»ä½ç½®è¾“å…¥æ¡†æ—¶ï¼Œæ¸²æŸ“è¿›ç¨‹é€šè¿‡ ipc ä¸ä¸»è¿›ç¨‹é€šä¿¡ï¼Œæ‰“å¼€ç³»ç»Ÿæ–‡ä»¶é€‰æ‹©å¯¹è¯æ¡†ã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="http://mei160.cn/images/select_path.gif" alt="é€‰æ‹©ä¿å­˜ä½ç½®"></p><p>ä¸»è¿›ç¨‹å®ç°ä»£ç ï¼š</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ‰“å¼€æ–‡ä»¶é€‰æ‹©æ¡†</span></span><br><span class="line"><span class="comment"> * @param oldPath - ä¸Šä¸€æ¬¡æ‰“å¼€çš„è·¯å¾„</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> openFileDialog = <span class="keyword">async</span> (oldPath: <span class="built_in">string</span> = app.getPath(<span class="string">&#x27;downloads&#x27;</span>)) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (!win) <span class="keyword">return</span> oldPath</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> &#123; canceled, filePaths &#125; = <span class="keyword">await</span> dialog.showOpenDialog(win, &#123;</span><br><span class="line">    title: <span class="string">&#x27;é€‰æ‹©ä¿å­˜ä½ç½®&#x27;</span>,</span><br><span class="line">    properties: [<span class="string">&#x27;openDirectory&#x27;</span>, <span class="string">&#x27;createDirectory&#x27;</span>],</span><br><span class="line">    defaultPath: oldPath,</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> !canceled ? filePaths[<span class="number">0</span>] : oldPath</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ipcMain.handle(<span class="string">&#x27;openFileDialog&#x27;</span>, <span class="function">(<span class="params">event, oldPath?: <span class="built_in">string</span></span>) =&gt;</span> openFileDialog(oldPath))</span><br></pre></td></tr></table></figure><p>æ¸²æŸ“è¿›ç¨‹ä»£ç ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="keyword">await</span> ipcRenderer.invoke(<span class="string">&#x27;openFileDialog&#x27;</span>, <span class="string">&#x27;PATH&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(path)</span><br></pre></td></tr></table></figure><h4 id="æš‚åœ-æ¢å¤å’Œå–æ¶ˆ"><a href="#æš‚åœ-æ¢å¤å’Œå–æ¶ˆ" class="headerlink" title="æš‚åœ/æ¢å¤å’Œå–æ¶ˆ"></a>æš‚åœ/æ¢å¤å’Œå–æ¶ˆ</h4><p>æ‹¿åˆ° <a href="https://www.electronjs.org/docs/api/download-item">downloadItem</a> åï¼Œæš‚åœã€æ¢å¤å’Œå–æ¶ˆåˆ†åˆ«è°ƒç”¨ <code>pause</code>ã€<code>resume</code> å’Œ <code>cancel</code> æ–¹æ³•ã€‚å½“æˆ‘ä»¬è¦åˆ é™¤åˆ—è¡¨ä¸­æ­£åœ¨ä¸‹è½½çš„é¡¹ï¼Œéœ€è¦å…ˆè°ƒç”¨ cancel æ–¹æ³•å–æ¶ˆä¸‹è½½ã€‚</p><h4 id="ä¸‹è½½è¿›åº¦"><a href="#ä¸‹è½½è¿›åº¦" class="headerlink" title="ä¸‹è½½è¿›åº¦"></a>ä¸‹è½½è¿›åº¦</h4><p>åœ¨ <a href="https://www.electronjs.org/docs/api/download-item">downloadItem</a> ä¸­ç›‘å¬ updated äº‹ä»¶ï¼Œå¯ä»¥å®æ—¶è·å–åˆ°å·²ä¸‹è½½çš„å­—èŠ‚æ•°æ®ï¼Œæ¥è®¡ç®—ä¸‹è½½è¿›åº¦å’Œæ¯ç§’ä¸‹è½½çš„é€Ÿåº¦ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è®¡ç®—ä¸‹è½½è¿›åº¦</span></span><br><span class="line"><span class="keyword">const</span> progress = item.getReceivedBytes() / item.getTotalBytes()</span><br></pre></td></tr></table></figure><p><img src= "/img/loading.gif" data-lazy-src="http://mei160.cn/images/download_progress.png" alt="ä¸‹è½½è¿›åº¦"></p><p>åœ¨ä¸‹è½½çš„æ—¶å€™ï¼Œæƒ³åœ¨ Mac ç³»ç»Ÿçš„ç¨‹åºåå’Œ Windows ç³»ç»Ÿçš„ä»»åŠ¡æ å±•ç¤ºä¸‹è½½ä¿¡æ¯ï¼Œæ¯”å¦‚ï¼š</p><ul><li>ä¸‹è½½æ•°ï¼šé€šè¿‡ app çš„ <a href="https://www.electronjs.org/docs/api/app#appbadgecount-linux-macos">badgeCount</a> å±æ€§è®¾ç½®ï¼Œå½“ä¸º 0 æ—¶ï¼Œä¸ä¼šæ˜¾ç¤ºã€‚ä¹Ÿå¯ä»¥é€šè¿‡ dock çš„ <a href="https://www.electronjs.org/docs/api/app#appsetbadgecountcount-linux-macos">setBadge</a> æ–¹æ³•è®¾ç½®ï¼Œè¯¥æ–¹æ³•æ”¯æŒçš„æ˜¯å­—ç¬¦ä¸²ï¼Œå¦‚æœä¸è¦æ˜¾ç¤ºï¼Œéœ€è¦è®¾ç½®ä¸º â€˜â€™ã€‚</li><li>ä¸‹è½½è¿›åº¦ï¼šé€šè¿‡çª—å£çš„ <a href="https://www.electronjs.org/docs/api/browser-window#winsetprogressbarprogress-options">setProgressBar</a> æ–¹æ³•è®¾ç½®ã€‚</li></ul><blockquote><p>ç”±äº Mac å’Œ Windows ç³»ç»Ÿå·®å¼‚ï¼Œä¸‹è½½æ•°ä»…åœ¨ Mac ç³»ç»Ÿä¸­ç”Ÿæ•ˆã€‚åŠ ä¸Š process.platform === â€˜darwinâ€™ æ¡ä»¶ï¼Œé¿å…åœ¨é Macã€Linux ç³»ç»Ÿä¸‹å‡ºç°å¼‚å¸¸é”™è¯¯ã€‚</p></blockquote><p>ä¸‹è½½è¿›åº¦ï¼ˆWindows ç³»ç»Ÿä»»åŠ¡æ ã€Mac ç³»ç»Ÿç¨‹åºåï¼‰æ˜¾ç¤ºæ•ˆæœï¼š</p><p><img src= "/img/loading.gif" data-lazy-src="http://mei160.cn/images/windows_progress.png" alt="windows è¿›åº¦"></p><p><img src= "/img/loading.gif" data-lazy-src="http://mei160.cn/images/mac_download_progress.png" alt="mac ç¨‹åºå"></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// mac ç¨‹åºåæ˜¾ç¤ºä¸‹è½½æ•°ï¼š</span></span><br><span class="line"><span class="comment">// æ–¹å¼ä¸€</span></span><br><span class="line">app.badgeCount = <span class="number">1</span></span><br><span class="line"><span class="comment">// æ–¹å¼äºŒ</span></span><br><span class="line">app.dock.setBadge(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// mac ç¨‹åºåã€windows ä»»åŠ¡æ æ˜¾ç¤ºè¿›åº¦</span></span><br><span class="line">win.setProgressBar(progress)</span><br></pre></td></tr></table></figure><h4 id="ä¸‹è½½é€Ÿåº¦"><a href="#ä¸‹è½½é€Ÿåº¦" class="headerlink" title="ä¸‹è½½é€Ÿåº¦"></a>ä¸‹è½½é€Ÿåº¦</h4><p>ç”±äº <a href="https://www.electronjs.org/docs/api/download-item">downloadItem</a> æ²¡æœ‰ç›´æ¥ä¸ºæˆ‘ä»¬æä¾›æ–¹æ³•æˆ–å±æ€§è·å–ä¸‹è½½é€Ÿåº¦ï¼Œéœ€è¦è‡ªå·±å®ç°ã€‚</p><blockquote><p>æ€è·¯ï¼šåœ¨ updated äº‹ä»¶é‡Œé€šè¿‡ getReceivedBytes æ–¹æ³•æ‹¿åˆ°æœ¬æ¬¡ä¸‹è½½çš„å­—èŠ‚æ•°æ®å‡å»ä¸Šä¸€æ¬¡ä¸‹è½½çš„å­—èŠ‚æ•°æ®ã€‚</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è®°å½•ä¸Šä¸€æ¬¡ä¸‹è½½çš„å­—èŠ‚æ•°æ®</span></span><br><span class="line"><span class="keyword">let</span> prevReceivedBytes = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">item.on(<span class="string">&#x27;updated&#x27;</span>, <span class="function">(<span class="params">e, state</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> receivedBytes = item.getReceivedBytes()</span><br><span class="line">  <span class="comment">// è®¡ç®—æ¯ç§’ä¸‹è½½çš„é€Ÿåº¦</span></span><br><span class="line">  downloadItem.speed = receivedBytes - prevReceivedBytes</span><br><span class="line">  prevReceivedBytes = receivedBytes</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><blockquote><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œupdated äº‹ä»¶æ‰§è¡Œçš„æ—¶é—´çº¦ 500ms ä¸€æ¬¡ã€‚</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="http://mei160.cn/images/updated_event.png" alt="updated_event"></p><h4 id="ä¸‹è½½å®Œæˆ"><a href="#ä¸‹è½½å®Œæˆ" class="headerlink" title="ä¸‹è½½å®Œæˆ"></a>ä¸‹è½½å®Œæˆ</h4><p>å½“ä¸€ä¸ªæ–‡ä»¶ä¸‹è½½å®Œæˆã€ä¸­æ–­æˆ–è€…è¢«å–æ¶ˆï¼Œéœ€è¦é€šçŸ¥æ¸²æŸ“è¿›ç¨‹ä¿®æ”¹çŠ¶æ€ï¼Œé€šè¿‡ç›‘å¬ <a href="https://www.electronjs.org/docs/api/download-item">downloadItem</a> çš„ done äº‹ä»¶ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">item.on(<span class="string">&#x27;done&#x27;</span>, <span class="function">(<span class="params">e, state</span>) =&gt;</span> &#123;</span><br><span class="line">  downloadItem.state = state</span><br><span class="line">  downloadItem.receivedBytes = item.getReceivedBytes()</span><br><span class="line">  downloadItem.lastModifiedTime = item.getLastModifiedTime()</span><br><span class="line"></span><br><span class="line">  <span class="comment">// é€šçŸ¥æ¸²æŸ“è¿›ç¨‹ï¼Œæ›´æ–°ä¸‹è½½çŠ¶æ€</span></span><br><span class="line">  webContents.send(<span class="string">&#x27;downloadItemDone&#x27;</span>, downloadItem)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="æ‰“å¼€æ–‡ä»¶å’Œæ‰“å¼€æ–‡ä»¶æ‰€åœ¨ä½ç½®"><a href="#æ‰“å¼€æ–‡ä»¶å’Œæ‰“å¼€æ–‡ä»¶æ‰€åœ¨ä½ç½®" class="headerlink" title="æ‰“å¼€æ–‡ä»¶å’Œæ‰“å¼€æ–‡ä»¶æ‰€åœ¨ä½ç½®"></a>æ‰“å¼€æ–‡ä»¶å’Œæ‰“å¼€æ–‡ä»¶æ‰€åœ¨ä½ç½®</h4><p>ä½¿ç”¨ electron çš„ shell æ¨¡å—æ¥å®ç°æ‰“å¼€æ–‡ä»¶ï¼ˆ<a href="https://www.electronjs.org/docs/api/shell#shellopenpathpath">openPath</a>ï¼‰å’Œæ‰“å¼€æ–‡ä»¶æ‰€åœ¨ä½ç½®ï¼ˆ<a href="https://www.electronjs.org/docs/api/shell#shellshowiteminfolderfullpath">showItemInFolder</a>ï¼‰ã€‚</p><blockquote><p>ç”±äº openPath æ–¹æ³•æ”¯æŒè¿”å›å€¼ <code>Promise&lt;string&gt;</code>ï¼Œå½“ä¸æ”¯æŒæ‰“å¼€çš„æ–‡ä»¶ï¼Œç³»ç»Ÿä¼šæœ‰ç›¸åº”çš„æç¤ºï¼Œè€Œ showItemInFolder æ–¹æ³•è¿”å›å€¼æ˜¯ <code>void</code>ã€‚å¦‚æœéœ€è¦æ›´å¥½çš„ç”¨æˆ·ä½“éªŒï¼Œå¯ä½¿ç”¨ nodejs çš„ fs æ¨¡å—ï¼Œå…ˆæ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ã€‚</p></blockquote><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> fs <span class="keyword">from</span> <span class="string">&#x27;fs&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‰“å¼€æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">const</span> openFile = (path: <span class="built_in">string</span>): <span class="function"><span class="params">boolean</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (!fs.existsSync(path)) <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">  shell.openPath(path)</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‰“å¼€æ–‡ä»¶æ‰€åœ¨ä½ç½®</span></span><br><span class="line"><span class="keyword">const</span> openFileInFolder = (path: <span class="built_in">string</span>): <span class="function"><span class="params">boolean</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (!fs.existsSync(path)) <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">  shell.showItemInFolder(path)</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ–‡ä»¶å›¾æ ‡"><a href="#æ–‡ä»¶å›¾æ ‡" class="headerlink" title="æ–‡ä»¶å›¾æ ‡"></a>æ–‡ä»¶å›¾æ ‡</h4><p>å¾ˆæ–¹ä¾¿çš„æ˜¯ä½¿ç”¨ app æ¨¡å—çš„ <a href="https://www.electronjs.org/docs/api/app#appgetfileiconpath-options">getFileIcon</a> æ–¹æ³•æ¥è·å–ç³»ç»Ÿå…³è”çš„æ–‡ä»¶å›¾æ ‡ï¼Œè¿”å›çš„æ˜¯ <code>Promise&lt;NativeImage&gt;</code> ç±»å‹ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ toDataURL æ–¹æ³•è½¬æ¢æˆ base64ï¼Œä¸éœ€è¦æˆ‘ä»¬å»å¤„ç†ä¸åŒæ–‡ä»¶ç±»å‹æ˜¾ç¤ºä¸åŒçš„å›¾æ ‡ã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> getFileIcon = <span class="keyword">async</span> (path: <span class="built_in">string</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> iconDefault = <span class="string">&#x27;./icon_default.png&#x27;</span></span><br><span class="line">  <span class="keyword">if</span> (!path) <span class="built_in">Promise</span>.resolve(iconDefault)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> icon = <span class="keyword">await</span> app.getFileIcon(path, &#123;</span><br><span class="line">    size: <span class="string">&#x27;normal&#x27;</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> icon.toDataURL()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ä¸‹è½½è®°å½•"><a href="#ä¸‹è½½è®°å½•" class="headerlink" title="ä¸‹è½½è®°å½•"></a>ä¸‹è½½è®°å½•</h4><p>éšç€ä¸‹è½½çš„å†å²æ•°æ®è¶Šæ¥è¶Šå¤šï¼Œä½¿ç”¨ <a href="https://github.com/sindresorhus/electron-store">electron-store</a> å°†ä¸‹è½½è®°å½•ä¿å­˜åœ¨æœ¬åœ°ã€‚</p><h2 id="åè®®"><a href="#åè®®" class="headerlink" title="åè®®"></a>åè®®</h2><p><strong>åè®®è‡ªåŠ¨å”¤èµ·åº”ç”¨ä¸è‡ªå®šä¹‰åè®®</strong></p><h3 id="åè®®-ä»ç½‘é¡µç«¯å”¤èµ·Electronåº”ç”¨"><a href="#åè®®-ä»ç½‘é¡µç«¯å”¤èµ·Electronåº”ç”¨" class="headerlink" title="åè®®: ä»ç½‘é¡µç«¯å”¤èµ·Electronåº”ç”¨"></a>åè®®: ä»ç½‘é¡µç«¯å”¤èµ·Electronåº”ç”¨</h3><h4 id="åè®®å”¤èµ·ç¤ºä¾‹"><a href="#åè®®å”¤èµ·ç¤ºä¾‹" class="headerlink" title="åè®®å”¤èµ·ç¤ºä¾‹:"></a>åè®®å”¤èµ·ç¤ºä¾‹:</h4><p><img src= "/img/loading.gif" data-lazy-src="http://mei160.cn/images/wakeUp.jpg?height=200"></p><h4 id="ä»€ä¹ˆæ˜¯åè®®"><a href="#ä»€ä¹ˆæ˜¯åè®®" class="headerlink" title="ä»€ä¹ˆæ˜¯åè®®"></a>ä»€ä¹ˆæ˜¯åè®®</h4><p>electronæ³¨å†Œçš„åè®®, electronä¼šå°†åè®®æ³¨å†Œåˆ°ç³»ç»Ÿçš„åè®®åˆ—è¡¨ä¸­ï¼Œå®ƒæ˜¯ç³»ç»Ÿå±‚çº§çš„APIï¼Œåªèƒ½åœ¨å½“å‰ç³»ç»Ÿä¸‹ä½¿ç”¨, å…¶ä»–æœªæ³¨å†Œåè®®çš„ç”µè„‘ä¸èƒ½è¯†åˆ«ã€‚</p><p>Electronçš„appæ¨¡å—æä¾›äº†ä¸€äº›å¤„ç†åè®®çš„æ–¹æ³•, è¿™äº›æ–¹æ³•å…è®¸æ‚¨è®¾ç½®åè®®å’Œå–æ¶ˆåè®®, æ¥è®©ä½ çš„åº”ç”¨æˆä¸ºé»˜è®¤çš„åº”ç”¨ç¨‹åºã€‚</p><h4 id="åè®®çš„ä½œç”¨"><a href="#åè®®çš„ä½œç”¨" class="headerlink" title="åè®®çš„ä½œç”¨"></a>åè®®çš„ä½œç”¨</h4><p>æ³¨å†Œä¸€ä¸ªåè®®åˆ°ç³»ç»Ÿåè®®ä¸­, å½“é€šè¿‡å…¶ä»–åº”ç”¨/æµè§ˆå™¨ç½‘é¡µç«¯**æ‰“å¼€æ–°åè®®çš„é“¾æ¥æ—¶ï¼Œæµè§ˆå™¨ä¼šæ£€æµ‹è¯¥åè®®æœ‰æ²¡æœ‰åœ¨ç³»ç»Ÿåè®®ä¸­, å¦‚æœè¯¥åè®®æ³¨å†Œè¿‡ï¼Œç„¶åå”¤èµ·åè®®çš„é»˜è®¤å¤„ç†ç¨‹åº(æˆ‘ä»¬çš„åº”ç”¨)**ã€‚</p><h4 id="æ³¨å†Œåè®®-app-setAsDefaultProtocolClient"><a href="#æ³¨å†Œåè®®-app-setAsDefaultProtocolClient" class="headerlink" title="æ³¨å†Œåè®®: app.setAsDefaultProtocolClient"></a>æ³¨å†Œåè®®: app.setAsDefaultProtocolClient</h4><p>åè®®éœ€è¦åœ¨readyäº‹ä»¶åæ³¨å†Œï¼Œå…·ä½“ä»£ç å¦‚ä¸‹.</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @@code-renderer: runner</span></span><br><span class="line"><span class="comment">// @@code-props: &#123; height: &#x27;400px&#x27; &#125;</span></span><br><span class="line"><span class="comment">// æ³¨å†Œè‡ªå®šä¹‰åè®®</span></span><br><span class="line"><span class="keyword">const</span> &#123; app &#125; = <span class="built_in">require</span>(<span class="string">&#x27;electron&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ³¨å†Œè‡ªå®šä¹‰åè®®</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">setDefaultProtocol</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> agreement = <span class="string">&#x27;electron-playground-code&#x27;</span> <span class="comment">// è‡ªå®šä¹‰åè®®å</span></span><br><span class="line">  <span class="keyword">let</span> isSet = <span class="literal">false</span> <span class="comment">// æ˜¯å¦æ³¨å†ŒæˆåŠŸ</span></span><br><span class="line"></span><br><span class="line">  app.removeAsDefaultProtocolClient(agreement) <span class="comment">// æ¯æ¬¡è¿è¡Œéƒ½åˆ é™¤è‡ªå®šä¹‰åè®® ç„¶åå†é‡æ–°æ³¨å†Œ</span></span><br><span class="line">  <span class="comment">// å¼€å‘æ¨¡å¼ä¸‹åœ¨windowè¿è¡Œéœ€è¦åšå…¼å®¹</span></span><br><span class="line">  <span class="keyword">if</span> (process.env.NODE_ENV === <span class="string">&#x27;development&#x27;</span> &amp;&amp; process.platform === <span class="string">&#x27;win32&#x27;</span>) &#123;</span><br><span class="line">    <span class="comment">// è®¾ç½®electron.exe å’Œ appçš„è·¯å¾„</span></span><br><span class="line">    isSet = app.setAsDefaultProtocolClient(agreement, process.execPath, [</span><br><span class="line">      path.resolve(process.argv[<span class="number">1</span>]),</span><br><span class="line">    ])</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    isSet = app.setAsDefaultProtocolClient(agreement)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;æ˜¯å¦æ³¨å†ŒæˆåŠŸ&#x27;</span>, isSet)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">setDefaultProtocol()</span><br></pre></td></tr></table></figure><h4 id="ä½¿ç”¨åè®®"><a href="#ä½¿ç”¨åè®®" class="headerlink" title="ä½¿ç”¨åè®®"></a>ä½¿ç”¨åè®®</h4><p>ä½¿ç”¨æ–¹å¼: åœ¨æµè§ˆå™¨åœ°å€æ è¾“å…¥æ³¨å†Œå¥½çš„åè®®ï¼Œå³å¯å”¤èµ·åº”ç”¨ã€‚ </p><p>åè®®å”¤èµ·çš„é“¾æ¥æ ¼å¼: è‡ªåè®®åç§°://å‚æ•°</p><p>æ¯”å¦‚ä¸Šæ–‡æ³¨å†Œ: <code>electron-playground-code</code>åè®®,è§¦å‘æ—¶ä¼šé»˜è®¤å¸¦ä¸Š<code>://</code>ã€‚</p><p>åœ¨ä½¿ç”¨çš„æ—¶å€™, éœ€è¦åœ¨æµè§ˆå™¨åœ°å€æ è¾“å…¥: </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">electron-playground-code:<span class="comment">//1234 // 1234æ˜¯å‚æ•° å¯æ ¹æ®ä¸šåŠ¡è‡ªè¡Œä¿®æ”¹</span></span><br></pre></td></tr></table></figure><h4 id="1-6-æ³¨å†Œåè®®å¹¶é€šè¿‡æµè§ˆå™¨å”¤èµ·åå°åº”ç”¨çš„gifç¤ºä¾‹"><a href="#1-6-æ³¨å†Œåè®®å¹¶é€šè¿‡æµè§ˆå™¨å”¤èµ·åå°åº”ç”¨çš„gifç¤ºä¾‹" class="headerlink" title="1.6 æ³¨å†Œåè®®å¹¶é€šè¿‡æµè§ˆå™¨å”¤èµ·åå°åº”ç”¨çš„gifç¤ºä¾‹:"></a>1.6 æ³¨å†Œåè®®å¹¶é€šè¿‡æµè§ˆå™¨å”¤èµ·åå°åº”ç”¨çš„gifç¤ºä¾‹:</h4><p><img src= "/img/loading.gif" data-lazy-src="http://mei160.cn/images/setProtocol.gif?height=400"></p><h4 id="ç›‘å¬åº”ç”¨ç¨‹åºè¢«å”¤èµ·"><a href="#ç›‘å¬åº”ç”¨ç¨‹åºè¢«å”¤èµ·" class="headerlink" title="ç›‘å¬åº”ç”¨ç¨‹åºè¢«å”¤èµ·"></a>ç›‘å¬åº”ç”¨ç¨‹åºè¢«å”¤èµ·</h4><p>åº”ç”¨ç¨‹åºå”¤èµ·ï¼Œmacç³»ç»Ÿä¼šè§¦å‘open-urläº‹ä»¶ï¼Œwindowç³»ç»Ÿä¼šè§¦å‘second-instanceäº‹ä»¶ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @@code-renderer: runner</span></span><br><span class="line"><span class="comment">// @@code-props: &#123; height: &#x27;450px&#x27; &#125;</span></span><br><span class="line"><span class="comment">// æ³¨å†Œè‡ªå®šä¹‰åè®®</span></span><br><span class="line"><span class="keyword">const</span> &#123; app, dialog &#125; = <span class="built_in">require</span>(<span class="string">&#x27;electron&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> agreement = <span class="string">&#x27;electron-playground-code&#x27;</span> <span class="comment">// è‡ªå®šä¹‰åè®®å</span></span><br><span class="line"><span class="comment">// éªŒè¯æ˜¯å¦ä¸ºè‡ªå®šä¹‰åè®®çš„é“¾æ¥</span></span><br><span class="line"><span class="keyword">const</span> AGREEMENT_REGEXP = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">`^<span class="subst">$&#123;agreement&#125;</span>://`</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç›‘å¬è‡ªå®šä¹‰åè®®å”¤èµ·</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">watchProtocol</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// macå”¤é†’åº”ç”¨ ä¼šæ¿€æ´»open-urläº‹ä»¶ åœ¨open-urlä¸­åˆ¤æ–­æ˜¯å¦ä¸ºè‡ªå®šä¹‰åè®®æ‰“å¼€äº‹ä»¶</span></span><br><span class="line">  app.on(<span class="string">&#x27;open-url&#x27;</span>, <span class="function">(<span class="params">event, url</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> isProtocol = AGREEMENT_REGEXP.test(url)</span><br><span class="line">    <span class="keyword">if</span> (isProtocol) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;è·å–åè®®é“¾æ¥, æ ¹æ®å‚æ•°åšå„ç§äº‹æƒ…&#x27;</span>)</span><br><span class="line">      dialog.showMessageBox(&#123;</span><br><span class="line">        type: <span class="string">&#x27;info&#x27;</span>,</span><br><span class="line">        message: <span class="string">&#x27;Mac protocol è‡ªå®šä¹‰åè®®æ‰“å¼€&#x27;</span>,</span><br><span class="line">        detail: <span class="string">`è‡ªå®šä¹‰åè®®é“¾æ¥:<span class="subst">$&#123;url&#125;</span>`</span>,</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="comment">// windowç³»ç»Ÿä¸‹å”¤é†’åº”ç”¨ä¼šæ¿€æ´»second-instanceäº‹ä»¶ å®ƒåœ¨readyæ‰§è¡Œä¹‹åæ‰èƒ½è¢«ç›‘å¬</span></span><br><span class="line">  app.on(<span class="string">&#x27;second-instance&#x27;</span>, <span class="function">(<span class="params">event, commandLine</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// commandLine æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œ å”¤é†’çš„é“¾æ¥ä½œä¸ºæ•°ç»„çš„ä¸€ä¸ªå…ƒç´ æ”¾åœ¨è¿™é‡Œé¢</span></span><br><span class="line">    commandLine.forEach(<span class="function"><span class="params">str</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (AGREEMENT_REGEXP.test(str)) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;è·å–åè®®é“¾æ¥, æ ¹æ®å‚æ•°åšå„ç§äº‹æƒ…&#x27;</span>)</span><br><span class="line">        dialog.showMessageBox(&#123;</span><br><span class="line">          type: <span class="string">&#x27;info&#x27;</span>,</span><br><span class="line">          message: <span class="string">&#x27;window protocol è‡ªå®šä¹‰åè®®æ‰“å¼€&#x27;</span>,</span><br><span class="line">          detail: <span class="string">`è‡ªå®šä¹‰åè®®é“¾æ¥:<span class="subst">$&#123;str&#125;</span>`</span>,</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨readyäº‹ä»¶å›è°ƒä¸­ç›‘å¬è‡ªå®šä¹‰åè®®å”¤èµ·</span></span><br><span class="line">watchProtocol()</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;ç›‘å¬æˆåŠŸ&#x27;</span>)</span><br></pre></td></tr></table></figure><h4 id="å”¤èµ·åº”ç”¨æ‰§è¡Œå›è°ƒç¤ºä¾‹"><a href="#å”¤èµ·åº”ç”¨æ‰§è¡Œå›è°ƒç¤ºä¾‹" class="headerlink" title="å”¤èµ·åº”ç”¨æ‰§è¡Œå›è°ƒç¤ºä¾‹"></a>å”¤èµ·åº”ç”¨æ‰§è¡Œå›è°ƒç¤ºä¾‹</h4><p><img src= "/img/loading.gif" data-lazy-src="http://mei160.cn/images/protocolWatch.gif?height=400"></p><h4 id="åº”ç”¨åœºæ™¯"><a href="#åº”ç”¨åœºæ™¯" class="headerlink" title="åº”ç”¨åœºæ™¯"></a>åº”ç”¨åœºæ™¯</h4><ol><li><p>å•çº¯å”¤é†’åº”ç”¨</p><p> åªéœ€æ³¨å†Œåè®®ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æ‰“å¼€åº”ç”¨ã€‚<br> è¡¨ç°ï¼šå¦‚æœåº”ç”¨æœªæ‰“å¼€å°†æ‰“å¼€åº”ç”¨ï¼Œå¦‚æœåº”ç”¨å·²ç»æ‰“å¼€åº”ç”¨å°†ä¼šæ¿€æ´»åº”ç”¨çª—å£ã€‚</p></li><li><p>æ ¹æ®åè®®é“¾æ¥çš„å‚æ•°è¿›è¡Œå„ç§æ“ä½œ</p><p>å¦‚ä¸Šé¢çš„å¼¹çª—æ¼”ç¤º, <strong>åœ¨ç›‘å¬åè®®é“¾æ¥æ‰“å¼€çš„æ—¶å€™ï¼Œå¯ä»¥è·å–å®Œæ•´çš„åè®®é“¾æ¥</strong>ã€‚</p><p>æˆ‘ä»¬å¯ä»¥æ ¹æ®åè®®é“¾æ¥æ¥è¿›è¡Œå„ç§ä¸šåŠ¡æ“ä½œã€‚</p><p>æ¯”å¦‚è·³è½¬æŒ‡å®šé“¾æ¥åœ°å€ï¼Œæ¯”å¦‚åˆ¤æ–­æ˜¯å¦ç™»å½•å†è¿›è¡Œè·³è½¬ï¼Œæ¯”å¦‚ä¸‹è½½æŒ‡å®šæ–‡ä»¶ç­‰ã€‚</p></li></ol><h4 id="ä¸€äº›å…¶ä»–API"><a href="#ä¸€äº›å…¶ä»–API" class="headerlink" title="ä¸€äº›å…¶ä»–API"></a>ä¸€äº›å…¶ä»–API</h4><p><strong>app.removeAsDefaultProtocolClient(protocol)</strong> åˆ é™¤æ³¨å†Œçš„åè®®, è¿”å›æ˜¯å¦æˆåŠŸåˆ é™¤çš„Boolean</p><p><strong>Mac: app.isDefaultProtocolClient(protocol)</strong> å½“å‰ç¨‹åºæ˜¯å¦ä¸ºåè®®çš„å¤„ç†ç¨‹åºã€‚</p><p><strong>app.getApplicationNameForProtocol(url)</strong> è·å–è¯¥åè®®é“¾æ¥çš„åº”ç”¨å¤„ç†ç¨‹åº</p><p>å‚æ•°è¯´æ˜: </p><p>protocol ä¸åŒ…å«:// æ³¨å†Œçš„åè®®åã€‚</p><p>url åŒ…å«://</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @@code-renderer: runner</span></span><br><span class="line"><span class="comment">// @@code-props: &#123; height: &#x27;200px&#x27; &#125;</span></span><br><span class="line"><span class="comment">// è‡ªå®šä¹‰åè®®çš„å…¶ä»–ç›¸å…³API</span></span><br><span class="line"><span class="keyword">const</span> &#123; app &#125; = <span class="built_in">require</span>(<span class="string">&#x27;electron&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> agreement = <span class="string">&#x27;electron-playground-code&#x27;</span> <span class="comment">// è‡ªå®šä¹‰åè®®å</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;è‡ªè¡Œæ³¨é‡Šï¼Œè‡ªç”±å°è¯•&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> isApp = app.isDefaultProtocolClient(agreement)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;å½“å‰ç¨‹åºæ˜¯å¦ä¸ºè‡ªå®šä¹‰åè®®çš„å¤„ç†ç¨‹åº: &#x27;</span>, isApp)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> AgreementAppName = app.getApplicationNameForProtocol(<span class="string">`<span class="subst">$&#123;agreement&#125;</span>://`</span>)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;è·å–è¯¥è‡ªå®šä¹‰åè®®é“¾æ¥çš„åº”ç”¨å¤„ç†ç¨‹åºçš„åå­—&#x27;</span>, AgreementAppName)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> isDelete = app.removeAsDefaultProtocolClient(agreement)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;åˆ é™¤è‡ªå®šä¹‰åè®®&#x27;</span>, isDelete)</span><br></pre></td></tr></table></figure><h3 id="è‡ªå®šä¹‰åè®®"><a href="#è‡ªå®šä¹‰åè®®" class="headerlink" title="è‡ªå®šä¹‰åè®®"></a>è‡ªå®šä¹‰åè®®</h3><p>æ³¨å†Œè‡ªå®šä¹‰åè®®ï¼Œæ‹¦æˆªåŸºäºç°æœ‰åè®®çš„è¯·æ±‚ï¼Œæ ¹æ®æ³¨å†Œçš„è‡ªå®šä¹‰åè®®ç±»å‹è¿”å›å¯¹åº”ç±»å‹çš„æ•°æ®ã€‚</p><p>åœ¨è¯¥é¡¹ç›®ä¸­çš„ä»£ç åœ°å€: electron-playground/app/protocol, å¯ä»¥è¿è¡Œé¡¹ç›®è°ƒè¯•ä¸€ä¸‹çœ‹çœ‹æ•ˆæœã€‚</p><h4 id="protocol-registerSchemesAsPrivileged"><a href="#protocol-registerSchemesAsPrivileged" class="headerlink" title="protocol.registerSchemesAsPrivileged"></a>protocol.registerSchemesAsPrivileged</h4><p>å°†åè®®æ³¨å†Œæˆæ ‡å‡†çš„scheme, æ–¹ä¾¿åç»­è°ƒç”¨ã€‚</p><p><strong>æ³¨æ„</strong>ï¼š å®ƒå¿…é¡»åœ¨readyäº‹ä»¶åŠ è½½ä¹‹å‰è°ƒç”¨ï¼Œå¹¶ä¸”åªèƒ½è°ƒç”¨ä¸€æ¬¡ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">protocol.registerSchemesAsPrivileged([</span><br><span class="line">  &#123; <span class="attr">scheme</span>: <span class="string">&#x27;myscheme&#x27;</span>, <span class="attr">privileges</span>: &#123; <span class="attr">bypassCSP</span>: <span class="literal">true</span> &#125; &#125;,</span><br><span class="line">])</span><br></pre></td></tr></table></figure><h4 id="protocol-registerFileProtocol"><a href="#protocol-registerFileProtocol" class="headerlink" title="protocol.registerFileProtocol"></a>protocol.registerFileProtocol</h4><p>æ‹¦æˆªè‡ªå®šä¹‰åè®®çš„è¯·æ±‚å›è°ƒï¼Œé‡æ–°å¤„ç†åå†è¯·æ±‚è·¯å¾„ã€‚</p><p><strong>ç¤ºä¾‹</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">protocol.registerFileProtocol(</span><br><span class="line">  <span class="string">&#x27;myscheme&#x27;</span>,</span><br><span class="line">  (request, callback) =&gt; &#123;</span><br><span class="line">    <span class="comment">// æ‹¼æ¥ç»å¯¹è·¯å¾„çš„url</span></span><br><span class="line">    <span class="keyword">const</span> resolvePath = path.resolve(__dirname, <span class="string">&#x27;../../playground&#x27;</span>)</span><br><span class="line">    <span class="keyword">let</span> url = request.url.replace( <span class="string">`<span class="subst">$&#123;myScheme&#125;</span>://`</span>, <span class="string">&#x27;&#x27;</span> )</span><br><span class="line">    url = <span class="string">`<span class="subst">$&#123;resolvePath&#125;</span>/<span class="subst">$&#123;url&#125;</span>`</span></span><br><span class="line">    <span class="keyword">return</span> callback(&#123; <span class="attr">path</span>: <span class="built_in">decodeURIComponent</span>(url) &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  error =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (error) <span class="built_in">console</span>.error(<span class="string">&#x27;Failed to register protocol&#x27;</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>PS: åœ¨<a href="https://www.electronjs.org/docs/api/protocol">æ–‡æ¡£</a>ä¸Šæä¾›äº†ä¸åŒç§ç±»çš„åŠ è½½APIï¼Œè¿™é‡Œåªæ¼”ç¤ºå…¶ä¸­çš„ä¸€ç§ã€‚</p><h4 id="ä½¿ç”¨æ–¹å¼"><a href="#ä½¿ç”¨æ–¹å¼" class="headerlink" title="ä½¿ç”¨æ–¹å¼"></a>ä½¿ç”¨æ–¹å¼</h4><p>åœ¨htmlä¸­ä½¿ç”¨è‡ªå®šä¹‰åè®®è¯·æ±‚æ–‡ä»¶ï¼Œå³å¯è‡ªåŠ¨æ‹¦æˆªã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#123;</span>&quot;<span class="attr">myscheme:</span>//<span class="attr">page</span>/<span class="attr">protocol</span>/<span class="attr">wakeUp.jpg</span>&quot;&#125; <span class="attr">alt</span>=<span class="string">&quot;wakeUp&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><h4 id="protocolå…¶ä»–API"><a href="#protocolå…¶ä»–API" class="headerlink" title="protocolå…¶ä»–API"></a>protocolå…¶ä»–API</h4><h2 id="æ‰˜ç›˜"><a href="#æ‰˜ç›˜" class="headerlink" title="æ‰˜ç›˜"></a>æ‰˜ç›˜</h2><h3 id="åˆ›å»ºæ‰˜ç›˜"><a href="#åˆ›å»ºæ‰˜ç›˜" class="headerlink" title="åˆ›å»ºæ‰˜ç›˜"></a>åˆ›å»ºæ‰˜ç›˜</h3><ol><li>å¼•å…¥Trayç±»</li><li>è·å–å›¾æ ‡åœ°å€</li><li>å®ä¾‹åŒ–trayå¹¶ä¼ å…¥å›¾æ ‡åœ°å€</li></ol><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @@code-renderer: block</span></span><br><span class="line"><span class="keyword">const</span> &#123; Tray &#125; = <span class="built_in">require</span>(<span class="string">&#x27;electron&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> icon = path.join(__dirname, <span class="string">&#x27;ä½ çš„å›¾ç‰‡è·¯å¾„&#x27;</span>)</span><br><span class="line"><span class="keyword">new</span> Tray(icon)</span><br></pre></td></tr></table></figure><p>ä¸€ä¸ªç³»ç»Ÿæ‰˜ç›˜å°±ä¼šè¢«åˆ›å»ºå‡ºæ¥ã€‚å¾ˆç®€å•å¯¹ä¸å¯¹ï¼Œä½†æ˜¯è¿™ä¸ªå›¾æ ‡è¿˜æ²¡æœ‰ä»»ä½•åŠŸèƒ½ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ä¸ºå›¾æ ‡æ·»åŠ ä¸€äº›å±æ€§å’Œäº‹ä»¶ã€‚</p><h3 id="è®¾ç½®æ‰˜ç›˜å±æ€§"><a href="#è®¾ç½®æ‰˜ç›˜å±æ€§" class="headerlink" title="è®¾ç½®æ‰˜ç›˜å±æ€§"></a>è®¾ç½®æ‰˜ç›˜å±æ€§</h3><h4 id="å¸¸ç”¨å±æ€§å’Œäº‹ä»¶"><a href="#å¸¸ç”¨å±æ€§å’Œäº‹ä»¶" class="headerlink" title="å¸¸ç”¨å±æ€§å’Œäº‹ä»¶"></a>å¸¸ç”¨å±æ€§å’Œäº‹ä»¶</h4><p>ä¸ºtrayå®ä¾‹è®¾ç½®ä¸€äº›å±æ€§å’Œäº‹ä»¶ï¼ŒåŒ…æ‹¬ä¸Šä¸‹æ–‡èœå•ã€é¼ æ ‡ç§»å…¥æ–‡å­—ã€‚è¯¦ç»†æ–‡æ¡£<a href="https://www.electronjs.org/docs/api/tray">ç‚¹å‡»è¿™é‡Œã€‚</a></p><p>è¿™é‡Œæˆ‘ä»¬ä¸ºtrayè®¾ç½®çµæ´»å›¾æ ‡ï¼Œè®©å®ƒå¯ä»¥æ ¹æ®ç³»ç»Ÿä¸»é¢˜æ˜¾ç¤ºä¸åŒçš„å›¾æ ‡ï¼›å†è®¾ç½®ä¸€ä¸ªé¼ æ ‡ç§»å…¥å›¾æ ‡çš„æ—¶å€™ä¼šæ˜¾ç¤ºçš„æç¤ºæ–‡å­—ï¼Œæœ€åä¸ºå®ƒè®¾ç½®ä¸Šä¸‹æ–‡èœå•ï¼Œè®©å®ƒå¯ä»¥å…·å¤‡ä¸€äº›åŠŸèƒ½ã€‚</p><p>å…ˆçœ‹ä¸‹æ•ˆæœå›¾ï¼š</p><p><img src= "/img/loading.gif" data-lazy-src="http://mei160.cn/images/create-tray.gif?width=600"></p><p>é™„ä¸Šä»£ç ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @@code-renderer: runner</span></span><br><span class="line"><span class="comment">// @@code-props: &#123;height: &#x27;580px&#x27;, hideRight: true&#125;</span></span><br><span class="line"><span class="keyword">const</span> &#123; Tray, Menu, nativeTheme, BrowserWindow &#125; = <span class="built_in">require</span>(<span class="string">&#x27;electron&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> tray</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®é¡¶éƒ¨APPå›¾æ ‡çš„æ“ä½œå’Œå›¾æ ‡</span></span><br><span class="line"><span class="keyword">const</span> lightIcon = path.join(__dirname, <span class="string">&#x27;..&#x27;</span>, <span class="string">&#x27;..&#x27;</span>, <span class="string">&#x27;resources&#x27;</span>, <span class="string">&#x27;tray&#x27;</span>, <span class="string">&#x27;StatusIcon_light.png&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> darkIcon = path.join(__dirname, <span class="string">&#x27;..&#x27;</span>, <span class="string">&#x27;..&#x27;</span>, <span class="string">&#x27;resources&#x27;</span>, <span class="string">&#x27;tray&#x27;</span>, <span class="string">&#x27;StatusIcon_dark.png&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ ¹æ®ç³»ç»Ÿä¸»é¢˜æ˜¾ç¤ºä¸åŒçš„ä¸»é¢˜å›¾æ ‡</span></span><br><span class="line">tray = <span class="keyword">new</span> Tray(nativeTheme.shouldUseDarkColors ? darkIcon : lightIcon)</span><br><span class="line"></span><br><span class="line">tray.setToolTip(<span class="string">&#x27;Electron-Playground&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> contextMenu = Menu.buildFromTemplate([</span><br><span class="line">  &#123;</span><br><span class="line">    label: <span class="string">&#x27;æ‰“å¼€æ–°çª—å£&#x27;</span>,</span><br><span class="line">    click: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">let</span> child = <span class="keyword">new</span> BrowserWindow(&#123; <span class="attr">parent</span>: BrowserWindow.getFocusedWindow() &#125;)</span><br><span class="line">      child.loadURL(<span class="string">&#x27;https://electronjs.org&#x27;</span>)</span><br><span class="line">      child.show()</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    label: <span class="string">&#x27;åˆ é™¤å›¾æ ‡&#x27;</span>,</span><br><span class="line">    click: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      tray.destroy()</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">tray.setContextMenu(contextMenu)</span><br></pre></td></tr></table></figure><br>ä½ å¯ä»¥ä¿®æ”¹æç¤ºæˆ–è€…èœå•æ¥è¯•ä¸€ä¸‹ã€‚è¿™é‡Œå¯ä»¥è®¾ç½®å¤šä¸ªæ‰˜ç›˜ï¼Œå®é™…åº”ç”¨ä¸­è¦æ³¨æ„è®¾ç½®å•ä¾‹é”ã€‚<p>æˆ‘ä»¬è®¾ç½®äº†æ‰˜ç›˜æ ¹æ®ç³»ç»Ÿä¸»é¢˜æ˜¾ç¤ºä¸åŒçš„å›¾æ ‡ï¼Œä½†æ˜¯ç³»ç»Ÿä¸»é¢˜æ˜¯åŠ¨æ€çš„ï¼Œåˆè¯¥æ€ä¹ˆåšå‘¢ï¼Œè¯·çœ‹ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @@code-renderer: block</span></span><br><span class="line">nativeTheme.on(<span class="string">&#x27;updated&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  tray.setImage(nativeTheme.shouldUseDarkColors ? darkIcon : lightIcon)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>æ·»åŠ ä¸€ä¸ªä¸»é¢˜ç›‘å¬äº‹ä»¶å°±å¥½äº†ã€‚æŠŠè¿™æ®µä»£ç å¤åˆ¶åˆ°ä¸Šé¢æ‰§è¡Œçœ‹ä¸‹æ•ˆæœå§ã€‚</p><h4 id="æ˜¾ç¤ºæœªè¯»æ¶ˆæ¯æ•°-macOS"><a href="#æ˜¾ç¤ºæœªè¯»æ¶ˆæ¯æ•°-macOS" class="headerlink" title="æ˜¾ç¤ºæœªè¯»æ¶ˆæ¯æ•°(macOS)"></a>æ˜¾ç¤ºæœªè¯»æ¶ˆæ¯æ•°(macOS)</h4><p>åœ¨macOSç³»ç»Ÿä¸‹ï¼Œå¯ä»¥é‡‡ç”¨setTitle(String)è®¾ç½®æœªè¯»æ¶ˆæ¯æ•°ã€‚PSï¼šwindowsä¸‹æ— æ•ˆæœã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @@code-renderer: block</span></span><br><span class="line">tray.setTitle(<span class="string">&quot;1&quot;</span>)</span><br></pre></td></tr></table></figure><p>æ•ˆæœæ˜¯è¿™æ ·çš„ï¼š</p><p><img src= "/img/loading.gif" data-lazy-src="http://mei160.cn/images/set-tray-title.png?width=400"></p><p>ä½ ä¹Ÿå¯ä»¥å¤åˆ¶åˆ°ä¸Šé¢ä»£ç ç¼–è¾‘å™¨ä¸­ç„¶åç‚¹å‡»æ‰§è¡Œçœ‹ä¸‹æ•ˆæœã€‚</p><h4 id="æœ‰æœªè¯»æ¶ˆæ¯æ—¶å›¾æ ‡é—ªåŠ¨-windows"><a href="#æœ‰æœªè¯»æ¶ˆæ¯æ—¶å›¾æ ‡é—ªåŠ¨-windows" class="headerlink" title="æœ‰æœªè¯»æ¶ˆæ¯æ—¶å›¾æ ‡é—ªåŠ¨(windows)"></a>æœ‰æœªè¯»æ¶ˆæ¯æ—¶å›¾æ ‡é—ªåŠ¨(windows)</h4><p>åœ¨windowsç³»ç»Ÿä¸‹ï¼Œå¯é€šè¿‡setImageè®¾ç½®æ­£å¸¸å›¾æ ‡ä¸ç©ºå›¾æ ‡åˆ‡æ¢è¾¾åˆ°é—ªåŠ¨æ•ˆæœã€‚åœ¨macç³»ç»Ÿä¸‹ç©ºå›¾æ ‡ä¸å ç”¨å›¾æ ‡ç©ºé—´ï¼Œæ‰€ä»¥éœ€è¦è®¾ç½®é€æ˜å›¾æ ‡ã€‚<br>ä½ å¯ä»¥åœ¨ä¸‹é¢ç¤ºä¾‹ä¸­ç”¨darkIconä»£æ›¿nativeImage.createEmpty()ç„¶åæ‰§è¡Œçœ‹ä¸€ä¸‹æ•ˆæœã€‚</p><p>å¦‚ä½•åˆ¤æ–­æ“ä½œç³»ç»Ÿå¹³å°ï¼Œ<a href="http://nodejs.cn/api/process/process_platform.html">ç‚¹å‡»è¿™é‡Œ</a></p><p>windowsä¸‹æ•ˆæœï¼š</p><p><img src= "/img/loading.gif" data-lazy-src="http://mei160.cn/images/create-glimmer-tray.gif?width=600"></p><p>é™„ä»£ç ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @@code-renderer: runner</span></span><br><span class="line"><span class="comment">// @@code-props: &#123;height: &#x27;880px&#x27;, hideRight: true&#125;</span></span><br><span class="line"><span class="keyword">const</span> &#123; Tray, Menu, nativeTheme, BrowserWindow, nativeImage &#125; = <span class="built_in">require</span>(<span class="string">&#x27;electron&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> tray</span><br><span class="line"><span class="keyword">let</span> timer</span><br><span class="line"><span class="keyword">let</span> toggle = <span class="literal">true</span></span><br><span class="line"><span class="keyword">let</span> haveMessage = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> lightIcon = path.join(__dirname, <span class="string">&#x27;..&#x27;</span>, <span class="string">&#x27;..&#x27;</span>, <span class="string">&#x27;resources&#x27;</span>, <span class="string">&#x27;tray&#x27;</span>, <span class="string">&#x27;StatusIcon_light.png&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> darkIcon = path.join(__dirname, <span class="string">&#x27;..&#x27;</span>, <span class="string">&#x27;..&#x27;</span>, <span class="string">&#x27;resources&#x27;</span>, <span class="string">&#x27;tray&#x27;</span>, <span class="string">&#x27;StatusIcon_dark.png&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> win = BrowserWindow.getFocusedWindow();</span><br><span class="line"></span><br><span class="line">tray = <span class="keyword">new</span> Tray(lightIcon)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> contextMenu = Menu.buildFromTemplate([</span><br><span class="line">  &#123;</span><br><span class="line">    label: <span class="string">&#x27;å¼ ä¸‰çš„æ¶ˆæ¯&#x27;</span>,</span><br><span class="line">    click: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">let</span> child = <span class="keyword">new</span> BrowserWindow(&#123; <span class="attr">parent</span>: BrowserWindow.getFocusedWindow() &#125;)</span><br><span class="line">      child.loadURL(<span class="string">&#x27;https://electronjs.org&#x27;</span>)</span><br><span class="line">      child.show()</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123; <span class="attr">type</span>: <span class="string">&#x27;separator&#x27;</span> &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    label: <span class="string">&#x27;åˆ é™¤å›¾æ ‡&#x27;</span>,</span><br><span class="line">    click: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      tray.destroy()</span><br><span class="line">      <span class="built_in">clearInterval</span>(timer)</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">tray.setContextMenu(contextMenu)</span><br><span class="line"></span><br><span class="line">tray.setToolTip(<span class="string">&#x27;Electron-Playground&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (haveMessage) &#123;</span><br><span class="line">  timer = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    toggle = !toggle</span><br><span class="line">    <span class="keyword">if</span> (toggle) &#123;</span><br><span class="line">      tray.setImage(nativeImage.createEmpty())</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      tray.setImage(lightIcon)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, <span class="number">600</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="åŒå‡»æ‰˜ç›˜æ˜¾ç¤ºéšè—ç•Œé¢-windows"><a href="#åŒå‡»æ‰˜ç›˜æ˜¾ç¤ºéšè—ç•Œé¢-windows" class="headerlink" title="åŒå‡»æ‰˜ç›˜æ˜¾ç¤ºéšè—ç•Œé¢(windows)"></a>åŒå‡»æ‰˜ç›˜æ˜¾ç¤ºéšè—ç•Œé¢(windows)</h4><p>windowsä¸‹æ•ˆæœï¼š</p><p><img src= "/img/loading.gif" data-lazy-src="http://mei160.cn/images/create-toggle-tray.gif?width=600"></p><p>é™„ä»£ç ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @@code-renderer: runner</span></span><br><span class="line"><span class="comment">// @@code-props: &#123;height: &#x27;260px&#x27;, hideRight: true&#125;</span></span><br><span class="line"><span class="keyword">const</span> &#123; Tray, Menu, nativeTheme, BrowserWindow, nativeImage &#125; = <span class="built_in">require</span>(<span class="string">&#x27;electron&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> tray</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> lightIcon = path.join(__dirname, <span class="string">&#x27;..&#x27;</span>, <span class="string">&#x27;..&#x27;</span>, <span class="string">&#x27;resources&#x27;</span>, <span class="string">&#x27;tray&#x27;</span>, <span class="string">&#x27;StatusIcon_light.png&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> win = BrowserWindow.getFocusedWindow()</span><br><span class="line"></span><br><span class="line">tray = <span class="keyword">new</span> Tray(lightIcon)</span><br><span class="line"></span><br><span class="line">tray.on(<span class="string">&#x27;double-click&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  win.isVisible() ? win.hide() : win.show()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>æ³¨ï¼šæ­¤æ•ˆæœåœ¨windowsä¸Šè‰¯å¥½ï¼Œåœ¨macä¸‹ä¼šæœ‰å…¼å®¹æ€§é—®é¢˜ï¼ŒåŒå‡»äº‹ä»¶å¯èƒ½å¤±æ•ˆï¼Œå®é™…ä½¿ç”¨è¿‡ç¨‹ä¸­è¦æ³¨æ„ã€‚</p><h2 id="èœå•"><a href="#èœå•" class="headerlink" title="èœå•"></a>èœå•</h2><h3 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h3><p>èœå•ä¸»è¦åˆ†ä¸ºåº”ç”¨ç¨‹åºèœå•ã€ä¸Šä¸‹æ–‡èœå•ï¼Œåœ¨trayå’Œdockä¸­ä¹Ÿæœ‰ç”¨åˆ°èœå•ï¼Œæœ¬èŠ‚ä¸»è¦ä»‹ç»å‰ä¸¤ç§ã€‚<a href="https://www.electronjs.org/docs/api/menu">æ–‡æ¡£åœ°å€</a></p><blockquote><p>ä»¥ä¸‹æ¡ˆä¾‹å¦‚æœ‰æ“ä½œåˆ°åº”ç”¨ç¨‹åºèœå•ï¼Œå¯ç‚¹å‡»å³ä¸‹è§’æ’¤å›æ¢å¤æ­£å¸¸èœå•ã€‚</p></blockquote><h4 id="åº”ç”¨ç¨‹åºèœå•"><a href="#åº”ç”¨ç¨‹åºèœå•" class="headerlink" title="åº”ç”¨ç¨‹åºèœå•"></a>åº”ç”¨ç¨‹åºèœå•</h4><p>macå’Œwindowséƒ½åœ¨å·¦ä¸Šè§’ï¼Œä½†æ˜¯ä¸€ä¸ªåœ¨å±å¹•å·¦ä¸Šè§’ä¸€ä¸ªåœ¨åº”ç”¨ç¨‹åºè§†å›¾å·¦ä¸Šè§’ã€‚<br>macæ˜¯è¿™æ ·çš„ï¼š  </p><p><img src= "/img/loading.gif" data-lazy-src="http://mei160.cn/images/mac-menu.png?width=400"></p><p>windowsé•¿è¿™æ ·ï¼š  </p><p><img src= "/img/loading.gif" data-lazy-src="http://mei160.cn/images/win-menu.png?width=400">  </p><p>å¦‚æœwindowsä¸‹æ²¡æœ‰æ˜¾ç¤ºèœå•ï¼Œåœ¨å½“å‰çª—å£æŒ‰alté”®å³ä¼šå‡ºç°ã€‚</p><h3 id="åˆ›å»ºèœå•"><a href="#åˆ›å»ºèœå•" class="headerlink" title="åˆ›å»ºèœå•"></a>åˆ›å»ºèœå•</h3><h4 id="åˆ›å»ºåº”ç”¨ç¨‹åºèœå•"><a href="#åˆ›å»ºåº”ç”¨ç¨‹åºèœå•" class="headerlink" title="åˆ›å»ºåº”ç”¨ç¨‹åºèœå•"></a>åˆ›å»ºåº”ç”¨ç¨‹åºèœå•</h4><p>æ¥ä¸‹æ¥æˆ‘ä»¬åˆ›å»ºåº”ç”¨ç¨‹åºèœå•ã€‚å¦‚ä¸‹æ­¥éª¤ï¼š  </p><ol><li>å¼•å…¥Menuç±»  </li><li>å®šä¹‰ä¸€ä¸ªèœå•æ¨¡æ¿  </li><li>è°ƒç”¨Menuç±»çš„<code>buildFromTemplate</code>æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šæ ¹æ®ä¼ å…¥çš„æ¨¡æ¿åˆ›å»ºå¯¹åº”çš„èœå•  </li><li>è°ƒç”¨Menuç±»çš„<code>setApplicationMenu</code>æ–¹æ³•  </li></ol><p>æ­¤å››æ­¥å³å¯åˆ›å»ºåº”ç”¨ç¨‹åºèœå•ï¼Œå…ˆæ¥çœ‹ä¸‹æ•ˆæœå›¾ã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="http://mei160.cn/images/create-menu.gif?width=600">   </p><p>é™„ä¸Šä»£ç ï¼š<br></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @@code-renderer: runner</span></span><br><span class="line"><span class="comment">// @@code-props: &#123; height: &#x27;570px&#x27;, hideRight: true &#125;</span></span><br><span class="line"><span class="keyword">const</span> &#123; Menu, dialog, app &#125; = <span class="built_in">require</span>(<span class="string">&#x27;electron&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> template = [</span><br><span class="line">  &#123;</span><br><span class="line">    label: <span class="string">&#x27;app&#x27;</span>, <span class="comment">// macOSä¸‹ç¬¬ä¸€ä¸ªæ ‡ç­¾æ˜¯åº”ç”¨ç¨‹åºåå­—ï¼Œæ­¤å¤„è®¾ç½®æ— æ•ˆ</span></span><br><span class="line">    submenu: [</span><br><span class="line">      &#123; <span class="attr">label</span>: <span class="string">&#x27;é€€å‡º&#x27;</span>, <span class="attr">click</span>: <span class="function">() =&gt;</span> &#123; app.quit() &#125; &#125;,</span><br><span class="line">      &#123; <span class="attr">label</span>: <span class="string">&#x27;å…³äº&#x27;</span>, <span class="attr">click</span>: <span class="function">() =&gt;</span> &#123; app.showAboutPanel() &#125; &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    label: <span class="string">&#x27;æ–‡ä»¶&#x27;</span>,</span><br><span class="line">    submenu: [</span><br><span class="line">      &#123;</span><br><span class="line">        label: <span class="string">&#x27;å­èœå•&#x27;</span>, </span><br><span class="line">        click: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">          <span class="comment">// è°ƒç”¨äº†dialogï¼ˆå¼¹çª—æ¨¡å—ï¼‰ï¼Œæ¼”ç¤ºæ•ˆæœ</span></span><br><span class="line">          dialog.showMessageBoxSync(&#123;</span><br><span class="line">            type: <span class="string">&#x27;info&#x27;</span>,</span><br><span class="line">            title: <span class="string">&#x27;æç¤º&#x27;</span>,</span><br><span class="line">            message: <span class="string">&#x27;ç‚¹å‡»äº†å­èœå•&#x27;</span></span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> menu = Menu.buildFromTemplate(template)</span><br><span class="line"></span><br><span class="line">Menu.setApplicationMenu(menu)</span><br></pre></td></tr></table></figure><br>ç‚¹å‡»æ‰§è¡Œåçœ‹å·¦ä¸Šèœå•æ•ˆæœã€‚  <h4 id="åˆ›å»ºä¸Šä¸‹æ–‡èœå•"><a href="#åˆ›å»ºä¸Šä¸‹æ–‡èœå•" class="headerlink" title="åˆ›å»ºä¸Šä¸‹æ–‡èœå•"></a>åˆ›å»ºä¸Šä¸‹æ–‡èœå•</h4><p>å³åˆ›å»ºå³é”®ç‚¹å‡»èœå•ï¼Œå‰ä¸‰æ­¥ä¸åˆ›å»ºåº”ç”¨ç¨‹åºèœå•ç›¸åŒï¼Œæœ€åä¸€æ­¥éœ€ç›‘å¬çª—å£<code>context-menu</code>äº‹ä»¶å±•ç¤ºèœå•é€‰é¡¹ã€‚<br>ç›‘å¬äº‹ä»¶<a href="https://www.electronjs.org/docs/api/web-contents#event-context-menu">context-menuæ–‡æ¡£</a>  </p><p>å…ˆä¸Šæ•ˆæœå›¾ã€‚  </p><p><img src= "/img/loading.gif" data-lazy-src="http://mei160.cn/images/create-context-menu.gif?width=600">   </p><p>é™„ä¸Šä»£ç ï¼š<br></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @@code-renderer: runner</span></span><br><span class="line"><span class="comment">// @@code-props: &#123;height: &#x27;460px&#x27;, hideRight: true&#125;</span></span><br><span class="line"><span class="keyword">const</span> &#123; Menu, BrowserWindow &#125; = <span class="built_in">require</span>(<span class="string">&#x27;electron&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> menu = <span class="keyword">new</span> Menu();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> template = [</span><br><span class="line">  &#123;</span><br><span class="line">    label: <span class="string">&#x27;app&#x27;</span>, <span class="comment">// macOSä¸‹ç¬¬ä¸€ä¸ªæ ‡ç­¾æ˜¯åº”ç”¨ç¨‹åºåå­—ï¼Œæ­¤å¤„è®¾ç½®æ— æ•ˆ</span></span><br><span class="line">    submenu: [</span><br><span class="line">      &#123; <span class="attr">role</span>: <span class="string">&#x27;quit&#x27;</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">role</span>: <span class="string">&#x27;about&#x27;</span> &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    label: <span class="string">&#x27;ç¼–è¾‘&#x27;</span>,</span><br><span class="line">    role: <span class="string">&#x27;editMenu&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> contextMenu = Menu.buildFromTemplate(template)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸»è¿›ç¨‹ï¼Œæ¸²æŸ“è¿›ç¨‹å¯ä½¿ç”¨window.addEventListenerè®¾ç½®ç›‘å¬äº‹ä»¶</span></span><br><span class="line">BrowserWindow.getFocusedWindow().webContents.on(<span class="string">&#x27;context-menu&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  contextMenu.popup()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><br><p>å¯èƒ½ä½ å·²ç»å‘ç°ï¼Œè¿™ä¸ªä¾‹å­çš„ä»£ç æ¯”ä¸Šä¸ªä¾‹å­å°‘ï¼Œå®ç°çš„èœå•å´æ›´å¤šï¼Œè€Œä¸”è¿™ä¸ª<code>role</code>åˆæ˜¯å¹²å˜›çš„å‘¢ï¼Œåˆ«æ€¥ï¼Œå¾€ä¸‹çœ‹ã€‚</p><h3 id="è®¾ç½®èœå•å±æ€§"><a href="#è®¾ç½®èœå•å±æ€§" class="headerlink" title="è®¾ç½®èœå•å±æ€§"></a>è®¾ç½®èœå•å±æ€§</h3><p>ä¸ŠèŠ‚è¯´åˆ°ï¼Œè¿™ä¸ª<code>role</code>æ˜¯å¹²å˜›çš„å‘¢ï¼Ÿ<br>å…¶å®åˆ›å»ºèœå•è¡Œä¸ºæœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯è‡ªå®šä¹‰ï¼Œå³1.1ä¸­å®ç°æ–¹å¼ï¼Œå¦å¤–ä¸€ç§æ˜¯é¢„å®šä¹‰å³<code>role</code>ã€‚  </p><p>roleæ˜¯MenuItemçš„å±æ€§ï¼Œæ˜¯electronçš„é¢„å®šä¹‰è¡Œä¸ºã€‚<a href="https://www.electronjs.org/docs/api/menu-item#%E8%A7%92%E8%89%B2">æ–‡æ¡£</a>è¯´ï¼šæœ€å¥½ç»™ä»»ä½•ä¸€ä¸ªèœå•æŒ‡å®š roleå»åŒ¹é…ä¸€ä¸ªæ ‡å‡†è§’è‰², è€Œä¸æ˜¯å°è¯•åœ¨ click å‡½æ•°ä¸­æ‰‹åŠ¨å®ç°è¯¥è¡Œä¸ºã€‚ å†…ç½®çš„ role è¡Œä¸ºå°†æä¾›æœ€ä½³çš„åŸç”Ÿä½“éªŒã€‚ä½¿ç”¨ role æ—¶, label å’Œ accelerator å€¼æ˜¯å¯é€‰çš„, å¹¶ä¸ºæ¯ä¸ªå¹³å°ï¼Œå°†é»˜è®¤ä¸ºé€‚å½“å€¼ã€‚</p><p>è¿™å°±æ˜¯è¯´ï¼Œä½ åªè¦è®¾ç½®å¥½roleå±æ€§ï¼Œé‚£ä¹ˆè¿™ä¸ªèœå•çš„æ–‡æ¡ˆã€å¿«æ·é”®ã€äº‹ä»¶è¡Œä¸ºéƒ½å·²å†…éƒ¨å®ç°ï¼Œè€Œä¸”æ¯”è‡ªå®šä¹‰çš„è¡Œä¸ºä½“éªŒæ›´å¥½ã€‚</p><pre><code class="js">// @@code-renderer: runner// @@code-props: &#123;height: &#39;500px&#39;, hideRight: true&#125;const &#123; Menu, BrowserWindow &#125; = require(&#39;electron&#39;)const templateCustom = [  &#123;    label: &#39;app&#39;, // macOSä¸‹ç¬¬ä¸€ä¸ªæ ‡ç­¾æ˜¯åº”ç”¨ç¨‹åºåå­—ï¼Œæ­¤å¤„è®¾ç½®æ— æ•ˆ    submenu: [      &#123; label: &#39;quit&#39;, role: &#39;quit&#39; &#125;,      &#123;label: &#39;å…³äº&#39;, role: &#39;about&#39;, accelerator: &#39;CommandOrControl + shift + H&#39; &#125;    ]  &#125;,  &#123;    label: &#39;ç¼–è¾‘&#39;,    submenu: [      &#123;role: &#39;editMenu&#39;&#125;,      &#123;type: &#39;separator&#39;&#125;,      &#123;label: &#39;è‡ªå®šä¹‰&#39;, click: () =&gt; &#123;        const win = new BrowserWindow()        win.loadURL(&#39;https://electronjs.org&#39;)      &#125; &#125;    ]  &#125;]const customMenu = Menu.buildFromTemplate(templateCustom)Menu.setApplicationMenu(customMenu)</code></pre><br><p>line8çš„<code>accelerator</code>ç›¸ä¿¡ä½ çœ‹ä¸€çœ¼å°±çŸ¥é“æ˜¯è®¾ç½®å¿«æ·é”®çš„å±æ€§ï¼Œä½ ä¹Ÿå¯ä»¥è‡ªå·±æ›´æ”¹å¿«æ·é”®ç‚¹å‡»æ‰§è¡Œè¯•ä¸€ä¸‹ã€‚</p><h3 id="éšè—èœå•"><a href="#éšè—èœå•" class="headerlink" title="éšè—èœå•"></a>éšè—èœå•</h3>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;åº”ç”¨&quot;&gt;&lt;a href=&quot;#åº”ç”¨&quot; class=&quot;headerlink&quot; title=&quot;åº”ç”¨&quot;&gt;&lt;/a&gt;åº”ç”¨&lt;/h1&gt;&lt;h2 id=&quot;Dialogä¸æ–‡ä»¶é€‰æ‹©&quot;&gt;&lt;a href=&quot;#Dialogä¸æ–‡ä»¶é€‰æ‹©&quot; class=&quot;headerlink&quot; title=&quot;Dia</summary>
      
    
    
    
    <category term="electron" scheme="https://hard-workingrookie.github.io/categories/electron/"/>
    
    
    <category term="electron" scheme="https://hard-workingrookie.github.io/tags/electron/"/>
    
  </entry>
  
  <entry>
    <title>electronå·¥ç¨‹åŒ–</title>
    <link href="https://hard-workingrookie.github.io/2021/01/07/electron%E5%B7%A5%E7%A8%8B%E5%8C%96/"/>
    <id>https://hard-workingrookie.github.io/2021/01/07/electron%E5%B7%A5%E7%A8%8B%E5%8C%96/</id>
    <published>2021-01-07T07:30:05.000Z</published>
    <updated>2021-03-09T14:07:46.598Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å·¥ç¨‹åŒ–"><a href="#å·¥ç¨‹åŒ–" class="headerlink" title="å·¥ç¨‹åŒ–"></a>å·¥ç¨‹åŒ–</h1><h2 id="å®‰å…¨æ€§"><a href="#å®‰å…¨æ€§" class="headerlink" title="å®‰å…¨æ€§"></a>å®‰å…¨æ€§</h2><p>åœ¨è¿™é‡Œè®¨è®ºå®‰å…¨æ€§ï¼Œæˆ‘ä»¬ä¸»è¦åˆ†ä¸ºä¸¤ç§ï¼Œä¸€ç§æ˜¯åŠ è½½<strong>åº”ç”¨å†…</strong>èµ„æºï¼Œä¸€ç§æ˜¯åŠ è½½<strong>è¿œç¨‹</strong>èµ„æºã€‚</p><p>å¯¹äºåŠ è½½åº”ç”¨å†…èµ„æºä»£ç æˆ‘ä»¬æ˜¯å¯æ§çš„ï¼Œéœ€è¦æ³¨æ„çš„å®‰å…¨é—®é¢˜å’Œé€šå¸¸çš„ç½‘ç«™å·®ä¸å¤šï¼Œé˜²èŒƒXSSæ”»å‡»ç­‰ã€‚</p><p>è€Œå¾ˆå¤šæƒ…å†µä¸‹ï¼Œåœ¨æˆ‘ä»¬çš„åº”ç”¨ä¸­å¯èƒ½éœ€è¦åŠ è½½è¿œç¨‹ç«™ç‚¹ï¼ˆåˆä½œç½‘ç«™ã€ç”¨æˆ·å‘é€çš„é“¾æ¥ï¼Œç”±ç¬¬ä¸‰æ–¹å¼€å‘çš„å°ç¨‹åºç­‰ï¼‰ï¼Œå¯¹äºè¿™äº›å¾ˆå¤šåœºæ™¯ä¸‹ä¸å¯æ§çš„ä»£ç èµ„æºï¼Œå¦‚æœç›´æ¥ç»™ä»–ä»¬æ‰€æœ‰çš„è®¿é—®æƒé™ï¼Œåæœå°†ä¸å¯æ§ï¼Œå› æ­¤æˆ‘ä»¬ç€é‡è®¨è®ºåŠ è½½è¿œç¨‹èµ„æºå¯èƒ½çš„é—®é¢˜ä»¥åŠè§£å†³æ–¹æ³•ã€‚</p><h3 id="ç”¨æˆ·å‘é€çš„é“¾æ¥"><a href="#ç”¨æˆ·å‘é€çš„é“¾æ¥" class="headerlink" title="ç”¨æˆ·å‘é€çš„é“¾æ¥"></a>ç”¨æˆ·å‘é€çš„é“¾æ¥</h3><p>ç”¨æˆ·å‘é€çš„å†…å®¹å¹¶ä¸å¯æ§ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬éœ€è¦<strong>å¤šé‡æ‹¦æˆª</strong>åšä¿éšœã€‚</p><h4 id="åç«¯ç»´æŠ¤ç«™ç‚¹é»‘åå•"><a href="#åç«¯ç»´æŠ¤ç«™ç‚¹é»‘åå•" class="headerlink" title="åç«¯ç»´æŠ¤ç«™ç‚¹é»‘åå•"></a>åç«¯ç»´æŠ¤ç«™ç‚¹é»‘åå•</h4><p>ç”±åç«¯ç»´æŠ¤ä¸€ä¸ªç«™ç‚¹é»‘åå•ï¼Œç”¨æˆ·å‘é€çš„æ¯ä¸ªé“¾æ¥åœ¨æ‰“å¼€å‰éƒ½è¯·æ±‚ä¸€æ¬¡æ¥å£ï¼Œåˆ¤æ–­åˆ°å¦‚æœæ˜¯è‰²æƒ…ç½‘ç«™é’“é±¼ç½‘ç«™ç­‰ä¸åˆæ³•ç«™ç‚¹ï¼Œç›´æ¥æé†’ç”¨æˆ·ä¸è¦æ‰“å¼€ã€‚</p><h4 id="é€šè¿‡ç³»ç»Ÿæµè§ˆå™¨æ‰“å¼€"><a href="#é€šè¿‡ç³»ç»Ÿæµè§ˆå™¨æ‰“å¼€" class="headerlink" title="é€šè¿‡ç³»ç»Ÿæµè§ˆå™¨æ‰“å¼€"></a>é€šè¿‡ç³»ç»Ÿæµè§ˆå™¨æ‰“å¼€</h4><p>å¯ä»¥é€šè¿‡<code>shell.openExternal</code>é€šè¿‡æµè§ˆå™¨æ‰“å¼€ç¬¬ä¸‰æ–¹ç«™ç‚¹</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @@code-renderer:runner</span></span><br><span class="line"><span class="comment">// @@code-props: &#123; height: &#x27;120px&#x27;, hideRight: true &#125;</span></span><br><span class="line"><span class="keyword">const</span> &#123; shell &#125; = <span class="built_in">require</span>(<span class="string">&#x27;electron&#x27;</span>)</span><br><span class="line">shell.openExternal(<span class="string">&#x27;https://github.com&#x27;</span>)</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯ä½¿ç”¨è¿™ä¸ªæ–¹æ³•éœ€è¦æ³¨æ„ä¸¤ç‚¹ï¼š</p><p>1.<strong>openExternalä¸åªèƒ½æ‰“å¼€httpé“¾æ¥</strong></p><p>  <code>openExternal</code>æ–¹æ³•æ˜¯æ˜¯é€šè¿‡ç³»ç»Ÿçš„é»˜è®¤åº”ç”¨æ‰“å¼€ç»™å®šçš„å¤–éƒ¨åè®®URLï¼Œæ¯”å¦‚è¯´æ‰“å¼€ä¸‹é¢è¿™æ®µurlä¼šæ‰“å¼€é‚®ä»¶åº”ç”¨å†™é‚®ä»¶ï¼Œéhttpåè®®çš„é“¾æ¥åªè¦æœ‰å¯¹åº”çš„å¤„ç†ç¨‹åºéƒ½ä¼šæ‰“å¼€ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @@code-renderer:runner</span></span><br><span class="line"><span class="comment">// @@code-props: &#123; height: &#x27;120px&#x27;, hideRight: true &#125;</span></span><br><span class="line"><span class="keyword">const</span> &#123; shell &#125; = <span class="built_in">require</span>(<span class="string">&#x27;electron&#x27;</span>)</span><br><span class="line">shell.openExternal(<span class="string">&#x27;mailto:somebody@gmail.com?subject=I love you&#x27;</span>)</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨æ­¤APIæ—¶éœ€è¦æ³¨æ„å…ˆåˆ¤æ–­URLåœ°å€çš„åè®®ã€‚</p><p>2.<strong>æ‰“å¼€httpé“¾æ¥ä»åº”å…ˆåˆ¤æ–­é£é™©</strong> </p><p>  å³ä½¿æ˜¯httpåè®®ï¼Œé€šè¿‡æµè§ˆå™¨æ‰“å¼€å‰ï¼Œæœ€å¥½ä¹Ÿèƒ½å…ˆåˆ¤æ–­æ˜¯å¦æœ‰é£é™©ï¼Œå¦åˆ™ç›¸å½“äºå°†ç½‘ç«™çš„å®‰å…¨æ€§åˆ¤æ–­è´£ä»»è½¬å«ç»™äº†æµè§ˆå™¨ï¼Œç”¨æˆ·ä»ç„¶æœ‰ä¸å°å¿ƒæ‰“å¼€é’“é±¼ç½‘ç«™çš„é£é™©ã€‚</p><h3 id="é€šè¿‡webPreferencesé™åˆ¶APIè®¿é—®"><a href="#é€šè¿‡webPreferencesé™åˆ¶APIè®¿é—®" class="headerlink" title="é€šè¿‡webPreferencesé™åˆ¶APIè®¿é—®"></a>é€šè¿‡webPreferencesé™åˆ¶APIè®¿é—®</h3><p>å¦‚æœéœ€è¦åœ¨Electronåº”ç”¨ä¸­æ‰“å¼€æ— æ³•ç¡®å®šå®‰å…¨æ€§çš„é“¾æ¥ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹æ‰“å¼€è¯¥é“¾æ¥çš„çª—å£è®¾ç½®æ›´ä¸ºä¸¥æ ¼çš„<code>webPreferences</code>é€‰é¡¹ä»¥é™åˆ¶å…¶èƒ½è®¿é—®åˆ°çš„apiå’Œå†…å®¹ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; BrowserWindow &#125; = <span class="built_in">require</span>(<span class="string">&#x27;electron&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> win = <span class="keyword">new</span> BrowserWindow(&#123;<span class="attr">webPreferences</span>: &#123;</span><br><span class="line">  <span class="comment">// æ˜¯å¦é›†æˆnodeç¯å¢ƒ</span></span><br><span class="line">  nodeIntegration: <span class="literal">false</span>,</span><br><span class="line">  <span class="comment">// åœ¨æ²™ç›’ä¸­è¿è¡Œæ¸²æŸ“è¿›ç¨‹</span></span><br><span class="line">  sandbox: <span class="literal">true</span>,</span><br><span class="line">  <span class="comment">// æ˜¯å¦å¯ç”¨remoteæ¨¡å—</span></span><br><span class="line">  enableRemoteModule: <span class="literal">false</span>,</span><br><span class="line">  <span class="comment">// å¯ç”¨åŒæºç­–ç•¥</span></span><br><span class="line">  webSecurity: <span class="literal">true</span>,</span><br><span class="line">  <span class="comment">// æ˜¯å¦å…è®¸è¿è¡Œhttpåè®®åŠ è½½çš„å†…å®¹</span></span><br><span class="line">  allowRunningInsecureContent: <span class="literal">false</span>,</span><br><span class="line">  <span class="comment">// åœ¨ç‹¬ç«‹JavaScriptç¯å¢ƒä¸­è¿è¡ŒElectron APIå’ŒæŒ‡å®šçš„preloadè„šæœ¬</span></span><br><span class="line">  contextIsolation: <span class="literal">true</span>,</span><br><span class="line">  <span class="comment">// æ˜¯å¦å…è®¸ä½¿ç”¨åŸç”Ÿçš„window.open()</span></span><br><span class="line">  nativeWindowOpen: <span class="literal">false</span>,</span><br><span class="line">  <span class="comment">// æ˜¯å¦å¯ç”¨webviewæ ‡ç­¾</span></span><br><span class="line">  webviewTag: <span class="literal">false</span>,</span><br><span class="line">&#125;&#125;)</span><br><span class="line">win.loadURL(<span class="string">&#x27;https://github.com&#x27;</span>)</span><br></pre></td></tr></table></figure><p>æ›´è¯¦ç»†çš„å‚æ•°è®¾ç½®å¯ä»¥å‚è€ƒ<a href="https://www.electronjs.org/docs/api/browser-window#new-browserwindowoptions">æ–‡æ¡£</a></p><p>ä¸Šé¢çš„é€‰é¡¹è¿›è¡Œäº†ååˆ†ä¸¥æ ¼çš„é™åˆ¶ï¼Œæ— nodeç¯å¢ƒï¼Œä¸å…è®¸<code>window.open</code>ï¼Œä¸å…è®¸åŠ è½½éhttpsé“¾æ¥ï¼Œåœ¨ç‹¬ç«‹JSç¯å¢ƒè¿è¡Œç­‰ç­‰ï¼Œå®‰å…¨æ€§æ˜¯å¤Ÿäº†ï¼Œä½†æ˜¯å¸¦æ¥çš„é—®é¢˜å°±æ˜¯ï¼Œå¦‚æœé‡åˆ°ä¸šåŠ¡éœ€è¦ä½¿ç”¨APIæ€ä¹ˆåŠï¼Ÿ</p><p>æ¯”å¦‚è¯´ç”±ç¬¬ä¸‰æ–¹å¼€å‘çš„å°ç¨‹åºï¼Œå¯èƒ½ä¼šéœ€è¦è·å–ä¸€äº›Nodeæˆ–Electronçš„apiï¼Œä½†æ˜¯åˆè¦ç¡®ä¿å®‰å…¨æ€§ã€‚</p><p>è¿™ç§æƒ…å†µä¸‹å°±éœ€è¦ä»£ç†ä¸€äº›Nodeå’ŒElectronçš„apiäº†</p><h3 id="ä»£ç†API"><a href="#ä»£ç†API" class="headerlink" title="ä»£ç†API"></a>ä»£ç†API</h3><p>è¿™é‡Œæˆ‘ä»¬ä¸»è¦è®¨è®ºä¸¤ç§æ–¹å¼ã€‚</p><h4 id="å¯¹APIåšå®Œå…¨çš„å°è£…"><a href="#å¯¹APIåšå®Œå…¨çš„å°è£…" class="headerlink" title="å¯¹APIåšå®Œå…¨çš„å°è£…"></a>å¯¹APIåšå®Œå…¨çš„å°è£…</h4><p>å°†æ–¹æ³•åœ¨preloadä¸­å°è£…å¥½ï¼ˆç¦ç”¨nodeé›†æˆä¸å½±å“preloadï¼‰ï¼Œç„¶åæŒ‚è½½åˆ°Windowä¸Šä¾›å…¶è°ƒç”¨ï¼Œæ¯”å¦‚åœ¨<br>ä¸­é€šè¿‡ä¸‹é¢çš„ä»£ç å¯ä»¥æä¾›APIè¯»å–æ–‡ä»¶å†…å®¹ï¼Œä½†ä¸å…è®¸å†™å…¥æ–‡ä»¶ç­‰æ“ä½œã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> JSBridge = &#123;</span><br><span class="line">  <span class="comment">// åªæä¾›è¯»å–æ–¹æ³•ï¼Œä¸æä¾›å†™å…¥</span></span><br><span class="line">  readFile: <span class="function">(<span class="params">path</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve,reject</span>)=&gt;</span>&#123;</span><br><span class="line">      <span class="comment">// åšä¸€äº›è·¯å¾„è§„åˆ™åˆ¤æ–­ï¼Œæ˜¯å¦å…è®¸è®¿é—®</span></span><br><span class="line">      <span class="keyword">if</span>(!<span class="regexp">/regexp-to-test-path/</span>.test(path)) reject(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">`not allowed path <span class="subst">$&#123;path&#125;</span>`</span>))</span><br><span class="line">      fs.readFile(path, <span class="function">(<span class="params">err, data</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(err) reject(err)</span><br><span class="line">        resolve(data)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">window</span>.JSBridge = JSBridge</span><br></pre></td></tr></table></figure><h4 id="é€šè¿‡remote-requireäº‹ä»¶åšä»£ç†å’Œæ”¾è¡Œ"><a href="#é€šè¿‡remote-requireäº‹ä»¶åšä»£ç†å’Œæ”¾è¡Œ" class="headerlink" title="é€šè¿‡remote-requireäº‹ä»¶åšä»£ç†å’Œæ”¾è¡Œ"></a>é€šè¿‡<code>remote-require</code>äº‹ä»¶åšä»£ç†å’Œæ”¾è¡Œ</h4><p>ç›‘å¬<a href="https://www.electronjs.org/docs/api/app#event-remote-require">appçš„remote-requireäº‹ä»¶</a>ï¼Œæ ¹æ®æ¨¡å—åç§°åšè¿‡æ»¤å’Œæ”¾è¡Œï¼Œä¹Ÿå¯ä»¥è¿”å›å°è£…å¥½çš„ä»£ç†æ¨¡å—ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> readOnlyFsProxy = <span class="built_in">require</span>(<span class="comment">/* ... */</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> allowedModules = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="string">&#x27;crypto&#x27;</span>])</span><br><span class="line"><span class="keyword">const</span> proxiedModules = <span class="keyword">new</span> <span class="built_in">Map</span>([<span class="string">&#x27;fs&#x27;</span>, readOnlyFsProxy])</span><br><span class="line"></span><br><span class="line">app.on(<span class="string">&#x27;remote-require&#x27;</span>, <span class="function">(<span class="params">event, webContents, moduleName</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (proxiedModules.has(moduleName)) &#123;</span><br><span class="line">    event.returnValue = proxiedModules.get(moduleName)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (!allowedModules.has(moduleName)) &#123;</span><br><span class="line">    event.preventDefault()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="é™åˆ¶å¯¼èˆª"><a href="#é™åˆ¶å¯¼èˆª" class="headerlink" title="é™åˆ¶å¯¼èˆª"></a>é™åˆ¶å¯¼èˆª</h3><p>åœ¨æµè§ˆå™¨è¦å¼€å§‹å¯¼èˆªæ—¶ä¼šè§¦å‘<code>will-navigate</code>äº‹ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨äº‹ä»¶å›è°ƒä¸­åˆ¤æ–­urlæ˜¯å¦ä¸ºç«™å†…é“¾æ¥ï¼Œå¦‚æœéç«™å†…é“¾æ¥å¯ä»¥è°ƒç”¨<code>event.preventDefault()</code>é˜»æ­¢è¿™æ¬¡å¯¼èˆªã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; BrowserWindow &#125; = <span class="built_in">require</span>(<span class="string">&#x27;electron&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> browserWindow = <span class="keyword">new</span> BrowserWindow()</span><br><span class="line">browserWindow.webContents.on(<span class="string">&#x27;will-navigate&#x27;</span>, <span class="function">(<span class="params">event, url</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// åˆ¤æ–­é“¾æ¥åŸŸå</span></span><br><span class="line">  <span class="keyword">if</span>(!<span class="regexp">/google.com?/</span>.test(<span class="keyword">new</span> URL(url).origin))&#123;</span><br><span class="line">    event.preventDefault()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">browserWindow.loadURL(<span class="string">&#x27;https://google.com&#x27;</span>)</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œä¸Šé¢çš„ä»£ç ï¼Œä¼šå‘ç°æ‰“å¼€çš„çª—å£ä¸­å¯ä»¥è¿›è¡Œæœç´¢ï¼Œä½†æ˜¯æ— æ³•è¿›å…¥æœç´¢å‡ºçš„ç¬¬ä¸‰æ–¹é¡µé¢ã€‚</p><h3 id="é™åˆ¶æ–°çª—å£çš„åˆ›å»º"><a href="#é™åˆ¶æ–°çª—å£çš„åˆ›å»º" class="headerlink" title="é™åˆ¶æ–°çª—å£çš„åˆ›å»º"></a>é™åˆ¶æ–°çª—å£çš„åˆ›å»º</h3><p>æ–°çª—å£çš„åˆ›å»ºä¸»è¦æœ‰å‡ ç§å½¢å¼ï¼š</p><ol><li>ç«™ç‚¹èµ„æºï¼Œå¯èƒ½ä¼šé€šè¿‡window.open(), aæ ‡ç­¾çš„target=_blankç­‰æ–¹å¼æ‰“å¼€æ–°çª—å£ï¼›</li><li>ç”¨æˆ·é€šè¿‡Command/Ctrl+é¼ æ ‡å•å‡»ï¼Œå³é”®èœå•ç­‰æ–¹å¼æ‰“å¼€æ–°çª—å£ï¼›</li></ol><p>é€šè¿‡ç›‘å¬<code>new-window</code>äº‹ä»¶å¯ä»¥åˆ¤æ–­urlå’Œæ‰“å¼€æ–¹å¼ï¼Œç„¶åé€šè¿‡<code>event.preventDefault()</code>æ¥é˜»æ­¢åˆ›å»ºæ–°çª—å£</p><p>ä¸‹é¢çš„ä»£ç é˜»æ­¢äº†command+clickå’Œç‚¹å‡»aæ ‡ç­¾target=_blankçš„æ–¹å¼æ‰“å¼€æ–°çª—å£:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; BrowserWindow, dialog &#125; = <span class="built_in">require</span>(<span class="string">&#x27;electron&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> browserWindow = <span class="keyword">new</span> BrowserWindow()</span><br><span class="line">browserWindow.webContents.on(<span class="string">&#x27;new-window&#x27;</span>, <span class="function">(<span class="params">event, url, frameName, disposition</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// dispositionå­—æ®µçš„ç›¸å…³è§£é‡Š:</span></span><br><span class="line">  <span class="comment">// new-window : openè°ƒç”¨</span></span><br><span class="line">  <span class="comment">// background-tab: command+click</span></span><br><span class="line">  <span class="comment">// foreground-tab: å³é”®ç‚¹å‡»æ–°æ ‡ç­¾æ‰“å¼€æˆ–ç‚¹å‡»aæ ‡ç­¾target _blankæ‰“å¼€</span></span><br><span class="line">  <span class="comment">// electronæ–‡æ¡£: æ–‡æ¡£ï¼šhttps://www.electronjs.org/docs/api/web-contents#webcontents</span></span><br><span class="line">  <span class="comment">// githubæºç : githubæºç ï¼š https://github.com/electron/electron/blob/72a089262e31054eabd342294ccdc4c414425c99/shell/browser/api/electron_api_web_contents.cc</span></span><br><span class="line">  <span class="comment">// chrome æºç ï¼š https://chromium.googlesource.com/chromium/src/+/66.0.3359.158/ui/base/mojo/window_open_disposition_struct_traits.h</span></span><br><span class="line">  <span class="keyword">if</span> (disposition === <span class="string">&#x27;background-tab&#x27;</span> || disposition === <span class="string">&#x27;foreground-tab&#x27;</span>) &#123;</span><br><span class="line">    dialog.showMessageBox(&#123;<span class="attr">message</span>: <span class="string">`not allowed. url: <span class="subst">$&#123;url&#125;</span>, disposition: <span class="subst">$&#123;disposition&#125;</span>`</span>&#125;)</span><br><span class="line">    event.preventDefault()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">browserWindow.loadURL(<span class="string">&#x27;https://google.com&#x27;</span>)</span><br></pre></td></tr></table></figure><p>å°è¯•ä¸€ä¸‹ï¼šä¿®æ”¹ä¸Šé¢çš„ä»£ç ï¼Œçœ‹çœ‹ä¸åŒçš„dispositionåˆ†åˆ«é€‚ç”¨ä»€ä¹ˆåœºæ™¯</p><h2 id="å´©æºƒæ”¶é›†"><a href="#å´©æºƒæ”¶é›†" class="headerlink" title="å´©æºƒæ”¶é›†"></a>å´©æºƒæ”¶é›†</h2><p>å¼€å‘electroné¡¹ç›®æ—¶ï¼Œç»å¸¸ä¼šé‡åˆ°APPå´©æºƒçš„æƒ…å†µï¼Œå¦‚æœAPPç«¯æ²¡æœ‰å¯¹åº”çš„æ—¥å¿—è®°å½•ï¼Œé‚£å¼€å‘å°±æ— æ³•æŒæ¡APPçš„å´©æºƒæƒ…å†µäº†ï¼Œä¹Ÿä¸å¥½åšåˆ†æã€‚</p><p>ç›®å‰æˆ‘ä»¬é€‰ç”¨çš„æ˜¯å¼€æºé¡¹ç›®<a href="https://sentry.io/">Sentry</a>,å®ƒç”¨æ¥è®°å½•crashæ—¥å¿—ï¼Œå®ƒä¹Ÿæœ‰ç»Ÿè®¡æ¨¡å—ï¼Œä¹Ÿèƒ½ç§æœ‰åŒ–éƒ¨ç½²ï¼ŒåŸºæœ¬ä¸Šå¼€ç®±å°±èƒ½ç”¨</p><p><img src= "/img/loading.gif" data-lazy-src="http://mei160.cn/images/sentry.png" alt="sentry"></p><h3 id="æƒ…å†µæ¨¡æ‹Ÿ"><a href="#æƒ…å†µæ¨¡æ‹Ÿ" class="headerlink" title="æƒ…å†µæ¨¡æ‹Ÿ"></a>æƒ…å†µæ¨¡æ‹Ÿ</h3><h4 id="Rendererè¿›ç¨‹ä¸»åŠ¨pushé”™è¯¯ä¿¡æ¯"><a href="#Rendererè¿›ç¨‹ä¸»åŠ¨pushé”™è¯¯ä¿¡æ¯" class="headerlink" title="Rendererè¿›ç¨‹ä¸»åŠ¨pushé”™è¯¯ä¿¡æ¯"></a>Rendererè¿›ç¨‹ä¸»åŠ¨pushé”™è¯¯ä¿¡æ¯</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">window</span>.$EB.ipcRenderer.send(<span class="string">&#x27;renderer.error&#x27;</span>, &#123;</span><br><span class="line">  message: <span class="string">&#x27;renderer.error&#x27;</span>,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>è§¦å‘çš„<a href="https://sentry.io/share/issue/76069b04b4aa4cc0ba99c2e74fceb8fc/">sentry é”™è¯¯æ—¥å¿—(å¯èƒ½éœ€è¦ç¿»å¢™)</a></p><h4 id="2-Rendererè¿›ç¨‹è¢«åŠ¨è§¦å‘é”™è¯¯ä¿¡æ¯"><a href="#2-Rendererè¿›ç¨‹è¢«åŠ¨è§¦å‘é”™è¯¯ä¿¡æ¯" class="headerlink" title="2. Rendererè¿›ç¨‹è¢«åŠ¨è§¦å‘é”™è¯¯ä¿¡æ¯"></a>2. Rendererè¿›ç¨‹è¢«åŠ¨è§¦å‘é”™è¯¯ä¿¡æ¯</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&#x27;Error triggered in renderer process&#x27;</span>)</span><br></pre></td></tr></table></figure><p>è¿™ä¸ä¼šè§¦å‘sentryä¿¡æ¯</p><h4 id="Rendererè¿›ç¨‹crashäº†"><a href="#Rendererè¿›ç¨‹crashäº†" class="headerlink" title="Rendererè¿›ç¨‹crashäº†"></a>Rendererè¿›ç¨‹crashäº†</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">window</span>.$EB.crash()</span><br></pre></td></tr></table></figure><p>è§¦å‘çš„<a href="https://sentry.io/share/issue/05a5ec366a194f36b2293b453cdec25c/">sentry crashæ—¥å¿—(å¯èƒ½éœ€è¦ç¿»å¢™)</a></p><h2 id="å¼€å‘"><a href="#å¼€å‘" class="headerlink" title="å¼€å‘"></a>å¼€å‘</h2><h3 id="å¿«é€Ÿæ–°å»ºä¸€ä¸ªElectron-App"><a href="#å¿«é€Ÿæ–°å»ºä¸€ä¸ªElectron-App" class="headerlink" title="å¿«é€Ÿæ–°å»ºä¸€ä¸ªElectron App"></a>å¿«é€Ÿæ–°å»ºä¸€ä¸ªElectron App</h3><p>æ–°å»ºä¸€ä¸ªå·¥ä½œç›®å½•ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir my-app &amp;&amp; cd my-app</span><br></pre></td></tr></table></figure><p>åˆå§‹åŒ–<strong>package.json</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn init</span><br></pre></td></tr></table></figure><p>å®‰è£…ä¾èµ–</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add electron -D</span><br></pre></td></tr></table></figure><p>æ–°å»ºindex.html</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Hello World<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">    html, body &#123;</span><br><span class="line">      background-color: antiquewhite;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello World<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ–°å»ºindex.js</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; app, BrowserWindow &#125; = <span class="built_in">require</span>(<span class="string">&#x27;electron&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"></span><br><span class="line">app.on(<span class="string">&#x27;ready&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="built_in">window</span> = <span class="keyword">new</span> BrowserWindow()</span><br><span class="line">  <span class="built_in">window</span>.loadFile(path.resolve(__dirname, <span class="string">&#x27;src&#x27;</span>, <span class="string">&#x27;index.html&#x27;</span>))</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>åœ¨package.jsonä¸­æ·»åŠ å¯åŠ¨å‘½ä»¤</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">  &quot;start&quot;: &quot;electron .&quot;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œå¯åŠ¨å‘½ä»¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn start</span><br></pre></td></tr></table></figure><p>æ˜¾ç¤ºæ•ˆæœå¦‚ä¸‹</p><p><img src= "/img/loading.gif" data-lazy-src="http://mei160.cn/images/quick_start_electron_app.png" alt="quick start electron app"></p><p>è¿™æ ·ï¼Œä¸€ä¸ªååˆ†ç®€å•çš„Electron Appå°±å®Œæˆäº†ã€‚</p><h3 id="æ­£å¼å¼€å§‹"><a href="#æ­£å¼å¼€å§‹" class="headerlink" title="æ­£å¼å¼€å§‹"></a>æ­£å¼å¼€å§‹</h3><p>åˆšåˆšçš„é¡¹ç›®è™½ç„¶å·²ç»èƒ½å¤Ÿå¯åŠ¨æ¥ï¼Œä½†è¿˜æœ‰äº›ç®€å•ï¼Œå¯¹äºéœ€æ±‚å’Œä¸šåŠ¡å¤æ‚çš„é¡¹ç›®æ¥è¯´è¿˜æœ‰å¾ˆå¤šä¸è¶³ã€‚</p><p>æ¯”å¦‚ï¼Œä¸»è¿›ç¨‹å’Œæ¸²æŸ“è¿›ç¨‹æ”¹å¦‚ä½•è°ƒè¯•ï¼Ÿæˆ‘æƒ³ç”¨æœ€æ–°çš„ESç‰¹æ€§è¯¥æ€ä¹ˆåšï¼Ÿæƒ³ç”¨TypeScriptè¯¥æ€ä¹ˆé…ç½®ï¼Ÿæƒ³ç”¨Reactï¼ŒVueï¼ŒAngularæ¥å†™UIå‘¢ï¼Ÿ</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬å°†ä¸€ä¸€è§£å†³è¿™äº›é—®é¢˜ã€‚</p><h4 id="ä½¿ç”¨Webpackæ¥ç¼–è¯‘æˆ‘ä»¬çš„ä»£ç "><a href="#ä½¿ç”¨Webpackæ¥ç¼–è¯‘æˆ‘ä»¬çš„ä»£ç " class="headerlink" title="ä½¿ç”¨Webpackæ¥ç¼–è¯‘æˆ‘ä»¬çš„ä»£ç "></a>ä½¿ç”¨Webpackæ¥ç¼–è¯‘æˆ‘ä»¬çš„ä»£ç </h4><p>é¦–å…ˆè°ƒæ•´ä¸€ä¸‹ç›®å½•ç»“æ„ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">â”œâ”€â”€ app                                 </span><br><span class="line">â”‚   â””â”€â”€ index.js                        ä¸»è¿›ç¨‹å…¥å£æ–‡ä»¶</span><br><span class="line">â”œâ”€â”€ build                               æ„å»ºç›¸å…³çš„è„šæœ¬å’Œé…ç½®</span><br><span class="line">â”‚   â””â”€â”€ webpack.config.js</span><br><span class="line">â”œâ”€â”€ output                              ç¼–è¯‘ç»“æœè¾“å‡ºç›®å½•</span><br><span class="line">â””â”€â”€ src                                 </span><br><span class="line">    â””â”€â”€ index.html                      æ¸²æŸ“è¿›ç¨‹å…¥å£æ–‡ä»¶ </span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬è¿™é‡Œé€‰æ‹©webpackä½œä¸ºæ„å»ºå·¥å…·ã€‚</p><p>Electronæœ¬èº«çš„TypeScriptç±»å‹å£°æ˜æ–‡ä»¶å¾ˆé½å…¨ï¼Œå¼€å‘ä½“éªŒä¸é”™ï¼Œå› æ­¤è¿™é‡Œé€‰æ‹©TypeScriptä½œä¸ºä¸»è¦å¼€å‘è¯­è¨€ã€‚</p><p>é¦–å…ˆå®‰è£…å¿…è¦çš„ä¾èµ–ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add -D webpack webpack-cli webpack-merge typescript awesome-typescript-loader</span><br></pre></td></tr></table></figure><p>åœ¨buildç›®å½•æ·»åŠ webpack.config.base.jsï¼Œé…ç½®å¦‚ä¸‹ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  resolve: &#123;</span><br><span class="line">    extensions: [<span class="string">&#x27;.ts&#x27;</span>, <span class="string">&#x27;.tsx&#x27;</span>, <span class="string">&#x27;.js&#x27;</span>, <span class="string">&#x27;.jsx&#x27;</span>],</span><br><span class="line">    alias: &#123;</span><br><span class="line">      <span class="string">&#x27;app&#x27;</span>: path.resolve(__dirname, <span class="string">&#x27;../app&#x27;</span>),</span><br><span class="line">      <span class="string">&#x27;src&#x27;</span>: path.resolve(__dirname, <span class="string">&#x27;../src&#x27;</span>),</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [&#123;</span><br><span class="line">      test: <span class="regexp">/\.tsx?$/</span>,</span><br><span class="line">      exclude: <span class="regexp">/node_modules/</span>,</span><br><span class="line">      use: [&#123;</span><br><span class="line">        loader: <span class="string">&#x27;awesome-typescript-loader&#x27;</span>,</span><br><span class="line">      &#125;],</span><br><span class="line">    &#125;],</span><br><span class="line">  &#125;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    path: path.join(__dirname, <span class="string">&#x27;..&#x27;</span>, <span class="string">&#x27;output&#x27;</span>, <span class="string">&#x27;main&#x27;</span>),</span><br><span class="line">    filename: <span class="string">&#x27;[name].js&#x27;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// https://webpack.js.org/configuration/node/</span></span><br><span class="line">  <span class="comment">// é¿å…webpacké…ç½®å¯¼è‡´çš„__dirnameå’Œ__filenameå’Œå®é™…è¾“å‡ºæ–‡ä»¶çš„ä¸ä¸€è‡´</span></span><br><span class="line">  node: &#123;</span><br><span class="line">    __dirname: <span class="literal">false</span>,</span><br><span class="line">    __filename: <span class="literal">false</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// å¯ç”¨source-map</span></span><br><span class="line">  devtool: <span class="string">&#x27;source-map&#x27;</span>,</span><br><span class="line">  plugins: [</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæ˜¯åŸºç¡€çš„webpacké…ç½®ï¼Œå°†åº”ç”¨äºä¸»è¿›ç¨‹å’Œpreloadçš„ä»£ç ç¼–è¯‘ã€‚</p><p>æ¥ä¸‹æ¥åœ¨buildç›®å½•æ·»åŠ webpack.config.main.jsä½œä¸ºä¸»è¿›ç¨‹çš„webpacké…ç½®ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">&#x27;webpack&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> &#123; merge &#125; = <span class="built_in">require</span>(<span class="string">&#x27;webpack-merge&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> baseConfig = <span class="built_in">require</span>(<span class="string">&#x27;./webpack.config.base&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = merge(baseConfig, &#123;</span><br><span class="line">  mode: process.env.NODE_ENV,</span><br><span class="line">  <span class="comment">// https://webpack.js.org/configuration/target/</span></span><br><span class="line">  <span class="comment">// webpackå¯ä»¥é’ˆå¯¹å¤šç§ç¯å¢ƒæˆ–ç›®æ ‡è¿›è¡Œç¼–è¯‘ï¼ŒåŒ…æ‹¬electron-mainå’Œelectron-preloadã€‚</span></span><br><span class="line">  target: <span class="string">&#x27;electron-main&#x27;</span>,</span><br><span class="line">  entry: &#123;</span><br><span class="line">    index: <span class="string">&#x27;./app/index.ts&#x27;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> webpack.NamedModulesPlugin(),</span><br><span class="line">    <span class="keyword">new</span> webpack.EnvironmentPlugin(&#123;</span><br><span class="line">      NODE_ENV: <span class="string">&#x27;development&#x27;</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">  ],</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>æ·»åŠ <code>tsconfig.json</code></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// https://www.typescriptlang.org/docs/handbook/tsconfig-json.html</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;compilerOptions&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;module&quot;</span>: <span class="string">&quot;commonjs&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;moduleResolution&quot;</span>: <span class="string">&quot;node&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;importHelpers&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">&quot;target&quot;</span>: <span class="string">&quot;es2015&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;jsx&quot;</span>: <span class="string">&quot;react&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;esModuleInterop&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">&quot;sourceMap&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">&quot;noImplicitAny&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">&quot;strict&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">&quot;allowSyntheticDefaultImports&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">&quot;experimentalDecorators&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">&quot;baseUrl&quot;</span>: <span class="string">&quot;.&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;paths&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;app/*&quot;</span>: [<span class="string">&quot;app/*&quot;</span>],</span><br><span class="line">      <span class="attr">&quot;src/*&quot;</span>: [<span class="string">&quot;src/*&quot;</span>],</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;include&quot;</span>: [<span class="string">&quot;app/**/*&quot;</span>],</span><br><span class="line">  <span class="attr">&quot;exclude&quot;</span>: [<span class="string">&quot;node_modules&quot;</span>, <span class="string">&quot;packages&quot;</span>, <span class="string">&quot;public&quot;</span>, <span class="string">&quot;mock&quot;</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åˆ é™¤<code>app/index.js</code>ï¼Œæ·»åŠ <code>app/index.ts</code>ï¼Œç°åœ¨æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨TypeScriptæ¥ç¼–å†™electronåº”ç”¨äº†ã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; app, BrowserWindow &#125; <span class="keyword">from</span> <span class="string">&#x27;electron&#x27;</span></span><br><span class="line"><span class="keyword">import</span> path <span class="keyword">from</span> <span class="string">&#x27;path&#x27;</span></span><br><span class="line"></span><br><span class="line">app.on(<span class="string">&#x27;ready&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="built_in">window</span> = <span class="keyword">new</span> BrowserWindow()</span><br><span class="line">  <span class="built_in">window</span>.loadFile(path.resolve(__dirname, <span class="string">&#x27;..&#x27;</span>, <span class="string">&#x27;..&#x27;</span>, <span class="string">&#x27;src&#x27;</span>, <span class="string">&#x27;index.html&#x27;</span>))</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>åœ¨package.jsonä¸­æ·»åŠ å‘½ä»¤</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;dev:main&quot;: &quot;NODE_ENV=development webpack --config ./build/webpack.config.main.js --watch&quot;</span><br></pre></td></tr></table></figure><p>å°† <code>main</code> å­—æ®µæ”¹ä¸ºè¾“å‡ºæ–‡ä»¶çš„è·¯å¾„ï¼š</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;main&quot;: &quot;output/main/index.js&quot;,</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn dev:main</span><br></pre></td></tr></table></figure><p>å‘ç°outputç›®å½•ä¸‹å¾—åˆ°äº†ç¼–è¯‘åçš„<code>index.js</code>æ–‡ä»¶å’Œsourcemapæ–‡ä»¶ï¼Œæ¥ä¸‹æ¥è¿è¡Œ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn start</span><br></pre></td></tr></table></figure><p>å³å¯å¯åŠ¨electron app</p><h4 id="è°ƒè¯•ä¸»è¿›ç¨‹"><a href="#è°ƒè¯•ä¸»è¿›ç¨‹" class="headerlink" title="è°ƒè¯•ä¸»è¿›ç¨‹"></a>è°ƒè¯•ä¸»è¿›ç¨‹</h4><h5 id="ä½¿ç”¨chromeè°ƒè¯•"><a href="#ä½¿ç”¨chromeè°ƒè¯•" class="headerlink" title="ä½¿ç”¨chromeè°ƒè¯•"></a>ä½¿ç”¨chromeè°ƒè¯•</h5><p>é¦–å…ˆå¯ä»¥é€šè¿‡electronæœ¬èº«æä¾›çš„inspecté¡¹å’Œchromeè¿›è¡Œè°ƒè¯•</p><p>ä¿®æ”¹package.jsonä¸­çš„<code>start</code>å‘½ä»¤</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;start&quot;: &quot;electron . --inspect-brk=5858&quot;,</span><br></pre></td></tr></table></figure><p>è¿è¡Œåæ‰“å¼€chromeï¼Œè¾“å…¥ <code>chrome://inspect</code>è¿›å…¥inspecté¡µé¢ï¼Œå¯ä»¥çœ‹åˆ°</p><p><img src= "/img/loading.gif" data-lazy-src="http://mei160.cn/images//inspect_main_process_in_chrome.png"></p><p>ç‚¹å‡» <code>Configure</code> è¾“å…¥ <code>localhost:5858</code>ï¼Œç‚¹å‡»<code>Done</code>ï¼Œå³å¯åœ¨ä¸‹é¢çš„Remote Targetåˆ—è¡¨ä¸­çœ‹åˆ°æˆ‘ä»¬çš„Electronåº”ç”¨ï¼Œç‚¹å‡»inspectä¾¿å¯ä»¥å¼€å§‹è°ƒè¯•ã€‚</p><p><a href="https://nodejs.org/en/docs/guides/debugging-getting-started/">æ–‡æ¡£å‚è€ƒ</a></p><h5 id="ä½¿ç”¨vscodeè°ƒè¯•"><a href="#ä½¿ç”¨vscodeè°ƒè¯•" class="headerlink" title="ä½¿ç”¨vscodeè°ƒè¯•"></a>ä½¿ç”¨vscodeè°ƒè¯•</h5><p>å°½ç®¡chromeçš„å¼€å‘è€…å·¥å…·ç”¨æ¥è°ƒè¯•å·²ç»ç›¸å½“å¥½ç”¨ï¼Œä½†è¿˜æ˜¯æŠµæŒ¡ä¸äº†å°†debuggeré›†æˆåˆ°ç¼–è¾‘å™¨ä¸­çš„è¯±æƒ‘ï¼šåœ¨ç¼–è¾‘å™¨ä¸­æºä»£ç ç›´æ¥æ‰“æ–­ç‚¹è°ƒè¯•å®åœ¨æ˜¯å¤ªæ–¹ä¾¿äº†ã€‚</p><p>vscodeä¸­é…ç½®ååˆ†ç®€å•ï¼Œæ‰“å¼€debugé¢æ¿ï¼Œç‚¹å‡»æ·»åŠ é…ç½®ï¼Œlaunch.jsoné…ç½®å¦‚ä¸‹:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;version&quot;</span>: <span class="string">&quot;0.2.0&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;configurations&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;node&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;request&quot;</span>: <span class="string">&quot;launch&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;Launch Program&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;program&quot;</span>: <span class="string">&quot;$&#123;workspaceFolder&#125;/app/index.ts&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;cwd&quot;</span>: <span class="string">&quot;$&#123;workspaceFolder&#125;&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;skipFiles&quot;</span>: [</span><br><span class="line">        <span class="string">&quot;&lt;node_internals&gt;/**&quot;</span></span><br><span class="line">      ],</span><br><span class="line">      <span class="attr">&quot;runtimeExecutable&quot;</span>: <span class="string">&quot;$&#123;workspaceFolder&#125;/node_modules/.bin/electron&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;windows&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;runtimeExecutable&quot;</span>: <span class="string">&quot;$&#123;workspaceFolder&#125;/node_modules/.bin/electron.cmd&quot;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">&quot;outFiles&quot;</span>: [</span><br><span class="line">        <span class="string">&quot;$&#123;workspaceRoot&#125;/output/main/*.js&quot;</span></span><br><span class="line">      ],</span><br><span class="line">      <span class="attr">&quot;args&quot;</span> : [<span class="string">&quot;.&quot;</span>]</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰“å¼€<code>app/index.ts</code>ï¼Œåœ¨æƒ³è¦è°ƒè¯•çš„ä»£ç å·¦è¾¹ç‚¹å‡»æ‰“ä¸Šæ–­ç‚¹ï¼Œåœ¨debugé¢æ¿ç‚¹å‡»<code>start debugging</code>ï¼Œå°±ä¼šå‘ç°ä»£ç æ‰§è¡Œåˆ°æ–­ç‚¹å¤„åœä½ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥è‡ªç”±åœ¨vscodeä¸­è°ƒè¯•äº†ã€‚</p><p><a href="https://www.electronjs.org/docs/tutorial/debugging-main-process-vscode">æ–‡æ¡£å‚è€ƒ</a></p><h5 id="ä½¿ç”¨webstormè°ƒè¯•"><a href="#ä½¿ç”¨webstormè°ƒè¯•" class="headerlink" title="ä½¿ç”¨webstormè°ƒè¯•"></a>ä½¿ç”¨webstormè°ƒè¯•</h5><p>å’Œvscodeç±»ä¼¼ï¼Œåœ¨webstormä¸­ä¹Ÿæ˜¯é€šè¿‡æ·»åŠ é…ç½®æ¥è¿›è¡Œè°ƒè¯•ï¼Œç‚¹å‡»æ·»åŠ é…ç½®ï¼Œé€‰æ‹©Node.jsï¼Œå¡«å†™å¦‚ä¸‹ï¼š</p><p><img src= "/img/loading.gif" data-lazy-src="http://mei160.cn/images/debug_main_process_in_webstorm.png"></p><p><a href="https://blog.jetbrains.com/webstorm/2016/05/getting-started-with-electron-in-webstorm/">æ–‡æ¡£å‚è€ƒ</a></p><h4 id="è°ƒè¯•æ¸²æŸ“è¿›ç¨‹"><a href="#è°ƒè¯•æ¸²æŸ“è¿›ç¨‹" class="headerlink" title="è°ƒè¯•æ¸²æŸ“è¿›ç¨‹"></a>è°ƒè¯•æ¸²æŸ“è¿›ç¨‹</h4><h5 id="æ‰“å¼€æ§åˆ¶å°"><a href="#æ‰“å¼€æ§åˆ¶å°" class="headerlink" title="æ‰“å¼€æ§åˆ¶å°"></a>æ‰“å¼€æ§åˆ¶å°</h5><p>ä¿®æ”¹<code>app/index.ts</code>ä¸­çš„ä»£ç :</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">app.on(<span class="string">&#x27;ready&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="built_in">window</span> = <span class="keyword">new</span> BrowserWindow()</span><br><span class="line">  <span class="built_in">window</span>.loadFile(path.resolve(__dirname, <span class="string">&#x27;..&#x27;</span>, <span class="string">&#x27;..&#x27;</span>, <span class="string">&#x27;src&#x27;</span>, <span class="string">&#x27;index.html&#x27;</span>))</span><br><span class="line">  <span class="keyword">if</span>(process.env.NODE_ENV === <span class="string">&#x27;development&#x27;</span>)&#123;</span><br><span class="line">    <span class="built_in">window</span>.webContents.openDevTools()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>åœ¨å¼€å‘ç¯å¢ƒä¸‹ï¼Œå°±ä¼šè‡ªåŠ¨æ‰“å¼€chromeè°ƒè¯•å·¥å…·äº†</p><h5 id="æ·»åŠ preload"><a href="#æ·»åŠ preload" class="headerlink" title="æ·»åŠ preload"></a>æ·»åŠ preload</h5><p>åœ¨<code>app</code>æ–‡ä»¶å¤¹ä¸‹æ·»åŠ <code>preload.ts</code></p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ipcRenderer &#125; <span class="keyword">from</span> <span class="string">&#x27;electron&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">getAppInfo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">await</span> ipcRenderer.invoke(<span class="string">&#x27;app/get_basic_info&#x27;</span>) </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> JSBridge = &#123;</span><br><span class="line">  getAppInfo,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">window</span>.JSBridge = JSBridge;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> JSBridgeType = <span class="keyword">typeof</span> JSBridge;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¹¶åœ¨appä¸­æ·»åŠ å¯¹ipcçš„å¤„ç†ï¼š</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">app.on(<span class="string">&#x27;will-finish-launching&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  ipcMain.handle(<span class="string">&#x27;app/get_basic_info&#x27;</span>, <span class="function"><span class="keyword">function</span> <span class="title">handleAppGetBasicInfo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      version: app.getVersion(),</span><br><span class="line">      name: app.name,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>ç”±äºwindowä¸Šæ²¡æœ‰JSBridgeå±æ€§ï¼Œtsä¼šæŠ¥é”™ï¼Œæ­¤æ—¶æˆ‘ä»¬åœ¨æ ¹ç›®å½•æ·»åŠ ä¸€ä¸ªglobal.d.ts:</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; JSBridgeType &#125; <span class="keyword">from</span> <span class="string">&quot;app/preload&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">declare</span> <span class="built_in">global</span>&#123;</span><br><span class="line">  <span class="keyword">interface</span> Window&#123;</span><br><span class="line">    JSBridge: JSBridgeType</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥åœ¨buildä¸‹æ·»åŠ <code>webpack.config.preload.js</code>ï¼Œå°†preloadä¹Ÿè¾“å‡ºåˆ°outputç›®å½•ä¸‹:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">&quot;webpack&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; merge &#125; = <span class="built_in">require</span>(<span class="string">&quot;webpack-merge&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> baseConfig = <span class="built_in">require</span>(<span class="string">&quot;./webpack.config.base&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = merge(baseConfig, &#123;</span><br><span class="line">  mode: process.env.NODE_ENV,</span><br><span class="line">  target: <span class="string">&quot;electron-preload&quot;</span>,</span><br><span class="line">  entry: &#123;</span><br><span class="line">    preload: <span class="string">&quot;./app/preload.ts&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> webpack.NamedModulesPlugin(),</span><br><span class="line">    <span class="keyword">new</span> webpack.EnvironmentPlugin(&#123;</span><br><span class="line">      NODE_ENV: <span class="string">&quot;development&quot;</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">  ],</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>åœ¨package.jsonä¸­æ·»åŠ ä¸€æ¡preloadçš„å¼€å‘å‘½ä»¤:</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;dev:preload&quot;: &quot;NODE_ENV=development webpack --config ./build/webpack.config.preload.js --watch&quot;</span><br></pre></td></tr></table></figure><p>å¯åŠ¨åå°±ä¼šå‘ç°output/mainç›®å½•ä¸‹å¤šå‡ºä¸€ä¸ªpreload.jsåŠsourcemap</p><p>ä¿®æ”¹<code>app/index.ts</code>ï¼Œåˆ›å»ºBrowserWindowæ—¶æ³¨å…¥preload.js</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> PRELOAD = path.resolve(__dirname, <span class="string">&#x27;preload.js&#x27;</span>)</span><br><span class="line"></span><br><span class="line">app.on(<span class="string">&#x27;ready&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="built_in">window</span> = <span class="keyword">new</span> BrowserWindow(&#123;webPreferences: &#123;preload: PRELOAD&#125;&#125;)</span><br><span class="line">  <span class="built_in">window</span>.loadFile(path.resolve(__dirname, <span class="string">&#x27;..&#x27;</span>, <span class="string">&#x27;..&#x27;</span>, <span class="string">&#x27;src&#x27;</span>, <span class="string">&#x27;index.html&#x27;</span>))</span><br><span class="line">  <span class="keyword">if</span>(process.env.NODE_ENV === <span class="string">&#x27;development&#x27;</span>)&#123;</span><br><span class="line">    <span class="built_in">window</span>.webContents.openDevTools()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>åœ¨<code>app/index.html</code>ä¸­æ·»åŠ æŒ‰é’®è·å–appä¿¡æ¯:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Hello World<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">      html,</span><br><span class="line">      body &#123;</span><br><span class="line">        background-color: antiquewhite;</span><br><span class="line">      &#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">handleGetAppInfo</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">const</span> &#123; version, name &#125; = <span class="keyword">await</span> <span class="built_in">window</span>.JSBridge.getAppInfo();</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(version,name)</span></span><br><span class="line"><span class="javascript">        <span class="built_in">document</span>.querySelector(<span class="string">&#x27;#version&#x27;</span>).innerText = version</span></span><br><span class="line"><span class="javascript">        <span class="built_in">document</span>.querySelector(<span class="string">&#x27;#name&#x27;</span>).innerText = name</span></span><br><span class="line">      &#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello World<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dl</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">dt</span>&gt;</span>version<span class="tag">&lt;/<span class="name">dt</span>&gt;</span> <span class="tag">&lt;<span class="name">dd</span> <span class="attr">id</span>=<span class="string">&quot;version&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">dt</span>&gt;</span>name<span class="tag">&lt;/<span class="name">dt</span>&gt;</span> <span class="tag">&lt;<span class="name">dd</span> <span class="attr">id</span>=<span class="string">&quot;name&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dl</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">&quot;handleGetAppInfo()&quot;</span>&gt;</span>get app info<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å¯åŠ¨appï¼Œç‚¹å‡»æŒ‰é’®ï¼Œå‘ç°èƒ½å¤Ÿæ­£å¸¸è·å–åˆ°appä¿¡æ¯</p><p>è‡³æ­¤æˆ‘ä»¬åŸºæœ¬çš„å¼€å‘æµç¨‹å°±éƒ½å®ç°äº†ï¼Œä¸»è¦åŒ…æ‹¬ï¼š</p><ul><li>ä¸»è¿›ç¨‹ï¼Œæ¸²æŸ“è¿›ç¨‹ï¼Œpreloadçš„ç¼–è¯‘</li><li>ä¸»è¿›ç¨‹å’Œæ¸²æŸ“è¿›ç¨‹çš„è°ƒè¯•</li></ul><p>çœ‹èµ·æ¥æ˜¯å®Œå¤‡äº†ï¼Œä½†å¼€å‘æ—¶å°±ä¼šå‘ç°è¿˜ä¸å¤Ÿç”¨å‘¢ã€‚æ¥ä¸‹æ¥å¯¹è¿™ä¸ªæµç¨‹åšä¸€äº›è¡¥å……</p><h3 id="æµç¨‹å®Œå–„"><a href="#æµç¨‹å®Œå–„" class="headerlink" title="æµç¨‹å®Œå–„"></a>æµç¨‹å®Œå–„</h3><h4 id="å¯åŠ¨å‘½ä»¤å®Œå–„"><a href="#å¯åŠ¨å‘½ä»¤å®Œå–„" class="headerlink" title="å¯åŠ¨å‘½ä»¤å®Œå–„"></a>å¯åŠ¨å‘½ä»¤å®Œå–„</h4><p>é¦–å…ˆå®‰è£…cross-envå’Œconcurrently</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add -D cross-env concurrently</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹<code>dev:main</code>å’Œ<code>dev:preload</code>å‘½ä»¤å¹¶æ·»åŠ <code>dev</code>å‘½ä»¤ï¼š</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&quot;dev:main&quot;: &quot;webpack --config ./build/webpack.config.main.js --watch&quot;,</span><br><span class="line">&quot;dev:preload&quot;: &quot;webpack --config ./build/webpack.config.preload.js --watch&quot;,</span><br><span class="line">&quot;dev&quot;: &quot;cross-env NODE_ENV=development concurrently \&quot;npm run dev:main\&quot; \&quot;npm run dev:preload\&quot;&quot;</span><br></pre></td></tr></table></figure><p>cross-envç”¨äºå…¼å®¹å„å¹³å°ä¸‹çš„<strong>ç¯å¢ƒå˜é‡è®¾ç½®</strong>ï¼Œconcurrentlyç”¨äºåŒæ—¶è¿è¡Œå¤šä¸ªwebpackç¼–è¯‘çš„watchæ¨¡å¼ã€‚ä¹‹åappçš„ç¼–è¯‘åªéœ€è¿è¡Œ<code>yarn dev</code>å³å¯</p><h4 id="ä½¿ç”¨Reactåšæ¸²æŸ“è¿›ç¨‹å¼€å‘"><a href="#ä½¿ç”¨Reactåšæ¸²æŸ“è¿›ç¨‹å¼€å‘" class="headerlink" title="ä½¿ç”¨Reactåšæ¸²æŸ“è¿›ç¨‹å¼€å‘"></a>ä½¿ç”¨Reactåšæ¸²æŸ“è¿›ç¨‹å¼€å‘</h4><p>é¦–å…ˆç”¨<code>create-react-app</code>åˆ›å»ºä¸€ä¸ªReactåº”ç”¨ï¼Œåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹è¿è¡Œ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn create react-app renderer</span><br></pre></td></tr></table></figure><p>è¿›å…¥rendererç›®å½•è¿è¡Œ<code>yarn start</code>ï¼Œåº”ç”¨é»˜è®¤åœ¨2333ç«¯å£å¯åŠ¨ï¼Œå¦‚æœæŠ¥é”™<code>The react-scripts package provided by Create React App requires a dependency: webpack</code>ï¼Œå¯ä»¥åœ¨rendererç›®å½•ä¸‹æ·»åŠ .envæ–‡ä»¶ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SKIP_PREFLIGHT_CHECK&#x3D;true</span><br></pre></td></tr></table></figure><p>è¿™æ—¶å€™æˆ‘ä»¬å°†<code>app/index.ts</code>ä¸­çš„<code>window.loadFile ...</code>æ”¹ä¸º</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.loadURL(<span class="string">&#x27;http://localhost:2333&#x27;</span>)</span><br></pre></td></tr></table></figure><p>é‡å¯Electronåº”ç”¨å³å¯çœ‹åˆ°æ¸²æŸ“çš„çª—å£åŠ è½½äº†æœ¬åœ°çš„Reactåº”ç”¨</p><p>ä½†æ˜¯è¿™é‡Œä¼šæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œåœ¨æ‰“åŒ…æ—¶æˆ‘ä»¬ä¼šå°†æ¸²æŸ“è¿›ç¨‹çš„ä»£ç æ‰“åŒ…è¿›å»ï¼Œçª—å£åŠ è½½å®é™…ä¸Šæ˜¯é€šè¿‡loadFileçš„æ–¹å¼è¿›è¡Œçš„ï¼Œå¦‚æœæœ¬åœ°å¼€å‘çš„æ—¶å€™ä½¿ç”¨æœ¬åœ°httpåœ°å€å¼€å‘ï¼Œå®é™…æ•ˆæœå’Œæ‰“åŒ…å‡ºæ¥çš„æ•ˆæœæ˜¯ä¼šæœ‰å‡ºå…¥çš„ï¼Œå› æ­¤æˆ‘ä»¬å†åšä¸€äº›ä¿®æ”¹ï¼Œå°†å¼€å‘æ—¶ç”Ÿæˆçš„æ–‡ä»¶è¾“å‡ºåˆ°<code>output/renderer</code>ç›®å½•ä¸‹ï¼Œç„¶åé€šè¿‡loadFileçš„æ–¹å¼åŠ è½½å®ƒã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦ä¿®æ”¹craé¡¹ç›®çš„webpackä¸­å¯¹åº”çš„outputé…ç½®å’Œpathä¸­çš„appBuildé…ç½®æ¥æ”¹å˜è¾“å‡ºç›®å½•ï¼Œç„¶åä¿®æ”¹devServerçš„é…ç½®è®©å¼€å‘æ—¶ä¹Ÿè¾“å‡ºæ–‡ä»¶ï¼Œå¹¶ä¸”ä¿®æ”¹socketé…ç½®ä¿è¯çƒ­æ›´æ–°èƒ½æ­£å¸¸ä½¿ç”¨ã€‚</p><p>å› ä¸ºcraé¡¹ç›®æœ¬èº«æ²¡æœ‰å°†é…ç½®æš´éœ²å‡ºæ¥ï¼Œè¿™é‡Œæˆ‘ä»¬åšçš„æ”¹åŠ¨ä¸å¤šï¼Œå› æ­¤é€‰æ‹©ä½¿ç”¨<code>react-app-rewired</code>è€Œéejectå¼¹å‡ºé…ç½®ã€‚</p><p>é¦–å…ˆå®‰è£…ä¾èµ–</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add -D react-app-rewired react-dev-utils</span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨rendererç›®å½•ä¸‹æ–°å»º<code>config-overrides.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> OUTPUT_PATH = path.resolve(__dirname, <span class="string">&#x27;..&#x27;</span>, <span class="string">&#x27;output&#x27;</span>, <span class="string">&#x27;renderer&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    webpack: <span class="function"><span class="keyword">function</span>(<span class="params">config, env</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// ä¿®æ”¹è¾“å‡ºç›®å½•</span></span><br><span class="line">        config.output.path = OUTPUT_PATH</span><br><span class="line">        <span class="comment">// ä¿®æ”¹publicPathï¼Œå¦åˆ™é™æ€èµ„æºæ–‡ä»¶ä¼šå¼•ç”¨å¤±è´¥</span></span><br><span class="line">        config.output.publicPath = <span class="string">&#x27;./&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> config;</span><br><span class="line">    &#125;,</span><br><span class="line">    devServer: <span class="function"><span class="keyword">function</span>(<span class="params">configFunction</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">proxy, allowedHost</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">const</span> config = configFunction(proxy, allowedHost);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// å°†æ–‡ä»¶è¾“å‡ºåˆ°ç¡¬ç›˜</span></span><br><span class="line">            config.writeToDisk = <span class="literal">true</span></span><br><span class="line">            <span class="comment">// ä¿®æ”¹sockç›¸å…³é…ç½®ä¿è¯çƒ­æ›´æ–°åŠŸèƒ½æ­£å¸¸</span></span><br><span class="line">            config.host = process.env.HOST || <span class="string">&#x27;0.0.0.0&#x27;</span>;</span><br><span class="line">            config.sockHost = process.env.WDS_SOCKET_HOST;</span><br><span class="line">            config.sockPath = process.env.WDS_SOCKET_PATH; <span class="comment">// default: &#x27;/sockjs-node&#x27;</span></span><br><span class="line">            config.sockPort = process.env.WDS_SOCKET_PORT;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> config;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">    paths: <span class="function"><span class="keyword">function</span>(<span class="params">paths, env</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// ä¿®æ”¹buildä¸‹çš„è¾“å‡ºç›®å½•</span></span><br><span class="line">        paths.appBuild = OUTPUT_PATH</span><br><span class="line">        <span class="keyword">return</span> paths;</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‡æ–°å¯åŠ¨reacté¡¹ç›®ï¼Œå‘ç°<code>output/renderer</code>ç›®å½•ä¸‹è¾“å‡ºäº†å¯¹åº”çš„é™æ€æ–‡ä»¶</p><p>ç„¶åæˆ‘ä»¬å°†<code>app/index.ts</code>ä¸­çš„<code>window.loadURL ...</code>æ³¨é‡Šï¼Œæ·»åŠ ä¸€è¡Œ</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// window.loadURL(&#x27;http://localhost:2333&#x27;)</span></span><br><span class="line"><span class="built_in">window</span>.loadFile(path.resolve(__dirname, <span class="string">&#x27;..&#x27;</span>, <span class="string">&#x27;..&#x27;</span>, <span class="string">&#x27;output&#x27;</span>, <span class="string">&#x27;renderer&#x27;</span>, <span class="string">&#x27;index.html&#x27;</span>))</span><br></pre></td></tr></table></figure><p>é‡æ–°å¯åŠ¨åº”ç”¨ï¼Œå‘ç°åŠ è½½æˆåŠŸã€‚</p><h4 id="ç»™devtoolsæ·»åŠ plugins"><a href="#ç»™devtoolsæ·»åŠ plugins" class="headerlink" title="ç»™devtoolsæ·»åŠ plugins"></a>ç»™devtoolsæ·»åŠ plugins</h4><p>æ¸²æŸ“è¿›ç¨‹ä½¿ç”¨äº†reactè¿›è¡Œå¼€å‘ï¼Œä¸ºäº†æ›´æ–¹ä¾¿çš„è°ƒè¯•ï¼Œæˆ‘ä»¬æ¥ç»™devtoolså®‰è£…æµè§ˆå™¨æ’ä»¶ã€‚</p><p>é¦–å…ˆæ‰¾åˆ°chromeæ’ä»¶çš„ä½ç½®</p><ul><li><p>windows</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%LOCALAPPDATA%\Google\Chrome\User Data\Default\Extensions</span><br></pre></td></tr></table></figure></li><li><p>MacOS</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~&#x2F;Library&#x2F;Application Support&#x2F;Google&#x2F;Chrome&#x2F;Default&#x2F;Extensions</span><br></pre></td></tr></table></figure></li><li><p>Linuxï¼Œæœ‰å‡ ä¸ªå¯èƒ½çš„è·¯å¾„</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">~&#x2F;.config&#x2F;google-chrome&#x2F;Default&#x2F;Extensions&#x2F;</span><br><span class="line">~&#x2F;.config&#x2F;google-chrome-beta&#x2F;Default&#x2F;Extensions&#x2F;</span><br><span class="line">~&#x2F;.config&#x2F;google-chrome-canary&#x2F;Default&#x2F;Extensions&#x2F;</span><br><span class="line">~&#x2F;.config&#x2F;chromium&#x2F;Default&#x2F;Extensions&#x2F;</span><br></pre></td></tr></table></figure></li></ul><p>æ‰“å¼€ç›®å½•ä¼šå‘ç°ä¸‹é¢éƒ½æ˜¯æ ¹æ®ä»¥æ‰©å±•idå‘½åçš„æ–‡ä»¶å¤¹ï¼Œæƒ³è¦æ‰¾åˆ°æ‰©å±•å¯¹åº”çš„idï¼Œå¯ä»¥åœ¨chromeä¸­æ‰“å¼€<code>chrome://extensions/</code>ï¼Œç‚¹å‡»å¯¹åº”æ‰©å±•çš„è¯¦ç»†ä¿¡æ¯ï¼Œå³å¯ä»urlå‚æ•°ä¸Šæ‰¾åˆ°idã€‚</p><p>ä»¥<code>React Developer Tools</code>åœ¨MacOSä¸Šçš„ä¸ºä¾‹ï¼Œåœ¨<code>app/index.ts</code>ä¸­æ·»åŠ ï¼š</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> EXTENSION_PATH_REACT_DEV_TOOLS = path.join(<span class="string">&#x27;/Users/wangshuwen/Library/Application Support/Google/Chrome/Default/Extensions/&#x27;</span>, <span class="string">&#x27;fmkadmapgofadopljbjfkapdkoienihi&#x27;</span>, <span class="string">&#x27;4.8.2_0&#x27;</span>)</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">app.on(<span class="string">&#x27;ready&#x27;</span>, <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> e = <span class="keyword">await</span> session.defaultSession.loadExtension(EXTENSION_PATH_REACT_DEV_TOOLS)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="built_in">window</span> = <span class="keyword">new</span> BrowserWindow(&#123;webPreferences: &#123;preload: PRELOAD&#125;&#125;)</span><br><span class="line">  <span class="built_in">window</span>.loadURL(<span class="string">&#x27;http://localhost:2333&#x27;</span>)</span><br><span class="line">  </span><br><span class="line">  ...</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>ç”±äºElectronæœ¬èº«åŸå› ï¼Œé€šè¿‡<code>session.loadExtension</code>æ·»åŠ çš„æ’ä»¶ç›®å‰React Dev Toolsåœ¨fileåè®®ä¸‹æ— æ³•è®¿é—®æ–‡ä»¶ï¼Œéœ€è¦åœ¨httpåè®®ä¸‹è¿›è¡Œè°ƒè¯•ã€‚</p><p>å¤‡é€‰æ–¹æ¡ˆï¼šæ”¹ä¸ºä½¿ç”¨<code>BrowserWindow.addDevToolsExtension</code>æ–¹æ³•æ·»åŠ æ’ä»¶ï¼Œåœ¨Electron 9.0.0ç‰ˆæœ¬ä»¥ä¸‹ç”Ÿæ•ˆ</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">app.on(<span class="string">&#x27;ready&#x27;</span>, <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  BrowserWindow.addDevToolsExtension(EXTENSION_PATH_REACT_DEV_TOOLS)</span><br><span class="line">  <span class="comment">// const e = await session.defaultSession.loadExtension(EXTENSION_PATH_REACT_DEV_TOOLS)</span></span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯æ³¨æ„è¿™ä¸ªæ–¹æ³•å³å°†è¢«ElectronåºŸå¼ƒï¼Œå¾…Electronä¿®å¤<code>session.loadExtension</code>çš„é—®é¢˜åå¯ä»¥æ›´æ¢æ‰æ­¤æ–¹æ³•ã€‚</p><p>å¦‚æœè§‰å¾—æ‰‹åŠ¨æ‰¾æ’ä»¶æ·»åŠ çš„æ–¹å¼è¿‡äºéº»çƒ¦ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨<a href="https://github.com/MarshallOfSound/electron-devtools-installer">electron-devtools-installer</a>è¿™ä¸ªåº“æ¥è¿›è¡Œæ‰©å±•ç®¡ç†ã€‚</p><h3 id="ç›¸å…³æ–‡æ¡£"><a href="#ç›¸å…³æ–‡æ¡£" class="headerlink" title="ç›¸å…³æ–‡æ¡£"></a>ç›¸å…³æ–‡æ¡£</h3><ul><li><a href="https://www.electronjs.org/docs/tutorial/devtools-extension">devtools-extension</a></li><li><a href="https://www.electronjs.org/docs/api/session#sesloadextensionpath">session#load-extension</a></li><li><a href="https://github.com/electron/electron/issues/24011">Extensions donâ€™t work with file:// protocol since 9.0.0</a></li></ul><h2 id="æ‰“åŒ…"><a href="#æ‰“åŒ…" class="headerlink" title="æ‰“åŒ…"></a>æ‰“åŒ…</h2><p>Electronå¸¸ç”¨çš„æ‰“åŒ…å·¥å…·æœ‰è¿™ä¹ˆå‡ ä¸ªï¼š</p><ul><li><a href="https://github.com/electron/electron-packager">electron-packager</a></li><li><a href="https://github.com/electron-userland/electron-forge">electron-forge</a></li><li><a href="https://github.com/electron-userland/electron-builder">electron-builder</a></li></ul><p><code>electron-packager</code>å’Œ<code>electron-builder</code>æ˜¯å•çº¯çš„Electronæ‰“åŒ…å·¥å…·ï¼Œ<code>electron-forge</code>ç±»ä¼¼äºä¸€ä¸ªCLIå·¥å…·ï¼Œå‚ä¸ä»åˆ›å»ºé¡¹ç›®åˆ°å¼€å‘å’Œæ‰“åŒ…çš„æµç¨‹ã€‚</p><p><code>electron-packager</code>è¾ƒä¸ºè½»é‡ï¼Œä¸Šæ‰‹ä½¿ç”¨è¿…é€Ÿï¼Œé€‚åˆç®€å•çš„é¡¹ç›®æ‰“åŒ…ã€‚ç›¸å¯¹è€Œè¨€<code>electron-builder</code>é…ç½®æ›´åŠ å¤æ‚å’Œå…¨é¢ä¸€äº›ï¼Œè¿™é‡Œæˆ‘ä»¬é€‰æ‹©<code>electron-builder</code>ä½œä¸ºæ‰“åŒ…å·¥å…·ã€‚</p><h3 id="åŸºæœ¬æ‰“åŒ…é…ç½®"><a href="#åŸºæœ¬æ‰“åŒ…é…ç½®" class="headerlink" title="åŸºæœ¬æ‰“åŒ…é…ç½®"></a>åŸºæœ¬æ‰“åŒ…é…ç½®</h3><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦å°†ä¸»è¿›ç¨‹ã€preloadã€æ¸²æŸ“è¿›ç¨‹çš„ä»£ç ç¼–è¯‘è¾“å‡ºåˆ°outputç›®å½•ï¼Œå‡å®šoutputç›®å½•ä¸‹æ–‡ä»¶ç»“æ„å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">â”œâ”€â”€ main</span><br><span class="line">â”‚   â”œâ”€â”€ index.js                &#x2F;&#x2F; ä¸»è¿›ç¨‹å…¥å£æ–‡ä»¶</span><br><span class="line">â”‚   â”œâ”€â”€ index.js.map</span><br><span class="line">â”‚   â”œâ”€â”€ preload.js              &#x2F;&#x2F; preloadæ–‡ä»¶</span><br><span class="line">â”‚   â””â”€â”€ preload.js.map</span><br><span class="line">â””â”€â”€ renderer                    &#x2F;&#x2F; æ¸²æŸ“è¿›ç¨‹çš„é™æ€æ–‡ä»¶</span><br><span class="line">    â”œâ”€â”€ static </span><br><span class="line">    â”œâ”€â”€ favicon.ico</span><br><span class="line">    â”œâ”€â”€ index.html</span><br><span class="line">    â”œâ”€â”€ manifest.json</span><br><span class="line">    â”œâ”€â”€ precache-manifest.4afa4365236dd3705833cb35553e2f08.js</span><br><span class="line">    â”œâ”€â”€ robots.txt</span><br><span class="line">    â”œâ”€â”€ service-worker.js</span><br><span class="line">    â””â”€â”€ asset-manifest.json</span><br></pre></td></tr></table></figure><h4 id="æ·»åŠ buildå‘½ä»¤"><a href="#æ·»åŠ buildå‘½ä»¤" class="headerlink" title="æ·»åŠ buildå‘½ä»¤"></a>æ·»åŠ buildå‘½ä»¤</h4><p>åœ¨<code>package.json</code>ä¸­æ·»åŠ buildå‘½ä»¤ï¼š</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&quot;build:main&quot;: &quot;webpack --config ./build/webpack.config.main.js&quot;,</span><br><span class="line">&quot;build:preload&quot;: &quot;webpack --config ./build/webpack.config.preload.js&quot;,</span><br><span class="line">&quot;build:renderer&quot;: &quot;cd ./renderer &amp;&amp; npm run build&quot;,</span><br><span class="line">&quot;build&quot;: &quot;cross-env NODE_ENV=production concurrently \&quot;npm run build:main\&quot; \&quot;npm run build:preload\&quot; \&quot;npm run build:renderer\&quot;&quot;</span><br></pre></td></tr></table></figure><p>å¯åŠ¨ <code>npm run build</code>ï¼Œå¯ä»¥å‘ç°outputç›®å½•ä¸‹ç”Ÿæˆäº†å¯¹åº”çš„æ–‡ä»¶ç›®å½•ã€‚</p><h4 id="å®‰è£…electron-builder"><a href="#å®‰è£…electron-builder" class="headerlink" title="å®‰è£…electron-builder"></a>å®‰è£…electron-builder</h4><p>å®‰è£…å¿…éœ€çš„ä¾èµ–é¡¹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add electron-builder -D</span><br></pre></td></tr></table></figure><p>package.jsonä¸­æ·»åŠ â€postinstallâ€å‘½ä»¤ï¼Œåœ¨å®‰è£…ä¾èµ–é¡¹åå¯ä»¥è‡ªåŠ¨å®‰è£…electron-builderçš„ä¾èµ–é¡¹</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;postinstall&quot;: &quot;electron-builder install-app-deps&quot;</span><br></pre></td></tr></table></figure><h4 id="æ·»åŠ é…ç½®æ–‡ä»¶"><a href="#æ·»åŠ é…ç½®æ–‡ä»¶" class="headerlink" title="æ·»åŠ é…ç½®æ–‡ä»¶"></a>æ·»åŠ é…ç½®æ–‡ä»¶</h4><p>åœ¨é¡¹ç›®æ ¹ç›®å½•æ·»åŠ <code>electron-builder.yml</code>ï¼Œelectron-builderä¼šé»˜è®¤è¯»å–è¯¥æ–‡ä»¶ä½œä¸ºé…ç½®æ–‡ä»¶ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">appId:</span> <span class="string">&#x27;com.my-app&#x27;</span></span><br><span class="line"><span class="attr">productName:</span> <span class="string">&#x27;My App&#x27;</span></span><br><span class="line"><span class="attr">copyright:</span> <span class="string">Copyright</span> <span class="string">Â©</span> <span class="number">2020</span> <span class="string">$&#123;author&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">directories:</span></span><br><span class="line">  <span class="attr">buildResources:</span> <span class="string">resources</span></span><br><span class="line">  <span class="attr">output:</span> <span class="string">release/$&#123;version&#125;</span></span><br><span class="line">  <span class="attr">app:</span> <span class="string">.</span></span><br><span class="line"></span><br><span class="line"><span class="attr">buildVersion:</span> <span class="number">1.0</span><span class="number">.0</span> </span><br><span class="line"><span class="attr">artifactName:</span> <span class="string">$&#123;productName&#125;-$&#123;version&#125;-$&#123;channel&#125;.$&#123;ext&#125;</span></span><br><span class="line"><span class="attr">files:</span> </span><br><span class="line">  <span class="bullet">-</span> <span class="string">output</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">resources</span></span><br><span class="line"><span class="attr">asar:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="attr">publish:</span> </span><br><span class="line">  <span class="bullet">-</span> <span class="attr">provider:</span> <span class="string">generic</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">https://update.electron-builder.com</span></span><br><span class="line">    <span class="attr">channel:</span> <span class="string">latest</span></span><br><span class="line"><span class="attr">releaseInfo:</span></span><br><span class="line">  <span class="attr">releaseName:</span> <span class="string">&#x27;A New Playground for Electron!&#x27;</span></span><br><span class="line">  <span class="attr">releaseNotes:</span> <span class="string">&#x27;Some new features now is available.&#x27;</span></span><br></pre></td></tr></table></figure><p>ç®€å•åˆ†æä¸€ä¸‹ä¸Šé¢çš„é…ç½®æ–‡ä»¶ï¼š</p><ul><li><strong>appId</strong>: åº”ç”¨idï¼Œä¸åŒå¹³å°æœ‰ä¸åŒçš„è§„åˆ™<ul><li><a href="https://developer.apple.com/library/archive/documentation/General/Reference/InfoPlistKeyReference/Articles/CoreFoundationKeys.html#//apple_ref/doc/uid/20001431-102070">MacOS</a></li><li><a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-lcid/a9eac961-e77d-41a6-90a5-ce1a8b0cdb9c?redirectedfrom=MSDN">Windows</a></li></ul></li><li><strong>directories</strong><ul><li>buildResources: æ„å»ºèµ„æºæ–‡ä»¶ç›®å½•ï¼Œä¸ä¼šæ‰“åŒ…åˆ°appä¸­ï¼Œå¦‚æœéœ€è¦æ‰“åŒ…å…¶ä¸­çš„ä¸€äº›æ–‡ä»¶æ¯”å¦‚æ‰˜ç›˜å›¾æ ‡ï¼Œéœ€è¦åœ¨fileså­—æ®µä¸­æŒ‡å®šï¼Œæ¯”å¦‚ <code>&quot;files&quot;: [&quot;**/*&quot;, &quot;build/icon.*&quot;]</code></li><li>output: æ‰“åŒ…è¾“å‡ºç›®å½•</li><li>app: åŒ…å«package.jsonçš„åº”ç”¨ç›®å½•ï¼Œé»˜è®¤ä¼šè¯»å– <code>app</code>, <code>www</code>, æˆ–å½“å‰å·¥ä½œç›®å½•ï¼Œé€šå¸¸ä¸ç”¨æŒ‡å®š </li></ul></li><li><strong>files</strong>: æŒ‡å®šéœ€è¦å¤åˆ¶è¿‡å»æ‰“åŒ…çš„æ–‡ä»¶ï¼Œ<a href="https://www.electron.build/configuration/contents#files">å‚è€ƒæ–‡æ¡£</a></li><li><strong>asar</strong>: æ˜¯å¦æ‰“åŒ…æˆasaræ¡£æ¡ˆæ–‡ä»¶, <a href="https://www.electronjs.org/docs/tutorial/application-packaging">å‚è€ƒæ–‡æ¡£</a></li><li><strong>publish</strong>: å‘å¸ƒé€‰é¡¹ï¼Œå’Œæ›´æ–°æœåŠ¡å™¨ç±»å‹ç›¸å…³ï¼Œ <a href="https://www.electron.build/configuration/publish">å‚è€ƒæ–‡æ¡£</a></li></ul><h4 id="1-4-æ·»åŠ æ‰“åŒ…å‘½ä»¤"><a href="#1-4-æ·»åŠ æ‰“åŒ…å‘½ä»¤" class="headerlink" title="1.4 æ·»åŠ æ‰“åŒ…å‘½ä»¤"></a>1.4 æ·»åŠ æ‰“åŒ…å‘½ä»¤</h4><p>åœ¨package.jsonä¸­æ·»åŠ æ‰“åŒ…å‘½ä»¤:</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&quot;pack-mac&quot;: &quot;electron-builder build --mac&quot;,</span><br><span class="line">&quot;pack-win&quot;: &quot;electron-builder build --win&quot;,</span><br><span class="line">&quot;pack-all&quot;: &quot;electron-builder build -mw&quot;,</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥å¼€å§‹æ‰“åŒ…ï¼Œé¦–å…ˆè¿è¡Œ<code>yarn run build</code>ï¼Œç¼–è¯‘æ–‡ä»¶åˆ°outputç›®å½•ï¼Œæ¥ä¸‹æ¥è¿è¡Œ<code>yarn pack-all</code>ï¼Œå¼€å§‹æ‰“åŒ…Windowså’ŒMacOSçš„åº”ç”¨ã€‚</p><p>è¿è¡Œç»“æŸåå¯ä»¥å‘ç°åœ¨releaseç›®å½•ä¸‹å‡ºç°äº†å¯¹åº”çš„ç‰ˆæœ¬æ–‡ä»¶å¤¹ï¼Œé‡Œé¢æœ‰æ‰“åŒ…å¥½çš„å®‰è£…æ–‡ä»¶å’Œæ›´æ–°å…¥å£æ–‡ä»¶ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">â””â”€â”€ 1.0.0</span><br><span class="line">    â”œâ”€â”€ My App-1.0.0-latest.dmg</span><br><span class="line">    â”œâ”€â”€ My App-1.0.0-latest.dmg.blockmap</span><br><span class="line">    â”œâ”€â”€ My App-1.0.0-latest.exe</span><br><span class="line">    â”œâ”€â”€ My App-1.0.0-latest.exe.blockmap</span><br><span class="line">    â”œâ”€â”€ My App-1.0.0-latest.zip</span><br><span class="line">    â”œâ”€â”€ builder-effective-config.yaml</span><br><span class="line">    â”œâ”€â”€ latest-mac.yml</span><br><span class="line">    â”œâ”€â”€ latest.yml</span><br><span class="line">    â”œâ”€â”€ mac</span><br><span class="line">    â””â”€â”€ win-unpacked</span><br></pre></td></tr></table></figure><h3 id="ä»£ç ç­¾å"><a href="#ä»£ç ç­¾å" class="headerlink" title="ä»£ç ç­¾å"></a>ä»£ç ç­¾å</h3><p>electron-builderæ”¯æŒMacOSå’ŒWindowsçš„ç­¾å</p><p>ä½†æ˜¯ç”±äºMacOSåº”ç”¨çš„ä»£ç ç­¾åå¿…é¡»åœ¨MacOSæœºå™¨ä¸Šå®Œæˆï¼Œè€Œä¸”MacOSå¯ä»¥è¿›è¡ŒWindowsåº”ç”¨ç­¾åï¼Œå› æ­¤å»ºè®®ä½¿ç”¨MacOSæœºå™¨è¿›è¡Œæ‰“åŒ…ç­¾åã€‚</p><h4 id="MacOSä»£ç ç­¾å"><a href="#MacOSä»£ç ç­¾å" class="headerlink" title="MacOSä»£ç ç­¾å"></a>MacOSä»£ç ç­¾å</h4><p>electronåœ¨è¿›è¡Œä»£ç ç­¾åçš„æ—¶å€™ä¼šè‡ªåŠ¨æ£€æŸ¥ç¯å¢ƒå˜é‡ä¸­çš„å¯¹åº”å­—æ®µï¼ŒåŒ…æ‹¬ï¼š</p><table><thead><tr><th>å­—æ®µ</th><th>æè¿°</th></tr></thead><tbody><tr><td><strong>CSC_LINK</strong></td><td>.p12æˆ–.pfxè¯ä¹¦æ–‡ä»¶çš„HTTPSé“¾æ¥ï¼ˆæˆ–base64ç¼–ç æ•°æ®ï¼Œæˆ–fileé“¾æ¥ï¼Œæˆ–æœ¬åœ°è·¯å¾„ï¼‰ã€‚</td></tr><tr><td><strong>CSC_KEY_PASSWORD</strong></td><td>è¯ä¹¦å¯†ç </td></tr><tr><td><strong>CSC_NAME</strong></td><td>(MacOS) login.keychainä¸­çš„è¯ä¹¦åç§°</td></tr><tr><td><strong>CSC_IDENTITY_AUTO_DISCOVERY</strong></td><td>(MacOS) MacOSä¸Šæ˜¯å¦è‡ªåŠ¨ä½¿ç”¨keychainä¸­çš„èº«ä»½</td></tr><tr><td><strong>CSC_KEYCHAIN</strong></td><td>(MacOS) keychainåç§°ã€‚å¦‚æœæœªæŒ‡å®šCSC_LINKåˆ™ä½¿ç”¨ã€‚é»˜è®¤ä¸ºç³»ç»Ÿé»˜è®¤keychainã€‚</td></tr><tr><td><strong>WIN_CSC_LINK</strong></td><td>(Windows) ç±»ä¼¼<code>CSC_LINK</code>ï¼Œåœ¨MacOSä¸Šç­¾åWindowsåº”ç”¨æ—¶ä½¿ç”¨</td></tr><tr><td><strong>WIN_CSC_KEY_PASSWORD</strong></td><td>(Windows) ç±»ä¼¼<code>CSC_KEY_PASSWORD</code>ï¼Œåœ¨MacOSä¸Šç­¾åWindowsåº”ç”¨æ—¶ä½¿ç”¨</td></tr></tbody></table><p>åœ¨MacOSä¸Šç­¾åå°±å¯ä»¥æœ‰å‡ ç§é€‰æ‹©ï¼š</p><ol><li><p>å®‰è£…å¯¹åº”çš„è¯ä¹¦åˆ°keychainï¼Œç„¶å<code>CSC_NAME</code>æŒ‡å®šä¸ºè¯ä¹¦åœ¨keychainä¸­æ˜¾ç¤ºçš„åç§°ï¼Œ<code>CSC_KEY_PASSWORD</code>è®¾ç½®ä¸ºè¯ä¹¦å¯†ç ï¼Œæ‰“åŒ…æ—¶å°±ä¼šè‡ªåŠ¨è¿›è¡Œç­¾åã€‚</p></li><li><p>å°†è¯ä¹¦æ–‡ä»¶æ”¾åœ¨å¯¹åº”ç›®å½•ï¼Œ<code>CSC_LINK</code>è®¾ç½®ä¸ºå¯¹åº”çš„è·¯å¾„ï¼Œ<code>CSC_KEY_PASSWORD</code>è®¾ç½®ä¸ºè¯ä¹¦å¯†ç å³å¯ã€‚è‹¥æ‹…å¿ƒè¯ä¹¦å’Œå¯†ç éƒ½æ”¾åœ¨é¡¹ç›®ä¸­ä¸åˆé€‚ï¼Œå¯ä»¥å»æ‰é¡¹ç›®ä¸­çš„è¯ä¹¦å¯†ç ï¼Œä¿®æ”¹æ‰“åŒ…è„šæœ¬ï¼Œæ¯æ¬¡è¿è¡Œæ‰“åŒ…å‘½ä»¤æ—¶è¾“å…¥å¯†ç å¹¶è®¾ç½®åˆ°ç¯å¢ƒå˜é‡ã€‚</p></li></ol><h4 id="Windowsä»£ç ç­¾å"><a href="#Windowsä»£ç ç­¾å" class="headerlink" title="Windowsä»£ç ç­¾å"></a>Windowsä»£ç ç­¾å</h4><ol><li>åœ¨Windowsæœºå™¨ä¸Šç­¾åï¼ŒåŒæ ·çš„æŒ‡å®š<code>CSC_LINK</code>å’Œ<code>CSC_KEY_PASSWORD</code>å³å¯</li><li>åœ¨Macæœºå™¨ä¸Šç­¾åï¼Œéœ€è¦å°†<code>CSC_LINK</code>å’Œ<code>CSC_KEY_PASSWORD</code>æ›¿æ¢ä¸º<code>WIN_CSC_LINK</code>å’Œ<code>WIN_CSC_KEY_PASSWORD</code></li></ol><p>å¦‚æœéœ€è¦ç”³è¯·Windowsä»£ç ç­¾åè¯ä¹¦ï¼Œå¯ä»¥å‚è€ƒè¿™ç¯‡<a href="https://docs.microsoft.com/zh-cn/windows-hardware/drivers/dashboard/get-a-code-signing-certificate">æ–‡æ¡£</a></p><h3 id="æ›´è¯¦ç»†çš„å¹³å°targeté…ç½®"><a href="#æ›´è¯¦ç»†çš„å¹³å°targeté…ç½®" class="headerlink" title="æ›´è¯¦ç»†çš„å¹³å°targeté…ç½®"></a>æ›´è¯¦ç»†çš„å¹³å°targeté…ç½®</h3><p>electron-builderæ”¯æŒå¤šç§ç±»å‹çš„å®‰è£…æ–‡ä»¶æ‰“åŒ…</p><ul><li>Macå¹³å°æ”¯æŒ.dmgå’Œ.pkgï¼Œ</li><li>Windowså¹³å°æ”¯æŒnsis, nsisWeb, appx, squirrelWindows</li></ul><h4 id="MacOSé…ç½®"><a href="#MacOSé…ç½®" class="headerlink" title="MacOSé…ç½®"></a>MacOSé…ç½®</h4><p>ä»¥MacOSä¸‹æ‰“åŒ….dmgæ–‡ä»¶ä¸ºä¾‹:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="attr">mac:</span></span><br><span class="line">  <span class="attr">target:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">dmg</span></span><br><span class="line">  <span class="attr">icon:</span> <span class="string">resources/icon.icns</span></span><br><span class="line">  <span class="attr">category:</span> <span class="string">public.app-category.developer-tools</span></span><br><span class="line">  <span class="attr">hardenedRuntime:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">entitlements:</span> <span class="string">resources/entitlements.mac.plist</span></span><br><span class="line">  <span class="attr">extendInfo:</span> </span><br><span class="line">    <span class="attr">NSMicrophoneUsageDescription:</span> <span class="string">è¯·å…è®¸è®¿é—®æ‚¨çš„éº¦å…‹é£</span></span><br><span class="line">    <span class="attr">NSCameraUsageDescription:</span> <span class="string">è¯·å…è®¸è®¿é—®æ‚¨çš„æ‘„åƒå¤´</span></span><br><span class="line"></span><br><span class="line"><span class="attr">dmg:</span></span><br><span class="line">  <span class="attr">background:</span> <span class="string">resources/background.png</span></span><br><span class="line">  <span class="attr">iconSize:</span> <span class="number">128</span></span><br><span class="line">  <span class="attr">iconTextSize:</span> <span class="number">13</span></span><br><span class="line">  <span class="attr">window:</span></span><br><span class="line">    <span class="attr">width:</span> <span class="number">300</span></span><br><span class="line">    <span class="attr">height:</span> <span class="number">200</span></span><br></pre></td></tr></table></figure><ul><li><strong>category</strong> åº”ç”¨åœ¨Macä¸‹çš„åˆ†ç±»ï¼Œåˆ†ç±»<a href="https://developer.apple.com/library/archive/documentation/General/Reference/InfoPlistKeyReference/Articles/LaunchServicesKeys.html#//apple_ref/doc/uid/TP40009250-SW8">å‚è€ƒæ–‡æ¡£</a></li><li><strong>hardenedRuntime</strong> åº”ç”¨æ˜¯å¦ä½¿ç”¨hardenedRuntimeè¿›è¡Œç­¾åã€‚hardenedRuntimeç”¨äºç®¡ç†macOSåº”ç”¨ç¨‹åºçš„å®‰å…¨ä¿æŠ¤å’Œèµ„æºè®¿é—®ã€‚ç›¸å…³çš„<a href="">å‚è€ƒæ–‡æ¡£</a></li><li><strong>entitlements</strong> å¯¹åº”çš„entitlements.mac.plistæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶ç”¨äºè·å–æˆæƒçš„å®šä¹‰ã€‚<a href="https://developer.apple.com/documentation/bundleresources/entitlements">å‚è€ƒæ–‡æ¡£</a></li><li><strong>extendInfo</strong> Info.plistçš„é¢å¤–æ¡ç›®ï¼Œä¸»è¦ç”¨äºé…ç½®ä¸€äº›åº”ç”¨å±æ€§ã€‚<a href="https://developer.apple.com/documentation/bundleresources/information_property_list">å‚è€ƒæ–‡æ¡£</a></li></ul><p>æ¯”å¦‚ä¸‹é¢è¿™ä¸ªentitlements.mac.plist</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">plist</span> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//Apple//DTD PLIST 1.0//EN&quot;</span> <span class="meta-string">&quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plist</span> <span class="attr">version</span>=<span class="string">&quot;1.0&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>com.apple.security.device.audio-input<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">true</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>com.apple.security.device.camera<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">true</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plist</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å£°æ˜äº†å¯¹å½•éŸ³å’Œæ‘„åƒå¤´æƒé™çš„ç”³è¯·</p><h4 id="Windowsé…ç½®"><a href="#Windowsé…ç½®" class="headerlink" title="Windowsé…ç½®"></a>Windowsé…ç½®</h4><p>ä»¥æ‰“åŒ…nsisæ–‡ä»¶ä¸ºä¾‹</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">win:</span></span><br><span class="line">  <span class="attr">target:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">target:</span> <span class="string">nsis</span></span><br><span class="line">      <span class="attr">arch:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">x64</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">ia32</span></span><br><span class="line">  <span class="attr">icon:</span> <span class="string">resources/icon.ico</span></span><br><span class="line"></span><br><span class="line"><span class="attr">nsis:</span></span><br><span class="line">  <span class="attr">oneClick:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">perMachine:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">allowToChangeInstallationDirectory:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">license:</span> <span class="string">resources/eula.txt</span></span><br><span class="line">  <span class="attr">deleteAppDataOnUninstall:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">displayLanguageSelector:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><ul><li><strong>oneClick</strong> æ˜¯å¦åˆ›å»ºä¸€ä¸ª<code>oneClick</code>å®‰è£…ç¨‹åºï¼Œå’Œé€šå¸¸çš„windowså®‰è£…ç¨‹åºä¸ä¸€æ ·ï¼Œ<code>oneClick</code>å®‰è£…ç¨‹åºç‚¹å‡»åä¼šç›´æ¥å®‰è£…ï¼Œä¸éœ€è¦ä¸€æ­¥ä¸€æ­¥é€‰æ‹©é€‰é¡¹ç„¶åç‚¹å‡»ç¡®å®šï¼Œä½†åœ¨ç”¨æˆ·ä½“éªŒæ¥è¯´å¯èƒ½ç”¨æˆ·è§‰å¾—ä¸èƒ½é€‰æ‹©å®‰è£…ç›®å½•ï¼Œç”¨æˆ·ç­‰é€‰é¡¹æœ‰äº›æµæ°“ï¼Œè€Œä¸”çœ‹ä¸åˆ°å®‰è£…è¿›åº¦ä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™å®‰è£…æˆåŠŸã€‚</li><li><strong>perMachine</strong> æ˜¯å¦æ˜¾ç¤ºå®‰è£…æ¨¡å¼ï¼Œå³é€‰æ‹©å®‰è£…ç»™æ‰€æœ‰ç”¨æˆ·æˆ–è€…å®‰è£…ç»™å½“å‰ç”¨æˆ·</li><li><strong>allowToChangeInstallationDirectory</strong> å…è®¸æ”¹å˜å®‰è£…ç›®å½•</li><li><strong>license</strong> æœ€ç»ˆç”¨æˆ·è®¸å¯åè®®ï¼Œæ”¯æŒ.txt, .rtf, .html</li><li><strong>deleteAppDataOnUninstall</strong> å¸è½½æ—¶æ¸…é™¤æ•°æ®</li><li><strong>displayLanguageSelector</strong> æ˜¯å¦æ˜¾ç¤ºè¯­è¨€é€‰æ‹©å™¨ï¼Œé€‰å¦åˆ™æ ¹æ®ç³»ç»Ÿè¯­è¨€è‡ªåŠ¨åˆ¤æ–­</li></ul><h3 id="å¤šå¹³å°çš„æ’ä»¶æ‰“åŒ…"><a href="#å¤šå¹³å°çš„æ’ä»¶æ‰“åŒ…" class="headerlink" title="å¤šå¹³å°çš„æ’ä»¶æ‰“åŒ…"></a>å¤šå¹³å°çš„æ’ä»¶æ‰“åŒ…</h3><h4 id="æ‰¾åˆ°æ’ä»¶æ‰§è¡Œæ–‡ä»¶"><a href="#æ‰¾åˆ°æ’ä»¶æ‰§è¡Œæ–‡ä»¶" class="headerlink" title="æ‰¾åˆ°æ’ä»¶æ‰§è¡Œæ–‡ä»¶"></a>æ‰¾åˆ°æ’ä»¶æ‰§è¡Œæ–‡ä»¶</h4><p>åœ¨MacOSä¸‹é€šå¸¸æ˜¯*.pluginæ–‡ä»¶ï¼ŒWindowsä¸‹ä¸º*.dllæ–‡ä»¶ï¼Œè¿™é‡Œä»¥32.0.0.414ç‰ˆæœ¬çš„flash playerä¸ºä¾‹å­ï¼Œåˆ°adobe flashå®˜ç½‘ä¸‹è½½å¹¶å®‰è£…flash playeråï¼Œå…¶ç›®å½•é€šå¸¸åœ¨</p><ul><li>MacOSï¼š /Library/Internet Plug-Ins/PepperFlashPlayer/PepperFlashPlayer.plugin</li><li>Windows: C:\Windows\SysWOW64\Macromed\Flash\pepflashplayer32_0_0_414.dll æˆ– C:\Windows\System32\Macromed\Flash\pepflashplayer64_32_0_0_414.dll</li></ul><h4 id="æ·»åŠ ç¼–è¯‘é…ç½®"><a href="#æ·»åŠ ç¼–è¯‘é…ç½®" class="headerlink" title="æ·»åŠ ç¼–è¯‘é…ç½®"></a>æ·»åŠ ç¼–è¯‘é…ç½®</h4><p>å°†æ‰¾åˆ°çš„æ’ä»¶å¤åˆ¶åˆ°é¡¹ç›®çš„pluginsç›®å½•ä¸‹ï¼Œæ ¹æ®å¹³å°åŒºåˆ†ç›®å½•ï¼Œå‡è®¾ç›®å½•å¦‚ä¸‹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">plugins</span><br><span class="line">â”œâ”€â”€ darwin</span><br><span class="line">â”‚   â””â”€â”€ PepperFlashPlayer.plugin</span><br><span class="line">â””â”€â”€ win32</span><br><span class="line">    â””â”€â”€ pepflashplayer.dll</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥åœ¨webpacké…ç½®ä¸­æ·»åŠ é…ç½®ï¼Œå¯åŠ¨ç¼–è¯‘æ—¶å¯ä»¥å°†pluginsä¸‹å¯¹åº”å¹³å°çš„æ–‡ä»¶è‡ªåŠ¨å¤åˆ¶åˆ°outputä¸‹çš„pluginsç›®å½•</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> CopyPlugin = <span class="built_in">require</span>(<span class="string">&#x27;copy-webpack-plugin&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ ¹æ®å¹³å°åˆ¤æ–­æ’ä»¶ç›®å½•</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getPluginSourceDir</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (process.platform === <span class="string">&quot;darwin&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> path.resolve(__dirname, <span class="string">&quot;..&quot;</span>, <span class="string">&quot;plugins&quot;</span>, <span class="string">&quot;darwin&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (process.platform === <span class="string">&quot;win32&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> path.resolve(__dirname, <span class="string">&quot;..&quot;</span>, <span class="string">&quot;plugins&quot;</span>, <span class="string">&quot;win32&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">`can not find plugins directory for platform <span class="subst">$&#123;process.platform&#125;</span>`</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  ...</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> CopyPlugin(&#123;</span><br><span class="line">      patterns: [</span><br><span class="line">        &#123; </span><br><span class="line">          <span class="keyword">from</span>: getPluginSourceDir(),</span><br><span class="line">          to: path.resolve(__dirname, <span class="string">&#x27;..&#x27;</span>, <span class="string">&#x27;output&#x27;</span>, <span class="string">&#x27;plugins&#x27;</span>),</span><br><span class="line">        &#125;,</span><br><span class="line">      ],</span><br><span class="line">    &#125;),</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="åŠ è½½æ’ä»¶"><a href="#åŠ è½½æ’ä»¶" class="headerlink" title="åŠ è½½æ’ä»¶"></a>åŠ è½½æ’ä»¶</h4><p>åŠ è½½æ’ä»¶éœ€è¦åœ¨appä¸­é€šè¿‡è°ƒç”¨å¯¹åº”çš„apiï¼Œå¹¶ä¸”åœ¨åˆ›å»ºBrowserWindowæ—¶å°†webPreferencesé€‰é¡¹ä¸­çš„pluginsè®¾ç½®ä¸ºtrue</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> pluginName</span><br><span class="line"><span class="keyword">switch</span> (process.platform) &#123;</span><br><span class="line">  <span class="keyword">case</span> <span class="string">&#x27;win32&#x27;</span>:</span><br><span class="line">    pluginName = <span class="string">&#x27;pepflashplayer.dll&#x27;</span></span><br><span class="line">    <span class="keyword">break</span></span><br><span class="line">  <span class="keyword">case</span> <span class="string">&#x27;darwin&#x27;</span>:</span><br><span class="line">    pluginName = <span class="string">&#x27;PepperFlashPlayer.plugin&#x27;</span></span><br><span class="line">    <span class="keyword">break</span></span><br><span class="line">&#125;</span><br><span class="line">app.commandLine.appendSwitch(<span class="string">&#x27;ppapi-flash-path&#x27;</span>, path.join(__dirname, <span class="string">&#x27;..&#x27;</span>,<span class="string">&#x27;plugins&#x27;</span>, pluginName <span class="keyword">as</span> <span class="built_in">string</span>))</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="built_in">window</span> = <span class="keyword">new</span> BrowserWindow(&#123;webPreferences: &#123;preload: PRELOAD, plugins: <span class="literal">true</span>&#125;&#125;)</span><br></pre></td></tr></table></figure><p>åŠ è½½ä¸€ä¸ªåŒ…å«flashçš„url</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.loadURL(EXAMPLE_FLASH_URL)</span><br></pre></td></tr></table></figure><p>é‡æ–°å¯åŠ¨åº”ç”¨ï¼Œå‘ç°flashå¯ä»¥æ­£å¸¸è¿è¡Œäº†</p><h4 id="åŠ è½½ç³»ç»Ÿå®‰è£…çš„-Pepper-Flash-æ’ä»¶"><a href="#åŠ è½½ç³»ç»Ÿå®‰è£…çš„-Pepper-Flash-æ’ä»¶" class="headerlink" title="åŠ è½½ç³»ç»Ÿå®‰è£…çš„ Pepper Flash æ’ä»¶"></a>åŠ è½½ç³»ç»Ÿå®‰è£…çš„ Pepper Flash æ’ä»¶</h4><p>è¿™ç§æ–¹å¼åªé€‚ç”¨äºflashæ’ä»¶ï¼Œä¸Šé¢çš„æ ¹æ®å¹³å°è·å–æ’ä»¶ï¼ŒåŠ è½½æŒ‡å®šç›®å½•ç­‰æ“ä½œéƒ½ä¸éœ€è¦äº†ï¼Œè€Œæ˜¯ç›´æ¥åŠ è½½ç³»ç»Ÿå·²ç»å®‰è£…çš„flashæ’ä»¶ï¼Œè¿™ä¹Ÿæ„å‘³ç€å¦‚æœç³»ç»Ÿæ²¡æœ‰å®‰è£…flashæ’ä»¶å°±æ— æ³•ä½¿ç”¨</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">app.commandLine.appendSwitch(<span class="string">&#x27;ppapi-flash-path&#x27;</span>, app.getPath(<span class="string">&#x27;pepperFlashSystemPlugin&#x27;</span>))</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="built_in">window</span> = <span class="keyword">new</span> BrowserWindow(&#123;webPreferences: &#123;preload: PRELOAD, plugins: <span class="literal">true</span>&#125;&#125;)</span><br></pre></td></tr></table></figure><h3 id="åˆ›å»ºå¤šå¹³å°å¤šç¯å¢ƒæ‰“åŒ…çš„å‘½ä»¤è¡Œå·¥å…·"><a href="#åˆ›å»ºå¤šå¹³å°å¤šç¯å¢ƒæ‰“åŒ…çš„å‘½ä»¤è¡Œå·¥å…·" class="headerlink" title="åˆ›å»ºå¤šå¹³å°å¤šç¯å¢ƒæ‰“åŒ…çš„å‘½ä»¤è¡Œå·¥å…·"></a>åˆ›å»ºå¤šå¹³å°å¤šç¯å¢ƒæ‰“åŒ…çš„å‘½ä»¤è¡Œå·¥å…·</h3><p>åœ¨å®é™…ä¸šåŠ¡ä¸­ï¼Œæ‰“åŒ…å¾€å¾€ä¸æ˜¯å•çº¯çš„<code>electron-builder build</code>å°±å¯ä»¥å®ç°ï¼Œå¯èƒ½ä¼šæœ‰è®¸å¤šç±»ä¼¼åŒºåˆ†ç¯å¢ƒå’Œå¹³å°ï¼Œå®šåˆ¶æ‰“åŒ…äº§å‡ºï¼Œæ‰“åŒ…åä¸Šä¼ ç­‰éœ€æ±‚ï¼Œåœ¨è¿™ç§æ—¶å€™å¯èƒ½å°±éœ€è¦åšä¸€äº›æ›´å¤æ‚çš„å·¥ä½œäº†ã€‚</p><p>æ¯”å¦‚åœ¨ä¸€ä¸ªå¸¸è§çš„ä¸šåŠ¡åœºæ™¯ï¼Œéœ€è¦å®ç°ä»¥ä¸‹åŠŸèƒ½ï¼š</p><ol><li>ç‰ˆæœ¬æ›´æ–°;</li><li>åŒæ­¥æ›´æ–°ä¿¡æ¯åˆ°CHANGELOG;</li><li>åŒºåˆ†ç¯å¢ƒæ‰“åŒ…;</li><li>åŒºåˆ†å¹³å°æ‰“åŒ…;</li><li>æ‰“åŒ…åè‡ªåŠ¨ä¸Šä¼ ;</li></ol><p>é’ˆå¯¹è¿™äº›åŠŸèƒ½åšä¸€ä¸ªæµç¨‹è®¾è®¡ï¼š</p><ol><li>è¾“å…¥ç‰ˆæœ¬å·(ä¸è¾“å…¥åˆ™è‡ªåŠ¨patch)åï¼Œæ ¡éªŒç‰ˆæœ¬å·æ˜¯å¦æ­£ç¡®ï¼Œæ›´æ–°package.json</li><li>è¾“å…¥æ›´æ–°çš„ä¿¡æ¯å’Œæ›´æ–°çš„æè¿°ï¼Œå¹¶åŒæ­¥å†™å…¥åˆ°CHANGELOG</li><li>è¯»å–ç”¨æˆ·é€‰æ‹©çš„ç¯å¢ƒï¼Œå¯ä»¥å¤šé€‰ï¼Œå¹¶åœ¨åç»­çš„æ‰“åŒ…æµç¨‹ä¸­é’ˆå¯¹ä¸åŒç¯å¢ƒå®ç°ä¸åŒçš„æ“ä½œ(ç¯å¢ƒå˜é‡æ³¨å…¥ç­‰);</li><li>è¯»å–ç”¨æˆ·é€‰æ‹©çš„å¹³å°ï¼Œå¯ä»¥å¤šé€‰ï¼Œåœ¨åç»­æ‰“åŒ…ä¸­åªæ‰“åŒ…å¯¹åº”çš„å¹³å°;</li><li>æ‰“åŒ…ç»“æŸåè‡ªåŠ¨ä¸Šä¼ åˆ°æœåŠ¡å™¨(ä»¥ftpä¸ºä¾‹);</li></ol><p>æ¥ä¸‹æ¥æ ¹æ®åŠŸèƒ½æµç¨‹è®¾è®¡æ¥åˆ’åˆ†åŠŸèƒ½æ¨¡å—ï¼š</p><ol><li>Inquirer: è¯»å–ç”¨æˆ·è¾“å…¥é¡¹å¹¶æä¾›æ ¡éªŒ;</li><li>CommandExecutor: æ‰§è¡Œå‘½ä»¤è¡Œå‘½ä»¤çš„å‡½æ•°;</li><li>JsonUpdater: æä¾›è¯»å†™æ“ä½œæ›´æ–°package.jsonå’Œpackage-lock.json;</li><li>ChangelogUpdater: æ›´æ–°CHANGELOG</li><li>Builder: ä½¿ç”¨electron-builderè¿›è¡Œæ‰“åŒ…æ“ä½œ</li><li>FileUploader: é€šè¿‡ftpè¿›è¡Œæ–‡ä»¶ä¸Šä¼ </li></ol><p>æ¥ä¸‹æ¥å®ç°è¿™äº›åŠŸèƒ½æ¨¡å—ï¼š</p><p><code>build/packaging-cli/inquirer.ts</code></p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> inquirer <span class="keyword">from</span> <span class="string">&quot;inquirer&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> envs = [<span class="string">&quot;test&quot;</span>, <span class="string">&quot;prod&quot;</span>] <span class="keyword">as</span> <span class="keyword">const</span>;</span><br><span class="line"><span class="keyword">const</span> platforms = [<span class="string">&quot;win&quot;</span>, <span class="string">&quot;mac&quot;</span>] <span class="keyword">as</span> <span class="keyword">const</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> envType = <span class="keyword">typeof</span> envs[<span class="built_in">number</span>]</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> platformType = <span class="keyword">typeof</span> platforms[<span class="built_in">number</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> options = [</span><br><span class="line">  &#123; <span class="keyword">type</span>: <span class="string">&quot;input&quot;</span>, name: <span class="string">&quot;version&quot;</span>, message: <span class="string">`ç‰ˆæœ¬å·ï¼Ÿ`</span> &#125;,</span><br><span class="line">  &#123; <span class="keyword">type</span>: <span class="string">&quot;input&quot;</span>, name: <span class="string">&quot;releaseName&quot;</span>, message: <span class="string">`æ›´æ–°æ ‡é¢˜`</span>, <span class="keyword">default</span>: <span class="string">&quot;æ›´æ–°&quot;</span> &#125;,</span><br><span class="line">  &#123; <span class="keyword">type</span>: <span class="string">&quot;editor&quot;</span>, name: <span class="string">&quot;releaseNotes&quot;</span>, message: <span class="string">`æ›´æ–°æè¿°:`</span> &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">type</span>: <span class="string">&quot;list&quot;</span>,</span><br><span class="line">    name: <span class="string">&quot;env&quot;</span>,</span><br><span class="line">    message: <span class="string">&quot;ç¯å¢ƒï¼Ÿ&quot;</span>,</span><br><span class="line">    choices: envs.map(<span class="function">(<span class="params">e</span>) =&gt;</span> (&#123; name: e, value: e &#125;)),</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">type</span>: <span class="string">&quot;list&quot;</span>,</span><br><span class="line">    name: <span class="string">&quot;platforms&quot;</span>,</span><br><span class="line">    message: <span class="string">&quot;å¹³å°ï¼Ÿ&quot;</span>,</span><br><span class="line">    choices: [</span><br><span class="line">      &#123; name: <span class="string">&quot;all&quot;</span>, value: platforms &#125;,</span><br><span class="line">      ...platforms.map(<span class="function">(<span class="params">p</span>) =&gt;</span> (&#123; name: p, value: [p] &#125;)),</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> QueryResult &#123;</span><br><span class="line">  env: envType;</span><br><span class="line">  platforms: platformType[];</span><br><span class="line">  version: <span class="built_in">string</span>;</span><br><span class="line">  releaseName: <span class="built_in">string</span>;</span><br><span class="line">  releaseNotes: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">query</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> result = <span class="keyword">await</span> inquirer.prompt&lt;QueryResult&gt;(options);</span><br><span class="line">  <span class="built_in">console</span>.log(result);</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>build/packaging-cli/command-executor.ts</code></p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; spawn &#125; <span class="keyword">from</span> <span class="string">&#x27;child_process&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">execCommand</span>(<span class="params">command: <span class="built_in">string</span>, args: <span class="built_in">string</span>[]</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> ls = spawn(command, args, &#123; stdio: <span class="string">&#x27;inherit&#x27;</span> &#125;)</span><br><span class="line"></span><br><span class="line">    ls.on(<span class="string">&#x27;error&#x27;</span>, <span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.error(error.message)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    ls.on(<span class="string">&#x27;close&#x27;</span>, <span class="function"><span class="params">code</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">`[<span class="subst">$&#123;command&#125;</span> <span class="subst">$&#123;args.join(<span class="string">&#x27; &#x27;</span>)&#125;</span>]`</span> + <span class="string">`exited with code <span class="subst">$&#123;code&#125;</span>`</span>)</span><br><span class="line">      code === <span class="number">0</span> ? resolve() : reject(code)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>build/packaging-cli/json-updater.ts</code></p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> path <span class="keyword">from</span> <span class="string">&quot;path&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; readJsonSync, writeJSONSync &#125; <span class="keyword">from</span> <span class="string">&quot;fs-extra&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> PACKAGE_JSON_PATH = path.resolve(__dirname, <span class="string">&quot;..&quot;</span>, <span class="string">&quot;..&quot;</span>, <span class="string">&quot;package.json&quot;</span>);</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> PACKAGE_JSON_LOCK_PATH = path.resolve(__dirname, <span class="string">&quot;..&quot;</span>, <span class="string">&quot;..&quot;</span>, <span class="string">&quot;package-lock.json&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¯»å–jsonå†…å®¹</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> readJSON = <span class="function">(<span class="params">path: <span class="built_in">string</span></span>) =&gt;</span> () =&gt; readJsonSync(path);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¦†å†™jsonå˜é‡</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> writeJSON = <span class="function">(<span class="params">path: <span class="built_in">string</span></span>) =&gt;</span> (vars: <span class="built_in">any</span>) =&gt; writeJSONSync(path, vars);</span><br></pre></td></tr></table></figure><p><code>build/packaging-cli/changelog-updater.ts</code></p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> fs <span class="keyword">from</span> <span class="string">&#x27;fs&#x27;</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> path <span class="keyword">from</span> <span class="string">&#x27;path&#x27;</span></span><br><span class="line"><span class="keyword">import</span> dayjs <span class="keyword">from</span> <span class="string">&#x27;dayjs&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> ChangeLog &#123;</span><br><span class="line">  version: <span class="built_in">string</span></span><br><span class="line">  releaseName: <span class="built_in">string</span></span><br><span class="line">  releaseNotes: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> CHANGE_LOG_PATH = path.resolve(__dirname, <span class="string">&#x27;..&#x27;</span>, <span class="string">&#x27;..&#x27;</span>, <span class="string">&#x27;CHANGELOG.md&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">updateChangeLog</span>(<span class="params">cl: ChangeLog</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; version, releaseName, releaseNotes &#125; = cl</span><br><span class="line">  <span class="keyword">const</span> content = <span class="string">`## ç‰ˆæœ¬ï¼š<span class="subst">$&#123;version&#125;</span></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">- <span class="subst">$&#123;dayjs().format(<span class="string">&#x27;YYYY-MM-DD hh:mm:ss&#x27;</span>)&#125;</span></span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string"><span class="subst">$&#123;releaseName&#125;</span></span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">\`\`\` </span></span><br><span class="line"><span class="string"><span class="subst">$&#123;releaseNotes&#125;</span></span></span><br><span class="line"><span class="string">\`\`\`</span></span><br><span class="line"><span class="string">`</span></span><br><span class="line"></span><br><span class="line">  fs.appendFileSync(CHANGE_LOG_PATH, content)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>build/packaging-cli/builder.ts</code></p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; envType, platformType &#125; <span class="keyword">from</span> <span class="string">&quot;./inquirer&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; execCommand &#125; <span class="keyword">from</span> <span class="string">&quot;./command-executor&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">build</span>(<span class="params">env: envType, platforms: platformType[]</span>) </span>&#123;</span><br><span class="line">  process.env.ENV = env;</span><br><span class="line">  <span class="keyword">await</span> execCommand(<span class="string">`npm`</span>, [<span class="string">&quot;run&quot;</span>, <span class="string">&quot;build&quot;</span>]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> buildArgs = [<span class="string">&quot;build&quot;</span>];</span><br><span class="line">  <span class="keyword">if</span> (platforms.includes(<span class="string">&quot;win&quot;</span>)) buildArgs.push(<span class="string">&quot;--win&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> (platforms.includes(<span class="string">&quot;mac&quot;</span>)) buildArgs.push(<span class="string">&quot;--mac&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">await</span> execCommand(<span class="string">`electron-builder`</span>, buildArgs);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> FTPClient <span class="keyword">from</span> <span class="string">&quot;ftp&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> path <span class="keyword">from</span> <span class="string">&quot;path&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> fs <span class="keyword">from</span> <span class="string">&quot;fs&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> clientConfig = &#123;</span><br><span class="line">  host: <span class="string">&quot;host.to.your.server&quot;</span>,</span><br><span class="line">  port: <span class="number">60021</span>,</span><br><span class="line">  user: <span class="string">&quot;username&quot;</span>,</span><br><span class="line">  password: <span class="string">&quot;password&quot;</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Client = <span class="keyword">new</span> FTPClient();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">connectClient</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    Client.on(<span class="string">&quot;ready&quot;</span>, resolve);</span><br><span class="line">    Client.on(<span class="string">&quot;error&quot;</span>, reject);</span><br><span class="line">    Client.connect(clientConfig);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">putFile</span>(<span class="params">file: <span class="built_in">string</span>, dest: <span class="built_in">string</span></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    Client.put(file, dest, <span class="function">(<span class="params">err</span>) =&gt;</span> (err ? reject(err) : resolve()));</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">uploadDir</span>(<span class="params">dir: <span class="built_in">string</span>, dest: <span class="built_in">string</span></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">await</span> connectClient();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> task: [<span class="built_in">string</span>, <span class="built_in">string</span>][] = fs</span><br><span class="line">    .readdirSync(dir)</span><br><span class="line">    .map(<span class="function">(<span class="params">f</span>) =&gt;</span> path.resolve(dir, f))</span><br><span class="line">    .filter(<span class="function">(<span class="params">f</span>) =&gt;</span> fs.statSync(f).isFile())</span><br><span class="line">    .map(<span class="function">(<span class="params">f</span>) =&gt;</span> ([f, <span class="string">`<span class="subst">$&#123;dest&#125;</span>/<span class="subst">$&#123;path.basename(f)&#125;</span>`</span>]));</span><br><span class="line"></span><br><span class="line">  <span class="keyword">await</span> <span class="built_in">Promise</span>.all(task.map(<span class="function">(<span class="params">[src, dest]</span>) =&gt;</span> putFile(src, dest)));</span><br><span class="line"></span><br><span class="line">  Client.end();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€åæ˜¯packaging-cliè„šæœ¬çš„å…¥å£æ–‡ä»¶ï¼Œç»Ÿé¢†æ•´ä¸ªæ‰“åŒ…æµç¨‹;</p><p><code>build/packaging-cli/index.ts</code></p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; query &#125; <span class="keyword">from</span> <span class="string">&quot;./inquirer&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; readJSON, PACKAGE_JSON_PATH &#125; <span class="keyword">from</span> <span class="string">&quot;./json-updater&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; execCommand &#125; <span class="keyword">from</span> <span class="string">&quot;./command-executor&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; updateChangeLog &#125; <span class="keyword">from</span> <span class="string">&quot;./changelog-updater&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; build &#125; <span class="keyword">from</span> <span class="string">&quot;./builder&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> path <span class="keyword">from</span> <span class="string">&quot;path&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; uploadDir &#125; <span class="keyword">from</span> <span class="string">&quot;./file-uploader&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> RELEASE_DIR = path.resolve(__dirname, <span class="string">&quot;..&quot;</span>, <span class="string">&quot;..&quot;</span>, <span class="string">&quot;release&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">startPackaging</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> &#123; version, env, platforms, releaseName, releaseNotes &#125; = <span class="keyword">await</span> query();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ›´æ–°ç‰ˆæœ¬å·</span></span><br><span class="line">  <span class="keyword">await</span> execCommand(<span class="string">&quot;npm&quot;</span>, [<span class="string">&quot;version&quot;</span>, version ? version : <span class="string">&quot;patch&quot;</span>]);</span><br><span class="line">  version = readJSON(PACKAGE_JSON_PATH)().version;</span><br><span class="line">  <span class="comment">// æ›´æ–°CHANGELOG</span></span><br><span class="line">  updateChangeLog(&#123; version, releaseName, releaseNotes &#125;);</span><br><span class="line">  <span class="comment">// å¼€å§‹æ‰“åŒ…</span></span><br><span class="line">  <span class="keyword">await</span> build(env, platforms);</span><br><span class="line">  <span class="comment">// ä¸Šä¼ æ–‡ä»¶</span></span><br><span class="line">  <span class="keyword">await</span> uploadDir(path.resolve(RELEASE_DIR, version), <span class="string">&quot;test-app-temp&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">startPackaging();</span><br></pre></td></tr></table></figure><p>åœ¨package.jsonä¸­æ·»åŠ å‘½ä»¤</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;pack&quot;: &quot;ts-node ./build/packaging-cli/index.ts&quot;,</span><br></pre></td></tr></table></figure><p>è¿è¡Œ<code>yarn run pack</code>å³å¯å¼€å§‹æ‰“åŒ…</p><h2 id="è‡ªåŠ¨æ›´æ–°"><a href="#è‡ªåŠ¨æ›´æ–°" class="headerlink" title="è‡ªåŠ¨æ›´æ–°"></a>è‡ªåŠ¨æ›´æ–°</h2><p>å‰é¢æ‰“åŒ…æµç¨‹åŸºäºElectron-Builderï¼Œå› æ­¤ä»¥ä¸‹çš„æ›´æ–°è®¨è®ºä¹Ÿæ˜¯åŸºäºå…¶æä¾›çš„<a href="">electron-updater</a>ã€‚</p><h3 id="å…³äºelectron-updater"><a href="#å…³äºelectron-updater" class="headerlink" title="å…³äºelectron-updater"></a>å…³äºelectron-updater</h3><h4 id="é€‚ç”¨åœºæ™¯"><a href="#é€‚ç”¨åœºæ™¯" class="headerlink" title="é€‚ç”¨åœºæ™¯"></a>é€‚ç”¨åœºæ™¯</h4><p>electron-updateråªé€‚ç”¨äºä»¥ä¸‹ç±»å‹çš„åº”ç”¨åŒ…ï¼š</p><ul><li>MacOS: DMG</li><li>Windows: NSIS</li><li>Linux: AppImage</li></ul><h4 id="æä¾›çš„API"><a href="#æä¾›çš„API" class="headerlink" title="æä¾›çš„API"></a>æä¾›çš„API</h4><p><a href="https://www.electron.build/auto-update#api">æ–‡æ¡£</a></p><table><thead><tr><th>APIæ–¹æ³•</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td><code>checkForUpdates()</code></td><td>æ£€æŸ¥æ›´æ–°</td></tr><tr><td><code>checkForUpdatesAndNotify()</code></td><td>æ£€æŸ¥æ›´æ–°ï¼Œæœ‰æ›´æ–°åˆ™æç¤º</td></tr><tr><td><code>downloadUpdate(cancellationToken)</code></td><td>ä¸‹è½½æ›´æ–°</td></tr><tr><td><code>getFeedURL()</code></td><td>è·å–æ›´æ–°æœåŠ¡é“¾æ¥</td></tr><tr><td><code>setFeedURL(options)</code></td><td>è®¾ç½®æ›´æ–°æœåŠ¡é“¾æ¥</td></tr><tr><td><code>quitAndInstall(isSilent, isForceRunAfter)</code></td><td>é€€å‡ºåº”ç”¨å¹¶å®‰è£…æ›´æ–°</td></tr></tbody></table><h4 id="æä¾›çš„äº‹ä»¶"><a href="#æä¾›çš„äº‹ä»¶" class="headerlink" title="æä¾›çš„äº‹ä»¶"></a>æä¾›çš„äº‹ä»¶</h4><p><a href="https://www.electron.build/auto-update#events">æ–‡æ¡£</a></p><table><thead><tr><th>äº‹ä»¶</th><th>è§¦å‘</th></tr></thead><tbody><tr><td>error</td><td>æ›´æ–°é”™è¯¯</td></tr><tr><td>checking-for-update</td><td>æ£€æŸ¥æ›´æ–°ä¸­</td></tr><tr><td>update-available</td><td>æœ‰å¯ç”¨æ›´æ–°</td></tr><tr><td>update-not-available</td><td>æ²¡æœ‰å¯ç”¨æ›´æ–°</td></tr><tr><td>download-progress</td><td>ä¸‹è½½æ›´æ–°ä¸­</td></tr><tr><td>update-downloaded</td><td>æ›´æ–°ä¸‹è½½å®Œæˆ</td></tr></tbody></table><h4 id="ä¸€ä¸ªç®€å•çš„æ›´æ–°ç¤ºä¾‹"><a href="#ä¸€ä¸ªç®€å•çš„æ›´æ–°ç¤ºä¾‹" class="headerlink" title="ä¸€ä¸ªç®€å•çš„æ›´æ–°ç¤ºä¾‹"></a>ä¸€ä¸ªç®€å•çš„æ›´æ–°ç¤ºä¾‹</h4><p>åœ¨ä¸»è¿›ç¨‹ç›‘å¬æ£€æŸ¥æ›´æ–°äº‹ä»¶</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; autoUpdater &#125; <span class="keyword">from</span> <span class="string">&#x27;electron-updater&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; ipcMain &#125; <span class="keyword">from</span> <span class="string">&#x27;electron&#x27;</span></span><br><span class="line"></span><br><span class="line">ipcMain.on(<span class="string">&#x27;CHECK_FOR_UPDATE&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  autoUpdater.checkForUpdatesAndNotify()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>åœ¨æ¸²æŸ“è¿›ç¨‹ç‚¹å‡»æŒ‰é’®å‘é€ipcäº‹ä»¶æ£€æŸ¥æ›´æ–°(ä»¥Reactä¸ºä¾‹)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">import React from &#39;react&#39;;</span><br><span class="line">import &#123; ipcRenderer &#125; from &#39;electron&#39;</span><br><span class="line">import &#39;.&#x2F;App.css&#39;;</span><br><span class="line"></span><br><span class="line">function App() &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;div className&#x3D;&quot;App&quot;&gt;</span><br><span class="line">      &lt;button onClick&#x3D;&#123;ipcRenderer.send(&#39;CHECK_FOR_UPDATE&#39;)&#125;&gt;æ£€æŸ¥æ›´æ–°&lt;&#x2F;button&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default App;</span><br></pre></td></tr></table></figure><p>æ³¨æ„åˆ›å»ºBrowserWindowæ—¶éœ€è¦è®¾ç½®webPreferenceså±æ€§</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="built_in">window</span> = <span class="keyword">new</span> BrowserWindow(&#123;</span><br><span class="line">  webPreferences: &#123;</span><br><span class="line">    webSecurity: <span class="literal">false</span>,</span><br><span class="line">    nodeIntegration: <span class="literal">true</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="æ›´æ–°æœåŠ¡çš„è®¾è®¡"><a href="#æ›´æ–°æœåŠ¡çš„è®¾è®¡" class="headerlink" title="æ›´æ–°æœåŠ¡çš„è®¾è®¡"></a>æ›´æ–°æœåŠ¡çš„è®¾è®¡</h3><p>ä¸Šé¢å¯¥å¯¥å‡ è¡Œä»£ç å°±å®ç°äº†ä¸€ä¸ªç®€å•çš„æ›´æ–°åŠŸèƒ½ï¼Œä½†æ˜¯è¿™ä¸ªåŠŸèƒ½åœ¨å¤æ‚çš„ä¸šåŠ¡åœºæ™¯ä¸­å¾€å¾€æ²¡æœ‰é‚£ä¹ˆé€‚åˆï¼Œå› æ­¤æˆ‘ä»¬åœ¨è¿™é‡Œå¼€å§‹æ¥è®¾è®¡ä¸€ä¸ªè´´åˆå¸¸è§åœºæ™¯çš„æ›´æ–°æ–¹æ¡ˆã€‚</p><h4 id="éœ€è¦å®ç°çš„åŠŸèƒ½"><a href="#éœ€è¦å®ç°çš„åŠŸèƒ½" class="headerlink" title="éœ€è¦å®ç°çš„åŠŸèƒ½"></a>éœ€è¦å®ç°çš„åŠŸèƒ½</h4><ol><li>æŸ¥çœ‹æ›´æ–°ä¿¡æ¯</li><li>ç”¨æˆ·æ‰‹åŠ¨æ£€æŸ¥æ›´æ–°;</li><li>åº”ç”¨å¯åŠ¨æ—¶é™é»˜æ£€æŸ¥æ›´æ–°;</li><li>åº”ç”¨åœ¨åå°å®šæ—¶æ£€æŸ¥æ›´æ–°;</li><li>ç”¨æˆ·æ‰‹åŠ¨ä¸‹è½½æ›´æ–°;</li><li>ä¸‹è½½è¿›åº¦æ˜¾ç¤º;</li><li>ç”¨æˆ·æ‰‹åŠ¨é€€å‡ºå®‰è£…æ›´æ–°;</li><li>é€šè¿‡ç‰ˆæœ¬å·æ§åˆ¶å¼ºåˆ¶æ›´æ–°; </li><li>æ—¥å¿—;</li><li>å¼€å‘æ—¶è¯·æ±‚æœ¬åœ°æœåŠ¡åšæµ‹è¯•;</li></ol><h4 id="æ›´æ–°æµç¨‹"><a href="#æ›´æ–°æµç¨‹" class="headerlink" title="æ›´æ–°æµç¨‹"></a>æ›´æ–°æµç¨‹</h4><p>æ›´æ–°è¿‡ç¨‹çš„æ‰€æœ‰çŠ¶æ€:</p><table><thead><tr><th>çŠ¶æ€</th><th>æè¿°</th></tr></thead><tbody><tr><td>Idle</td><td>ç©ºé—²</td></tr><tr><td>Checking</td><td>æ£€æŸ¥ä¸­</td></tr><tr><td>Available</td><td>æœ‰å¯ä¸‹è½½æ›´æ–°</td></tr><tr><td>Downloading</td><td>ä¸‹è½½ä¸­</td></tr><tr><td>Downloaded</td><td>ä¸‹è½½å®Œæˆ</td></tr></tbody></table><p>çŠ¶æ€æµç¨‹å¦‚å›¾</p><p><img src= "/img/loading.gif" data-lazy-src="http://mei160.cn/images/auto_update_workflow.png" alt="auto update workflow"></p><h4 id="æ¥å£è®¾è®¡"><a href="#æ¥å£è®¾è®¡" class="headerlink" title="æ¥å£è®¾è®¡"></a>æ¥å£è®¾è®¡</h4><p>æ ¹æ®ä¸Šè¿°åŠŸèƒ½ï¼Œå¯¹æ›´æ–°æœåŠ¡åšä¸€ä¸ªåˆæ­¥çš„è®¾è®¡</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// app/updater.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; autoUpdater, UpdateInfo &#125; <span class="keyword">from</span> <span class="string">&#x27;electron-updater&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> CheckResult&#123;</span><br><span class="line">  <span class="comment">// æ˜¯å¦æœ‰æ›´æ–°</span></span><br><span class="line">  available: <span class="built_in">boolean</span></span><br><span class="line">  <span class="comment">// æ›´æ–°å†…å®¹</span></span><br><span class="line">  updateInfo: UpdateInfo</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> ProgressInfo &#123;</span><br><span class="line">  total: <span class="built_in">number</span></span><br><span class="line">  delta: <span class="built_in">number</span></span><br><span class="line">  transferred: <span class="built_in">number</span></span><br><span class="line">  percent: <span class="built_in">number</span></span><br><span class="line">  bytesPerSecond: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸‹è½½è¿›åº¦å›è°ƒ</span></span><br><span class="line"><span class="keyword">type</span> DownloadProgressCallback = <span class="function">(<span class="params">p: ProgressInfo</span>) =&gt;</span> <span class="built_in">void</span></span><br><span class="line"><span class="comment">// ä¸‹è½½ç»“æŸå›è°ƒ</span></span><br><span class="line"><span class="keyword">type</span> DownloadedCallback = <span class="function">() =&gt;</span> <span class="built_in">void</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">abstract</span> <span class="keyword">class</span> AppUpdateService &#123;</span><br><span class="line">  <span class="comment">// æ£€æŸ¥æ›´æ–°</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">abstract</span> checkUpdate(): CheckResult</span><br><span class="line">  <span class="comment">// ä¸‹è½½æ›´æ–°</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">abstract</span> downloadUpdate(params: &#123;onDownloadProgress: DownloadProgressCallback, onDownloaded: DownloadedCallback &#125;): <span class="built_in">void</span></span><br><span class="line">  <span class="comment">// åº”ç”¨æ›´æ–°</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">abstract</span> applyUpdate(): <span class="built_in">void</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯ç”±äºipcé€šä¿¡çš„é™åˆ¶ï¼Œæ— æ³•ä¼ é€’å›è°ƒå‡½æ•°ï¼Œå› æ­¤æˆ‘ä»¬åœ¨è¿™é‡Œè€ƒè™‘å°†æ›´æ–°æœåŠ¡çš„ä¸šåŠ¡åŠŸèƒ½å°è£…éƒ½ç§»åˆ°æ¸²æŸ“è¿›ç¨‹ï¼Œä¸»è¿›ç¨‹åªæä¾›åŸºæœ¬çš„åˆå§‹åŒ–æœåŠ¡å’Œæ¥å£æ–¹æ³•çš„å°è£…ã€‚</p><p><code>app/updater.ts</code></p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; autoUpdater &#125; <span class="keyword">from</span> <span class="string">&quot;electron-updater&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> logger <span class="keyword">from</span> <span class="string">&quot;electron-log&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; BrowserWindow, ipcMain, app &#125; <span class="keyword">from</span> <span class="string">&#x27;electron&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkUpdate</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> autoUpdater.checkForUpdates();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">downloadUpdate</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> autoUpdater.downloadUpdate();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">applyUpdate</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> autoUpdater.quitAndInstall();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sendToAllBrowserWindows</span>(<span class="params">channel: <span class="built_in">string</span>, ...args: unknown[]</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> browserWindows = BrowserWindow.getAllWindows()</span><br><span class="line">  browserWindows.forEach(<span class="function"><span class="params">bw</span>=&gt;</span>bw.webContents.send(channel, ...args))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">init</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// æ—¥å¿—</span></span><br><span class="line">  logger.transports.file.level = <span class="string">&quot;info&quot;</span>;</span><br><span class="line">  autoUpdater.logger = logger;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ç¦ç”¨è‡ªåŠ¨ä¸‹è½½</span></span><br><span class="line">  autoUpdater.autoDownload = <span class="literal">false</span>;</span><br><span class="line">  <span class="comment">// å¯ç”¨é€€å‡ºappæ—¶è‡ªåŠ¨å®‰è£…æ›´æ–°</span></span><br><span class="line">  autoUpdater.autoInstallOnAppQuit = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ç›‘å¬äº‹ä»¶å¹¶å‘é€åˆ°æ¸²æŸ“è¿›ç¨‹</span></span><br><span class="line">  <span class="keyword">const</span> events = [</span><br><span class="line">    <span class="string">&quot;error&quot;</span>,</span><br><span class="line">    <span class="string">&quot;checking-for-update&quot;</span>,</span><br><span class="line">    <span class="string">&quot;update-available&quot;</span>,</span><br><span class="line">    <span class="string">&quot;update-not-available&quot;</span>,</span><br><span class="line">    <span class="string">&quot;download-progress&quot;</span>,</span><br><span class="line">    <span class="string">&quot;update-downloaded&quot;</span>,</span><br><span class="line">  ]</span><br><span class="line">  events.forEach(<span class="function">(<span class="params">eventName</span>) =&gt;</span> autoUpdater.on(eventName, sendToAllBrowserWindows.bind(<span class="literal">null</span>, <span class="string">&#x27;APP_UPDATER/STATUS_CHANGE&#x27;</span>)));</span><br><span class="line"></span><br><span class="line">  <span class="comment">// é€šè¿‡æ¥æ”¶æ¸²æŸ“è¿›ç¨‹å‘é€çš„ipcè°ƒç”¨æ–¹æ³•</span></span><br><span class="line">  ipcMain.on(<span class="string">&#x27;APP_UPDATER/CHECK_UPDATE&#x27;</span>, checkUpdate)</span><br><span class="line">  ipcMain.on(<span class="string">&#x27;APP_UPDATER/DOWNLOAD_UPDATE&#x27;</span>, downloadUpdate)</span><br><span class="line">  ipcMain.on(<span class="string">&#x27;APP_UPDATER/APPLY_UPDATE&#x27;</span>, applyUpdate)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">app.once(<span class="string">&#x27;will-finish-launching&#x27;</span>, init)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> AppUpdater = &#123;</span><br><span class="line">  checkUpdate,</span><br><span class="line">  downloadUpdate,</span><br><span class="line">  applyUpdate,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨æ¸²æŸ“è¿›ç¨‹ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰hooksæ¥å®ç°æ¥æ”¶æ›´æ–°çŠ¶æ€å˜æ›´å¹¶é€šè¿‡<code>createContext</code>æ¥å®ç°ç»„ä»¶çŠ¶æ€å…±äº«ã€‚<br><code>renderer/src/Hooks/useAppUpdate.js</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; useState, useEffect, useContext, createContext &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; ipcRenderer &#125; <span class="keyword">from</span> <span class="string">&quot;electron&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">useAppUpdate</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> [status, setStatus] = useState(<span class="literal">null</span>);</span><br><span class="line">  <span class="keyword">const</span> [updateInfo, setUpdateInfo] = useState(<span class="literal">null</span>);</span><br><span class="line">  <span class="keyword">const</span> [updateProgressInfo, setUpdateProgressInfo] = useState(<span class="literal">null</span>);</span><br><span class="line">  <span class="keyword">const</span> [error, setError] = useState(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> checkUpdate = <span class="function">() =&gt;</span> ipcRenderer.send(<span class="string">&#x27;APP_UPDATER/CHECK_UPDATE&#x27;</span>)</span><br><span class="line">  <span class="keyword">const</span> downloadUpdate = <span class="function">() =&gt;</span> ipcRenderer.send(<span class="string">&#x27;APP_UPDATER/DOWNLOAD_UPDATE&#x27;</span>)</span><br><span class="line">  <span class="keyword">const</span> applyUpdate = <span class="function">() =&gt;</span> ipcRenderer.send(<span class="string">&#x27;APP_UPDATER/APPLY_UPDATE&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  useEffect(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    ipcRenderer.on(<span class="string">&quot;APP_UPDATER/STATUS_CHANGE&quot;</span>, <span class="function">(<span class="params">event, updateEventName, ...args</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`updater#<span class="subst">$&#123;updateEventName&#125;</span>: `</span>, ...args);</span><br><span class="line"></span><br><span class="line">        setStatus(updateEventName);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">switch</span> (updateEventName) &#123;</span><br><span class="line">          <span class="keyword">case</span> <span class="string">&quot;error&quot;</span>:</span><br><span class="line">            setError(args[<span class="number">0</span>]);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          <span class="keyword">case</span> <span class="string">&quot;checking-for-update&quot;</span>:</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          <span class="keyword">case</span> <span class="string">&quot;update-available&quot;</span>:</span><br><span class="line">            setUpdateInfo(args[<span class="number">0</span>]);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          <span class="keyword">case</span> <span class="string">&quot;update-not-available&quot;</span>:</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          <span class="keyword">case</span> <span class="string">&quot;download-progress&quot;</span>:</span><br><span class="line">            setUpdateProgressInfo(args[<span class="number">0</span>]);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          <span class="keyword">case</span> <span class="string">&quot;update-downloaded&quot;</span>:</span><br><span class="line">            setUpdateInfo(args[<span class="number">0</span>]);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    );</span><br><span class="line">  &#125;, []);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123; </span><br><span class="line">    status, updateInfo, updateProgressInfo, error, </span><br><span class="line">    checkUpdate, downloadUpdate, applyUpdate,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> UpdaterContext = createContext();</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> UpdaterProvider = <span class="function">(<span class="params">&#123; children &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> state = useAppUpdate();</span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">UpdaterContext.Provider</span> <span class="attr">value</span>=<span class="string">&#123;state&#125;</span>&gt;</span>&#123;children&#125;<span class="tag">&lt;/<span class="name">UpdaterContext.Provider</span>&gt;</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">useUpdaterContext</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">const</span> store = useContext(UpdaterContext)</span><br><span class="line">  <span class="keyword">return</span> store</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ–°å»ºä¸€ä¸ªAboutPanelç»„ä»¶ï¼Œåœ¨ç»„ä»¶ä¸­æ˜¾ç¤ºæ›´æ–°ä¿¡æ¯ä¸‹è½½è¿›åº¦ï¼Œå·²ç»æ›´æ–°æŒ‰é’®ç­‰<br><code>renderer/src/Components/AboutPanel/index.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123;useMemo&#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useUpdaterContext &#125; <span class="keyword">from</span> <span class="string">&#x27;../../Hooks/useAppUpdate&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">AboutPanel</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; </span><br><span class="line">    status, updateInfo, updateProgressInfo, error, </span><br><span class="line">    checkUpdate, downloadUpdate, applyUpdate,</span><br><span class="line">   &#125; = useUpdaterContext()</span><br><span class="line"></span><br><span class="line">   <span class="keyword">const</span> Button = useMemo(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(status === <span class="string">&#x27;update-available&#x27;</span>)&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;downloadUpdate&#125;</span>&gt;</span>Download Updates<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(status === <span class="string">&#x27;download-progress&#x27;</span>)&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">button</span>&gt;</span>Downloading...<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(status === <span class="string">&#x27;update-downloaded&#x27;</span>)&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;applyUpdate&#125;</span>&gt;</span>Apply Updates<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;checkUpdate&#125;</span>&gt;</span>Check for Updates<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">   &#125;, [status])</span><br><span class="line"></span><br><span class="line">   <span class="keyword">const</span> Info = useMemo(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">     <span class="keyword">if</span>(status === <span class="string">&#x27;error&#x27;</span>)&#123;</span><br><span class="line">       <span class="built_in">console</span>.log(<span class="string">&#x27;error&#x27;</span>,error)</span><br><span class="line">       <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;&gt;</span> </span></span><br><span class="line"><span class="xml">          <span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">&#123;&#123;color:</span> &#x27;<span class="attr">lightpink</span>&#x27;&#125;&#125;&gt;</span>&#123;error?.name&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span> </span></span><br><span class="line"><span class="xml">          <span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">&#123;&#123;color:</span> &#x27;<span class="attr">lightpink</span>&#x27;&#125;&#125;&gt;</span>&#123;error?.message&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span> </span></span><br><span class="line"><span class="xml">          <span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">&#123;&#123;color:</span> &#x27;<span class="attr">lightpink</span>&#x27;&#125;&#125;&gt;</span>&#123;error?.stack&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span> </span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">if</span>(status === <span class="string">&#x27;checking-for-update&#x27;</span>)&#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Checking...<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line">     &#125;</span><br><span class="line">    <span class="keyword">if</span>(status ===<span class="string">&#x27;update-not-available&#x27;</span>)&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>No Updates Available<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(updateInfo)&#123;</span><br><span class="line">      <span class="keyword">const</span> &#123;version, releaseName, releaseNotes, releaseDate&#125; = updateInfo</span><br><span class="line">      <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>version: &#123;version&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>date: &#123;releaseDate&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>name: &#123;releaseName&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>notes: &#123;releaseNotes&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">   &#125;, [status, updateInfo, error])</span><br><span class="line"></span><br><span class="line">   <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">      &#123;Info&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">      &#123;</span></span><br><span class="line"><span class="xml">        status === &#x27;download-progress&#x27; &amp;&amp; Boolean(updateProgressInfo) &amp;&amp; </span></span><br><span class="line">        &lt;div style=&#123;&#123;backgroundColor: &#x27;grey&#x27;, width: 300, height: 20, margin: &#x27;12px auto&#x27;&#125;&#125;&gt;</span><br><span class="line">          &lt;div style=&#123;&#123;backgroundColor: &#x27;cornflowerblue&#x27;, height: 20, width: 300 * updateProgressInfo.percent / 100&#125;&#125;&gt;&lt;/div&gt;</span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">      &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">      &#123;Button&#125;</span></span><br><span class="line"><span class="xml">   <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ–°å»ºä¸€ä¸ªUpdateCheckerç»„ä»¶ï¼Œåœ¨è¿™ä¸ªç»„ä»¶ä¸­åšé™é»˜æ£€æŸ¥ã€å®šæ—¶æ£€æŸ¥å’Œæ›´æ–°æç¤º<br><code>renderer/src/Components/UpdateChecker/index.jsx</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useAppUpdate &#125; <span class="keyword">from</span> <span class="string">&#x27;../../Hooks/useAppUpdate&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">UpdateChecker</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">const</span> &#123;checkUpdate, downloadUpdate, applyUpdate, updateInfo, status, updateProgressInfo&#125; = useAppUpdate()</span><br><span class="line"></span><br><span class="line">  useEffect(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> timeout</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">scheduleCheckUpdate</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      <span class="keyword">if</span>(![<span class="string">&#x27;checking-for-update&#x27;</span>, <span class="string">&#x27;update-available&#x27;</span>, <span class="string">&#x27;download-progress&#x27;</span>, <span class="string">&#x27;update-downloaded&#x27;</span>].includes(status))&#123;</span><br><span class="line">        checkUpdate()</span><br><span class="line">      &#125;</span><br><span class="line">      timeout = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        scheduleCheckUpdate()</span><br><span class="line">      &#125;, <span class="number">1000</span> * <span class="number">60</span> *<span class="number">60</span>);  </span><br><span class="line">    &#125;</span><br><span class="line">    scheduleCheckUpdate()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> <span class="built_in">clearTimeout</span>(timeout)</span><br><span class="line">  &#125;, [])</span><br><span class="line"></span><br><span class="line">  useEffect(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(status === <span class="string">&#x27;update-available&#x27;</span>)&#123;</span><br><span class="line">  <span class="comment">// eslint-disable-next-line no-restricted-globals</span></span><br><span class="line">      <span class="keyword">const</span> result = confirm(<span class="string">&#x27;Updates available, download instantly?&#x27;</span>)</span><br><span class="line">      <span class="keyword">if</span>(result)&#123;</span><br><span class="line">        downloadUpdate()</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(status === <span class="string">&#x27;update-downloaded&#x27;</span>)&#123;</span><br><span class="line">  <span class="comment">// eslint-disable-next-line no-restricted-globals</span></span><br><span class="line">      <span class="keyword">const</span> result = confirm(<span class="string">&#x27;Download completed, apply updates?&#x27;</span>)</span><br><span class="line">      <span class="keyword">if</span>(result)&#123;</span><br><span class="line">        applyUpdate()</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, [status])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸€ä¸ªåŸºæœ¬çš„è‡ªåŠ¨æ›´æ–°æœåŠ¡å°±å®Œæˆäº†</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å·¥ç¨‹åŒ–&quot;&gt;&lt;a href=&quot;#å·¥ç¨‹åŒ–&quot; class=&quot;headerlink&quot; title=&quot;å·¥ç¨‹åŒ–&quot;&gt;&lt;/a&gt;å·¥ç¨‹åŒ–&lt;/h1&gt;&lt;h2 id=&quot;å®‰å…¨æ€§&quot;&gt;&lt;a href=&quot;#å®‰å…¨æ€§&quot; class=&quot;headerlink&quot; title=&quot;å®‰å…¨æ€§&quot;&gt;&lt;/a&gt;å®‰å…¨æ€§&lt;/h</summary>
      
    
    
    
    <category term="electron" scheme="https://hard-workingrookie.github.io/categories/electron/"/>
    
    
    <category term="electron" scheme="https://hard-workingrookie.github.io/tags/electron/"/>
    
  </entry>
  
  <entry>
    <title>react+tså­¦ä¹ é¡¹ç›®åŠç¬”è®°</title>
    <link href="https://hard-workingrookie.github.io/2020/12/29/react-ts%E5%AD%A6%E4%B9%A0%E9%A1%B9%E7%9B%AE%E5%8F%8A%E7%AC%94%E8%AE%B0/"/>
    <id>https://hard-workingrookie.github.io/2020/12/29/react-ts%E5%AD%A6%E4%B9%A0%E9%A1%B9%E7%9B%AE%E5%8F%8A%E7%AC%94%E8%AE%B0/</id>
    <published>2020-12-29T08:40:32.000Z</published>
    <updated>2020-12-29T08:56:55.832Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ä½¿ç”¨-envæ–‡ä»¶é…ç½®å…¨å±€ç¯å¢ƒå˜é‡"><a href="#ä½¿ç”¨-envæ–‡ä»¶é…ç½®å…¨å±€ç¯å¢ƒå˜é‡" class="headerlink" title="ä½¿ç”¨.envæ–‡ä»¶é…ç½®å…¨å±€ç¯å¢ƒå˜é‡"></a>ä½¿ç”¨.envæ–‡ä»¶é…ç½®å…¨å±€ç¯å¢ƒå˜é‡</h1><p>.env å…¨å±€é»˜è®¤é…ç½®æ–‡ä»¶ï¼Œä¸è®ºä»€ä¹ˆç¯å¢ƒéƒ½ä¼šåŠ è½½åˆå¹¶</p><p>.env.development å¼€å‘ç¯å¢ƒä¸‹çš„é…ç½®æ–‡ä»¶</p><p>.env.production ç”Ÿäº§ç¯å¢ƒä¸‹çš„é…ç½®æ–‡ä»¶</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;div className&#x3D;&quot;App&quot;&gt;</span><br><span class="line">       &#123;process.env.REACT_APP_info&#125;</span><br><span class="line"> &lt;&#x2F;div&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">REACT_APP_info&#x3D;hello</span><br></pre></td></tr></table></figure><ul><li>vue ä»¥ **VUE_APP_ **å¼€å¤´</li><li>react ä»¥**REACT_APP_ **å¼€å¤´</li></ul><p>åœ¨**.gitignore **é‡Œé¢è¦å°†ç¯å¢ƒå˜é‡é…ç½®æ–‡ä»¶å¿½ç•¥ä¸Šä¼ </p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ä½¿ç”¨-envæ–‡ä»¶é…ç½®å…¨å±€ç¯å¢ƒå˜é‡&quot;&gt;&lt;a href=&quot;#ä½¿ç”¨-envæ–‡ä»¶é…ç½®å…¨å±€ç¯å¢ƒå˜é‡&quot; class=&quot;headerlink&quot; title=&quot;ä½¿ç”¨.envæ–‡ä»¶é…ç½®å…¨å±€ç¯å¢ƒå˜é‡&quot;&gt;&lt;/a&gt;ä½¿ç”¨.envæ–‡ä»¶é…ç½®å…¨å±€ç¯å¢ƒå˜é‡&lt;/h1&gt;&lt;p&gt;.env å…¨å±€é»˜è®¤é…ç½®æ–‡ä»¶ï¼Œ</summary>
      
    
    
    
    <category term="JS" scheme="https://hard-workingrookie.github.io/categories/JS/"/>
    
    
    <category term="JS" scheme="https://hard-workingrookie.github.io/tags/JS/"/>
    
  </entry>
  
  <entry>
    <title>è·¨åŸŸhttp-proxy-middleware</title>
    <link href="https://hard-workingrookie.github.io/2020/12/24/%E8%B7%A8%E5%9F%9Fhttp-proxy-middleware/"/>
    <id>https://hard-workingrookie.github.io/2020/12/24/%E8%B7%A8%E5%9F%9Fhttp-proxy-middleware/</id>
    <published>2020-12-24T06:22:09.000Z</published>
    <updated>2020-12-25T14:13:47.496Z</updated>
    
    <content type="html"><![CDATA[<h1 id="vue-config-js"><a href="#vue-config-js" class="headerlink" title="vue.config.js"></a>vue.config.js</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  devServer: &#123;</span><br><span class="line">    open: <span class="literal">true</span>,</span><br><span class="line">    host: <span class="string">&#x27;localhost&#x27;</span>,</span><br><span class="line">    port: <span class="number">8080</span>,</span><br><span class="line">    https: <span class="literal">false</span>, <span class="comment">//ä»¥ä¸Šçš„ipå’Œç«¯å£æ˜¯æˆ‘ä»¬æœ¬æœºçš„;ä¸‹é¢ä¸ºéœ€è¦è·¨åŸŸçš„</span></span><br><span class="line">    proxy: &#123;</span><br><span class="line">      <span class="comment">//é…ç½®è·¨åŸŸ</span></span><br><span class="line">      <span class="string">&#x27;/api&#x27;</span>: &#123;</span><br><span class="line">        target: <span class="string">&#x27;https://chp.shadiao.app/api.php&#x27;</span>, <span class="comment">//è¿™é‡Œåå°çš„åœ°å€æ¨¡æ‹Ÿçš„;åº”è¯¥å¡«å†™ä½ ä»¬çœŸå®çš„åå°æ¥å£</span></span><br><span class="line">        ws: <span class="literal">true</span>,</span><br><span class="line">        changOrigin: <span class="literal">true</span>, <span class="comment">//å…è®¸è·¨åŸŸ</span></span><br><span class="line">        pathRewrite: &#123;</span><br><span class="line">          <span class="string">&#x27;^/api&#x27;</span>: <span class="string">&#x27;&#x27;</span> <span class="comment">//è¯·æ±‚çš„æ—¶å€™ä½¿ç”¨è¿™ä¸ªapiå°±å¯ä»¥</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">this</span>.$http</span><br><span class="line">      .get(<span class="string">&quot;/api&quot;</span>)</span><br><span class="line">      .then(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.words=response.data</span><br><span class="line">      &#125;)</span><br><span class="line">      .catch(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(error);</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="main-js"><a href="#main-js" class="headerlink" title="main.js"></a>main.js</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import axios from &quot;axios&quot;;</span><br><span class="line">Vue.prototype.$http &#x3D; axios;</span><br></pre></td></tr></table></figure><h1 id="ä½¿ç”¨-è¿œç¨‹æ•°æ®æ¥å£ä»£ç†æœåŠ¡"><a href="#ä½¿ç”¨-è¿œç¨‹æ•°æ®æ¥å£ä»£ç†æœåŠ¡" class="headerlink" title="ä½¿ç”¨ è¿œç¨‹æ•°æ®æ¥å£ä»£ç†æœåŠ¡"></a>ä½¿ç”¨ è¿œç¨‹æ•°æ®æ¥å£ä»£ç†æœåŠ¡</h1><h2 id="config-index-js"><a href="#config-index-js" class="headerlink" title="config/index.js"></a>config/index.js</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  build: &#123;</span><br><span class="line">    env: <span class="built_in">require</span>(<span class="string">&quot;./prod.env&quot;</span>),</span><br><span class="line">    index: path.resolve(__dirname, <span class="string">&quot;../dist/index.html&quot;</span>),</span><br><span class="line">    assetsRoot: path.resolve(__dirname, <span class="string">&quot;../dist&quot;</span>),</span><br><span class="line">    assetsSubDirectory: <span class="string">&quot;static&quot;</span>,</span><br><span class="line">    assetsPublicPath: <span class="string">&quot;./&quot;</span>,</span><br><span class="line">    productionSourceMap: <span class="literal">false</span>,</span><br><span class="line">    productionGzip: <span class="literal">false</span>,</span><br><span class="line">    productionGzipExtensions: [<span class="string">&quot;js&quot;</span>, <span class="string">&quot;css&quot;</span>],</span><br><span class="line">    bundleAnalyzerReport: process.env.npm_config_report,</span><br><span class="line">    autoOpenBrowser: <span class="literal">true</span>,</span><br><span class="line">    cssSourceMap: <span class="literal">false</span>,</span><br><span class="line">    proxyTable: &#123;</span><br><span class="line">      <span class="string">&quot;/api&quot;</span>: &#123;</span><br><span class="line">        target: <span class="string">&quot;https://chp.shadiao.app&quot;</span>,</span><br><span class="line">        changeOrigin: <span class="literal">true</span>,</span><br><span class="line">        pathRewrite: &#123;</span><br><span class="line">          <span class="string">&quot;^/api&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  dev: &#123;</span><br><span class="line">    env: <span class="built_in">require</span>(<span class="string">&quot;./dev.env&quot;</span>),</span><br><span class="line">    port: <span class="number">8080</span>,</span><br><span class="line">    autoOpenBrowser: <span class="literal">true</span>,</span><br><span class="line">    assetsSubDirectory: <span class="string">&quot;static&quot;</span>,</span><br><span class="line">    assetsPublicPath: <span class="string">&quot;./&quot;</span>,</span><br><span class="line">    proxyTable: &#123;</span><br><span class="line">      <span class="string">&quot;/api&quot;</span>: &#123;</span><br><span class="line">        target: <span class="string">&quot;https://chp.shadiao.app&quot;</span>,</span><br><span class="line">        secure: <span class="literal">false</span>,</span><br><span class="line">        <span class="comment">// å¼€å¯ä»£ç†ï¼Œåœ¨æœ¬åœ°åˆ›å»ºä¸€ä¸ªè™šæ‹ŸæœåŠ¡ç«¯</span></span><br><span class="line">        changeOrigin: <span class="literal">true</span>,</span><br><span class="line">        <span class="comment">// æ˜¯å¦å¯ç”¨websockets</span></span><br><span class="line">        ws: <span class="literal">false</span>,</span><br><span class="line">        <span class="comment">//é‡å†™è·¯å¾„ æ¯”å¦‚&#x27;/api/a/b&#x27;é‡å†™ä¸º&#x27;/aaa/ccc&#x27;</span></span><br><span class="line">        pathRewrite: &#123;</span><br><span class="line">          <span class="string">&quot;^/api&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    cssSourceMap: <span class="literal">false</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h1 id="HoneyWords"><a href="#HoneyWords" class="headerlink" title="HoneyWords:"></a>HoneyWords:</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;p <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;words&quot;</span>&gt;&#123;&#123; words &#125;&#125;...&lt;/p&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">const</span> API_PROXY = <span class="string">&quot;https://bird.ioliu.cn/v1/?url=&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  data() &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      words: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  created() &#123;</span><br><span class="line">    <span class="built_in">this</span>.getHoneyWords();</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    getHoneyWords() &#123;</span><br><span class="line">      <span class="keyword">var</span> _this = <span class="built_in">this</span>;</span><br><span class="line">      <span class="built_in">this</span>.$axios</span><br><span class="line">        .get(API_PROXY + <span class="string">&quot;https://chp.shadiao.app/api.php&quot;</span>)</span><br><span class="line">        .then(</span><br><span class="line">          <span class="function"><span class="keyword">function</span>(<span class="params">res</span>) </span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(res.data)</span><br><span class="line">            _this.words=res.data</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="function"><span class="keyword">function</span>(<span class="params">error</span>) </span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(error);</span><br><span class="line">          &#125;</span><br><span class="line">        );</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style lang=<span class="string">&quot;scss&quot;</span> scope&gt;</span><br><span class="line">.words &#123;</span><br><span class="line">  line-height: <span class="number">40</span>px;</span><br><span class="line">  padding-top: <span class="number">10</span>px;</span><br><span class="line">  font-size: <span class="number">18</span>px;</span><br><span class="line">  color: #a685e2;</span><br><span class="line">  font-weight: <span class="number">300</span>;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;vue-config-js&quot;&gt;&lt;a href=&quot;#vue-config-js&quot; class=&quot;headerlink&quot; title=&quot;vue.config.js&quot;&gt;&lt;/a&gt;vue.config.js&lt;/h1&gt;&lt;figure class=&quot;highlight java</summary>
      
    
    
    
    <category term="è·¨åŸŸ" scheme="https://hard-workingrookie.github.io/categories/%E8%B7%A8%E5%9F%9F/"/>
    
    
    <category term="è·¨åŸŸ" scheme="https://hard-workingrookie.github.io/tags/%E8%B7%A8%E5%9F%9F/"/>
    
  </entry>
  
  <entry>
    <title>æ¯å¤©å®šæ—¶ç”¨jså‘é€é‚®ä»¶</title>
    <link href="https://hard-workingrookie.github.io/2020/12/24/%E6%AF%8F%E5%A4%A9%E5%AE%9A%E6%97%B6%E7%94%A8js%E5%8F%91%E9%80%81%E9%82%AE%E4%BB%B6/"/>
    <id>https://hard-workingrookie.github.io/2020/12/24/%E6%AF%8F%E5%A4%A9%E5%AE%9A%E6%97%B6%E7%94%A8js%E5%8F%91%E9%80%81%E9%82%AE%E4%BB%B6/</id>
    <published>2020-12-24T06:17:29.000Z</published>
    <updated>2020-12-24T06:18:41.478Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> nodemailer = <span class="built_in">require</span>(<span class="string">&quot;nodemailer&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; <span class="attr">default</span>: Axios &#125; = <span class="built_in">require</span>(<span class="string">&quot;axios&quot;</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getHoneyedWords</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> url = <span class="string">&quot;https://chp.shadiao.app/api.php&quot;</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> Axios.get(url);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">sendMail</span>(<span class="params">text</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> user = <span class="string">&quot;1494***9@qq.com&quot;</span>; </span><br><span class="line">  <span class="keyword">var</span> pass = <span class="string">&quot;**********&quot;</span>;<span class="comment">//æˆæƒç </span></span><br><span class="line">  <span class="keyword">var</span> to = <span class="string">&quot;59***4@qq.com&quot;</span>; </span><br><span class="line">  <span class="keyword">let</span> transporter = nodemailer.createTransport(&#123;</span><br><span class="line">    host: <span class="string">&quot;smtp.qq.com&quot;</span>,</span><br><span class="line">    port: <span class="number">587</span>,</span><br><span class="line">    secure: <span class="literal">false</span>,</span><br><span class="line">    auth: &#123;</span><br><span class="line">      user: user, </span><br><span class="line">      pass: pass,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">let</span> info = <span class="keyword">await</span> transporter.sendMail(&#123;</span><br><span class="line">    <span class="keyword">from</span>: <span class="string">`äº²çˆ±çš„è€å©†&lt;<span class="subst">$&#123;user&#125;</span>&gt;`</span>, </span><br><span class="line">    to: <span class="string">`äº²çˆ±çš„è€å…¬&lt;<span class="subst">$&#123;to&#125;</span>&gt;`</span>, </span><br><span class="line">    subject: <span class="string">&quot;äº²çˆ±çš„è€å…¬&quot;</span>,</span><br><span class="line">    text: text, </span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;å‘é€æˆåŠŸ&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> schedule = <span class="built_in">require</span>(<span class="string">&quot;node-schedule&quot;</span>);</span><br><span class="line">schedule.scheduleJob(&#123; <span class="attr">hour</span>: <span class="number">17</span>, <span class="attr">minute</span>: <span class="number">54</span> &#125;, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;å¯åŠ¨ä»»åŠ¡:&quot;</span> + <span class="keyword">new</span> <span class="built_in">Date</span>());</span><br><span class="line">  getHoneyedWords().then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(res.data);</span><br><span class="line">    sendMail(res.data);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line">getHoneyedWords().then(<span class="function"><span class="params">res</span>=&gt;</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(res.data)</span><br><span class="line">  sendMail(res.data);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span </summary>
      
    
    
    
    <category term="JS" scheme="https://hard-workingrookie.github.io/categories/JS/"/>
    
    
    <category term="JS" scheme="https://hard-workingrookie.github.io/tags/JS/"/>
    
  </entry>
  
  <entry>
    <title>jsç»å…¸æ¡ˆä¾‹</title>
    <link href="https://hard-workingrookie.github.io/2020/12/24/js%E7%BB%8F%E5%85%B8%E6%A1%88%E4%BE%8B/"/>
    <id>https://hard-workingrookie.github.io/2020/12/24/js%E7%BB%8F%E5%85%B8%E6%A1%88%E4%BE%8B/</id>
    <published>2020-12-24T05:49:24.000Z</published>
    <updated>2020-12-28T10:22:57.114Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://www.yuque.com/u2417328/rlt5do/kguiwo">https://www.yuque.com/u2417328/rlt5do/kguiwo</a></p><h1 id="vue-è¿‡æ»¤å™¨-æ•°å€¼è¿‡ä¸‡å¤„ç†"><a href="#vue-è¿‡æ»¤å™¨-æ•°å€¼è¿‡ä¸‡å¤„ç†" class="headerlink" title="vue è¿‡æ»¤å™¨ æ•°å€¼è¿‡ä¸‡å¤„ç†"></a>vue è¿‡æ»¤å™¨ æ•°å€¼è¿‡ä¸‡å¤„ç†</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">      &lt;span&gt;&#123;&#123; num|million &#125;&#125;&lt;/span&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  filters:&#123;</span><br><span class="line">   million: <span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</span><br><span class="line">      <span class="comment">//è¿‡ä¸‡å¤„ç†</span></span><br><span class="line">      <span class="keyword">let</span> num;</span><br><span class="line">      <span class="keyword">if</span> (value &gt; <span class="number">9999</span>) &#123;</span><br><span class="line">        <span class="comment">//å¤§äº9999æ˜¾ç¤ºx.xxä¸‡</span></span><br><span class="line">        num = <span class="built_in">Math</span>.floor(value / <span class="number">1000</span>) / <span class="number">10</span> + <span class="string">&quot;W&quot;</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (value &lt; <span class="number">9999</span> &amp;&amp; value &gt; <span class="number">-9999</span>) &#123;</span><br><span class="line">        num = value;</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (value &lt; <span class="number">-9999</span>) &#123;</span><br><span class="line">        <span class="comment">//å°äº-9999æ˜¾ç¤º-x.xxä¸‡</span></span><br><span class="line">        num = -(<span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.abs(value) / <span class="number">1000</span>) / <span class="number">10</span>) + <span class="string">&quot;W&quot;</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> num;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;a href=&quot;https://www.yuque.com/u2417328/rlt5do/kguiwo&quot;&gt;https://www.yuque.com/u2417328/rlt5do/kguiwo&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;vue-è¿‡æ»¤å™¨-æ•°å€¼è¿‡ä¸‡å¤„ç†&quot;&gt;&lt;a hr</summary>
      
    
    
    
    <category term="JS" scheme="https://hard-workingrookie.github.io/categories/JS/"/>
    
    
    <category term="JS" scheme="https://hard-workingrookie.github.io/tags/JS/"/>
    
  </entry>
  
  <entry>
    <title>æµè§ˆå™¨æ’ä»¶å…¥é—¨ä¾‹å­</title>
    <link href="https://hard-workingrookie.github.io/2020/10/26/%E6%B5%8F%E8%A7%88%E5%99%A8%E6%8F%92%E4%BB%B6%E5%85%A5%E9%97%A8%E4%BE%8B%E5%AD%90/"/>
    <id>https://hard-workingrookie.github.io/2020/10/26/%E6%B5%8F%E8%A7%88%E5%99%A8%E6%8F%92%E4%BB%B6%E5%85%A5%E9%97%A8%E4%BE%8B%E5%AD%90/</id>
    <published>2020-10-26T14:04:23.000Z</published>
    <updated>2020-12-24T06:20:21.599Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ä¸€ä¸ªè§£å†³Bç«™æ–‡ç« ä¸å¯å¤åˆ¶æ’ä»¶"><a href="#ä¸€ä¸ªè§£å†³Bç«™æ–‡ç« ä¸å¯å¤åˆ¶æ’ä»¶" class="headerlink" title="ä¸€ä¸ªè§£å†³Bç«™æ–‡ç« ä¸å¯å¤åˆ¶æ’ä»¶"></a>ä¸€ä¸ªè§£å†³Bç«™æ–‡ç« ä¸å¯å¤åˆ¶æ’ä»¶</h1><h2 id="é…ç½®æ–‡ä»¶-manifest-json"><a href="#é…ç½®æ–‡ä»¶-manifest-json" class="headerlink" title="é…ç½®æ–‡ä»¶ manifest.json"></a>é…ç½®æ–‡ä»¶ manifest.json</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;allow copy&quot;</span>,</span><br><span class="line">    <span class="string">&quot;description&quot;</span>: <span class="string">&quot;è§£é”biç«™å¤åˆ¶é™åˆ¶&quot;</span>,</span><br><span class="line">    <span class="string">&quot;version&quot;</span>: <span class="string">&quot;1.0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;manifest_version&quot;</span>: <span class="number">2</span>,</span><br><span class="line">    <span class="string">&quot;browser_action&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;default_icon&quot;</span>: <span class="string">&quot;icons/copy.jpg&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;content_scripts&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;matches&quot;</span>: [</span><br><span class="line">                <span class="string">&quot;https://www.bilibili.com/read/*&quot;</span></span><br><span class="line">            ],</span><br><span class="line">            <span class="string">&quot;js&quot;</span>: [</span><br><span class="line">                <span class="string">&quot;js/copy.js&quot;</span></span><br><span class="line">            ],</span><br><span class="line">            <span class="string">&quot;run_at&quot;</span>: <span class="string">&quot;document_start&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="js-copy-js-æ–‡ä»¶"><a href="#js-copy-js-æ–‡ä»¶" class="headerlink" title="js/copy.js æ–‡ä»¶"></a>js/copy.js æ–‡ä»¶</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">&#x27;load&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> elements = <span class="built_in">document</span>.getElementsByClassName(<span class="string">&quot;article-holder&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> index = <span class="number">0</span>; index &lt; elements.length; index++) &#123;</span><br><span class="line">        elements[index].style.userSelect = <span class="string">&quot;auto&quot;</span>;</span><br><span class="line">        elements[index].addEventListener(<span class="string">&quot;copy&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span><br><span class="line">            event.clipboardData.setData(<span class="string">&quot;text&quot;</span>, <span class="built_in">window</span>.getSelection().toString())</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>åœ¨è°·æ­Œchromeæµè§ˆå™¨é‡Œ æ‰“å¼€<strong>ç®¡ç†æ‰©å±•ç¨‹åº</strong>ï¼Œ å‹¾é€‰ <strong>å¼€å‘è€…æ¨¡å¼</strong>  ç‚¹å‡»<strong>åŠ è½½å·²è§£å‹çš„æ‰©å±•ç¨‹åº</strong></p><p>æ‰“å¼€æˆ‘ä»¬çš„é¡¹ç›®ï¼Œå›ºå®šåˆ°æ‰©å±•ç¨‹åº</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ä¸€ä¸ªè§£å†³Bç«™æ–‡ç« ä¸å¯å¤åˆ¶æ’ä»¶&quot;&gt;&lt;a href=&quot;#ä¸€ä¸ªè§£å†³Bç«™æ–‡ç« ä¸å¯å¤åˆ¶æ’ä»¶&quot; class=&quot;headerlink&quot; title=&quot;ä¸€ä¸ªè§£å†³Bç«™æ–‡ç« ä¸å¯å¤åˆ¶æ’ä»¶&quot;&gt;&lt;/a&gt;ä¸€ä¸ªè§£å†³Bç«™æ–‡ç« ä¸å¯å¤åˆ¶æ’ä»¶&lt;/h1&gt;&lt;h2 id=&quot;é…ç½®æ–‡ä»¶-manifest-jso</summary>
      
    
    
    
    <category term="æµè§ˆå™¨æ’ä»¶" scheme="https://hard-workingrookie.github.io/categories/%E6%B5%8F%E8%A7%88%E5%99%A8%E6%8F%92%E4%BB%B6/"/>
    
    
    <category term="æµè§ˆå™¨æ’ä»¶" scheme="https://hard-workingrookie.github.io/tags/%E6%B5%8F%E8%A7%88%E5%99%A8%E6%8F%92%E4%BB%B6/"/>
    
  </entry>
  
  <entry>
    <title>websocket</title>
    <link href="https://hard-workingrookie.github.io/2020/10/25/websocket/"/>
    <id>https://hard-workingrookie.github.io/2020/10/25/websocket/</id>
    <published>2020-10-25T05:15:02.000Z</published>
    <updated>2020-12-24T06:20:21.607Z</updated>
    
    <content type="html"><![CDATA[<h1 id="websocket"><a href="#websocket" class="headerlink" title="websocket"></a>websocket</h1><h2 id="å‰ç«¯-ç¤ºä¾‹ä»£ç "><a href="#å‰ç«¯-ç¤ºä¾‹ä»£ç " class="headerlink" title="å‰ç«¯ ç¤ºä¾‹ä»£ç "></a>å‰ç«¯ ç¤ºä¾‹ä»£ç </h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> input =<span class="built_in">document</span>.querySelector(<span class="string">&#x27;input&#x27;</span>)</span><br><span class="line">  <span class="keyword">var</span>  button =<span class="built_in">document</span>.querySelector(<span class="string">&#x27;button&#x27;</span>)</span><br><span class="line">  <span class="keyword">var</span> div =<span class="built_in">document</span>.querySelector(<span class="string">&#x27;div&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 1.åˆ›å»ºwebsocket</span></span><br><span class="line">  <span class="keyword">var</span> socket =<span class="keyword">new</span> WebSocket(<span class="string">&#x27;ws://echo.websocket.org&#x27;</span>)</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 2.open: å½“å’ŒwebsocketæœåŠ¡è¿æ¥æˆåŠŸçš„æ—¶å€™è§¦å‘</span></span><br><span class="line">  socket.addEventListener(<span class="string">&#x27;open&#x27;</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    div.innerHTML=<span class="string">&#x27;è¿æ¥æœåŠ¡æˆåŠŸäº†&#x27;</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 3.ä¸»åŠ¨ç»™websocketæœåŠ¡å™¨å‘é€æ¶ˆæ¯</span></span><br><span class="line">  button.addEventListener(<span class="string">&#x27;click&#x27;</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> val =input.value</span><br><span class="line">    socket.send(val) </span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 4.æ¥æ”¶websocketæœåŠ¡çš„æ•°æ®</span></span><br><span class="line">  socket.addEventListener(<span class="string">&#x27;message&#x27;</span>,<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(e.data)</span><br><span class="line">    div.innerHTML=e.data</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  socket.addEventListener(<span class="string">&#x27;close&#x27;</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    div.innerHTML=<span class="string">&#x27;æœåŠ¡æ–­å¼€è¿æ¥&#x27;</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç‚¹å‡»è°ƒè¯•å·¥å…· ä¸­çš„ NetWork ä¸­çš„ WS å¯ä»¥çœ‹åˆ°å‘é€å’Œæ¥æ”¶æƒ…å†µ</p><p>ç»¿è‰²æ˜¯å‘é€ç»™æœåŠ¡å™¨çš„<br>çº¢è‰²æ˜¯æœåŠ¡å™¨è¿”å›æ¥çš„</p><h2 id="æœåŠ¡å™¨ç«¯ä»£ç "><a href="#æœåŠ¡å™¨ç«¯ä»£ç " class="headerlink" title="æœåŠ¡å™¨ç«¯ä»£ç "></a>æœåŠ¡å™¨ç«¯ä»£ç </h2><h3 id="1-å®‰è£…-nodejs-websocket"><a href="#1-å®‰è£…-nodejs-websocket" class="headerlink" title="1.å®‰è£… nodejs-websocket"></a>1.å®‰è£… nodejs-websocket</h3><p><code>yarn add nodejs-websocket</code></p><h3 id="2-ç¤ºä¾‹ä»£ç "><a href="#2-ç¤ºä¾‹ä»£ç " class="headerlink" title="2.ç¤ºä¾‹ä»£ç "></a>2.ç¤ºä¾‹ä»£ç </h3><p>const ws = require(â€˜nodejs-websocketâ€™)</p><p>const PORT = 3000</p><p>// åˆ›å»ºä¸€ä¸ªserver</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ¯æ¬¡åªè¦æœ‰ç”¨æˆ·è¿æ¥ï¼Œå‡½æ•°å°±ä¼šè¢«æ‰§è¡Œï¼Œä¼šç»™å½“å‰è¿æ¥çš„ç”¨æˆ·åˆ›å»ºä¸€ä¸ª connect å¯¹è±¡</span></span><br><span class="line"><span class="keyword">const</span> server = ws.createServer(<span class="function">(<span class="params">connect</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;æœ‰ç”¨æˆ·è¿æ¥ä¸Šæ¥äº†&#x27;</span>)</span><br><span class="line">  <span class="comment">// æ¯å½“æ¥æ”¶åˆ°ç”¨æˆ·ä¼ é€’è¿‡æ¥çš„æ•°æ®ï¼Œè¿™ä¸ªtextäº‹ä»¶ä¼šè¢«è§¦å‘</span></span><br><span class="line">  connect.on(<span class="string">&#x27;text&#x27;</span>, <span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;æ¥æ”¶åˆ°äº†ç”¨æˆ·çš„æ•°æ®&#x27;</span>, data)</span><br><span class="line">    <span class="comment">// ç»™ç”¨æˆ·ä¸€ä¸ªå“åº”çš„æ•°æ®</span></span><br><span class="line">    <span class="comment">// å¯¹ç”¨æˆ·å‘é€çš„æ•°æ®ï¼ŒæŠŠå°å†™è½¬æ¢æˆå¤§å†™ï¼Œå¹¶æ‹¼æ¥ä¸€ç‚¹å†…å®¹</span></span><br><span class="line">    connect.send(data.toUpperCase() + <span class="string">&#x27;!!!&#x27;</span>)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// åªè¦websocketè¿æ¥æ–­å¼€ï¼Œclose äº‹ä»¶ä¼šè§¦å‘</span></span><br><span class="line">  connect.on(<span class="string">&#x27;close&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;è¿æ¥æ–­å¼€äº†&#x27;</span>)</span><br><span class="line">  &#125;)</span><br><span class="line"> </span><br><span class="line">  <span class="comment">//   å¤„ç†ç”¨æˆ·çš„é”™è¯¯ä¿¡æ¯</span></span><br><span class="line">  connect.on(<span class="string">&#x27;error&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;ç”¨æˆ·è¿æ¥å¼‚å¸¸&#x27;</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">server.listen(PORT, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;websocktetæœåŠ¡å¯åŠ¨æˆåŠŸäº†,ç›‘å¬äº†ç«¯å£&#x27;</span> + PORT)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="ä¸€ä¸ªç®€å•çš„èŠå¤©å®¤"><a href="#ä¸€ä¸ªç®€å•çš„èŠå¤©å®¤" class="headerlink" title="ä¸€ä¸ªç®€å•çš„èŠå¤©å®¤"></a>ä¸€ä¸ªç®€å•çš„èŠå¤©å®¤</h2><p><a href="https://imgchr.com/i/Bm6xBt"><img src= "/img/loading.gif" data-lazy-src="https://s1.ax1x.com/2020/10/25/Bm6xBt.md.jpg" alt="Bm6xBt.md.jpg"></a></p><h3 id="å‰ç«¯"><a href="#å‰ç«¯" class="headerlink" title="å‰ç«¯"></a>å‰ç«¯</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">  <span class="keyword">const</span> type_enter = <span class="number">0</span></span><br><span class="line">  <span class="keyword">const</span> type_leave = <span class="number">1</span></span><br><span class="line">  <span class="keyword">const</span> type_message = <span class="number">2</span></span><br><span class="line">  <span class="keyword">var</span> input = <span class="built_in">document</span>.querySelector(<span class="string">&#x27;input&#x27;</span>)</span><br><span class="line">  <span class="keyword">var</span> button = <span class="built_in">document</span>.querySelector(<span class="string">&#x27;button&#x27;</span>)</span><br><span class="line">  <span class="keyword">var</span> div = <span class="built_in">document</span>.querySelector(<span class="string">&#x27;div&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 1.åˆ›å»ºwebsocket</span></span><br><span class="line">  <span class="keyword">var</span> socket = <span class="keyword">new</span> WebSocket(<span class="string">&#x27;ws://localhost:3000&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 2.open: å½“å’ŒwebsocketæœåŠ¡è¿æ¥æˆåŠŸçš„æ—¶å€™è§¦å‘</span></span><br><span class="line">  socket.addEventListener(<span class="string">&#x27;open&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// div.innerHTML = &#x27;è¿æ¥æœåŠ¡æˆåŠŸäº†&#x27;</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 3.ä¸»åŠ¨ç»™websocketæœåŠ¡å™¨å‘é€æ¶ˆæ¯</span></span><br><span class="line">  button.addEventListener(<span class="string">&#x27;click&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> val = input.value</span><br><span class="line">    socket.send(val)</span><br><span class="line">    input.value = <span class="string">&#x27;&#x27;</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 4.æ¥æ”¶websocketæœåŠ¡çš„æ•°æ®</span></span><br><span class="line">  socket.addEventListener(<span class="string">&#x27;message&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// console.log(JSON.parse(e.data))</span></span><br><span class="line">    <span class="keyword">let</span> data = <span class="built_in">JSON</span>.parse(e.data)</span><br><span class="line">    <span class="keyword">var</span> dv = <span class="built_in">document</span>.createElement(<span class="string">&#x27;div&#x27;</span>)</span><br><span class="line">    dv.innerText = data.msg + <span class="string">&#x27;---------&#x27;</span> + data.time</span><br><span class="line">    <span class="keyword">if</span> (data.type == type_enter) &#123;</span><br><span class="line">      dv.style.color = <span class="string">&#x27;green&#x27;</span></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (data.type == type_leave) &#123;</span><br><span class="line">      dv.style.color = <span class="string">&#x27;red&#x27;</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      dv.style.color = <span class="string">&#x27;#333&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    div.appendChild(dv)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  socket.addEventListener(<span class="string">&#x27;close&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// div.innerHTML = &#x27;æœåŠ¡æ–­å¼€è¿æ¥&#x27;</span></span><br><span class="line">  &#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="æœåŠ¡ç«¯"><a href="#æœåŠ¡ç«¯" class="headerlink" title="æœåŠ¡ç«¯"></a>æœåŠ¡ç«¯</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> ws = <span class="built_in">require</span>(<span class="string">&#x27;nodejs-websocket&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> PORT = <span class="number">3000</span></span><br><span class="line"><span class="comment">// ç”¨æˆ·æ•°é‡</span></span><br><span class="line"><span class="keyword">let</span> count = <span class="number">0</span></span><br><span class="line"><span class="keyword">const</span> type_enter = <span class="number">0</span></span><br><span class="line"><span class="keyword">const</span> type_leave = <span class="number">1</span></span><br><span class="line"><span class="keyword">const</span> type_message = <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> server = ws.createServer(<span class="function">(<span class="params">connect</span>) =&gt;</span> &#123;</span><br><span class="line">  count++</span><br><span class="line">  connect.userName = <span class="string">`ç”¨æˆ·<span class="subst">$&#123;count&#125;</span>`</span></span><br><span class="line">  <span class="comment">//   å‘Šè¯‰æ‰€æœ‰ç”¨æˆ·ï¼Œæœ‰äººåŠ å…¥äº†èŠå¤©å®¤</span></span><br><span class="line">  broadcast(&#123;</span><br><span class="line">    type: type_enter,</span><br><span class="line">    msg: <span class="string">`<span class="subst">$&#123;connect.userName&#125;</span>è¿›å…¥äº†èŠå¤©å®¤ï¼`</span>,</span><br><span class="line">    time: <span class="keyword">new</span> <span class="built_in">Date</span>().toLocaleDateString()</span><br><span class="line">  &#125;)</span><br><span class="line">  connect.on(<span class="string">&#x27;text&#x27;</span>, <span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">    broadcast(&#123;</span><br><span class="line">      type: type_message,</span><br><span class="line">      msg:data,</span><br><span class="line">      time: <span class="keyword">new</span> <span class="built_in">Date</span>().toLocaleDateString()</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  connect.on(<span class="string">&#x27;close&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    count--</span><br><span class="line">    <span class="comment">//   å‘Šè¯‰æ‰€æœ‰ç”¨æˆ·ï¼Œæœ‰äººç¦»å¼€äº†èŠå¤©å®¤</span></span><br><span class="line">    broadcast(&#123;</span><br><span class="line">      type: type_leave,</span><br><span class="line">      msg: <span class="string">`<span class="subst">$&#123;connect.userName&#125;</span>ç¦»å¼€äº†èŠå¤©å®¤ï¼`</span>,</span><br><span class="line">      time: <span class="keyword">new</span> <span class="built_in">Date</span>().toLocaleDateString()</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">  connect.on(<span class="string">&#x27;error&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;ç”¨æˆ·è¿æ¥å¼‚å¸¸&#x27;</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¹¿æ’­ï¼Œç»™æ‰€æœ‰çš„ç”¨æˆ·å‘é€æ¶ˆæ¯</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">broadcast</span>(<span class="params">msg</span>) </span>&#123;</span><br><span class="line">  server.connections.forEach(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">    item.send(<span class="built_in">JSON</span>.stringify(msg))</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server.listen(PORT, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;websocktetæœåŠ¡å¯åŠ¨æˆåŠŸäº†,ç›‘å¬äº†ç«¯å£&#x27;</span> + PORT)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;websocket&quot;&gt;&lt;a href=&quot;#websocket&quot; class=&quot;headerlink&quot; title=&quot;websocket&quot;&gt;&lt;/a&gt;websocket&lt;/h1&gt;&lt;h2 id=&quot;å‰ç«¯-ç¤ºä¾‹ä»£ç &quot;&gt;&lt;a href=&quot;#å‰ç«¯-ç¤ºä¾‹ä»£ç &quot; class=&quot;he</summary>
      
    
    
    
    <category term="websocket" scheme="https://hard-workingrookie.github.io/categories/websocket/"/>
    
    
    <category term="websocket" scheme="https://hard-workingrookie.github.io/tags/websocket/"/>
    
  </entry>
  
  <entry>
    <title>sasså­¦ä¹ </title>
    <link href="https://hard-workingrookie.github.io/2020/09/28/sass%E5%AD%A6%E4%B9%A0/"/>
    <id>https://hard-workingrookie.github.io/2020/09/28/sass%E5%AD%A6%E4%B9%A0/</id>
    <published>2020-09-28T13:40:34.000Z</published>
    <updated>2020-12-24T06:20:21.607Z</updated>
    
    <content type="html"><![CDATA[<h1 id="css-å˜é‡"><a href="#css-å˜é‡" class="headerlink" title="css å˜é‡"></a>css å˜é‡</h1><p><strong>$</strong></p><p><code>$Primary-color : #333;</code></p><h1 id="Modules-æ¨¡å—"><a href="#Modules-æ¨¡å—" class="headerlink" title="Modules æ¨¡å—"></a>Modules æ¨¡å—</h1><p><strong>@use</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// _base.scss</span></span><br><span class="line">$font-stack :Helvetica,sans-serif;</span><br><span class="line">$primary-color:#333;</span><br><span class="line"></span><br><span class="line">body&#123;</span><br><span class="line">    font: <span class="number">100</span>% $font-stack;</span><br><span class="line">    color: $primary-color;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@use <span class="string">&#x27;base&#x27;</span>;</span><br><span class="line"></span><br><span class="line">.inverse&#123;</span><br><span class="line">    background-color: base.$primary-color;</span><br><span class="line">    color: #fff;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Mixins-amp-Functions"><a href="#Mixins-amp-Functions" class="headerlink" title="Mixins &amp; Functions"></a>Mixins &amp; Functions</h1><p><strong>@mixin</strong></p><h2 id="Sass"><a href="#Sass" class="headerlink" title="Sass"></a>Sass</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@mixin transform ($property) &#123;</span><br><span class="line">    -webkit-transform: $property;</span><br><span class="line">    -ms-transform: $property;</span><br><span class="line">    transform: $property;</span><br><span class="line">&#125;</span><br><span class="line">.box &#123;</span><br><span class="line">    @include transform(rotate(<span class="number">30</span>deg))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="css"><a href="#css" class="headerlink" title="css"></a>css</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.box&#123;</span><br><span class="line">    -webkit-transform: rotate(<span class="number">30</span>deg);</span><br><span class="line">    -ms-transform: rotate(<span class="number">30</span>deg);</span><br><span class="line">    transform: rotate(<span class="number">30</span>deg);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Inheritance-ç»§æ‰¿"><a href="#Inheritance-ç»§æ‰¿" class="headerlink" title="Inheritance ç»§æ‰¿"></a>Inheritance ç»§æ‰¿</h1><p>**@extend **</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">%message-shared&#123;</span><br><span class="line">    border: 1px solid #ccc;</span><br><span class="line">    padding: <span class="number">10</span>px;</span><br><span class="line">    color: #333;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.message&#123;</span><br><span class="line">    @extend %message-shared;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.success&#123;</span><br><span class="line">    @extend %message-shared;</span><br><span class="line">    border-color: green;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="é€»è¾‘åˆ¤æ–­"><a href="#é€»è¾‘åˆ¤æ–­" class="headerlink" title="é€»è¾‘åˆ¤æ–­"></a>é€»è¾‘åˆ¤æ–­</h1><p>**@if â€¦. @else if â€¦. @else **</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">@mixin triangle($size,$color,$direction) &#123;</span><br><span class="line">    height: <span class="number">0</span>;</span><br><span class="line">    width: <span class="number">0</span>;</span><br><span class="line">    border-color: transparent;</span><br><span class="line">    border-style: solid;</span><br><span class="line">    border-width: $size/<span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@<span class="keyword">if</span> $direction == up &#123;</span><br><span class="line">    border-bottom-color: $color;</span><br><span class="line">&#125;@<span class="keyword">else</span> <span class="keyword">if</span> $direction == right &#123;</span><br><span class="line">    border-left-color: $color;</span><br><span class="line">&#125;@<span class="keyword">else</span> &#123;</span><br><span class="line">    @error <span class="string">&quot;Unknown direction #&#123; $direction&#125;.&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.next&#123;</span><br><span class="line">    @include triangle(<span class="number">5</span>px, black,right )</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="æ’ä»¶"><a href="#æ’ä»¶" class="headerlink" title="æ’ä»¶"></a>æ’ä»¶</h1><p>VsCode é‡Œé¢ æ’ä»¶ ï¼šLive Sass Compiler</p><p>åœ¨ setting è®¾ç½®é‡Œé¢æœç´¢ live sass compiler</p><p>è®¾ç½® format é‡Œé¢</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;format&quot;</span>: <span class="string">&quot;compressed&quot;</span>, <span class="comment">//å‹ç¼©css</span></span><br><span class="line"><span class="string">&quot;extensionName&quot;</span>: <span class="string">&quot;.css&quot;</span>, <span class="comment">//ç¼–è¯‘æ‰©å±•å</span></span><br><span class="line"><span class="string">&quot;savePath&quot;</span>: <span class="string">&quot;/css&quot;</span> <span class="comment">//ç¼–è¯‘åå­˜æ”¾è·¯å¾„</span></span><br></pre></td></tr></table></figure><p>åœ¨éœ€è¦è½¬æ¢ä¸ºcssçš„sass çš„æ–‡ä»¶é‡Œé¢ç‚¹å‡»Vscode ä¸‹é¢çš„<strong>Watching..</strong>.  å³å¯è½¬æ¢æˆ/css/æ–‡ä»¶å¤¹ä¸‹çš„cssæ–‡ä»¶ </p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;css-å˜é‡&quot;&gt;&lt;a href=&quot;#css-å˜é‡&quot; class=&quot;headerlink&quot; title=&quot;css å˜é‡&quot;&gt;&lt;/a&gt;css å˜é‡&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;$&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;$Primary-color : #333;</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>RXJSå­¦ä¹ </title>
    <link href="https://hard-workingrookie.github.io/2020/09/28/RXJS%E5%AD%A6%E4%B9%A0/"/>
    <id>https://hard-workingrookie.github.io/2020/09/28/RXJS%E5%AD%A6%E4%B9%A0/</id>
    <published>2020-09-28T07:58:40.000Z</published>
    <updated>2020-09-28T11:03:09.532Z</updated>
    
    <content type="html"><![CDATA[<p><strong>The ReactiveX library fro JavaScript</strong></p><p>Reactive-Extensions (RX)</p><p>RxJS æ˜¯ä½¿ç”¨ Observables çš„å“åº”å¼ç¼–ç¨‹çš„åº“ï¼Œå®ƒä½¿ç¼–å†™å¼‚æ­¥æˆ–åŸºäºå›è°ƒçš„ä»£ç æ›´å®¹æ˜“ã€‚</p><h1 id="RXJS-ä»‹ç»"><a href="#RXJS-ä»‹ç»" class="headerlink" title="RXJS ä»‹ç»"></a>RXJS ä»‹ç»</h1><p>ä¸€ç»„å¯ç”¨æ¥å¤„ç† <strong>éåŒæ­¥ æˆ–äº‹ä»¶</strong> çš„JavaScript å‡½æ•°åº“ã€‚</p><h2 id="éåŒæ­¥"><a href="#éåŒæ­¥" class="headerlink" title="éåŒæ­¥"></a>éåŒæ­¥</h2><ul><li>AJAX / XHR (XMLHttpRequest) / fetch API</li><li>Service Worker / Node Stream </li><li>setTimeout / setInterval</li><li>Promise</li></ul><h2 id="äº‹ä»¶"><a href="#äº‹ä»¶" class="headerlink" title="äº‹ä»¶"></a>äº‹ä»¶</h2><p>å„å¼ DOM äº‹ä»¶ (click ,dbclick ,keyup ,mousemove â€¦ )<br>css åŠ¨ç”»äº‹ä»¶ (css3 transitionEnd event)<br>HTML5 Geolocation (åœ°ç†åœ°ä½)/ WebSockets (åœ¨å•ä¸ª TCP è¿æ¥ä¸Šè¿›è¡Œå…¨åŒå·¥é€šè®¯çš„åè®®) / server Send Event(SSE)</p><h1 id="RXJS-çš„æ ¸å¿ƒæ¦‚å¿µ"><a href="#RXJS-çš„æ ¸å¿ƒæ¦‚å¿µ" class="headerlink" title="RXJS çš„æ ¸å¿ƒæ¦‚å¿µ"></a>RXJS çš„æ ¸å¿ƒæ¦‚å¿µ</h1><h2 id="Observable-å¯è§‚å¯Ÿçš„ç‰©ä»¶"><a href="#Observable-å¯è§‚å¯Ÿçš„ç‰©ä»¶" class="headerlink" title="Observable   å¯è§‚å¯Ÿçš„ç‰©ä»¶"></a>Observable   å¯è§‚å¯Ÿçš„ç‰©ä»¶</h2><ul><li>ä»£è¡¨ä¸€ç»„<strong>æœªæ¥</strong>å³å°†å‘ç”Ÿçš„<strong>äº‹ä»¶èµ„æ–™</strong>ï¼ˆè¢«è§‚å¯Ÿçš„ç‰©ä»¶ï¼‰</li></ul><h2 id="Observer-è§‚å¯Ÿè€…ç‰©ä»¶"><a href="#Observer-è§‚å¯Ÿè€…ç‰©ä»¶" class="headerlink" title="Observer     è§‚å¯Ÿè€…ç‰©ä»¶"></a>Observer     è§‚å¯Ÿè€…ç‰©ä»¶</h2><ul><li>ä»£è¡¨ä¸€ä¸ªç”¨æ¥æ¥æ”¶ <strong>è§‚å¯Ÿç»“æœ</strong> çš„ç‰©ä»¶ ï¼ˆæ”¶åˆ°çš„å°±æ˜¯<strong>äº‹ä»¶èµ„æ–™</strong>ï¼‰</li><li>è§‚å¯Ÿè€…ç‰©ä»¶å°±æ˜¯ä¸€ä¸ªç‰©ä»¶åŒ…å«3ä¸ªåŒ…å«å›å‘¼å‡½å¼çš„å±æ€§ ï¼ˆnext,error,complete)</li></ul><h2 id="Subsciption-è®¢é˜…ç‰©ä»¶"><a href="#Subsciption-è®¢é˜…ç‰©ä»¶" class="headerlink" title="Subsciption  è®¢é˜…ç‰©ä»¶"></a>Subsciption  è®¢é˜…ç‰©ä»¶</h2><ul><li>ä»£è¡¨æ­£åœ¨æ‰§è¡Œ Observable / Observer çš„æ‰§è¡Œä¸ªæ•° ï¼ˆå¯ç”¨æ¥<strong>å–æ¶ˆè®¢é˜…</strong>ï¼‰</li></ul><h2 id="Operators-è¿ç®—å­"><a href="#Operators-è¿ç®—å­" class="headerlink" title="Operators    è¿ç®—å­"></a>Operators    è¿ç®—å­</h2><ul><li>å¿…é¡»æ‹¥æœ‰<strong>å‡½æ•°ç¼–ç¨‹</strong>ä¸­æ‰€å®šä¹‰çš„çº¯å‡½æ•°ç‰¹æ€§ï¼ˆ<strong>æ²¡æœ‰å‰¯ä½œç”¨çš„å‡½å¼</strong>ï¼‰</li><li>ä¸»è¦ç”¨æ¥å¤„ç†ä¸€ç³»åˆ—çš„<strong>äº‹ä»¶èµ„æ–™é›†åˆ</strong></li><li>å¸¸è§çš„è¿ç®—åœ¨åŒ…å«mapï¼Œfilterï¼Œconcatï¼ŒflatMapï¼ŒswitchMapï¼Œâ€¦</li></ul><h2 id="Subject-ä¸»ä½“ç‰©ä»¶"><a href="#Subject-ä¸»ä½“ç‰©ä»¶" class="headerlink" title="Subject      ä¸»ä½“ç‰©ä»¶"></a>Subject      ä¸»ä½“ç‰©ä»¶</h2><p>å¦‚åŒ EventEmitter ä¸€æ ·ï¼Œä¸»è¦ç”¨æ¥<strong>å¹¿æ’­</strong>æ”¶åˆ°çš„äº‹ä»¶èµ„æ–™ç»™å¤šä¸ªObserverï¼ˆè§‚å¯Ÿè€…ï¼‰</p><h2 id="Schedulers-æ’ç¨‹æ§åˆ¶å™¨"><a href="#Schedulers-æ’ç¨‹æ§åˆ¶å™¨" class="headerlink" title="Schedulers   æ’ç¨‹æ§åˆ¶å™¨"></a>Schedulers   æ’ç¨‹æ§åˆ¶å™¨</h2><p>ç”¨æ¥é›†ä¸­ç®¡ç†å’Œè°ƒåº¦å¤šé‡äº‹ä»¶ä¹‹é—´çš„èµ„æ–™ï¼Œä»¥æ§åˆ¶<strong>äº‹ä»¶å¹¶å‘</strong>çš„æƒ…å†µ</p><h1 id="Rxjsçš„è¿ä½œæ–¹å¼"><a href="#Rxjsçš„è¿ä½œæ–¹å¼" class="headerlink" title="Rxjsçš„è¿ä½œæ–¹å¼"></a>Rxjsçš„è¿ä½œæ–¹å¼</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rxjs.interval(500) &#x2F;&#x2F;å»ºç«‹è¿ç®—å­ï¼ˆcreationï¼‰</span><br><span class="line">    .pipe(rxjs.operators.take(4)) &#x2F;&#x2F; è¿‡æ»¤è¿ç®—å­ ï¼ˆFiltering)</span><br><span class="line">    .subscribe(console.log) &#x2F;&#x2F; å›å¤è®¢é˜…ç‰©ä»¶ï¼ˆSubscription)  è§‚å¯Ÿè€…ï¼ˆobserverï¼‰</span><br></pre></td></tr></table></figure><p>const { interval } =rxjs;<br>const { take } =rxjs.operators</p><p>interval(5000)<br>    .pipe(take(4))<br>    .subscribe(console.log)</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;The ReactiveX library fro JavaScript&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Reactive-Extensions (RX)&lt;/p&gt;
&lt;p&gt;RxJS æ˜¯ä½¿ç”¨ Observables çš„å“åº”å¼ç¼–ç¨‹çš„åº“ï¼Œå®ƒä½¿ç¼–å†™å¼‚æ­¥æˆ–åŸºäºå›è°ƒçš„ä»£ç </summary>
      
    
    
    
    <category term="RXJSå­¦ä¹ " scheme="https://hard-workingrookie.github.io/categories/RXJS%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="RXJS" scheme="https://hard-workingrookie.github.io/tags/RXJS/"/>
    
  </entry>
  
  <entry>
    <title>å‰ç«¯å­¦ä¹ è·¯çº¿</title>
    <link href="https://hard-workingrookie.github.io/2020/09/27/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0%E8%B7%AF%E7%BA%BF/"/>
    <id>https://hard-workingrookie.github.io/2020/09/27/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0%E8%B7%AF%E7%BA%BF/</id>
    <published>2020-09-27T14:45:45.000Z</published>
    <updated>2020-12-24T06:20:21.600Z</updated>
    
    <content type="html"><![CDATA[<p>å¦‚æœæœ‰è¯´é”™äº†ï¼Œè¯·è§è°…ã€‚<br>æ­¤æ–‡ç« é“¾æ¥åœ¨çŸ¥ä¹ä¸Šï¼š</p><p> å‰ç«¯å­¦ä¹ è·¯çº¿ï¼ˆå¾ˆé•¿ï¼Œå»ºè®®æ”¶è—ï¼‰ - æœ‰ä¸€å¤©wmçš„æ–‡ç«  - çŸ¥ä¹<br><a href="https://zhuanlan.zhihu.com/p/164701269">https://zhuanlan.zhihu.com/p/164701269</a></p><h1 id="ä¸€ã€ç¼–è¾‘å™¨ï¼š"><a href="#ä¸€ã€ç¼–è¾‘å™¨ï¼š" class="headerlink" title="ä¸€ã€ç¼–è¾‘å™¨ï¼š"></a>ä¸€ã€ç¼–è¾‘å™¨ï¼š</h1><h2 id="VSCode-æ¨èä½¿ç”¨"><a href="#VSCode-æ¨èä½¿ç”¨" class="headerlink" title="VSCode (æ¨èä½¿ç”¨)"></a>VSCode (æ¨èä½¿ç”¨)</h2><p>â€‹</p><ol><li>WebStorm</li><li>Atom</li><li>Sublime</li></ol><h1 id="äºŒã€HTML"><a href="#äºŒã€HTML" class="headerlink" title="äºŒã€HTML"></a>äºŒã€HTML</h1><ul><li>å¸¸ç”¨æ ‡ç­¾</li><li>è¡¨å•</li><li>HTML </li></ul><h1 id="ä¸‰ã€CSS"><a href="#ä¸‰ã€CSS" class="headerlink" title="ä¸‰ã€CSS"></a>ä¸‰ã€CSS</h1><h2 id="åŸºæœ¬è¯­æ³•"><a href="#åŸºæœ¬è¯­æ³•" class="headerlink" title="åŸºæœ¬è¯­æ³•"></a>åŸºæœ¬è¯­æ³•</h2><h2 id="å¸ƒå±€ï¼ˆæµ®åŠ¨floatã€å®šä½positionã€ç›’æ¨¡å‹ã€flexã€grid-layout"><a href="#å¸ƒå±€ï¼ˆæµ®åŠ¨floatã€å®šä½positionã€ç›’æ¨¡å‹ã€flexã€grid-layout" class="headerlink" title="å¸ƒå±€ï¼ˆæµ®åŠ¨floatã€å®šä½positionã€ç›’æ¨¡å‹ã€flexã€grid/layout)"></a>å¸ƒå±€ï¼ˆæµ®åŠ¨floatã€å®šä½positionã€ç›’æ¨¡å‹ã€flexã€grid/layout)</h2><h2 id="å“åº”å¼å¸ƒå±€"><a href="#å“åº”å¼å¸ƒå±€" class="headerlink" title="å“åº”å¼å¸ƒå±€"></a>å“åº”å¼å¸ƒå±€</h2><ol><li>viewportï¼ˆç”¨æˆ·ç½‘é¡µçš„å¯è§†åŒºåŸŸï¼‰</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;device-width, initial-scale&#x3D;1.0&quot;&gt;</span><br></pre></td></tr></table></figure><ol start="2"><li>æµåŠ¨å¸ƒå±€ï¼ˆfluid gridï¼‰</li><li>åª’ä½“ç›‘å¬@media</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@media only screen and (max-width: <span class="number">500</span>px) &#123;</span><br><span class="line">    .gridmenu &#123;</span><br><span class="line">         width:<span class="number">100</span>%;</span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å››ã€JS"><a href="#å››ã€JS" class="headerlink" title="å››ã€JS"></a>å››ã€JS</h1><h2 id="åŸºæœ¬è¯­æ³•-1"><a href="#åŸºæœ¬è¯­æ³•-1" class="headerlink" title="åŸºæœ¬è¯­æ³•"></a>åŸºæœ¬è¯­æ³•</h2><h2 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h2><ol><li>å‡½æ•°å®šä¹‰å’Œè°ƒç”¨</li><li>å˜é‡ä½œç”¨åŸŸä¸è§£æ„èµ‹å€¼</li><li>æ–¹æ³•</li><li>é«˜é˜¶å‡½æ•°</li><li>é—­åŒ…</li><li>ç®­å¤´å‡½æ•°</li><li>generator</li></ol><h2 id="æ ‡å‡†å¯¹è±¡"><a href="#æ ‡å‡†å¯¹è±¡" class="headerlink" title="æ ‡å‡†å¯¹è±¡"></a>æ ‡å‡†å¯¹è±¡</h2><h2 id="é¢å‘å¯¹è±¡ç¼–ç¨‹"><a href="#é¢å‘å¯¹è±¡ç¼–ç¨‹" class="headerlink" title="é¢å‘å¯¹è±¡ç¼–ç¨‹"></a>é¢å‘å¯¹è±¡ç¼–ç¨‹</h2><ol><li>åˆ›å»ºå¯¹è±¡</li><li>åŸå‹ç»§æ‰¿</li><li>classç»§æ‰¿</li></ol><h2 id="ES6"><a href="#ES6" class="headerlink" title="ES6+"></a>ES6+</h2><h2 id="æ¥å£è¯·æ±‚Ajaxï¼ˆXMLHTTPRequestçš„ä¸€ä¸ªå®ä¾‹ï¼‰-Fetchï¼ˆåŸºäºpromiseå®ç°çš„ï¼Œä¹Ÿå¯ä»¥ç»“åˆasync-awaitï¼‰"><a href="#æ¥å£è¯·æ±‚Ajaxï¼ˆXMLHTTPRequestçš„ä¸€ä¸ªå®ä¾‹ï¼‰-Fetchï¼ˆåŸºäºpromiseå®ç°çš„ï¼Œä¹Ÿå¯ä»¥ç»“åˆasync-awaitï¼‰" class="headerlink" title="æ¥å£è¯·æ±‚Ajaxï¼ˆXMLHTTPRequestçš„ä¸€ä¸ªå®ä¾‹ï¼‰/Fetchï¼ˆåŸºäºpromiseå®ç°çš„ï¼Œä¹Ÿå¯ä»¥ç»“åˆasync/awaitï¼‰"></a>æ¥å£è¯·æ±‚Ajaxï¼ˆXMLHTTPRequestçš„ä¸€ä¸ªå®ä¾‹ï¼‰/Fetchï¼ˆåŸºäºpromiseå®ç°çš„ï¼Œä¹Ÿå¯ä»¥ç»“åˆasync/awaitï¼‰</h2><h1 id="äº”ã€ç‰ˆæœ¬ç®¡ç†å·¥å…·Git"><a href="#äº”ã€ç‰ˆæœ¬ç®¡ç†å·¥å…·Git" class="headerlink" title="äº”ã€ç‰ˆæœ¬ç®¡ç†å·¥å…·Git"></a>äº”ã€ç‰ˆæœ¬ç®¡ç†å·¥å…·Git</h1><p><strong>æ¨èä½¿ç”¨è½¯ä»¶ï¼ˆTower)</strong></p><p>å¿«æ·æ–¹ä¾¿ï¼Œcommit push pull checkout merge restore renameç­‰ç­‰ï¼Œä¸€é”®æå®š </p><p>å·¥ä½œæµç¨‹</p><p>â€‹<a href="https://pic1.zhimg.com/80/v2-4da51a165e7fbeba06f782eed69dd94b_720w.jpg">https://pic1.zhimg.com/80/v2-4da51a165e7fbeba06f782eed69dd94b_720w.jpg</a></p><ul><li>åˆ›å»ºä»“åº“</li></ul><p>git init</p><ul><li><p>åŸºæœ¬æ“ä½œ</p><p>  git clone<br>  git add<br>  git diff<br>  git commit<br>  git rm<br>  git reset HEAD</p></li><li><p>åˆ†æ”¯ç®¡ç†</p><p>  git branch (branchname)<br>  git branch (branchname)<br>  git merge </p></li><li><p>ä½¿ç”¨githubæ­å»ºä¸ªäººåšå®¢ï¼Œå¯ç”¨ä»¥ä¸‹</p><p>  hexo<br>  gatsby<br>  vuePress</p></li></ul><h1 id="å…­ã€Node-ä¸ç”¨å­¦å¤ªæ·±"><a href="#å…­ã€Node-ä¸ç”¨å­¦å¤ªæ·±" class="headerlink" title="å…­ã€Node(ä¸ç”¨å­¦å¤ªæ·±)"></a>å…­ã€Node(ä¸ç”¨å­¦å¤ªæ·±)</h1><p><strong>åŒ…ç®¡ç†</strong></p><ul><li><p>npm<br>  npm install <package-name>  (å®‰è£…å•ä¸ªè½¯ä»¶åŒ…)<br>  npm update <package-name>  (æ›´æ–°è½¯ä»¶åŒ…)<br>  npm run <task-name> (è¿è¡Œä»»åŠ¡)<br>  npm uninstall <package-name>(å¸è½½ npm è½¯ä»¶åŒ…)<br>  -gæ ‡å¿—å¯ä»¥æ‰§è¡Œå…¨å±€å®‰è£…<br>  -Så°±æ˜¯â€“saveçš„ç®€å†™<br>  -Då°±æ˜¯â€“save-dev è¿™æ ·å®‰è£…çš„åŒ…çš„åç§°åŠç‰ˆæœ¬å·å°±ä¼šå­˜åœ¨package.jsonçš„devDependenciesè¿™ä¸ªé‡Œé¢ï¼Œè€Œâ€“saveä¼šå°†åŒ…çš„åç§°åŠç‰ˆæœ¬å·æ”¾åœ¨dependenciesé‡Œé¢ã€‚</p></li><li><p>yarn</p></li><li><p>npx </p></li></ul><p>å¸¸ç”¨åŒ…</p><ul><li>æ–‡ä»¶è¯»å†™fs</li><li>è·¯å¾„æŸ¥æ‰¾path</li><li>ç½‘ç»œhttp</li></ul><h1 id="ä¸ƒã€æ„å»ºå·¥å…·"><a href="#ä¸ƒã€æ„å»ºå·¥å…·" class="headerlink" title="ä¸ƒã€æ„å»ºå·¥å…·"></a>ä¸ƒã€æ„å»ºå·¥å…·</h1><h2 id="è‡ªåŠ¨åŒ–æ„å»º"><a href="#è‡ªåŠ¨åŒ–æ„å»º" class="headerlink" title="è‡ªåŠ¨åŒ–æ„å»º"></a>è‡ªåŠ¨åŒ–æ„å»º</h2><ul><li><p>npm script</p><p>  npm å…è®¸åœ¨ package.json æ–‡ä»¶é‡Œé¢ï¼Œä½¿ç”¨ scripts å­—æ®µå®šä¹‰è„šæœ¬å‘½ä»¤</p></li><li><p>gulp</p></li><li><p>æ¨¡å—åŒ–æ‰“åŒ…</p></li><li><p>webpack(æ¨è)</p></li><li><p>Rollup</p></li><li><p>Snowpack</p></li><li><p>Parcel</p></li></ul><h1 id="å…«ã€CSSé¢„å¤„ç†"><a href="#å…«ã€CSSé¢„å¤„ç†" class="headerlink" title="å…«ã€CSSé¢„å¤„ç†"></a>å…«ã€CSSé¢„å¤„ç†</h1><p>Sass(æ¨èï¼‰<br>â€‹<br>PostCss<br>Stylus<br>Less</p><p>è½¬è½½<br>CSS é¢„å¤„ç†å™¨ sass,less,stylusä¼˜ç¼ºç‚¹</p><h1 id="ä¹ã€JSæ¡†æ¶-æ²¡æœ‰å¥½ä¸ä¸å¥½ï¼Œåªæœ‰é€‚ä¸é€‚åˆ"><a href="#ä¹ã€JSæ¡†æ¶-æ²¡æœ‰å¥½ä¸ä¸å¥½ï¼Œåªæœ‰é€‚ä¸é€‚åˆ" class="headerlink" title="ä¹ã€JSæ¡†æ¶(æ²¡æœ‰å¥½ä¸ä¸å¥½ï¼Œåªæœ‰é€‚ä¸é€‚åˆ)"></a>ä¹ã€JSæ¡†æ¶(æ²¡æœ‰å¥½ä¸ä¸å¥½ï¼Œåªæœ‰é€‚ä¸é€‚åˆ)</h1><h2 id="React-æ¨èï¼‰"><a href="#React-æ¨èï¼‰" class="headerlink" title="React(æ¨èï¼‰"></a>React(æ¨èï¼‰</h2><ul><li>Redux</li><li>Mobx</li><li>React-router</li></ul><h2 id="Vueï¼ˆæ¨èï¼‰"><a href="#Vueï¼ˆæ¨èï¼‰" class="headerlink" title="Vueï¼ˆæ¨èï¼‰"></a>Vueï¼ˆæ¨èï¼‰</h2><ul><li>Vuex</li><li>Vue-router</li></ul><h2 id="Angular"><a href="#Angular" class="headerlink" title="Angular"></a>Angular</h2><ul><li>RxJS</li><li>NgRx</li></ul><h1 id="åã€CSSæ¡†æ¶"><a href="#åã€CSSæ¡†æ¶" class="headerlink" title="åã€CSSæ¡†æ¶"></a>åã€CSSæ¡†æ¶</h1><h2 id="Antd-æ¨è"><a href="#Antd-æ¨è" class="headerlink" title="Antd(æ¨è)"></a>Antd(æ¨è)</h2><p>Ant Design - ä¸€å¥—ä¼ä¸šçº§ UI è®¾è®¡è¯­è¨€å’Œ React ç»„ä»¶åº“<br>â€‹</p><h2 id="Element-UIï¼ˆæ¨èï¼‰"><a href="#Element-UIï¼ˆæ¨èï¼‰" class="headerlink" title="Element UIï¼ˆæ¨èï¼‰"></a>Element UIï¼ˆæ¨èï¼‰</h2><p>â€‹</p><h2 id="Material-UI"><a href="#Material-UI" class="headerlink" title="Material UI"></a>Material UI</h2><p>â€‹</p><h2 id="Bootstrap"><a href="#Bootstrap" class="headerlink" title="Bootstrap"></a>Bootstrap</h2><p>â€‹</p><h2 id="semantic-UI"><a href="#semantic-UI" class="headerlink" title="semantic UI"></a>semantic UI</h2><p>â€‹</p><h1 id="åä¸€ã€CSSä¼˜åŒ–æ–¹æ¡ˆ"><a href="#åä¸€ã€CSSä¼˜åŒ–æ–¹æ¡ˆ" class="headerlink" title="åä¸€ã€CSSä¼˜åŒ–æ–¹æ¡ˆ"></a>åä¸€ã€CSSä¼˜åŒ–æ–¹æ¡ˆ</h1><ul><li><p>Styled Component(æ¨è)</p></li><li><p>â€‹</p></li><li><p>CSS Modulesï¼ˆæ¨èï¼‰</p></li><li><p>Styled JSX</p></li></ul><h1 id="åäºŒã€æ€§èƒ½"><a href="#åäºŒã€æ€§èƒ½" class="headerlink" title="åäºŒã€æ€§èƒ½"></a>åäºŒã€æ€§èƒ½</h1><p>ç™½å±ã€å¡é¡¿ã€é¡µé¢åŠ è½½å¤±è´¥ã€é¡µé¢è·³è½¬æ…¢ã€å›¾ç‰‡ç©ºçª—ã€å´©æºƒã€è€—ç”µç­‰é—®é¢˜ä¸€ç›´éƒ½æ˜¯ç”¨æˆ·é¢‘ç¹èˆ†æƒ…åé¦ˆçš„ç—›ç‚¹ã€‚</p><p><strong>æ€§èƒ½æŒ‡æ ‡</strong><br>    ç™½å±æ—¶é—´<br>    é¦–å±æ—¶é—´<br>    ç”¨æˆ·å¯æ“ä½œæ—¶é—´<br>    é¡µé¢æ€»ä¸‹è½½æ—¶é—´<br>    è¯·æ±‚æ•°é‡</p><p><strong>RAILæ¨¡å‹</strong></p><p><strong>LightHouseæŒ‡æ ‡</strong></p><p><strong>DevTools</strong><br><strong>PWA</strong><br>â€‹<br><strong>Service Worker</strong><br><strong>éª¨æ¶å±</strong>ï¼ˆéª¨æ¶å±(Skeleton Screen)æ˜¯æŒ‡åœ¨é¡µé¢æ•°æ®åŠ è½½å®Œæˆå‰ï¼Œå…ˆç»™ç”¨æˆ·å±•ç¤ºå‡ºé¡µé¢çš„å¤§è‡´ç»“æ„ï¼ˆç°è‰²å ä½å›¾ï¼‰ï¼Œåœ¨æ‹¿åˆ°æ¥å£æ•°æ®åæ¸²æŸ“å‡ºå®é™…é¡µé¢å†…å®¹ç„¶åæ›¿æ¢æ‰ã€‚ï¼‰</p><h1 id="åä¸‰ã€æ•°æ®å¯è§†åŒ–"><a href="#åä¸‰ã€æ•°æ®å¯è§†åŒ–" class="headerlink" title="åä¸‰ã€æ•°æ®å¯è§†åŒ–"></a>åä¸‰ã€æ•°æ®å¯è§†åŒ–</h1><ul><li>ECharts(æ¨è)</li><li>AntV</li><li>HighChat</li></ul><h1 id="åå››ã€ç§»åŠ¨ç«¯åº”ç”¨"><a href="#åå››ã€ç§»åŠ¨ç«¯åº”ç”¨" class="headerlink" title="åå››ã€ç§»åŠ¨ç«¯åº”ç”¨"></a>åå››ã€ç§»åŠ¨ç«¯åº”ç”¨</h1><h2 id="React-Native-æ¨è"><a href="#React-Native-æ¨è" class="headerlink" title="React Native(æ¨è)"></a>React Native(æ¨è)</h2><p>â€‹</p><ul><li>React Native æ’ä»¶æ±‡æ€»ï¼š</li><li>react-native-linear-gradient é¢œè‰²æ¸å˜å¤„ç†</li><li>react-native-login  è§†é¢‘ç•Œé¢ç™»å½•</li><li>react-native-keyboard-aware-scroll-view é”®ç›˜æ˜¾ç¤ºå¤„ç†</li><li>react-native-popup-dialog å¼¹çª—</li><li>react-native-dropdownalert ä¸€ç§éå¸¸æ¼‚äº®çš„alertå¼¹çª—æ–¹å¼ï¼Œä»çŠ¶æ€æ å¾€ä¸‹å¼¹çª—ï¼›</li><li>react-native-simple-radio-button å•é€‰æŒ‰é’®ï¼›</li><li>react-native-swiper</li><li>react-native-macos macosæ¡Œé¢åº”ç”¨</li><li>react-native-wechat é›†æˆå¾®ä¿¡ç›¸å…³SDK</li><li>react-native-modalbox  æ¨¡æ€å¼¹çª—</li><li>react-native-touch-id æŒ‡çº¹ç™»å½•</li><li>react-native-prompt å¯è¾“å…¥æ–‡å­—çš„å¼¹çª—</li><li>react-native-sqlite-storage sqliteæ•°æ®åº“å­˜å‚¨</li><li>react-native-permissions æƒé™æ£€æŸ¥</li><li>react-native-progress-hud loadingåœˆ</li><li>react-native-snackbar ç±»ä¼¼toastçš„å¼¹çª—æ¨¡å¼</li><li>react-native-qrcode-svg äºŒç»´ç ç”Ÿäº§å·¥å…·</li><li>native-base UIç»„ä»¶</li><li>react-native-busy-indicator loadingåœˆ</li><li>react-native-fit-image å›¾ç‰‡å±•ç¤ºä¼˜åŒ–</li><li>react-native-timer å®šæ—¶å™¨ç®¡ç†</li><li>react-native-scrollable-tab-view å¯ä»¥å·¦å³æ»‘åŠ¨çš„tab</li><li>react-native-zip-archive è§£å‹å·¥å…·</li><li>react-native-xml2js</li><li>react-native-spinkit å¥½çœ‹çš„loadingåœˆ</li><li>react-native-interactable æœ‰å¾ˆå¼ºäº¤äº’æ•ˆæœçš„tableè§†å›¾</li><li>react-native-pull-to-refresh ä¸‹æ‹‰åˆ·æ–°æ•ˆæœ</li><li>react-native-deck-swiper ä¸é”™çš„swiperæ•ˆæœ</li><li>react-native-prefix-picker selectæ•ˆæœ</li><li>react-native-gesture-helper æ‰‹åŠ¿ å‘ä¸Šè¿˜æ˜¯å‘ä¸‹ è¿˜æ˜¯å‘å·¦</li><li>react-native-drawer-layout æŠ½å±‰æ•ˆæœ</li><li>react-native-sortable-listview å¯æ‹–æ‹½æ’åºçš„åˆ—è¡¨è§†å›¾</li><li>react-native-progress è¿›åº¦æ¡ é•¿æ–¹å½¢ åœ†å½¢</li><li>react-native-splash-screen å¯åŠ¨å±å¤„ç†</li><li>react-native-masked-text æŒ‡å®šæ ¼å¼çš„è¾“å…¥æ¡†</li><li>react-native-keyboard-manager é’ˆå¯¹IOS é”®ç›˜é®æŒ¡çš„é—®é¢˜ ä¿ºå¯ä»¥è¿™ä¹ˆç”¨android:windowSoftInputMode=â€adjustResizeâ€</li><li>react-native-beacons-manager è“ç‰™å¤„ç†</li><li>react-native-fetch-blob  æ–‡ä»¶è·å–</li><li>react-native-popup-menu å¼¹å‡ºèœå•</li><li>react-native-pathjs-charts å›¾è¡¨</li><li>react-native-dates æ—¥å†æ—¥æœŸé€‰æ‹©å·¥å…·</li><li>react-native-calendar-strip ä¸€ç§ç®€å•çš„æ—¥å†å¤„ç†</li><li>react-native-simple-markdown ç®€å•çš„markdownæ–‡æœ¬ç¼–è¾‘å™¨</li><li>react-native-image-progress è¿›åº¦æ¡</li><li>react-native-img-cache å›¾ç‰‡ç¼“å­˜æŠ€æœ¯</li><li>rn-placeholder åœ¨å±•ç¤ºå…·ä½“çš„æ–‡å­—å’Œå›¾ç‰‡ä¹‹å‰æœ‰ä¸ªåŠ è½½æ ·å¼å¤„ç†</li><li>react-native-pie-chart é¥¼çŠ¶å›¾</li><li>react-native-maps åœ°å›¾</li><li>react-native-loading-overlay loadingåœˆåŠ è½½é®ç½©</li><li>react-native-progress åœ†å½¢è¿›åº¦æ¡ react-native åœ†å½¢è¿›åº¦æ¡</li><li>react-native-modal  å¼¹çª—æ’ä»¶ react-native-modal</li><li>react-native-extra-dimensions-android å®‰å“æ°´æ»´å±è·å–å±å¹•é«˜åº¦ Sunhat/react-native-extra-dimensions-android</li></ul><h2 id="Weex-é˜¿é‡Œå·´å·´æ——ä¸‹çš„è·¨å¹³å°ç§»åŠ¨å¼€å‘è§£å†³æ–¹æ¡ˆ"><a href="#Weex-é˜¿é‡Œå·´å·´æ——ä¸‹çš„è·¨å¹³å°ç§»åŠ¨å¼€å‘è§£å†³æ–¹æ¡ˆ" class="headerlink" title="Weex(é˜¿é‡Œå·´å·´æ——ä¸‹çš„è·¨å¹³å°ç§»åŠ¨å¼€å‘è§£å†³æ–¹æ¡ˆ)"></a>Weex(é˜¿é‡Œå·´å·´æ——ä¸‹çš„è·¨å¹³å°ç§»åŠ¨å¼€å‘è§£å†³æ–¹æ¡ˆ)</h2><h2 id="Flutter"><a href="#Flutter" class="headerlink" title="Flutter"></a>Flutter</h2><h1 id="åäº”ã€å°ç¨‹åº"><a href="#åäº”ã€å°ç¨‹åº" class="headerlink" title="åäº”ã€å°ç¨‹åº"></a>åäº”ã€å°ç¨‹åº</h1><h2 id="åŸç”Ÿ"><a href="#åŸç”Ÿ" class="headerlink" title="åŸç”Ÿ"></a>åŸç”Ÿ</h2><ul><li>å¾®ä¿¡</li><li>æ”¯ä»˜å®</li><li>å¤´æ¡</li></ul><h2 id="è·¨ç«¯"><a href="#è·¨ç«¯" class="headerlink" title="è·¨ç«¯"></a>è·¨ç«¯</h2><ul><li>Taro</li><li>uni-app<br>â€‹</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;å¦‚æœæœ‰è¯´é”™äº†ï¼Œè¯·è§è°…ã€‚&lt;br&gt;æ­¤æ–‡ç« é“¾æ¥åœ¨çŸ¥ä¹ä¸Šï¼š&lt;/p&gt;
&lt;p&gt; å‰ç«¯å­¦ä¹ è·¯çº¿ï¼ˆå¾ˆé•¿ï¼Œå»ºè®®æ”¶è—ï¼‰ - æœ‰ä¸€å¤©wmçš„æ–‡ç«  - çŸ¥ä¹&lt;br&gt;&lt;a href=&quot;https://zhuanlan.zhihu.com/p/164701269&quot;&gt;https://zhuanlan.zh</summary>
      
    
    
    
    <category term="å‰ç«¯" scheme="https://hard-workingrookie.github.io/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
    <category term="å‰ç«¯" scheme="https://hard-workingrookie.github.io/tags/%E5%89%8D%E7%AB%AF/"/>
    
  </entry>
  
  <entry>
    <title>Vueå­¦ä¹ æ€»ç»“</title>
    <link href="https://hard-workingrookie.github.io/2020/09/23/Vue%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93/"/>
    <id>https://hard-workingrookie.github.io/2020/09/23/Vue%E5%AD%A6%E4%B9%A0%E6%80%BB%E7%BB%93/</id>
    <published>2020-09-23T01:26:20.000Z</published>
    <updated>2020-12-24T06:20:21.606Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å®ä¾‹vue-3æ­¥-ï¼š"><a href="#å®ä¾‹vue-3æ­¥-ï¼š" class="headerlink" title="å®ä¾‹vue(3æ­¥)ï¼š"></a>å®ä¾‹vue(3æ­¥)ï¼š</h1><h2 id="1-åˆ›å»ºæ ¹å®ä¾‹"><a href="#1-åˆ›å»ºæ ¹å®ä¾‹" class="headerlink" title="1.åˆ›å»ºæ ¹å®ä¾‹:"></a>1.åˆ›å»ºæ ¹å®ä¾‹:</h2><p>let app =new Vue({})</p><h2 id="2-æŒ‚è½½æ ¹å®ä¾‹ï¼š"><a href="#2-æŒ‚è½½æ ¹å®ä¾‹ï¼š" class="headerlink" title="2.æŒ‚è½½æ ¹å®ä¾‹ï¼š"></a>2.æŒ‚è½½æ ¹å®ä¾‹ï¼š</h2><p>let app = new Vue({<br>    el:â€™#appâ€™<br>})</p><h2 id="3-ç»‘å®šæ•°æ®ï¼š"><a href="#3-ç»‘å®šæ•°æ®ï¼š" class="headerlink" title="3.ç»‘å®šæ•°æ®ï¼š"></a>3.ç»‘å®šæ•°æ®ï¼š</h2><p>let app =new Vue({<br>    el:â€™#appâ€™,<br>    data: {age:24}<br>})</p><h1 id="vueæ ¸å¿ƒ"><a href="#vueæ ¸å¿ƒ" class="headerlink" title="vueæ ¸å¿ƒ"></a>vueæ ¸å¿ƒ</h1><p>æ•°æ®çš„åŒå‘ç»‘å®šã€ç»„ä»¶åŒ–</p><h1 id="el"><a href="#el" class="headerlink" title="$el"></a>$el</h1><p>è¡¨ç¤ºåœ¨vueå®ä¾‹ä¸ŠæŒ‚è½½çš„DOMå¯¹è±¡å±æ€§<br>app.$el ===document.getElementById(â€œappâ€)</p><h1 id="data"><a href="#data" class="headerlink" title="$data"></a>$data</h1><p>è¡¨ç¤ºåœ¨vueå®ä¾‹ä¸ŠæŒ‚è½½çš„æ•°æ®å±æ€§<br>app.$data.apge === app.age //true</p><h1 id="åŸºæœ¬æŒ‡ä»¤"><a href="#åŸºæœ¬æŒ‡ä»¤" class="headerlink" title="åŸºæœ¬æŒ‡ä»¤"></a>åŸºæœ¬æŒ‡ä»¤</h1><h2 id="v-html-åŸå§‹html"><a href="#v-html-åŸå§‹html" class="headerlink" title="v-html: åŸå§‹html"></a>v-html: åŸå§‹html</h2><h2 id="v-once-å•é¡¹ç»‘å®š"><a href="#v-once-å•é¡¹ç»‘å®š" class="headerlink" title="v-once:å•é¡¹ç»‘å®š"></a>v-once:å•é¡¹ç»‘å®š</h2><h2 id="v-pre-è·³è·ƒç¼–è¯‘ï¼Œæ˜¾ç¤ºåŸå§‹æ ‡ç­¾"><a href="#v-pre-è·³è·ƒç¼–è¯‘ï¼Œæ˜¾ç¤ºåŸå§‹æ ‡ç­¾" class="headerlink" title="v-pre:è·³è·ƒç¼–è¯‘ï¼Œæ˜¾ç¤ºåŸå§‹æ ‡ç­¾"></a>v-pre:è·³è·ƒç¼–è¯‘ï¼Œæ˜¾ç¤ºåŸå§‹æ ‡ç­¾</h2><h2 id="v-bind-å±æ€§ç»‘å®š-ï¼ˆ-ï¼šï¼‰"><a href="#v-bind-å±æ€§ç»‘å®š-ï¼ˆ-ï¼šï¼‰" class="headerlink" title="v-bind:å±æ€§ç»‘å®š ï¼ˆ ï¼šï¼‰"></a>v-bind:å±æ€§ç»‘å®š ï¼ˆ ï¼šï¼‰</h2><h3 id="ç»‘å®š-class"><a href="#ç»‘å®š-class" class="headerlink" title="ç»‘å®š class"></a>ç»‘å®š class</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;div</span><br><span class="line">  <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;static&quot;</span></span><br><span class="line">  v-bind:<span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;&#123; active: isActive, &#x27;text-danger&#x27;: hasError &#125;&quot;</span></span><br><span class="line">&gt;&lt;/div&gt;</span><br></pre></td></tr></table></figure><p>å’Œå¦‚ä¸‹ dataï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">data: &#123;</span><br><span class="line">  isActive: <span class="literal">true</span>,</span><br><span class="line">  hasError: <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»“æœæ¸²æŸ“ä¸ºï¼š</p><p><code>&lt;div class=&quot;static active&quot;&gt;&lt;/div&gt;</code></p><h3 id="ç»‘å®š-style"><a href="#ç»‘å®š-style" class="headerlink" title="ç»‘å®š style"></a>ç»‘å®š style</h3><p><code>&lt;div v-bind:style=&quot;styleObject&quot;&gt;&lt;/div&gt;</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">data: &#123;</span><br><span class="line">  styleObject: &#123;</span><br><span class="line">    color: <span class="string">&#x27;red&#x27;</span>,</span><br><span class="line">    fontSize: <span class="string">&#x27;13px&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="v-show-å’Œ-v-if"><a href="#v-show-å’Œ-v-if" class="headerlink" title="v-show å’Œ v-if"></a>v-show å’Œ v-if</h2><p>v-show æœ¬è´¨æ˜¯æ ‡ç­¾display:none  ,å…ƒç´ éšè—ï¼Œ æ§åˆ¶CSSï¼Œ åªç¼–è¯‘ä¸€æ¬¡ï¼Œåé¢ä¸€ç›´æ§åˆ¶css,æ•…æ€§èƒ½æ›´å¥½</p><p>v-if æ˜¯åŠ¨æ€çš„å‘DOM æ ‘å†… æ·»åŠ æˆ–åˆ é™¤DOMå…ƒç´ ï¼Œä¸åœçš„é”€æ¯å’Œåˆ›å»º</p><h2 id="v-cloak-é®ç½©æŒ‡ä»¤-ï¼ˆé˜²æ­¢å±å¹•é—ªåŠ¨ï¼Œéœ€è¦é…åˆ-v-cloak-display-none"><a href="#v-cloak-é®ç½©æŒ‡ä»¤-ï¼ˆé˜²æ­¢å±å¹•é—ªåŠ¨ï¼Œéœ€è¦é…åˆ-v-cloak-display-none" class="headerlink" title="v-cloak : é®ç½©æŒ‡ä»¤ ï¼ˆé˜²æ­¢å±å¹•é—ªåŠ¨ï¼Œéœ€è¦é…åˆ[v-cloak]{display:none})"></a>v-cloak : é®ç½©æŒ‡ä»¤ ï¼ˆé˜²æ­¢å±å¹•é—ªåŠ¨ï¼Œéœ€è¦é…åˆ[v-cloak]{display:none})</h2><h2 id="v-else-v-else-if-v-if-åŠ key"><a href="#v-else-v-else-if-v-if-åŠ key" class="headerlink" title="v-else / v-else-if / v-if :  åŠ key"></a>v-else / v-else-if / v-if :  åŠ key</h2><h2 id="v-for-åˆ—è¡¨æ¸²æŸ“-ï¼ˆåŠ keyï¼‰"><a href="#v-for-åˆ—è¡¨æ¸²æŸ“-ï¼ˆåŠ keyï¼‰" class="headerlink" title="v-for :  åˆ—è¡¨æ¸²æŸ“ ï¼ˆåŠ keyï¼‰"></a>v-for :  åˆ—è¡¨æ¸²æŸ“ ï¼ˆåŠ keyï¼‰</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;ul id=<span class="string">&quot;example-1&quot;</span>&gt;</span><br><span class="line">  &lt;li v-<span class="keyword">for</span>=<span class="string">&quot;item in items&quot;</span> :key=<span class="string">&quot;item.message&quot;</span>&gt;</span><br><span class="line">    &#123;&#123; item.message &#125;&#125;</span><br><span class="line">  &lt;/li&gt;</span><br><span class="line">&lt;/ul&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>éå†æ•°ç»„</strong> å¯ä»¥æ¥æ”¶ä¸‰ä¸ªå‚æ•° ï¼š element ,index ,self<br><strong>éå†å¯¹è±¡</strong> å¯ä»¥æ¥æ”¶ä¸‰ä¸ªå‚æ•° ï¼š value , key, index</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;div v-<span class="keyword">for</span>=<span class="string">&quot;(value, name, index) in object&quot;</span>&gt;</span><br><span class="line">  &#123;&#123; index &#125;&#125;. &#123;&#123; name &#125;&#125;: &#123;&#123; value &#125;&#125;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="æ§åˆ¶å¾ªç¯æ¬¡æ•°çš„ä¸¤æ¬¡æ–¹æ³•ï¼š"><a href="#æ§åˆ¶å¾ªç¯æ¬¡æ•°çš„ä¸¤æ¬¡æ–¹æ³•ï¼š" class="headerlink" title="æ§åˆ¶å¾ªç¯æ¬¡æ•°çš„ä¸¤æ¬¡æ–¹æ³•ï¼š"></a>æ§åˆ¶å¾ªç¯æ¬¡æ•°çš„ä¸¤æ¬¡æ–¹æ³•ï¼š</h3><ul><li>item of items.slice(0,2)</li><li>é€šè¿‡ v-if æ§åˆ¶</li></ul><h2 id="v-onï¼šäº‹ä»¶ç»‘å®š-ï¼ˆ-ï¼‰"><a href="#v-onï¼šäº‹ä»¶ç»‘å®š-ï¼ˆ-ï¼‰" class="headerlink" title="v-onï¼šäº‹ä»¶ç»‘å®š   ï¼ˆ @ ï¼‰"></a>v-onï¼šäº‹ä»¶ç»‘å®š   ï¼ˆ @ ï¼‰</h2><h3 id="v-on-ç»‘å®šä¿®é¥°ç¬¦"><a href="#v-on-ç»‘å®šä¿®é¥°ç¬¦" class="headerlink" title="v-on ç»‘å®šä¿®é¥°ç¬¦"></a>v-on ç»‘å®šä¿®é¥°ç¬¦</h3><ul><li>.stop: é˜»æ­¢äº‹ä»¶çš„ä¼ é€’ï¼Œå³é˜»æ­¢äº‹ä»¶å‘ä¸Šå†’æ³¡ ï¼ˆå†™åœ¨å­å…ƒç´ é‡Œï¼‰</li><li>.prevent: é˜»æ­¢å¯¹è±¡çš„é»˜è®¤è¡Œä¸º</li><li>.capture: ä½¿ç”¨äº‹ä»¶æ•è·æœºåˆ¶ ï¼ˆå†™ç»™çˆ¶å…ƒç´ ï¼‰</li><li>.self: è‡ªèº«äº‹ä»¶ä¿®é¥°ç¬¦</li><li>.once: ç»‘å®šçš„äº‹ä»¶åªèƒ½è§¦å‘ä¸€æ¬¡</li><li>.keyup .keyCode é”®å€¼ä¿®é¥°ç¬¦</li></ul><h2 id="v-model"><a href="#v-model" class="headerlink" title="v-model"></a>v-model</h2><h3 id="ä¿®é¥°ç¬¦"><a href="#ä¿®é¥°ç¬¦" class="headerlink" title="ä¿®é¥°ç¬¦"></a>ä¿®é¥°ç¬¦</h3><ul><li>.lazy   å–ä»£ input ç›‘å¬ change äº‹ä»¶</li><li>.number è¾“å…¥å­—ç¬¦ä¸²è½¬ä¸ºæœ‰æ•ˆçš„æ•°å­—</li><li>.trim   è¾“å…¥é¦–å°¾ç©ºæ ¼è¿‡æ»¤</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;input v-model=<span class="string">&quot;message&quot;</span> placeholder=<span class="string">&quot;edit me&quot;</span>&gt;</span><br><span class="line">&lt;p&gt;Message is: &#123;&#123; message &#125;&#125;&lt;/p&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åœ¨æ–‡æœ¬åŒºåŸŸæ’å€¼ (<textarea></textarea>) å¹¶ä¸ä¼šç”Ÿæ•ˆï¼Œåº”ç”¨ v-model æ¥ä»£æ›¿ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;span&gt;Multiline message is:&lt;/span&gt;</span><br><span class="line">&lt;p style=<span class="string">&quot;white-space: pre-line;&quot;</span>&gt;&#123;&#123; message &#125;&#125;&lt;/p&gt;</span><br><span class="line">&lt;br&gt;</span><br><span class="line">&lt;textarea v-model=<span class="string">&quot;message&quot;</span> placeholder=<span class="string">&quot;add multiple lines&quot;</span>&gt;&lt;/textarea&gt;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨v-modleæ—¶ï¼Œå¦‚æœæ˜¯ä¸­æ–‡è¾“å…¥æ³•ä¸‹ï¼Œåœ¨æ‹¼éŸ³é˜¶æ®µï¼Œä¸ä¼šéšæ—¶æ›´æ–°ï¼Œå¯ä»¥ç”¨<code>@input</code>æ¥ä»£æ›¿</p><ol><li>å•é€‰æ¡†/æŒ‰é’®ï¼šç»„åˆä½¿ç”¨å¯ä½¿v-modelç›¸åŒï¼Œå³å¯å®ç°äº’æ–¥ï¼Œé…åˆvalueä½¿ç”¨</li><li>å¤é€‰æ¡†/å¤šé€‰æŒ‰é’®ï¼šb-modelä¼šç»‘å®šåˆ°åŒæ•°ç»„ç±»å‹çš„æ•°æ®ï¼Œé…åˆvalueä½¿ç”¨</li><li>ä¸‹æ‹‰åˆ—è¡¨ï¼šæƒ³å¤šé€‰å°±åŠ ä¸€ä¸ªmultiple</li></ol><h1 id="updatedï¼Œwatchï¼ŒnextTick"><a href="#updatedï¼Œwatchï¼ŒnextTick" class="headerlink" title="updatedï¼Œwatchï¼ŒnextTick"></a>updatedï¼Œwatchï¼ŒnextTick</h1><h2 id="updated"><a href="#updated" class="headerlink" title="updated"></a>updated</h2><p>å¯¹æ•°æ®çš„æŸä¸€æ¬¡æ›´æ–°</p><h2 id="watch"><a href="#watch" class="headerlink" title="watch"></a>watch</h2><p>å¯¹æŸä¸ªæ•°æ®çš„ç»Ÿä¸€å˜åŒ–</p><h2 id="nextTick"><a href="#nextTick" class="headerlink" title="nextTick"></a>nextTick</h2><p>å¯¹æ‰€æœ‰æ•°æ®å˜åŒ–ç»Ÿä¸€çš„å¤„ç†</p><h1 id="console"><a href="#console" class="headerlink" title="console"></a>console</h1><ul><li>console.log()     æ—¥å¿—ä¿¡æ¯</li><li>console.info()    ä¸€èˆ¬ä¿¡æ¯</li><li>console.debug()   é™¤é”™ä¿¡æ¯ ï¼ˆ è°·æ­Œ ï¼ŒOpera ä¸æ”¯æŒï¼‰</li><li>console..warn()   è­¦å‘Šæç¤º</li><li>console.error()   é”™è¯¯æç¤º</li><li>console.group()å’Œ console.groupEnd()      åˆ†ç»„æ˜¾ç¤º</li><li>console.dir()     è¾“å‡ºå±æ€§å’Œæ–¹æ³•</li><li>console.dirxml()  è¾“å‡ºèŠ‚ç‚¹ä»£ç </li><li>console.clear()   æ¸…ç©ºæ§åˆ¶å°å†…å®¹</li><li>console.time() , console.timeEnd()    è®¡æ—¶å™¨</li><li>console.count()   è®¡æ•°å™¨</li><li>console.table()   è¡¨æ ¼åŒ–</li></ul><h1 id="ç”Ÿå‘½å‘¨æœŸé’©å­"><a href="#ç”Ÿå‘½å‘¨æœŸé’©å­" class="headerlink" title="ç”Ÿå‘½å‘¨æœŸé’©å­"></a>ç”Ÿå‘½å‘¨æœŸé’©å­</h1><h2 id="åˆ›å»ºé˜¶æ®µ"><a href="#åˆ›å»ºé˜¶æ®µ" class="headerlink" title="åˆ›å»ºé˜¶æ®µ"></a>åˆ›å»ºé˜¶æ®µ</h2><p>beforeCreate : el å’Œ data å¹¶æœªåˆå§‹åŒ–<br>created : data å·²ç»åˆå§‹åŒ– ï¼Œä½† el å¹¶æœªåˆå§‹åŒ–</p><h2 id="æŒ‚è½½é˜¶æ®µ"><a href="#æŒ‚è½½é˜¶æ®µ" class="headerlink" title="æŒ‚è½½é˜¶æ®µ"></a>æŒ‚è½½é˜¶æ®µ</h2><p>beforeMount : el å’Œ data  å‡å·²åˆå§‹åŒ– ï¼Œç”¨äº† è™šæ‹ŸDOM æŠ€æœ¯<br>mounted ï¼š æ•°æ®è¢«æ¸²æŸ“å‡ºæ¥</p><h2 id="æ›´æ–°é˜¶æ®µ"><a href="#æ›´æ–°é˜¶æ®µ" class="headerlink" title="æ›´æ–°é˜¶æ®µ"></a>æ›´æ–°é˜¶æ®µ</h2><p>beforeUpdate ï¼š æ— æ³•è®¿é—®DOM<br>updated : å¯ä»¥è®¿é—®DOM</p><h2 id="é”€æ¯é˜¶æ®µ"><a href="#é”€æ¯é˜¶æ®µ" class="headerlink" title="é”€æ¯é˜¶æ®µ"></a>é”€æ¯é˜¶æ®µ</h2><p>beforeDestroyï¼š å®ä¾‹é”€æ¯å‰è°ƒç”¨ï¼Œåœ¨è¿™ä¸€æ­¥ï¼Œå®ä¾‹ä»ç„¶å®Œå…¨å¯ç”¨<br>destoryed:  å®ä¾‹é”€æ¯åè¢«è°ƒç”¨ ã€‚ è¯¥é’©å­è¢«è°ƒç”¨åï¼Œ å¯¹åº”Vue å®ä¾‹çš„æ‰€æœ‰æŒ‡ä»¤éƒ½è¢«è§£ç»‘ï¼Œæ‰€æœ‰çš„äº‹ä»¶ç›‘å¬å™¨éƒ½è¢«ç§»é™¤ï¼Œæ‰€æœ‰çš„å­å®ä¾‹ ä¹Ÿéƒ½è¢«é”€æ¯ ã€‚</p><h2 id="æ•°æ®æŒ‚è½½æ–¹å¼"><a href="#æ•°æ®æŒ‚è½½æ–¹å¼" class="headerlink" title="æ•°æ®æŒ‚è½½æ–¹å¼"></a>æ•°æ®æŒ‚è½½æ–¹å¼</h2><ol><li>å®ä¾‹åŒ–æ—¶ç”¨el æŒ‚è½½</li><li>$mount</li></ol><h1 id="computed"><a href="#computed" class="headerlink" title="computed"></a>computed</h1><p>åŒ…å« getter  å’Œ setter  ï¼Œé‡‡ç”¨ getter è¯»å– ï¼Œç”¨ setter è®¾ç½® ï¼Œé»˜è®¤ ç”¨ getter è¯»å–å°±å¯</p><p> getter  å’Œ setter  çš„ this ä¸Šä¸‹æ–‡ è‡ªåŠ¨ç»‘å®šä¸º vue å®ä¾‹ ã€‚ </p><h1 id="æ•°ç»„æ›´æ–°æ£€æµ‹"><a href="#æ•°ç»„æ›´æ–°æ£€æµ‹" class="headerlink" title="æ•°ç»„æ›´æ–°æ£€æµ‹"></a>æ•°ç»„æ›´æ–°æ£€æµ‹</h1><h2 id="å˜æ›´æ–¹æ³•"><a href="#å˜æ›´æ–¹æ³•" class="headerlink" title="å˜æ›´æ–¹æ³•"></a>å˜æ›´æ–¹æ³•</h2><ul><li>push()    æœ«å°¾æ·»åŠ </li><li>pop()     æœ«å°¾åˆ é™¤</li><li>shift()   å¼€å¤´åˆ é™¤</li><li>unshift() å¼€å¤´æ·»åŠ </li><li>splice()  æ·»åŠ ã€åˆ é™¤ã€æ›¿æ¢</li><li>sort()    æ’åº</li><li>reverse() é¢ å€’æ•°ç»„ä¸­å…ƒç´ çš„é¡ºåº</li></ul><h2 id="æ›¿æ¢æ•°ç»„"><a href="#æ›¿æ¢æ•°ç»„" class="headerlink" title="æ›¿æ¢æ•°ç»„"></a>æ›¿æ¢æ•°ç»„</h2><p>å˜æ›´æ–¹æ³•ï¼Œé¡¾åæ€ä¹‰ï¼Œä¼šå˜æ›´è°ƒç”¨äº†è¿™äº›æ–¹æ³•çš„åŸå§‹æ•°ç»„ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œä¹Ÿæœ‰éå˜æ›´æ–¹æ³•ï¼Œä¾‹å¦‚ filter()ã€concat() å’Œ slice()ã€‚å®ƒä»¬ä¸ä¼šå˜æ›´åŸå§‹æ•°ç»„ï¼Œè€Œæ€»æ˜¯è¿”å›ä¸€ä¸ªæ–°æ•°ç»„ã€‚å½“ä½¿ç”¨éå˜æ›´æ–¹æ³•æ—¶ï¼Œå¯ä»¥ç”¨æ–°æ•°ç»„æ›¿æ¢æ—§æ•°ç»„ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">example1.items = example1.items.filter(<span class="function"><span class="keyword">function</span> (<span class="params">item</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> item.message.match(<span class="regexp">/Foo/</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="æ˜¾ç¤ºè¿‡æ»¤-æ’åºåçš„ç»“æœ"><a href="#æ˜¾ç¤ºè¿‡æ»¤-æ’åºåçš„ç»“æœ" class="headerlink" title="æ˜¾ç¤ºè¿‡æ»¤/æ’åºåçš„ç»“æœ"></a>æ˜¾ç¤ºè¿‡æ»¤/æ’åºåçš„ç»“æœ</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;ul v-<span class="keyword">for</span>=<span class="string">&quot;set in sets&quot;</span>&gt;</span><br><span class="line">  &lt;li v-<span class="keyword">for</span>=<span class="string">&quot;n in even(set)&quot;</span>&gt;&#123;&#123; n &#125;&#125;&lt;/li&gt;</span><br><span class="line">&lt;/ul&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">data: &#123;</span><br><span class="line">  sets: [[ <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span> ], [<span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>]]</span><br><span class="line">&#125;,</span><br><span class="line">methods: &#123;</span><br><span class="line">  even: <span class="function"><span class="keyword">function</span> (<span class="params">numbers</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> numbers.filter(<span class="function"><span class="keyword">function</span> (<span class="params">number</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> number % <span class="number">2</span> === <span class="number">0</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="éå†å¯¹è±¡"><a href="#éå†å¯¹è±¡" class="headerlink" title="éå†å¯¹è±¡"></a>éå†å¯¹è±¡</h2><p>for â€¦ in<br>éå†å¯¹è±¡é”® object.keys()<br>éå†å¯¹è±¡é”® object.values()<br>for â€¦ of</p><h2 id="æ•°ç»„éå˜å¼‚æ–¹æ³•"><a href="#æ•°ç»„éå˜å¼‚æ–¹æ³•" class="headerlink" title="æ•°ç»„éå˜å¼‚æ–¹æ³•"></a>æ•°ç»„éå˜å¼‚æ–¹æ³•</h2><ol><li>ç­›é€‰-filter</li><li>æ‹¼æ¥-concat</li><li>æˆªå–-slice</li></ol><h2 id="js-é™åˆ¶-æ•°ç»„æ“ä½œ"><a href="#js-é™åˆ¶-æ•°ç»„æ“ä½œ" class="headerlink" title="js é™åˆ¶ - æ•°ç»„æ“ä½œ"></a>js é™åˆ¶ - æ•°ç»„æ“ä½œ</h2><ol><li>ç›´æ¥è®¾ç½®/ä¿®æ”¹ä¸€é¡¹å†…å®¹<br> vue.set(app.items,0,â€™pâ€™)<br> app.items.splice(0,1,â€™pâ€™)</li><li>ä¿®æ”¹é•¿åº¦<br> app.items.splice(0,0)<br> app.items.length = 8;</li></ol><h2 id="JSé™åˆ¶-å¯¹è±¡æ“ä½œï¼š"><a href="#JSé™åˆ¶-å¯¹è±¡æ“ä½œï¼š" class="headerlink" title="JSé™åˆ¶-å¯¹è±¡æ“ä½œï¼š"></a>JSé™åˆ¶-å¯¹è±¡æ“ä½œï¼š</h2><pre><code>  vue.set(app.obj,&#39;height&#39;,&#39;180&#39;)</code></pre><h1 id="å…¨å±€ç»„ä»¶å’Œå±€éƒ¨ç»„ä»¶"><a href="#å…¨å±€ç»„ä»¶å’Œå±€éƒ¨ç»„ä»¶" class="headerlink" title="å…¨å±€ç»„ä»¶å’Œå±€éƒ¨ç»„ä»¶"></a>å…¨å±€ç»„ä»¶å’Œå±€éƒ¨ç»„ä»¶</h1><h2 id="å…¨å±€ç»„ä»¶"><a href="#å…¨å±€ç»„ä»¶" class="headerlink" title="å…¨å±€ç»„ä»¶"></a>å…¨å±€ç»„ä»¶</h2><ul><li>æ³¨å†Œæ­¥éª¤</li></ul><ol><li>æ³¨å†Œç»„ä»¶ component å¹¶å‘½å</li><li>æ·»åŠ  template å†…å®¹</li><li>é€šè¿‡è‡ªå®šä¹‰ç»„ä»¶åè°ƒç”¨ç»„ä»¶</li></ol><ul><li>ä½œç”¨åŸŸ</li></ul><p>å…¨å±€éƒ½å¯ä»¥ç›´æ¥ç”¨</p><ul><li>æ³¨å†Œä½ç½®</li></ul><p>åœ¨åˆ›å»ºå®ä¾‹å‰æ³¨å†Œ</p><h2 id="å±€éƒ¨ç»„ä»¶"><a href="#å±€éƒ¨ç»„ä»¶" class="headerlink" title="å±€éƒ¨ç»„ä»¶"></a>å±€éƒ¨ç»„ä»¶</h2><ul><li>ä½œç”¨åŸŸ</li></ul><p>åœ¨å½“å‰å®ä¾‹ä½œç”¨åŸŸä¸‹æœ‰æ•ˆ</p><ul><li>æ³¨å†Œä½ç½®</li></ul><p>åœ¨componenté€‰é¡¹å†…æ³¨å†Œ</p><p>ç»„ä»¶å½“ä¸­é™¤äº†å¯ä»¥ç”¨templateï¼Œè¿˜å¯ä»¥ç”¨ computed ï¼Œmethodsï¼Œdata å¿…é¡»æ˜¯å‡½æ•°ï¼Œ ä¸”å¿…é¡»å°†æ•°æ®return å‡ºå»</p><h1 id="è·¯ç”±è·³è½¬"><a href="#è·¯ç”±è·³è½¬" class="headerlink" title="è·¯ç”±è·³è½¬"></a>è·¯ç”±è·³è½¬</h1><ol><li><router-link to=""></router-link></li><li>this.$router.push()</li></ol><p>$once(é’©å­ï¼Œå‡½æ•°)</p><h1 id="æ··å…¥-mixin"><a href="#æ··å…¥-mixin" class="headerlink" title="æ··å…¥ mixin"></a>æ··å…¥ mixin</h1><p>æ··å…¥ (mixin) æä¾›äº†ä¸€ç§éå¸¸çµæ´»çš„æ–¹å¼ï¼Œæ¥åˆ†å‘ Vue ç»„ä»¶ä¸­çš„å¯å¤ç”¨åŠŸèƒ½ã€‚ä¸€ä¸ªæ··å…¥å¯¹è±¡å¯ä»¥åŒ…å«ä»»æ„ç»„ä»¶é€‰é¡¹ã€‚å½“ç»„ä»¶ä½¿ç”¨æ··å…¥å¯¹è±¡æ—¶ï¼Œæ‰€æœ‰æ··å…¥å¯¹è±¡çš„é€‰é¡¹å°†è¢«â€œæ··åˆâ€è¿›å…¥è¯¥ç»„ä»¶æœ¬èº«çš„é€‰é¡¹ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ªæ··å…¥å¯¹è±¡</span></span><br><span class="line"><span class="keyword">var</span> myMixin = &#123;</span><br><span class="line">  created: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.hello()</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    hello: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;hello from mixin!&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ªä½¿ç”¨æ··å…¥å¯¹è±¡çš„ç»„ä»¶</span></span><br><span class="line"><span class="keyword">var</span> Component = Vue.extend(&#123;</span><br><span class="line">  mixins: [myMixin]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> component = <span class="keyword">new</span> Component() <span class="comment">// =&gt; &quot;hello from mixin!&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="é€‰é¡¹åˆå¹¶"><a href="#é€‰é¡¹åˆå¹¶" class="headerlink" title="é€‰é¡¹åˆå¹¶"></a>é€‰é¡¹åˆå¹¶</h2><p>å½“ç»„ä»¶å’Œæ··å…¥å¯¹è±¡å«æœ‰åŒåé€‰é¡¹æ—¶ï¼Œè¿™äº›é€‰é¡¹å°†ä»¥æ°å½“çš„æ–¹å¼è¿›è¡Œâ€œåˆå¹¶â€ã€‚</p><p>æ¯”å¦‚ï¼Œæ•°æ®å¯¹è±¡åœ¨å†…éƒ¨ä¼šè¿›è¡Œé€’å½’åˆå¹¶ï¼Œå¹¶åœ¨å‘ç”Ÿå†²çªæ—¶ä»¥ç»„ä»¶æ•°æ®ä¼˜å…ˆã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">var</span> mixin = &#123;</span><br><span class="line">  data: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      message: <span class="string">&#x27;hello&#x27;</span>,</span><br><span class="line">      foo: <span class="string">&#x27;abc&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  mixins: [mixin],</span><br><span class="line">  data: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      message: <span class="string">&#x27;goodbye&#x27;</span>,</span><br><span class="line">      bar: <span class="string">&#x27;def&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  created: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">this</span>.$data)</span><br><span class="line">    <span class="comment">// =&gt; &#123; message: &quot;goodbye&quot;, foo: &quot;abc&quot;, bar: &quot;def&quot; &#125;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å€¼ä¸ºå¯¹è±¡çš„é€‰é¡¹ï¼Œä¾‹å¦‚ methodsã€components å’Œ directivesï¼Œå°†è¢«åˆå¹¶ä¸ºåŒä¸€ä¸ªå¯¹è±¡ã€‚ä¸¤ä¸ªå¯¹è±¡é”®åå†²çªæ—¶ï¼Œå–ç»„ä»¶å¯¹è±¡çš„é”®å€¼å¯¹ã€‚</p><h2 id="å…¨å±€æ··å…¥"><a href="#å…¨å±€æ··å…¥" class="headerlink" title="å…¨å±€æ··å…¥"></a>å…¨å±€æ··å…¥</h2><p>æ··å…¥ä¹Ÿå¯ä»¥è¿›è¡Œå…¨å±€æ³¨å†Œã€‚ä½¿ç”¨æ—¶æ ¼å¤–å°å¿ƒï¼ä¸€æ—¦ä½¿ç”¨å…¨å±€æ··å…¥ï¼Œå®ƒå°†å½±å“æ¯ä¸€ä¸ªä¹‹ååˆ›å»ºçš„ Vue å®ä¾‹ã€‚ä½¿ç”¨æ°å½“æ—¶ï¼Œè¿™å¯ä»¥ç”¨æ¥ä¸ºè‡ªå®šä¹‰é€‰é¡¹æ³¨å…¥å¤„ç†é€»è¾‘ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¸ºè‡ªå®šä¹‰çš„é€‰é¡¹ &#x27;myOption&#x27; æ³¨å…¥ä¸€ä¸ªå¤„ç†å™¨ã€‚</span></span><br><span class="line">Vue.mixin(&#123;</span><br><span class="line">  created: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> myOption = <span class="built_in">this</span>.$options.myOption</span><br><span class="line">    <span class="keyword">if</span> (myOption) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(myOption)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  myOption: <span class="string">&#x27;hello!&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// =&gt; &quot;hello!&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="å¯¹è±¡çš„èµ‹å€¼"><a href="#å¯¹è±¡çš„èµ‹å€¼" class="headerlink" title="å¯¹è±¡çš„èµ‹å€¼"></a>å¯¹è±¡çš„èµ‹å€¼</h1><h2 id="ï¼ˆ1ï¼‰åœ¨-store-ä¸­å®šä¹‰ä¸€ä¸ªå¯¹è±¡ï¼š"><a href="#ï¼ˆ1ï¼‰åœ¨-store-ä¸­å®šä¹‰ä¸€ä¸ªå¯¹è±¡ï¼š" class="headerlink" title="ï¼ˆ1ï¼‰åœ¨ store ä¸­å®šä¹‰ä¸€ä¸ªå¯¹è±¡ï¼š"></a>ï¼ˆ1ï¼‰åœ¨ store ä¸­å®šä¹‰ä¸€ä¸ªå¯¹è±¡ï¼š</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">userInfo: &#123;</span><br><span class="line">        pin: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        nickName: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        avatarUrl: DEFAULT_AVATAR,</span><br><span class="line">        definePin: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        isbind: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure><h2 id="ï¼ˆ2ï¼‰ä»æ¥å£æ‹¿åˆ°æ•°æ®åï¼Œç»™è¿™ä¸ªå¯¹è±¡èµ‹å€¼ï¼š"><a href="#ï¼ˆ2ï¼‰ä»æ¥å£æ‹¿åˆ°æ•°æ®åï¼Œç»™è¿™ä¸ªå¯¹è±¡èµ‹å€¼ï¼š" class="headerlink" title="ï¼ˆ2ï¼‰ä»æ¥å£æ‹¿åˆ°æ•°æ®åï¼Œç»™è¿™ä¸ªå¯¹è±¡èµ‹å€¼ï¼š"></a>ï¼ˆ2ï¼‰ä»æ¥å£æ‹¿åˆ°æ•°æ®åï¼Œç»™è¿™ä¸ªå¯¹è±¡èµ‹å€¼ï¼š</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">this</span>.userInfo = &#123;</span><br><span class="line">        ...this.userInfo,</span><br><span class="line">        pin: res.base.curPin,</span><br><span class="line">        nickName: res.base.nickname,</span><br><span class="line">        avatarUrl: res.base.headImageUrl ? res.base.headImageUrl : DEFAULT_AVATAR,</span><br><span class="line">        definePin: res.definePin</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h1 id="è‡ªå®šä¹‰è¿‡æ»¤å™¨"><a href="#è‡ªå®šä¹‰è¿‡æ»¤å™¨" class="headerlink" title="è‡ªå®šä¹‰è¿‡æ»¤å™¨"></a>è‡ªå®šä¹‰è¿‡æ»¤å™¨</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">&quot;en&quot;</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">    &lt;meta name=<span class="string">&quot;viewport&quot;</span> content=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br><span class="line">    &lt;meta http-equiv=<span class="string">&quot;X-UA-Compatible&quot;</span> content=<span class="string">&quot;ie=edge&quot;</span>&gt;</span><br><span class="line">    &lt;title&gt;Document&lt;/title&gt;</span><br><span class="line">    &lt;script src=<span class="string">&quot;vue2.5.16.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div id=<span class="string">&quot;app&quot;</span>&gt;</span><br><span class="line">        &lt;!-- é€šè¿‡ è¿‡æ»¤å™¨ msgFormat å¯¹ msg è¿›è¡Œè¿‡æ»¤--&gt;</span><br><span class="line">        &lt;p&gt;&#123;&#123; msg | msgFormat &#125;&#125;&lt;/p&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        <span class="comment">// å®šä¹‰ä¸€ä¸ª Vue å…¨å±€çš„è¿‡æ»¤å™¨ï¼Œåå­—å«åš  msgFormat</span></span><br><span class="line">        Vue.filter(<span class="string">&#x27;msgFormat&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">myMsg</span>) </span>&#123;</span><br><span class="line">            <span class="comment">// å­—ç¬¦ä¸²çš„  replace æ–¹æ³•ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ï¼Œé™¤äº†å¯å†™ä¸€ä¸ª å­—ç¬¦ä¸²ä¹‹å¤–ï¼Œè¿˜å¯ä»¥å®šä¹‰ä¸€ä¸ªæ­£åˆ™</span></span><br><span class="line">            <span class="comment">//å°† myMsg ä¸­çš„æ‰€æœ‰`ç¾`å­—æ ·ï¼Œä¿®æ”¹ä¸º`ä¸‘`</span></span><br><span class="line">            <span class="keyword">return</span> myMsg.replace(<span class="regexp">/ç¾/g</span>, <span class="string">&#x27;ä¸‘&#x27;</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="comment">// åˆ›å»º Vue å®ä¾‹ï¼Œå¾—åˆ° ViewModel</span></span><br><span class="line">        <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">            el: <span class="string">&#x27;#app&#x27;</span>,</span><br><span class="line">            data: &#123;</span><br><span class="line">                msg: <span class="string">&#x27;æ²¡æœ‰ç¾çš„å¥³äºº&#x27;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            methods: &#123;&#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><h2 id="æ—¶é—´æ ¼å¼åŒ–"><a href="#æ—¶é—´æ ¼å¼åŒ–" class="headerlink" title="æ—¶é—´æ ¼å¼åŒ–"></a>æ—¶é—´æ ¼å¼åŒ–</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">&quot;en&quot;</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">    &lt;title&gt;Document&lt;/title&gt;</span><br><span class="line">    &lt;script src=<span class="string">&quot;vue2.5.16.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div id=<span class="string">&quot;app&quot;</span>&gt;</span><br><span class="line">        <span class="number">2018</span><span class="number">-05</span><span class="number">-25</span>T14:<span class="number">06</span>:<span class="number">51.618</span>Z</span><br><span class="line">        &lt;br /&gt; &#123;&#123; <span class="string">&#x27;2018-05-25T14:06:51.618Z&#x27;</span> | dateFormat &#125;&#125;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    Vue.filter(<span class="string">&#x27;dateFormat&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">dateStr, pattern = <span class="string">&#x27;&#x27;</span></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// æ ¹æ®ç»™å®šçš„æ—¶é—´å­—ç¬¦ä¸²ï¼Œå¾—åˆ°ç‰¹å®šçš„æ—¶é—´</span></span><br><span class="line">        <span class="keyword">var</span> dt = <span class="keyword">new</span> <span class="built_in">Date</span>(dateStr)</span><br><span class="line">        <span class="comment">//   yyyy-mm-dd</span></span><br><span class="line">        <span class="keyword">var</span> y = dt.getFullYear()</span><br><span class="line">        <span class="keyword">var</span> m = (dt.getMonth() + <span class="number">1</span>).toString().padStart(<span class="number">2</span>, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">        <span class="keyword">var</span> d = dt.getDate().toString().padStart(<span class="number">2</span>, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> (pattern.toLowerCase() === <span class="string">&#x27;yyyy-mm-dd&#x27;</span>) &#123; <span class="comment">//å¦‚æœè°ƒç”¨è¿‡æ»¤å™¨çš„å‚æ•°å†™çš„æ˜¯ yyyy-mm-ddï¼Œé‚£å°±æŒ‰ç…§è¿™ç§  yyyy-mm-dd çš„æ ¼å¼å†™</span></span><br><span class="line">            <span class="comment">//è¿™é‡Œç”¨çš„æ˜¯å­—ç¬¦ä¸²æ¨¡æ¿</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;y&#125;</span>-<span class="subst">$&#123;m&#125;</span>-<span class="subst">$&#123;d&#125;</span>`</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; <span class="comment">//å¦åˆ™ï¼ˆæ¯”å¦‚è¯´è°ƒç”¨è¿‡æ»¤å™¨æ—¶ä¸å†™å‚æ•°ï¼‰ï¼Œåé¢å°±è¡¥ä¸Š æ—¶-åˆ†-ç§’</span></span><br><span class="line">            <span class="keyword">var</span> hh = dt.getHours().toString().padStart(<span class="number">2</span>, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">            <span class="keyword">var</span> mm = dt.getMinutes().toString().padStart(<span class="number">2</span>, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">            <span class="keyword">var</span> ss = dt.getSeconds().toString().padStart(<span class="number">2</span>, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;y&#125;</span>-<span class="subst">$&#123;m&#125;</span>-<span class="subst">$&#123;d&#125;</span> <span class="subst">$&#123;hh&#125;</span>:<span class="subst">$&#123;mm&#125;</span>:<span class="subst">$&#123;ss&#125;</span> ~~~~~~~`</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">        el: <span class="string">&#x27;#app&#x27;</span>,</span><br><span class="line">        data: &#123;</span><br><span class="line">            time: <span class="keyword">new</span> <span class="built_in">Date</span>()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><h2 id="è‡ªå®šä¹‰ç§æœ‰è¿‡æ»¤å™¨"><a href="#è‡ªå®šä¹‰ç§æœ‰è¿‡æ»¤å™¨" class="headerlink" title="è‡ªå®šä¹‰ç§æœ‰è¿‡æ»¤å™¨"></a>è‡ªå®šä¹‰ç§æœ‰è¿‡æ»¤å™¨</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">&quot;en&quot;</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">    &lt;title&gt;Document&lt;/title&gt;</span><br><span class="line">    &lt;script src=<span class="string">&quot;vue2.5.16.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div id=<span class="string">&quot;app&quot;</span>&gt;</span><br><span class="line">        &#123;&#123; time &#125;&#125;</span><br><span class="line">        &lt;br /&gt;</span><br><span class="line">        &#123;&#123; time | datefmt &#125;&#125;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">        el: <span class="string">&#x27;#app&#x27;</span>,</span><br><span class="line">        data: &#123;</span><br><span class="line">            time: <span class="keyword">new</span> <span class="built_in">Date</span>()</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">//åœ¨æŸä¸€ä¸ªvueå¯¹è±¡å†…éƒ¨å®šä¹‰çš„è¿‡æ»¤å™¨ç§°ä¹‹ä¸ºç§æœ‰è¿‡æ»¤å™¨ï¼Œ</span></span><br><span class="line">        <span class="comment">//è¿™ç§è¿‡æ»¤å™¨åªæœ‰åœ¨å½“å‰vueå¯¹è±¡elæŒ‡å®šçš„ç›‘ç®¡çš„åŒºåŸŸæœ‰ç”¨</span></span><br><span class="line">        filters: &#123;</span><br><span class="line">            <span class="comment">// inputæ˜¯è‡ªå®šä¹‰è¿‡æ»¤å™¨çš„é»˜è®¤å‚æ•°ï¼Œinputçš„å€¼æ°¸è¿œéƒ½æ˜¯å–è‡ªäº | å·¦è¾¹çš„å†…å®¹</span></span><br><span class="line">            datefmt: <span class="function"><span class="keyword">function</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">                <span class="comment">// å®šä¹‰è¿‡æ»¤å™¨çš„å†…å®¹ï¼šå°†inputçš„å€¼æ ¼å¼åŒ–æˆ yyyy-MM-dd å­—ç¬¦ä¸²è¾“å‡º</span></span><br><span class="line">                <span class="keyword">var</span> res = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">                <span class="keyword">var</span> year = input.getFullYear();</span><br><span class="line">                <span class="keyword">var</span> month = input.getMonth() + <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">var</span> day = input.getDate();</span><br><span class="line">                res = year + <span class="string">&#x27;-&#x27;</span> + month + <span class="string">&#x27;-&#x27;</span> + day;</span><br><span class="line">                <span class="keyword">return</span> res;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>â€¢ padStartï¼šè¿”å›æ–°çš„å­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºç”¨å‚æ•°å­—ç¬¦ä¸²<strong>ä»å¤´éƒ¨ï¼ˆå·¦ä¾§ï¼‰</strong>è¡¥å…¨åŸå­—ç¬¦ä¸²ã€‚<br>â€¢ padEndï¼šè¿”å›æ–°çš„å­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºç”¨å‚æ•°å­—ç¬¦ä¸²ä»<strong>å°¾éƒ¨ï¼ˆå³ä¾§ï¼‰</strong>è¡¥å…¨åŸå­—ç¬¦ä¸²ã€‚<br>ä»¥ä¸Šä¸¤ä¸ªæ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æŒ‡å®šç”Ÿæˆçš„å­—ç¬¦ä¸²çš„æœ€å°é•¿åº¦ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ç”¨æ¥è¡¥å…¨çš„å­—ç¬¦ä¸²ã€‚å¦‚æœæ²¡æœ‰æŒ‡å®šç¬¬äºŒä¸ªå‚æ•°ï¼Œé»˜è®¤ç”¨ç©ºæ ¼å¡«å……ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;h&quot;</span>.padStart(<span class="number">5</span>,<span class="string">&quot;o&quot;</span>));  <span class="comment">// &quot;ooooh&quot;</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;h&quot;</span>.padEnd(<span class="number">5</span>,<span class="string">&quot;o&quot;</span>));    <span class="comment">// &quot;hoooo&quot;</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;h&quot;</span>.padStart(<span class="number">5</span>));      <span class="comment">// &quot;    h&quot;</span></span><br></pre></td></tr></table></figure><h1 id="Vue-åŠ¨ç”»"><a href="#Vue-åŠ¨ç”»" class="headerlink" title="Vue åŠ¨ç”»"></a>Vue åŠ¨ç”»</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">&quot;en&quot;</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">    &lt;meta name=<span class="string">&quot;viewport&quot;</span> content=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br><span class="line">    &lt;meta http-equiv=<span class="string">&quot;X-UA-Compatible&quot;</span> content=<span class="string">&quot;ie=edge&quot;</span>&gt;</span><br><span class="line">    &lt;title&gt;Document&lt;/title&gt;</span><br><span class="line">    &lt;script src=<span class="string">&quot;https://cdn.jsdelivr.net/npm/vue/dist/vue.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">    &lt;style&gt;</span><br><span class="line">        li &#123;</span><br><span class="line">            border: 1px dashed #999;</span><br><span class="line">            margin: <span class="number">5</span>px;</span><br><span class="line">            line-height: <span class="number">35</span>px;</span><br><span class="line">            padding-left: <span class="number">5</span>px;</span><br><span class="line">            font-size: <span class="number">12</span>px;</span><br><span class="line">            width: <span class="number">100</span>%;</span><br><span class="line">        &#125;</span><br><span class="line">        li:hover &#123;</span><br><span class="line">            background-color: hotpink;</span><br><span class="line">            transition: all <span class="number">0.8</span>s ease;</span><br><span class="line">        &#125;</span><br><span class="line">        .v-enter,</span><br><span class="line">        .v-leave-to &#123;</span><br><span class="line">            opacity: <span class="number">0</span>;</span><br><span class="line">            transform: translateY(<span class="number">80</span>px);</span><br><span class="line">        &#125;</span><br><span class="line">        .v-enter-active,</span><br><span class="line">        .v-leave-active &#123;</span><br><span class="line">            transition: all <span class="number">0.6</span>s ease;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/* ä¸‹é¢çš„ .v-move å’Œ .v-leave-active é…åˆä½¿ç”¨ï¼Œèƒ½å¤Ÿå®ç°åˆ—è¡¨åç»­çš„å…ƒç´ ï¼Œæ¸æ¸åœ°æ¼‚ä¸Šæ¥çš„æ•ˆæœ */</span></span><br><span class="line">        .v-move &#123;</span><br><span class="line">            transition: all <span class="number">0.6</span>s ease;</span><br><span class="line">        &#125;</span><br><span class="line">        .v-leave-active &#123;</span><br><span class="line">            position: absolute;</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div id=<span class="string">&quot;app&quot;</span>&gt;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">            &lt;label&gt;</span><br><span class="line">                Id:</span><br><span class="line">                &lt;input type=<span class="string">&quot;text&quot;</span> v-model=<span class="string">&quot;id&quot;</span>&gt;</span><br><span class="line">            &lt;/label&gt;</span><br><span class="line">            &lt;label&gt;</span><br><span class="line">                Name:</span><br><span class="line">                &lt;input type=<span class="string">&quot;text&quot;</span> v-model=<span class="string">&quot;name&quot;</span>&gt;</span><br><span class="line">            &lt;/label&gt;</span><br><span class="line">            &lt;input type=<span class="string">&quot;button&quot;</span> value=<span class="string">&quot;æ·»åŠ &quot;</span> @click=<span class="string">&quot;add&quot;</span>&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;!-- <span class="xml"><span class="tag">&lt;<span class="name">ul</span>&gt;</span> --&gt;</span></span><br><span class="line"><span class="xml">        <span class="comment">&lt;!-- åœ¨å®ç°åˆ—è¡¨è¿‡æ¸¡çš„æ—¶å€™ï¼Œå¦‚æœéœ€è¦è¿‡æ¸¡çš„å…ƒç´ ï¼Œæ˜¯é€šè¿‡ v-for å¾ªç¯æ¸²æŸ“å‡ºæ¥çš„ï¼Œä¸èƒ½ä½¿ç”¨ transition åŒ…è£¹ï¼Œéœ€è¦ä½¿ç”¨ transitionGroup --&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="comment">&lt;!-- å¦‚æœè¦ä¸º v-for å¾ªç¯åˆ›å»ºçš„å…ƒç´ è®¾ç½®åŠ¨ç”»ï¼Œå¿…é¡»ä¸ºæ¯ä¸€ä¸ª å…ƒç´  è®¾ç½® :key å±æ€§ --&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="comment">&lt;!-- ç»™ ransition-group æ·»åŠ  appear å±æ€§ï¼Œå®ç°é¡µé¢åˆšå±•ç¤ºå‡ºæ¥æ—¶å€™ï¼Œå…¥åœºæ—¶å€™çš„æ•ˆæœ --&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="comment">&lt;!-- é€šè¿‡ ä¸º transition-group å…ƒç´ ï¼Œè®¾ç½® tag å±æ€§ï¼ŒæŒ‡å®š transition-group æ¸²æŸ“ä¸ºæŒ‡å®šçš„å…ƒç´ ï¼Œå¦‚æœä¸æŒ‡å®š tag å±æ€§ï¼Œé»˜è®¤ï¼Œæ¸²æŸ“ä¸º span æ ‡ç­¾ --&gt;</span></span></span><br><span class="line">        &lt;transition-group appear tag=&quot;ul&quot;&gt;</span><br><span class="line">            &lt;li v-for=&quot;(item, i) in list&quot; :key=&quot;item.id&quot; @click=&quot;del(i)&quot;&gt;</span><br><span class="line">                &#123;&#123;item.id&#125;&#125; --- &#123;&#123;item.name&#125;&#125;</span><br><span class="line">            &lt;/li&gt;</span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">transition-group</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="comment">&lt;!-- &lt;/ul&gt;</span></span> --&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        <span class="comment">// åˆ›å»º Vue å®ä¾‹ï¼Œå¾—åˆ° ViewModel</span></span><br><span class="line">        <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">            el: <span class="string">&#x27;#app&#x27;</span>,</span><br><span class="line">            data: &#123;</span><br><span class="line">                id: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">                name: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">                list: [</span><br><span class="line">                    &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">&#x27;èµµé«˜&#x27;</span> &#125;,</span><br><span class="line">                    &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">name</span>: <span class="string">&#x27;ç§¦æ¡§&#x27;</span> &#125;,</span><br><span class="line">                    &#123; <span class="attr">id</span>: <span class="number">3</span>, <span class="attr">name</span>: <span class="string">&#x27;ä¸¥åµ©&#x27;</span> &#125;,</span><br><span class="line">                    &#123; <span class="attr">id</span>: <span class="number">4</span>, <span class="attr">name</span>: <span class="string">&#x27;é­å¿ è´¤&#x27;</span> &#125;</span><br><span class="line">                ]</span><br><span class="line">            &#125;,</span><br><span class="line">            methods: &#123;</span><br><span class="line">                add() &#123;</span><br><span class="line">                    <span class="built_in">this</span>.list.push(&#123; <span class="attr">id</span>: <span class="built_in">this</span>.id, <span class="attr">name</span>: <span class="built_in">this</span>.name &#125;)</span><br><span class="line">                    <span class="built_in">this</span>.id = <span class="built_in">this</span>.name = <span class="string">&#x27;&#x27;</span></span><br><span class="line">                &#125;,</span><br><span class="line">                del(i) &#123;</span><br><span class="line">                    <span class="built_in">this</span>.list.splice(i, <span class="number">1</span>)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å®ä¾‹vue-3æ­¥-ï¼š&quot;&gt;&lt;a href=&quot;#å®ä¾‹vue-3æ­¥-ï¼š&quot; class=&quot;headerlink&quot; title=&quot;å®ä¾‹vue(3æ­¥)ï¼š&quot;&gt;&lt;/a&gt;å®ä¾‹vue(3æ­¥)ï¼š&lt;/h1&gt;&lt;h2 id=&quot;1-åˆ›å»ºæ ¹å®ä¾‹&quot;&gt;&lt;a href=&quot;#1-åˆ›å»ºæ ¹å®ä¾‹&quot; class</summary>
      
    
    
    
    <category term="Vueå­¦ä¹ " scheme="https://hard-workingrookie.github.io/categories/Vue%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="vue" scheme="https://hard-workingrookie.github.io/tags/vue/"/>
    
  </entry>
  
  <entry>
    <title>es678</title>
    <link href="https://hard-workingrookie.github.io/2020/09/21/es678/"/>
    <id>https://hard-workingrookie.github.io/2020/09/21/es678/</id>
    <published>2020-09-21T02:26:55.000Z</published>
    <updated>2020-12-24T06:20:21.600Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ES6-å¸¸ç”¨æ–°ç‰¹æ€§"><a href="#ES6-å¸¸ç”¨æ–°ç‰¹æ€§" class="headerlink" title="ES6 å¸¸ç”¨æ–°ç‰¹æ€§"></a>ES6 å¸¸ç”¨æ–°ç‰¹æ€§</h1><h2 id="let-amp-amp-const"><a href="#let-amp-amp-const" class="headerlink" title="let &amp;&amp; const"></a>let &amp;&amp; const</h2><p>let å‘½ä»¤ä¹Ÿç”¨äºå˜é‡å£°æ˜ï¼Œä½†æ˜¯ä½œç”¨åŸŸä¸º<strong>å±€éƒ¨</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">let</span> a =<span class="number">10</span>;</span><br><span class="line">    <span class="keyword">var</span> b =<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åœ¨å‡½æ•°å¤–éƒ¨å¯ä»¥è·å–åˆ° bï¼Œè·å–ä¸åˆ° a,å› æ­¤ä¾‹å¦‚<code>for</code>å¾ªç¯è®¡æ•°å™¨å°±é€‚åˆä½¿ç”¨ letã€‚</p><p>const ç”¨äºå£°æ˜ä¸€ä¸ªå¸¸é‡ï¼Œè®¾å®šå<strong>å€¼ä¸ä¼šå†æ”¹å˜</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> PI =<span class="number">3.1415</span>;</span><br><span class="line">PI  <span class="comment">//3.1415</span></span><br><span class="line">PI=<span class="number">3</span>;  <span class="comment">//TypeError: Assignment to constant variable.</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="iterable-ç±»å‹"><a href="#iterable-ç±»å‹" class="headerlink" title="iterable ç±»å‹"></a>iterable ç±»å‹</h2><p>ä¸ºäº†ç»Ÿä¸€é›†åˆç±»å‹ï¼ŒES6 æ ‡å‡†å¼•å…¥äº†æ–°çš„<code>iterable</code>ç±»å‹ï¼ŒArrayã€Map å’Œ Set éƒ½å±äº<code>iterable</code>ç±»å‹ï¼Œå…·æœ‰<br><code>iterable</code>ç±»å‹çš„é›†åˆå¯ä»¥é€šè¿‡æ–°çš„ <code> for ...of</code> å¾ªç¯æ¥éå†</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">var</span> a=[<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;C&#x27;</span>];</span><br><span class="line"><span class="keyword">var</span> s=<span class="keyword">new</span> <span class="built_in">Set</span>([<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;C&#x27;</span>]);</span><br><span class="line"><span class="keyword">var</span> m=<span class="keyword">new</span> <span class="built_in">Map</span>([[<span class="number">1</span>,<span class="string">&#x27;x&#x27;</span>],[<span class="number">2</span>,<span class="string">&#x27;y&#x27;</span>],[<span class="number">3</span>,<span class="string">&#x27;z&#x27;</span>]]);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> x <span class="keyword">of</span> a)&#123;   <span class="comment">//éå†Array</span></span><br><span class="line">    alert(x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> x <span class="keyword">of</span> s)&#123;  <span class="comment">//éå†Set</span></span><br><span class="line">    alert(x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> x <span class="keyword">of</span> m)&#123;  <span class="comment">//éå†Map</span></span><br><span class="line">    alert(x[<span class="number">0</span>]+<span class="string">&#x27;=&#x27;</span>+x[<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>Map ç›¸å…³æ“ä½œå¦‚ä¸‹ï¼ŒSet åŒç†ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">var</span> m = <span class="keyword">new</span> <span class="built_in">Map</span>(); <span class="comment">// ç©ºMap</span></span><br><span class="line">m.set(<span class="string">&#x27;Adam&#x27;</span>, <span class="number">67</span>); <span class="comment">// æ·»åŠ æ–°çš„key-value</span></span><br><span class="line">m.set(<span class="string">&#x27;Bob&#x27;</span>, <span class="number">59</span>);</span><br><span class="line">m.has(<span class="string">&#x27;Adam&#x27;</span>); <span class="comment">// æ˜¯å¦å­˜åœ¨key &#x27;Adam&#x27;: true</span></span><br><span class="line">m.get(<span class="string">&#x27;Adam&#x27;</span>); <span class="comment">// 67</span></span><br><span class="line">m.delete(<span class="string">&#x27;Adam&#x27;</span>); <span class="comment">// åˆ é™¤key &#x27;Adam&#x27;</span></span><br><span class="line">m.get(<span class="string">&#x27;Adam&#x27;</span>); <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure><h2 id="è§£æ„èµ‹å€¼"><a href="#è§£æ„èµ‹å€¼" class="headerlink" title="è§£æ„èµ‹å€¼"></a>è§£æ„èµ‹å€¼</h2><p>ES6 å…è®¸æŒ‰ç…§ä¸€å®šæ¨¡å¼ï¼Œä»æ•°ç»„å’Œå¯¹è±¡ä¸­æå–å€¼ï¼Œå¯¹å˜é‡è¿›è¡Œèµ‹å€¼ï¼Œè¿™è¢«ç§°ä¸ºè§£æ„ã€‚</p><p>ä¾‹å¦‚æ•°ç»„ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">let</span> [a,b,c]=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line">ç­‰åŒäº</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> a=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">let</span> b=<span class="number">2</span>;</span><br><span class="line"><span class="keyword">let</span> c=<span class="number">3</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>å¯¹è±¡çš„è§£æ„èµ‹å€¼ï¼šè·å–å¯¹è±¡çš„å¤šä¸ªå±æ€§å¹¶ä¸”ä½¿ç”¨ä¸€æ¡è¯­å¥å°†å®ƒä»¬èµ‹ç»™å¤šä¸ªå˜é‡</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> &#123;</span><br><span class="line">  StyleSheet,</span><br><span class="line">  Text,</span><br><span class="line">  View</span><br><span class="line">&#125; = React;</span><br><span class="line"></span><br><span class="line">ç­‰åŒäº</span><br><span class="line"><span class="keyword">var</span> StyleSheet = React.StyleSheet;</span><br><span class="line"><span class="keyword">var</span> Text = React.Text;</span><br><span class="line"><span class="keyword">var</span> View = React.Text;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="gt-å‡½æ•°-ç®­å¤´å‡½æ•°"><a href="#gt-å‡½æ•°-ç®­å¤´å‡½æ•°" class="headerlink" title="=&gt;å‡½æ•°(ç®­å¤´å‡½æ•°)"></a>=&gt;å‡½æ•°(ç®­å¤´å‡½æ•°)</h2><p><code>var sum =(num1,num2)=&gt;&#123;return num1+num2;&#125;</code></p><p>ç­‰åŒäº</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">var</span> sum =<span class="function"><span class="keyword">function</span>(<span class="params">num1,num2</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> num1+num2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç®­å¤´å‡½æ•°è¿˜ä¿®å¤äº† this çš„æŒ‡å‘ï¼Œä½¿å…¶æ°¸è¿œæŒ‡å‘è¯æ³•ä½œç”¨åŸŸï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"> <span class="keyword">var</span> obj = &#123;</span><br><span class="line">   birth: <span class="number">1999</span>,</span><br><span class="line">   getAge: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">     <span class="keyword">var</span> b = <span class="built_in">this</span>.birth</span><br><span class="line">     <span class="keyword">var</span> fn = <span class="function">() =&gt;</span> <span class="keyword">new</span> <span class="built_in">Date</span>().getFullYear() - <span class="built_in">this</span>.birth <span class="comment">//thisæŒ‡å‘objå¯¹è±¡</span></span><br><span class="line">     <span class="keyword">return</span> fn()</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br><span class="line"><span class="built_in">console</span>.log( obj.getAge()) <span class="comment">//21</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="â€¦æ“ä½œç¬¦"><a href="#â€¦æ“ä½œç¬¦" class="headerlink" title="â€¦æ“ä½œç¬¦"></a>â€¦æ“ä½œç¬¦</h2><p>è¿™ä¸ªçš„å¼•å…¥å‡ ä¹ä¸ä¼šç”¨åˆ° extend è¿™ä¸ªå‡½æ•°æ¥ã€‚é€šè¿‡å®ƒå¯ä»¥å°†æ•°ç»„ä½œä¸ºå‚æ•°ç›´æ¥ä¼ å…¥å‡½æ•°ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> people = [<span class="string">&#x27;jack&#x27;</span>, <span class="string">&#x27;Mary&#x27;</span>, <span class="string">&#x27;Candy&#x27;</span>]</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sayHello</span>(<span class="params">...people</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`Hello <span class="subst">$&#123;people&#125;</span>!`</span>)</span><br><span class="line">&#125;</span><br><span class="line">sayHello(people) <span class="comment">// Hello jack,Mary,Candy!</span></span><br></pre></td></tr></table></figure><p>åœ¨å‡½æ•°å®šä¹‰æ—¶å¯ä»¥é€šè¿‡â€¦rest è·å–å®šä¹‰ å‚æ•°å¤– çš„æ‰€æœ‰å‚æ•°</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">a, b, ...rest</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;a=&#x27;</span> + a)</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;b=&#x27;</span> + b)</span><br><span class="line">  <span class="built_in">console</span>.log(rest)</span><br><span class="line">&#125;</span><br><span class="line">foo(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>)</span><br><span class="line"><span class="comment">//  a=1</span></span><br><span class="line"><span class="comment">//  b=2</span></span><br><span class="line"><span class="comment">//  (3)Â [3, 4, 5]</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="ç±»"><a href="#ç±»" class="headerlink" title="ç±»"></a>ç±»</h2><p>ES6 æä¾›äº†æ›´æ¥è¿‘ ä¼ ç»Ÿè¯­è¨€çš„å†™æ³•ï¼Œå¼•å…¥äº† Class ï¼ˆç±»ï¼‰ è¿™ä¸ªæ¦‚å¿µï¼Œä½œä¸ºå¯¹è±¡çš„æ¨¡æ¿ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰ç±»</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(x, y) &#123;</span><br><span class="line">    <span class="built_in">this</span>.x = x</span><br><span class="line">    <span class="built_in">this</span>.y = y</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  toString() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;(&#x27;</span> + <span class="built_in">this</span>.x + <span class="string">&#x27;,&#x27;</span> + <span class="built_in">this</span>.y + <span class="string">&#x27;)&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="ES7-å¸¸ç”¨æ–°ç‰¹æ€§"><a href="#ES7-å¸¸ç”¨æ–°ç‰¹æ€§" class="headerlink" title="ES7 å¸¸ç”¨æ–°ç‰¹æ€§"></a>ES7 å¸¸ç”¨æ–°ç‰¹æ€§</h1><h2 id="Array-prototype-includes-includes"><a href="#Array-prototype-includes-includes" class="headerlink" title="Array.prototype.includes (includes)"></a>Array.prototype.includes (<strong>includes</strong>)</h2><p><code>Array.prototype.includes</code>æ˜¯æ›¿ä»£<code>indexOf</code>ï¼Œå¼€å‘äººå‘˜ç”¨æ¥æ£€æŸ¥æ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨å€¼ï¼Œ<code>indexOf</code>æ˜¯ä¸€ç§å°´å°¬çš„ä½¿ç”¨ï¼Œå› ä¸ºå®ƒè¿”å›ä¸€ä¸ªå…ƒç´ åœ¨æ•°ç»„çš„ä½ç½®æˆ–è€…-1(å½“è¿™æ ·çš„å…ƒç´ ä¸èƒ½è¢«æ‰¾åˆ°çš„æƒ…å†µä¸‹)ã€‚<br>æ‰€ä»¥å®ƒè¿”å›çš„æ˜¯ä¸€ä¸ªæ•°å­— ï¼Œè€Œä¸æ˜¯ä¸€ä¸ª å¸ƒå°”å€¼ã€‚<br>å¼€å‘äººå‘˜éœ€è¦å®æ–½é¢å¤–çš„æ£€æŸ¥ã€‚åœ¨ ES6ï¼Œè¦æ£€æŸ¥æ˜¯å¦å­˜åœ¨å€¼éœ€è¦åšå¦‚ä¸‹å›¾æ‰€ç¤ºå°æŠ€å·§ï¼Œå› ä¸ºä»–ä»¬æ²¡æœ‰åŒ¹é…åˆ°å€¼ï¼Œ<code>Array.prototype.includes</code>è¿”å›-1 å˜æˆ trueï¼Œä½†æ˜¯å½“åŒ¹é…çš„å…ƒç´ ä¸º 0 ä½ç½®çš„æ—¶å€™ï¼Œè¯¥æ•°ç»„åŒ…å«å…ƒç´ ï¼Œå´å˜æˆ falseã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">let</span> arr = [<span class="string">&#x27;react&#x27;</span>, <span class="string">&#x27;angular&#x27;</span>, <span class="string">&#x27;vue&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(arr.indexOf(<span class="string">&#x27;react&#x27;</span>)) <span class="comment">// 0</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æˆ–è€…ä½¿ç”¨ä¸€ç‚¹ç‚¹ hack ä½è¿ç®—ç¬¦ ~ ä½¿ä»£ç æ›´åŠ ç´§å‡‘ä¸€äº› ï¼Œå› ä¸º ~ï¼ˆä½å¼‚æˆ–ï¼‰å¯¹ä»»ä½•æ•°å­—ç›¸å½“äº -(a+1)</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="string">&#x27;react&#x27;</span>, <span class="string">&#x27;angular&#x27;</span>, <span class="string">&#x27;vue&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(~arr.indexOf(<span class="string">&#x27;react&#x27;</span>)) <span class="comment">// -1      -(0+1)=-1</span></span><br></pre></td></tr></table></figure><p>åœ¨ ES7 ä¸­ä½¿ç”¨ includes ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">let</span> arr = [<span class="string">&#x27;react&#x27;</span>, <span class="string">&#x27;angular&#x27;</span>, <span class="string">&#x27;vue&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(arr.includes(<span class="string">&#x27;react&#x27;</span>)) <span class="comment">//  true</span></span><br></pre></td></tr></table></figure><p>è¿˜èƒ½åœ¨å­—ç¬¦ä¸²ä¸­ä½¿ç”¨ includesï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">let</span> str =<span class="string">&#x27;React Quickly&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(str.toLowerCase().includes(<span class="string">&#x27;react&#x27;</span>))&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;Found &quot;react&quot;&#x27;</span>)  <span class="comment">// Found &quot;react&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>includes ä¹Ÿå¯ä»¥åœ¨ NANï¼ˆéæ•°å­—ï¼‰ ä½¿ç”¨ã€‚<br>æœ€å includes ç¬¬äºŒå¯é€‰å‚æ•° fromIndexï¼Œè¿™å¯¹äºä¼˜åŒ– æ˜¯æœ‰å¥½å¤„çš„ ï¼Œå› ä¸º å®ƒå…è®¸ä»ç‰¹å®šä½ç½®å¼€å§‹å¯»æ‰¾åŒ¹é…ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].includes(<span class="number">2</span>)) <span class="comment">// === true)</span></span><br><span class="line"><span class="built_in">console</span>.log([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].includes(<span class="number">4</span>)) <span class="comment">// === false)</span></span><br><span class="line"><span class="built_in">console</span>.log([<span class="number">1</span>, <span class="number">2</span>, <span class="literal">NaN</span>].includes(<span class="literal">NaN</span>)) <span class="comment">// === true)</span></span><br><span class="line"><span class="built_in">console</span>.log([<span class="number">1</span>, <span class="number">2</span>, <span class="number">-0</span>].includes(+<span class="number">0</span>)) <span class="comment">// === true)</span></span><br><span class="line"><span class="built_in">console</span>.log([<span class="number">1</span>, <span class="number">2</span>, +<span class="number">0</span>].includes(<span class="number">-0</span>)) <span class="comment">// === true)</span></span><br><span class="line"><span class="built_in">console</span>.log([<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>].includes(<span class="string">&#x27;a&#x27;</span>)) <span class="comment">// === true)</span></span><br><span class="line"><span class="built_in">console</span>.log([<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>].includes(<span class="string">&#x27;a&#x27;</span>, <span class="number">1</span>)) <span class="comment">// === false)</span></span><br></pre></td></tr></table></figure><p><code>includes</code> åœ¨ä¸€ä¸ªæ•°ç»„æˆ–è€…åˆ—è¡¨ä¸­æ£€æŸ¥æ˜¯å¦å­˜åœ¨ä¸€ä¸ªå€¼ã€‚</p><h2 id="Exponentiation-Operator-æ±‚å¹‚è¿ç®—"><a href="#Exponentiation-Operator-æ±‚å¹‚è¿ç®—" class="headerlink" title="Exponentiation Operator(æ±‚å¹‚è¿ç®—)"></a>Exponentiation Operator(æ±‚å¹‚è¿ç®—)</h2><p>æ±‚å¹‚è¿ç®—å¤§å¤šæ•°æ˜¯åšäº›æ•°å­¦è®¡ç®—ï¼Œå¯¹äº 3D,VR ,SVG è¿˜æœ‰æ•°æ®å¯è§†åŒ–éå¸¸æœ‰ç”¨ã€‚</p><p>åœ¨ ES6/2015ESï¼Œä½ èƒ½ä½¿ç”¨ Math.pow åˆ›å»ºä¸€ä¸ªçŸ­çš„é€’å½’ç®­å¤´å‡½æ•°ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">calculateExponent = <span class="function">(<span class="params">base, exponent</span>) =&gt;</span></span><br><span class="line">  base * (--exponent &gt; <span class="number">1</span> ? calculateExponent(base, exponent) : base)</span><br><span class="line"><span class="built_in">console</span>.log(calculateExponent(<span class="number">7</span>, <span class="number">12</span>) === <span class="built_in">Math</span>.pow(<span class="number">7</span>, <span class="number">12</span>)) <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(calculateExponent(<span class="number">2</span>, <span class="number">7</span>) === <span class="built_in">Math</span>.pow(<span class="number">2</span>, <span class="number">7</span>)) <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p>åœ¨ ES7/ES2016 ï¼Œä»¥æ•°å­¦å‘å¯¼ çš„å¼€å‘è€… å¯ä»¥ä½¿ç”¨æ›´çŸ­çš„è¯­æ³•</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">let</span> a = <span class="number">7</span> ** <span class="number">12</span></span><br><span class="line"><span class="built_in">console</span>.log(a == <span class="built_in">Math</span>.pow(<span class="number">7</span>, <span class="number">12</span>)) <span class="comment">//true</span></span><br></pre></td></tr></table></figure><p>è¿˜å¯ä»¥è¿™æ ·å­</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">let</span> a = <span class="number">7</span></span><br><span class="line">a **= <span class="number">12</span></span><br><span class="line"><span class="keyword">let</span> b = <span class="number">2</span></span><br><span class="line">b **= <span class="number">7</span></span><br><span class="line"><span class="built_in">console</span>.log(a === <span class="built_in">Math</span>.pow(<span class="number">7</span>, <span class="number">12</span>)) <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(b === <span class="built_in">Math</span>.pow(<span class="number">2</span>, <span class="number">7</span>)) <span class="comment">// true</span></span><br></pre></td></tr></table></figure><h1 id="ES8-å¸¸ç”¨æ–°ç‰¹æ€§"><a href="#ES8-å¸¸ç”¨æ–°ç‰¹æ€§" class="headerlink" title="ES8 å¸¸ç”¨æ–°ç‰¹æ€§"></a>ES8 å¸¸ç”¨æ–°ç‰¹æ€§</h1><h2 id="Object-values-Object-entries"><a href="#Object-values-Object-entries" class="headerlink" title="Object.values/Object.entries"></a>Object.values/Object.entries</h2><p>Object.values å’Œ Object.entries æ˜¯åœ¨ ES2017 è§„æ ¼ä¸­ï¼Œå®ƒä¸ Object.keys ç±»ä¼¼ï¼Œè¿”å›æ•°ç»„ç±»å‹ï¼Œå…¶åºå·å’Œ Object.key åºå·å¯¹åº”ã€‚ç±»ä¼¼ Python ä¸­çš„ dict.iteritems()</p><p>Object.values å’Œ Object.entries å’Œ Object.keys å„è‡ªé¡¹è¿”å›æ˜¯æ•°ç»„ï¼Œç›¸å¯¹åº”åŒ…æ‹¬ key,value æˆ–è€…å¯ç¾å‰§å¯¹è±¡ property/attribute</p><p>åœ¨ ES8/ES2017 ä¹‹å‰ï¼ŒJavaScript å¼€å‘è€…è¿­ä»£ä¸€ä¸ªå¯¹è±¡çš„è‡ªèº«å±æ€§æ—¶å€™ä¸å¾—ä¸ä½¿ç”¨ Object.keysï¼Œé€šè¿‡è¿­ä»£ä¸”ä½¿ç”¨ obj[key]è·å– value è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œå¾ˆæŒ«çš„ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj = &#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>, <span class="attr">c</span>: <span class="number">3</span> &#125;</span><br><span class="line">    <span class="built_in">Object</span>.keys(obj).forEach(<span class="function">(<span class="params">key,index</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(key,obj[key]);</span><br><span class="line"></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// a 1</span></span><br><span class="line">    <span class="comment">// b 2</span></span><br><span class="line">    <span class="comment">// c 3</span></span><br></pre></td></tr></table></figure><p>è€Œä½¿ç”¨ES6/ES2015 ä¸­for/ofç¨å¾®å¥½ç‚¹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj = &#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>, <span class="attr">c</span>: <span class="number">3</span> &#125;</span><br><span class="line">     <span class="keyword">for</span>(<span class="keyword">let</span> key <span class="keyword">of</span> <span class="built_in">Object</span>.keys(obj))&#123;</span><br><span class="line">         <span class="built_in">console</span>.log(key,obj[key]);</span><br><span class="line">     &#125;</span><br></pre></td></tr></table></figure><p>Object.values è¿”å›å¯¹è±¡è‡ªèº«å¯ä»¥è¿­ä»£å±æ€§å€¼ï¼ˆvalues)ä¸ºæ•°ç»„ç±»å‹ã€‚æˆ‘ä»¬æœ€å¥½Array.prototype.forEachè¿­ä»£å®ƒï¼Œç»“åˆES6çš„ç®­å¤´å‡½æ•°éšå½¢è¿”å›å€¼ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>, <span class="attr">c</span>: <span class="number">3</span> &#125;</span><br><span class="line"><span class="built_in">Object</span>.values(obj).forEach(<span class="function">(<span class="params">value</span>) =&gt;</span> <span class="built_in">console</span>.log(value)) <span class="comment">// 1, 2, 3</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨for/of</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj = &#123;<span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>, <span class="attr">c</span>: <span class="number">3</span>&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> value <span class="keyword">of</span> <span class="built_in">Object</span>.values(obj)) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(value)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 1, 2, 3</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>Object.entries</code>ï¼Œåœ¨å¦ä¸€æ–¹é¢ï¼Œå°†ä¼šè¿”å›å¯¹è±¡è‡ªèº«å¯è¿­ä»£å±æ€§key-valueå¯¹æ•°ç»„ï¼ˆä½œä¸ºä¸€ä¸ªæ•°ç»„ï¼‰ï¼Œä»–ä»¬ï¼ˆkey-valueï¼‰åˆ†åˆ«ä»¥æ•°ç»„å­˜æ”¾æ•°ç»„ä¸­:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj = &#123;<span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>, <span class="attr">c</span>: <span class="number">3</span>&#125;</span><br><span class="line"> <span class="built_in">console</span>.log(<span class="built_in">JSON</span>.stringify(<span class="built_in">Object</span>.entries(obj)));  </span><br><span class="line">  <span class="comment">// &quot;[[&quot;a&quot;,1],[&quot;b&quot;,2],[&quot;c&quot;,3]]&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¯ä»¥ä½¿ç”¨ES6/ES2015è§£æ„ï¼Œä»è¿™åµŒå¥—æ•°ç»„ä¸­åˆ†åˆ«å£°æ˜keyå’Œvalue</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">   <span class="keyword">let</span> obj = &#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>, <span class="attr">c</span>: <span class="number">3</span> &#125;</span><br><span class="line">   <span class="built_in">Object</span>.entries(obj).forEach(<span class="function">(<span class="params">[key, value]</span>) =&gt;</span> &#123;</span><br><span class="line">     <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;key&#125;</span> is <span class="subst">$&#123;value&#125;</span>`</span>)</span><br><span class="line">   &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// a is 1</span></span><br><span class="line"><span class="comment">// b is 2</span></span><br><span class="line"><span class="comment">// c is 3</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åŒæ ·ä½¿ç”¨ES6 for/ofï¼ˆæ¯•ç«Ÿå…¨éƒ¨éƒ½æ˜¯æ•°ç»„ï¼‰éå†Object.entriesè¿”å›æ¥çš„ç»“æœå€¼ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj = &#123;<span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>, <span class="attr">c</span>: <span class="number">3</span>&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [key, value] <span class="keyword">of</span> <span class="built_in">Object</span>.entries(obj)) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;key&#125;</span> is <span class="subst">$&#123;value&#125;</span>`</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// a is 1, b is 2, c is 3</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="String-padding-å­—ç¬¦ä¸²å¡«å……"><a href="#String-padding-å­—ç¬¦ä¸²å¡«å……" class="headerlink" title="String padding(å­—ç¬¦ä¸²å¡«å……)"></a>String padding(å­—ç¬¦ä¸²å¡«å……)</h2><p>String.prototype.padStart å’Œ String.prototype.padEndåœ¨javascriptå­—ç¬¦æ“ä½œæ˜¯ä¸€ä¸ªä¸é”™çš„ä½“éªŒï¼Œå¸®åŠ©é¿å…ä¾èµ–è€Œå¤–çš„åº“ã€‚<br>padStart()åœ¨å¼€å§‹éƒ¨ä½å¡«å……ï¼Œè¿”å›ä¸€ä¸ªç»™å‡ºé•¿åº¦çš„å­—ç¬¦ä¸²ï¼Œå¡«å……ç‰©ç»™å®šå­—ç¬¦ä¸²ï¼ŒæŠŠå­—ç¬¦ä¸²å¡«å……åˆ°æœŸæœ›çš„é•¿åº¦ã€‚ä»å­—ç¬¦ä¸²çš„å·¦è¾¹å¼€å§‹ï¼ˆè‡³å°‘å¤§éƒ¨åˆ†è¥¿æ–¹è¯­è¨€ï¼‰ï¼Œä¸€ä¸ªç»å…¸ä¾‹å­æ˜¯ä½¿ç”¨ç©ºæ ¼åˆ›å»ºåˆ—ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;react&#x27;</span>.padStart(<span class="number">10</span>))</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;backbone&#x27;</span>.padStart(<span class="number">10</span>))</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;0.00&#x27;</span>.padStart(<span class="number">20</span>))</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;10,000.00&#x27;</span>.padStart(<span class="number">20</span>))</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;250,000.00&#x27;</span>.padStart(<span class="number">20</span>))</span><br><span class="line"><span class="comment">//     react</span></span><br><span class="line"><span class="comment">//   backbone</span></span><br><span class="line"><span class="comment">//                 0.00</span></span><br><span class="line"><span class="comment">//            10,000.00</span></span><br><span class="line"><span class="comment">//           250,000.00</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç¬¬äºŒä¸ªå‚æ•°ï¼Œè®©æˆ‘ä»¬æ”¾ä¸€äº›å…¶ä»–çš„å¡«å……å­—ç¬¦æ›¿ä»£ç©ºå­—ç¬¦ä¸²ï¼Œä¸€ä¸ªå­—ç¬¦ä¸²å¡«å……</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;react&#x27;</span>.padStart(<span class="number">10</span>,<span class="string">&#x27;#&#x27;</span>))</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;backbone&#x27;</span>.padStart(<span class="number">10</span>,<span class="string">&#x27;#&#x27;</span>))</span><br><span class="line"><span class="comment">// #####react</span></span><br><span class="line"><span class="comment">// ##backbone</span></span><br></pre></td></tr></table></figure><h2 id="Object-getOwnPropertyDescriptors"><a href="#Object-getOwnPropertyDescriptors" class="headerlink" title="Object.getOwnPropertyDescriptors"></a>Object.getOwnPropertyDescriptors</h2><h2 id="å‡½æ•°å‚æ•°åˆ—è¡¨å’Œè°ƒç”¨ä¸­çš„å°¾é€—å·ï¼ˆTrailing-commasï¼‰"><a href="#å‡½æ•°å‚æ•°åˆ—è¡¨å’Œè°ƒç”¨ä¸­çš„å°¾é€—å·ï¼ˆTrailing-commasï¼‰" class="headerlink" title="å‡½æ•°å‚æ•°åˆ—è¡¨å’Œè°ƒç”¨ä¸­çš„å°¾é€—å·ï¼ˆTrailing commasï¼‰"></a>å‡½æ•°å‚æ•°åˆ—è¡¨å’Œè°ƒç”¨ä¸­çš„å°¾é€—å·ï¼ˆTrailing commasï¼‰</h2><h2 id="å¼‚æ­¥å‡½æ•°ï¼ˆAsync-Functionsï¼‰"><a href="#å¼‚æ­¥å‡½æ•°ï¼ˆAsync-Functionsï¼‰" class="headerlink" title="å¼‚æ­¥å‡½æ•°ï¼ˆAsync Functionsï¼‰"></a>å¼‚æ­¥å‡½æ•°ï¼ˆAsync Functionsï¼‰</h2>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ES6-å¸¸ç”¨æ–°ç‰¹æ€§&quot;&gt;&lt;a href=&quot;#ES6-å¸¸ç”¨æ–°ç‰¹æ€§&quot; class=&quot;headerlink&quot; title=&quot;ES6 å¸¸ç”¨æ–°ç‰¹æ€§&quot;&gt;&lt;/a&gt;ES6 å¸¸ç”¨æ–°ç‰¹æ€§&lt;/h1&gt;&lt;h2 id=&quot;let-amp-amp-const&quot;&gt;&lt;a href=&quot;#let-amp-</summary>
      
    
    
    
    <category term="ç¬”è®°" scheme="https://hard-workingrookie.github.io/categories/%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="ES6" scheme="https://hard-workingrookie.github.io/tags/ES6/"/>
    
    <category term="javaScript" scheme="https://hard-workingrookie.github.io/tags/javaScript/"/>
    
  </entry>
  
  <entry>
    <title>Vuexå­¦ä¹ ç¬”è®°</title>
    <link href="https://hard-workingrookie.github.io/2020/09/04/vuex%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <id>https://hard-workingrookie.github.io/2020/09/04/vuex%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</id>
    <published>2020-09-04T06:41:39.000Z</published>
    <updated>2020-12-24T06:20:21.607Z</updated>
    
    <content type="html"><![CDATA[<p>é¡¹ç›®åœ°å€åœ¨ <a href="https://github.com/Hard-workingrookie/todoList_vuex">https://github.com/Hard-workingrookie/todoList_vuex</a></p><h1 id="ç»„ä»¶ä¹‹é—´å…±äº«æ•°æ®çš„æ–¹å¼"><a href="#ç»„ä»¶ä¹‹é—´å…±äº«æ•°æ®çš„æ–¹å¼" class="headerlink" title="ç»„ä»¶ä¹‹é—´å…±äº«æ•°æ®çš„æ–¹å¼"></a>ç»„ä»¶ä¹‹é—´å…±äº«æ•°æ®çš„æ–¹å¼</h1><p><strong>çˆ¶å‘å­ä¼ å€¼</strong>ï¼š v-bind å±æ€§ç»‘å®š<br><strong>å­å‘çˆ¶ä¼ å€¼</strong>ï¼š v-on å±æ€§ç»‘å®š<br><strong>å…„å¼Ÿç»„ä»¶ä¹‹é—´å…±äº«æ•°æ®</strong> ï¼šEventBus</p><ul><li>$on æ¥æ”¶æ•°æ®çš„é‚£ä¸ªç»„ä»¶</li><li>$emit å‘é€æ•°æ®çš„é‚£ä¸ªç»„ä»¶</li></ul><h1 id="Vuex-æ˜¯ä»€ä¹ˆ"><a href="#Vuex-æ˜¯ä»€ä¹ˆ" class="headerlink" title="Vuex æ˜¯ä»€ä¹ˆ"></a>Vuex æ˜¯ä»€ä¹ˆ</h1><p><code>Vuex</code>æ˜¯å®ç°æ­£åœ¨ç»„ä»¶å…¨å±€<strong>çŠ¶æ€</strong>ï¼ˆæ•°æ®ï¼‰ç®¡ç†çš„ä¸€ç§æœºåˆ¶ï¼Œå¯ä»¥æ–¹ä¾¿çš„å®ç°ç»„ä»¶ä¹‹é—´çš„æ•°æ®å…±äº«ã€‚</p><h1 id="Vuex-çš„åŸºæœ¬ä½¿ç”¨"><a href="#Vuex-çš„åŸºæœ¬ä½¿ç”¨" class="headerlink" title="Vuex çš„åŸºæœ¬ä½¿ç”¨"></a>Vuex çš„åŸºæœ¬ä½¿ç”¨</h1><h2 id="å®‰è£…-Vuex-ä¾èµ–åŒ…"><a href="#å®‰è£…-Vuex-ä¾èµ–åŒ…" class="headerlink" title="å®‰è£… Vuex ä¾èµ–åŒ…"></a>å®‰è£… Vuex ä¾èµ–åŒ…</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install vuex --save</span><br></pre></td></tr></table></figure><h2 id="å¯¼å…¥-Vuex-åŒ…"><a href="#å¯¼å…¥-Vuex-åŒ…" class="headerlink" title="å¯¼å…¥ Vuex åŒ…"></a>å¯¼å…¥ Vuex åŒ…</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vuex <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line">Vue.use(Vuex)</span><br></pre></td></tr></table></figure><h2 id="åˆ›å»º-store-å¯¹è±¡"><a href="#åˆ›å»º-store-å¯¹è±¡" class="headerlink" title="åˆ›å»º store å¯¹è±¡"></a>åˆ›å»º store å¯¹è±¡</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> store =<span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">    state:&#123;countï¼š<span class="number">0</span>&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="å°†-store-å¯¹è±¡æŒ‚è½½åˆ°-vue-å®ä¾‹ä¸­"><a href="#å°†-store-å¯¹è±¡æŒ‚è½½åˆ°-vue-å®ä¾‹ä¸­" class="headerlink" title="å°† store å¯¹è±¡æŒ‚è½½åˆ° vue å®ä¾‹ä¸­"></a>å°† store å¯¹è±¡æŒ‚è½½åˆ° vue å®ä¾‹ä¸­</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    el:<span class="string">&#x27;#app&#x27;</span>,</span><br><span class="line">    render:<span class="function"><span class="params">h</span>=&gt;</span>h(app),</span><br><span class="line">    router,</span><br><span class="line">    store</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h1 id="ä½¿ç”¨-Mutation-å˜æ›´-store-ä¸­çš„æ•°æ®"><a href="#ä½¿ç”¨-Mutation-å˜æ›´-store-ä¸­çš„æ•°æ®" class="headerlink" title="ä½¿ç”¨ Mutation å˜æ›´ store ä¸­çš„æ•°æ®"></a>ä½¿ç”¨ Mutation å˜æ›´ store ä¸­çš„æ•°æ®</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">mutations: &#123;</span><br><span class="line">  add (state) &#123;</span><br><span class="line">    state.count++</span><br><span class="line">  &#125;,</span><br><span class="line">  sub (state) &#123;</span><br><span class="line">    <span class="keyword">if</span> (state.count &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      state.count--</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>åœ¨é¡µé¢ä½¿ç”¨</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">addCount () &#123;</span><br><span class="line">     <span class="built_in">this</span>.$store.commit(<span class="string">&#x27;add&#x27;</span>)</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">subCount () &#123;</span><br><span class="line">     <span class="built_in">this</span>.$store.commit(<span class="string">&#x27;sub&#x27;</span>)</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><h2 id="mutations-å¸¦å‚ä¼ é€"><a href="#mutations-å¸¦å‚ä¼ é€" class="headerlink" title="mutations å¸¦å‚ä¼ é€"></a>mutations å¸¦å‚ä¼ é€</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> addN (state, step) &#123;</span><br><span class="line">      state.count += step</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">addCount () &#123;</span><br><span class="line"><span class="built_in">this</span>.$store.commit(<span class="string">&#x27;addN&#x27;</span>, <span class="number">3</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="Mutation-è§¦å‘"><a href="#Mutation-è§¦å‘" class="headerlink" title="Mutation è§¦å‘"></a>Mutation è§¦å‘</h1><p><code>this.$store.commit() </code>æ˜¯è§¦å‘ mutation ç¬¬ä¸€ç§æ–¹å¼</p><p><strong>ç¬¬äºŒç§ï¼š</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; mapMutations &#125; <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">...mapMutations([<span class="string">&#x27;add&#x27;</span>])</span><br></pre></td></tr></table></figure><p><strong>å¸¦å‚ï¼š</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">   ...mapMutations([<span class="string">&#x27;add&#x27;</span>, <span class="string">&#x27;addN&#x27;</span>]),</span><br><span class="line">   addCount () &#123;</span><br><span class="line">     <span class="built_in">this</span>.addN(<span class="number">3</span>)</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p><strong>ä¸è¦åœ¨ mutations ä¸­æ‰§è¡Œå¼‚æ­¥æ“ä½œã€‚action ç”¨äºæ‰§è¡Œå¼‚æ­¥æ“ä½œ</strong></p><h1 id="Action"><a href="#Action" class="headerlink" title="Action"></a>Action</h1><p>action ç”¨äºæ‰§è¡Œå¼‚æ­¥æ“ä½œ</p><h2 id="è§¦å‘-action"><a href="#è§¦å‘-action" class="headerlink" title="è§¦å‘ action"></a>è§¦å‘ action</h2><h3 id="ç¬¬ä¸€ç§æ–¹å¼"><a href="#ç¬¬ä¸€ç§æ–¹å¼" class="headerlink" title="ç¬¬ä¸€ç§æ–¹å¼"></a>ç¬¬ä¸€ç§æ–¹å¼</h3><h4 id="ä¸å¸¦å‚"><a href="#ä¸å¸¦å‚" class="headerlink" title="ä¸å¸¦å‚"></a>ä¸å¸¦å‚</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">actions: &#123;</span><br><span class="line">    addAsync (context) &#123;</span><br><span class="line">      <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        context.commit(<span class="string">&#x27;add&#x27;</span>)</span><br><span class="line">      &#125;, <span class="number">1000</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">this</span>.$store.dispath(<span class="string">&#x27;addAsync&#x27;</span>)</span><br></pre></td></tr></table></figure><h4 id="å¸¦å‚"><a href="#å¸¦å‚" class="headerlink" title="å¸¦å‚"></a>å¸¦å‚</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">actions: &#123;</span><br><span class="line">    addAsync (context,step) &#123;</span><br><span class="line">      <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        context.commit(<span class="string">&#x27;addN&#x27;</span>,step)</span><br><span class="line">      &#125;, <span class="number">1000</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">this</span>.$store.dispath(<span class="string">&#x27;addAsync&#x27;</span>,<span class="number">5</span>)</span><br></pre></td></tr></table></figure><h3 id="ç¬¬äºŒç§æ–¹å¼"><a href="#ç¬¬äºŒç§æ–¹å¼" class="headerlink" title="ç¬¬äºŒç§æ–¹å¼"></a>ç¬¬äºŒç§æ–¹å¼</h3><p>1.å¯¼å…¥ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import &#123; mapAction &#125; from &#39;vuex&#39;</span><br></pre></td></tr></table></figure><p>2.æ˜ å°„åˆ°å½“å‰ç»„ä»¶çš„ methods å‡½æ•°</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">methods:&#123;</span><br><span class="line">  ...mapAction([<span class="string">&#x27;addAsync&#x27;</span>,<span class="string">&#x27;addNAsync&#x27;</span>])</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="Getter"><a href="#Getter" class="headerlink" title="Getter"></a>Getter</h1><p>Getter ç”¨äºå¯¹ store ä¸­çš„æ•°æ®è¿›è¡ŒåŠ å·¥å¤„ç†å½¢æˆæ–°çš„æ•°æ®ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> store=<span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">  state:&#123;</span><br><span class="line">    count:<span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  getters:&#123;</span><br><span class="line">    showNum:<span class="function"><span class="params">state</span>=&gt;</span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&#x27;å½“å‰æœ€æ–°çš„æ•°é‡æ˜¯ã€&#x27;</span>+state.count+<span class="string">&#x27;ã€‘&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨-Getter-çš„ç¬¬ä¸€ç§æ–¹å¼"><a href="#ä½¿ç”¨-Getter-çš„ç¬¬ä¸€ç§æ–¹å¼" class="headerlink" title="ä½¿ç”¨ Getter çš„ç¬¬ä¸€ç§æ–¹å¼"></a>ä½¿ç”¨ Getter çš„ç¬¬ä¸€ç§æ–¹å¼</h2><p><code>this.$store.getters.åç§°</code></p><h2 id="ä½¿ç”¨-Getter-çš„ç¬¬äºŒç§æ–¹å¼"><a href="#ä½¿ç”¨-Getter-çš„ç¬¬äºŒç§æ–¹å¼" class="headerlink" title="ä½¿ç”¨ Getter çš„ç¬¬äºŒç§æ–¹å¼"></a>ä½¿ç”¨ Getter çš„ç¬¬äºŒç§æ–¹å¼</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; mapGetters &#125; <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">computed: &#123;</span><br><span class="line">  ...mapGetters([<span class="string">&#x27;showNum&#x27;</span>])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;h1&gt;&#123;&#123;showNum&#125;&#125;&lt;/h1&gt;</span><br></pre></td></tr></table></figure><h1 id="Modules"><a href="#Modules" class="headerlink" title="Modules"></a>Modules</h1><p>Vuex å…è®¸æˆ‘ä»¬å°† store åˆ†å‰²æˆæ¨¡å—ï¼ˆmoduleï¼‰ã€‚æ¯ä¸ªæ¨¡å—æ‹¥æœ‰è‡ªå·±çš„ stateã€mutationã€actionã€getterã€ç”šè‡³æ˜¯åµŒå¥—å­æ¨¡å—â€”â€”ä»ä¸Šè‡³ä¸‹è¿›è¡ŒåŒæ ·æ–¹å¼çš„åˆ†å‰²ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> moduleA = &#123;</span><br><span class="line">  state: <span class="function">() =&gt;</span> (&#123; ... &#125;),</span><br><span class="line">  mutations: &#123; ... &#125;,</span><br><span class="line">  actions: &#123; ... &#125;,</span><br><span class="line">  getters: &#123; ... &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> moduleB = &#123;</span><br><span class="line">  state: <span class="function">() =&gt;</span> (&#123; ... &#125;),</span><br><span class="line">  mutations: &#123; ... &#125;,</span><br><span class="line">  actions: &#123; ... &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">  modules: &#123;</span><br><span class="line">    a: moduleA,</span><br><span class="line">    b: moduleB</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">store.state.a <span class="comment">// -&gt; moduleA çš„çŠ¶æ€</span></span><br><span class="line">store.state.b <span class="comment">// -&gt; moduleB çš„çŠ¶æ€</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="æ¨¡å—çš„å±€éƒ¨çŠ¶æ€"><a href="#æ¨¡å—çš„å±€éƒ¨çŠ¶æ€" class="headerlink" title="æ¨¡å—çš„å±€éƒ¨çŠ¶æ€"></a>æ¨¡å—çš„å±€éƒ¨çŠ¶æ€</h2><p>å¯¹äºæ¨¡å—å†…éƒ¨çš„ mutation å’Œ getterï¼Œæ¥æ”¶çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ¨¡å—çš„å±€éƒ¨çŠ¶æ€å¯¹è±¡ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> moduleA = &#123;</span><br><span class="line">  state: <span class="function">() =&gt;</span> (&#123;</span><br><span class="line">    count: <span class="number">0</span></span><br><span class="line">  &#125;),</span><br><span class="line">  mutations: &#123;</span><br><span class="line">    increment (state) &#123;</span><br><span class="line">      <span class="comment">// è¿™é‡Œçš„ `state` å¯¹è±¡æ˜¯æ¨¡å—çš„å±€éƒ¨çŠ¶æ€</span></span><br><span class="line">      state.count++</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  getters: &#123;</span><br><span class="line">    doubleCount (state) &#123;</span><br><span class="line">      <span class="keyword">return</span> state.count * <span class="number">2</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹äºæ¨¡å—å†…éƒ¨çš„ actionï¼Œå±€éƒ¨çŠ¶æ€é€šè¿‡ context.state æš´éœ²å‡ºæ¥ï¼Œæ ¹èŠ‚ç‚¹çŠ¶æ€åˆ™ä¸º context.rootState</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> moduleA = &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  actions: &#123;</span><br><span class="line">    incrementIfOddOnRootSum (&#123; state, commit, rootState &#125;) &#123;</span><br><span class="line">      <span class="keyword">if</span> ((state.count + rootState.count) % <span class="number">2</span> === <span class="number">1</span>) &#123;</span><br><span class="line">        commit(<span class="string">&#x27;increment&#x27;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹äºæ¨¡å—å†…éƒ¨çš„ getterï¼Œæ ¹èŠ‚ç‚¹çŠ¶æ€ä¼šä½œä¸ºç¬¬ä¸‰ä¸ªå‚æ•°æš´éœ²å‡ºæ¥ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> moduleA = &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  getters: &#123;</span><br><span class="line">    sumWithRootCount (state, getters, rootState) &#123;</span><br><span class="line">      <span class="keyword">return</span> state.count + rootState.count</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="åœ¨å¸¦å‘½åç©ºé—´çš„æ¨¡å—å†…è®¿é—®å…¨å±€å†…å®¹"><a href="#åœ¨å¸¦å‘½åç©ºé—´çš„æ¨¡å—å†…è®¿é—®å…¨å±€å†…å®¹" class="headerlink" title="åœ¨å¸¦å‘½åç©ºé—´çš„æ¨¡å—å†…è®¿é—®å…¨å±€å†…å®¹"></a>åœ¨å¸¦å‘½åç©ºé—´çš„æ¨¡å—å†…è®¿é—®å…¨å±€å†…å®¹</h2><p>å¦‚æœä½ å¸Œæœ›ä½¿ç”¨å…¨å±€ state å’Œ getterï¼ŒrootState å’Œ rootGetters ä¼šä½œä¸ºç¬¬ä¸‰å’Œç¬¬å››å‚æ•°ä¼ å…¥ getterï¼Œä¹Ÿä¼šé€šè¿‡ context å¯¹è±¡çš„å±æ€§ä¼ å…¥ actionã€‚</p><p>è‹¥éœ€è¦åœ¨å…¨å±€å‘½åç©ºé—´å†…åˆ†å‘ action æˆ–æäº¤ mutationï¼Œå°† { root: true } ä½œä¸ºç¬¬ä¸‰å‚æ•°ä¼ ç»™ dispatch æˆ– commit å³å¯ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">modules: &#123;</span><br><span class="line">  foo: &#123;</span><br><span class="line">    namespaced: <span class="literal">true</span>,</span><br><span class="line"></span><br><span class="line">    getters: &#123;</span><br><span class="line">      <span class="comment">// åœ¨è¿™ä¸ªæ¨¡å—çš„ getter ä¸­ï¼Œ`getters` è¢«å±€éƒ¨åŒ–äº†</span></span><br><span class="line">      <span class="comment">// ä½ å¯ä»¥ä½¿ç”¨ getter çš„ç¬¬å››ä¸ªå‚æ•°æ¥è°ƒç”¨ `rootGetters`</span></span><br><span class="line">      someGetter (state, getters, rootState, rootGetters) &#123;</span><br><span class="line">        getters.someOtherGetter <span class="comment">// -&gt; &#x27;foo/someOtherGetter&#x27;</span></span><br><span class="line">        rootGetters.someOtherGetter <span class="comment">// -&gt; &#x27;someOtherGetter&#x27;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      someOtherGetter: <span class="function"><span class="params">state</span> =&gt;</span> &#123; ... &#125;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    actions: &#123;</span><br><span class="line">      <span class="comment">// åœ¨è¿™ä¸ªæ¨¡å—ä¸­ï¼Œ dispatch å’Œ commit ä¹Ÿè¢«å±€éƒ¨åŒ–äº†</span></span><br><span class="line">      <span class="comment">// ä»–ä»¬å¯ä»¥æ¥å— `root` å±æ€§ä»¥è®¿é—®æ ¹ dispatch æˆ– commit</span></span><br><span class="line">      someAction (&#123; dispatch, commit, getters, rootGetters &#125;) &#123;</span><br><span class="line">        getters.someGetter <span class="comment">// -&gt; &#x27;foo/someGetter&#x27;</span></span><br><span class="line">        rootGetters.someGetter <span class="comment">// -&gt; &#x27;someGetter&#x27;</span></span><br><span class="line"></span><br><span class="line">        dispatch(<span class="string">&#x27;someOtherAction&#x27;</span>) <span class="comment">// -&gt; &#x27;foo/someOtherAction&#x27;</span></span><br><span class="line">        dispatch(<span class="string">&#x27;someOtherAction&#x27;</span>, <span class="literal">null</span>, &#123; <span class="attr">root</span>: <span class="literal">true</span> &#125;) <span class="comment">// -&gt; &#x27;someOtherAction&#x27;</span></span><br><span class="line"></span><br><span class="line">        commit(<span class="string">&#x27;someMutation&#x27;</span>) <span class="comment">// -&gt; &#x27;foo/someMutation&#x27;</span></span><br><span class="line">        commit(<span class="string">&#x27;someMutation&#x27;</span>, <span class="literal">null</span>, &#123; <span class="attr">root</span>: <span class="literal">true</span> &#125;) <span class="comment">// -&gt; &#x27;someMutation&#x27;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      someOtherAction (ctx, payload) &#123; ... &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="åœ¨å¸¦å‘½åç©ºé—´çš„æ¨¡å—æ³¨å†Œå…¨å±€-action"><a href="#åœ¨å¸¦å‘½åç©ºé—´çš„æ¨¡å—æ³¨å†Œå…¨å±€-action" class="headerlink" title="åœ¨å¸¦å‘½åç©ºé—´çš„æ¨¡å—æ³¨å†Œå…¨å±€ action"></a>åœ¨å¸¦å‘½åç©ºé—´çš„æ¨¡å—æ³¨å†Œå…¨å±€ action</h2><p>è‹¥éœ€è¦åœ¨å¸¦å‘½åç©ºé—´çš„æ¨¡å—æ³¨å†Œå…¨å±€ actionï¼Œä½ å¯æ·»åŠ  root: trueï¼Œå¹¶å°†è¿™ä¸ª action çš„å®šä¹‰æ”¾åœ¨å‡½æ•° handler ä¸­ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  actions: &#123;</span><br><span class="line">    someOtherAction (&#123;dispatch&#125;) &#123;</span><br><span class="line">      dispatch(<span class="string">&#x27;someAction&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  modules: &#123;</span><br><span class="line">    foo: &#123;</span><br><span class="line">      namespaced: <span class="literal">true</span>,</span><br><span class="line"></span><br><span class="line">      actions: &#123;</span><br><span class="line">        someAction: &#123;</span><br><span class="line">          root: <span class="literal">true</span>,</span><br><span class="line">          handler (namespacedContext, payload) &#123; ... &#125; <span class="comment">// -&gt; &#x27;someAction&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="æ¨¡å—åŠ¨æ€æ³¨å†Œ"><a href="#æ¨¡å—åŠ¨æ€æ³¨å†Œ" class="headerlink" title="æ¨¡å—åŠ¨æ€æ³¨å†Œ"></a>æ¨¡å—åŠ¨æ€æ³¨å†Œ</h2><p>åœ¨ store åˆ›å»ºä¹‹åï¼Œä½ å¯ä»¥ä½¿ç”¨ store.registerModule æ–¹æ³•æ³¨å†Œæ¨¡å—ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vuex <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> Vuex.Store(&#123; <span class="comment">/* é€‰é¡¹ */</span> &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ³¨å†Œæ¨¡å— `myModule`</span></span><br><span class="line">store.registerModule(<span class="string">&#x27;myModule&#x27;</span>, &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// æ³¨å†ŒåµŒå¥—æ¨¡å— `nested/myModule`</span></span><br><span class="line">store.registerModule([<span class="string">&#x27;nested&#x27;</span>, <span class="string">&#x27;myModule&#x27;</span>], &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>ä¹‹åå°±å¯ä»¥é€šè¿‡ <code>store.state.myModule </code>å’Œ <code>store.state.nested.myModule</code> è®¿é—®æ¨¡å—çš„çŠ¶æ€ã€‚</p><p>æ¨¡å—åŠ¨æ€æ³¨å†ŒåŠŸèƒ½ä½¿å¾—å…¶ä»– Vue æ’ä»¶å¯ä»¥é€šè¿‡åœ¨ store ä¸­é™„åŠ æ–°æ¨¡å—çš„æ–¹å¼æ¥ä½¿ç”¨ Vuex ç®¡ç†çŠ¶æ€ã€‚ä¾‹å¦‚ï¼Œvuex-router-sync æ’ä»¶å°±æ˜¯é€šè¿‡åŠ¨æ€æ³¨å†Œæ¨¡å—å°† vue-router å’Œ vuex ç»“åˆåœ¨ä¸€èµ·ï¼Œå®ç°åº”ç”¨çš„è·¯ç”±çŠ¶æ€ç®¡ç†ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;é¡¹ç›®åœ°å€åœ¨ &lt;a href=&quot;https://github.com/Hard-workingrookie/todoList_vuex&quot;&gt;https://github.com/Hard-workingrookie/todoList_vuex&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;ç»„</summary>
      
    
    
    
    <category term="Vueå­¦ä¹ " scheme="https://hard-workingrookie.github.io/categories/Vue%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="Vue" scheme="https://hard-workingrookie.github.io/tags/Vue/"/>
    
    <category term="Vuex" scheme="https://hard-workingrookie.github.io/tags/Vuex/"/>
    
  </entry>
  
  <entry>
    <title>next.jså…¥é—¨</title>
    <link href="https://hard-workingrookie.github.io/2020/08/27/next-js%E5%85%A5%E9%97%A8/"/>
    <id>https://hard-workingrookie.github.io/2020/08/27/next-js%E5%85%A5%E9%97%A8/</id>
    <published>2020-08-27T12:02:21.000Z</published>
    <updated>2020-12-24T06:20:21.606Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Next-jsç®€ä»‹"><a href="#Next-jsç®€ä»‹" class="headerlink" title="Next.jsç®€ä»‹"></a>Next.jsç®€ä»‹</h1><div class="note default"><p>Next.js æ˜¯ä¸€ä¸ªè½»é‡çº§çš„ React æœåŠ¡ç«¯æ¸²æŸ“åº”ç”¨æ¡†æ¶ã€‚</p></div><p>ç›®å‰Next.jsæ˜¯ReactæœåŠ¡ç«¯æ¸²æŸ“çš„æœ€ä½³è§£å†³æ–¹æ¡ˆï¼Œæ‰€ä»¥å¦‚æœæƒ³ä½¿ç”¨Reactæ¥å¼€å‘éœ€è¦SEOçš„åº”ç”¨ï¼ŒåŸºæœ¬ä¸Šå°±è¦ä½¿ç”¨Next.jsã€‚</p><h1 id="åˆ›å»ºnext-jsé¡¹ç›®"><a href="#åˆ›å»ºnext-jsé¡¹ç›®" class="headerlink" title="åˆ›å»ºnext.jsé¡¹ç›®"></a>åˆ›å»ºnext.jsé¡¹ç›®</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g create-next-app</span><br></pre></td></tr></table></figure><p>ç›®å‰å¯ä»¥æ”¯æŒä¸‰ç§æ–¹å¼çš„åˆ›å»ºï¼Œåˆ†åˆ«æ˜¯ç”¨npx,yarnå’Œcreate-next-appå‘½ä»¤æ¥è¿›è¡Œå®‰è£…ï¼Œå®‰è£…çš„ç»“æ„éƒ½æ˜¯å®Œå…¨ä¸€æ ·çš„ï¼Œä»¥npxä¸ºä¾‹ã€‚</p><div class="note default"><p>npx æ˜¯Nodeè‡ªå¸¦çš„npmæ¨¡å—ï¼Œæ‰€ä»¥ä½ åªè¦å®‰è£…äº†Nodeéƒ½æ˜¯å¯ä»¥ç›´æ¥ä½¿ç”¨npxå‘½ä»¤çš„ã€‚</p></div><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx create-next-app next-create</span><br></pre></td></tr></table></figure><p>å®‰è£…å®Œæˆä¹‹åè¿›å…¥é¡¹ç›®ç›®å½•</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn dev</span><br></pre></td></tr></table></figure><p>åœ¨æµè§ˆå™¨ä¸­è¾“å…¥<code>http://localhost:3000/</code>çœ‹è¿è¡Œæ•ˆæœã€‚</p><h1 id="Next-jsçš„Pageå’ŒComponentçš„ä½¿ç”¨"><a href="#Next-jsçš„Pageå’ŒComponentçš„ä½¿ç”¨" class="headerlink" title="Next.jsçš„Pageå’ŒComponentçš„ä½¿ç”¨"></a>Next.jsçš„Pageå’ŒComponentçš„ä½¿ç”¨</h1><h2 id="æ–°å»ºé¡µé¢å’Œè®¿é—®è·¯å¾„"><a href="#æ–°å»ºé¡µé¢å’Œè®¿é—®è·¯å¾„" class="headerlink" title="æ–°å»ºé¡µé¢å’Œè®¿é—®è·¯å¾„"></a>æ–°å»ºé¡µé¢å’Œè®¿é—®è·¯å¾„</h2><p>ç›´æ¥åœ¨æ ¹ç›®å½•ä¸‹çš„pagesæ–‡ä»¶å¤¹ä¸‹ï¼Œæ–°å»ºä¸€ä¸ªlitterWang.jsé¡µé¢ã€‚ç„¶åå†™å…¥ä¸‹é¢çš„ä»£ç ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">litterWang</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">button</span>&gt;</span>litterWang<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span>  litterWang;</span><br></pre></td></tr></table></figure><p>åªè¦å†™å®Œä¸Šé¢çš„ä»£ç ï¼ŒNextæ¡†æ¶å°±è‡ªåŠ¨ä½œå¥½äº†è·¯ç”±ï¼Œè¿™ä¸ªä¹Ÿç®—æ˜¯Nextçš„ä¸€ä¸ªé‡è¦ä¼˜ç‚¹ï¼Œç»™æˆ‘ä»¬èŠ‚çœäº†å¤§é‡çš„æ—¶é—´ã€‚</p><p>ç°åœ¨è¦ä½œä¸€ä¸ªæ›´æ·±çš„é¡µé¢ï¼Œæ¯”å¦‚æŠŠæœ‰å…³åšå®¢çš„ç•Œé¢éƒ½æ”¾åœ¨è¿™æ ·çš„è·¯å¾„ä¸‹<a href="http://localhost:3000/blog/nextBlog,%E5%85%B6%E5%AE%9E%E5%8F%AA%E8%A6%81%E5%9C%A8pages%E6%96%87%E4%BB%B6%E5%A4%B9%E4%B8%8B%E5%86%8D%E5%BB%BA%E7%AB%8B%E4%B8%80%E4%B8%AA%E6%96%B0%E7%9A%84%E6%96%87%E4%BB%B6%E5%A4%B9blog%EF%BC%8C%E7%84%B6%E5%90%8E%E8%BF%9B%E5%85%A5blog%E6%96%87%E4%BB%B6%E5%A4%B9%EF%BC%8C%E6%96%B0%E5%BB%BA%E4%B8%80%E4%B8%AAnextBlog.js%E6%96%87%E4%BB%B6%EF%BC%8C%E5%B0%B1%E5%8F%AF%E4%BB%A5%E5%AE%9E%E7%8E%B0%E4%BA%86%E3%80%82">http://localhost:3000/blog/nextBlog,å…¶å®åªè¦åœ¨pagesæ–‡ä»¶å¤¹ä¸‹å†å»ºç«‹ä¸€ä¸ªæ–°çš„æ–‡ä»¶å¤¹blogï¼Œç„¶åè¿›å…¥blogæ–‡ä»¶å¤¹ï¼Œæ–°å»ºä¸€ä¸ªnextBlog.jsæ–‡ä»¶ï¼Œå°±å¯ä»¥å®ç°äº†ã€‚</a></p><p>nextBlog.jsæ–‡ä»¶å†…å®¹,æˆ‘ä»¬è¿™é‡Œå°±ç”¨æœ€ç®€å•çš„å†™æ³•äº†</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> ()=&gt;<span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>nextBlog page<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>å†™å®Œåï¼Œå°±å¯ä»¥ç›´æ¥åœ¨æµè§ˆå™¨ä¸­è®¿é—®äº†ï¼Œæ˜¯ä¸æ˜¯å‘ç°Nextæ¡†æ¶çœŸçš„å‡è½»äº†æˆ‘ä»¬å¤§é‡çš„å·¥ä½œã€‚</p><h2 id="Componentç»„ä»¶çš„åˆ¶ä½œ"><a href="#Componentç»„ä»¶çš„åˆ¶ä½œ" class="headerlink" title="Componentç»„ä»¶çš„åˆ¶ä½œ"></a>Componentç»„ä»¶çš„åˆ¶ä½œ</h2><p>åˆ¶ä½œç»„ä»¶ä¹ŸåŒæ ·æ–¹ä¾¿ï¼Œæ¯”å¦‚è¦å»ºç«‹ä¸€ä¸ªlitterWangç»„ä»¶ï¼Œç›´æ¥åœ¨componentsç›®å½•ä¸‹å»ºç«‹ä¸€ä¸ªæ–‡ä»¶litterWang.js,ç„¶åå†™å…¥ä¸‹é¢ä»£ç :</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (&#123;children&#125;)=&gt;<span class="xml"><span class="tag">&lt;<span class="name">button</span>&gt;</span>&#123;children&#125;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>ç»„ä»¶å†™å®Œåéœ€è¦å…ˆå¼•å…¥ï¼Œæ¯”å¦‚æˆ‘ä»¬åœ¨Indexé¡µé¢é‡Œè¿›è¡Œå¼•å…¥ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> litterWang <span class="keyword">from</span> <span class="string">&#x27;../components/litterWang&#x27;</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨å°±éå¸¸ç®€å•äº†ï¼Œç›´æ¥å†™å…¥æ ‡ç­¾å°±å¯ä»¥ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;litterWang&gt;æŒ‰é’®&lt;/litterWang&gt;</span><br></pre></td></tr></table></figure><h1 id="è·¯ç”±-åŸºç¡€å’ŒåŸºæœ¬è·³è½¬"><a href="#è·¯ç”±-åŸºç¡€å’ŒåŸºæœ¬è·³è½¬" class="headerlink" title="è·¯ç”±-åŸºç¡€å’ŒåŸºæœ¬è·³è½¬"></a>è·¯ç”±-åŸºç¡€å’ŒåŸºæœ¬è·³è½¬</h1><p>å­¦ä¼šç¼–å†™ç»„ä»¶å’Œé¡µé¢åï¼Œä¸‹ä¸€æ­¥åº”è¯¥äº†è§£çš„å°±æ˜¯è·¯ç”±ä½“ç³»ï¼Œæ¯ä¸ªæ¡†æ¶éƒ½æœ‰ç€ä¸åŒçš„è·¯ç”±ä½“ç³»ï¼Œè¿™èŠ‚å…ˆå­¦ä¹ æœ€åŸºç¡€çš„é¡µé¢å¦‚ä½•è·³è½¬ã€‚é¡µé¢è·³è½¬ä¸€èˆ¬æœ‰ä¸¤ç§å½¢å¼ï¼Œç¬¬ä¸€ç§æ˜¯åˆ©ç”¨æ ‡ç­¾<code>&lt;Link&gt;</code>,ç¬¬äºŒç§æ˜¯ç”¨jsç¼–ç¨‹çš„æ–¹å¼è¿›è¡Œè·³è½¬ï¼Œä¹Ÿå°±æ˜¯åˆ©ç”¨<code>Router</code>ç»„ä»¶ã€‚å…ˆæ¥çœ‹ä¸€ä¸‹æ ‡ç­¾çš„å½¢å¼å¦‚ä½•è·³è½¬ã€‚</p><h2 id="æ ‡ç­¾å¼å¯¼èˆª"><a href="#æ ‡ç­¾å¼å¯¼èˆª" class="headerlink" title="æ ‡ç­¾å¼å¯¼èˆª"></a>æ ‡ç­¾å¼å¯¼èˆª<Link></h2><p>åœ¨ç¼–å†™ä»£ç ä¹‹å‰ï¼Œå…ˆåˆ é™¤index.jsä¸­çš„ä»£ç ï¼Œä¿è¯ä»£ç çš„æœ€å°åŒ–ã€‚ä½¿ç”¨æ ‡ç­¾å¼å¯¼èˆªéœ€è¦å…ˆè¿›è¡Œå¼•å…¥ï¼Œä»£ç å¦‚ä¸‹:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Link <span class="keyword">from</span> <span class="string">&#x27;next/link&#x27;</span></span><br></pre></td></tr></table></figure><p>ç„¶åæ–°å»ºä¸¤ä¸ªé¡µé¢litterWangA.jså’ŒlitterWangB.jsï¼Œæ–°å»ºåå†™ä¸ªæœ€ç®€å•çš„é¡µé¢ï¼Œèƒ½æ ‡è¯†å‡ºæ¥Aã€Bä¸¤ä¸ªé¡µé¢å°±å¥½ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//litterWangA.js</span></span><br><span class="line"><span class="keyword">import</span> Link <span class="keyword">from</span> <span class="string">&#x27;next/link&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> ()=&gt;(</span><br><span class="line">    &lt;&gt;</span><br><span class="line">        &lt;div&gt;litterWang-A page .  &lt;/div&gt;</span><br><span class="line">        &lt;Link href=<span class="string">&quot;/&quot;</span>&gt;<span class="xml"><span class="tag">&lt;<span class="name">a</span>&gt;</span>è¿”å›é¦–é¡µ<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span>&lt;/Link&gt;</span><br><span class="line">    &lt;/&gt;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>å†™å®ŒAé¡µé¢åï¼Œå¯ä»¥ç›´æ¥å¤åˆ¶Aé¡µé¢çš„å†…å®¹ï¼Œç„¶åä¿®æ”¹ä¸€ä¸‹å°±æ˜¯Bé¡µé¢ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//litterWangB.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> Link <span class="keyword">from</span> <span class="string">&#x27;next/link&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> ()=&gt;(</span><br><span class="line">    &lt;&gt;</span><br><span class="line">        &lt;div&gt;litterWang-B page .  &lt;/div&gt;</span><br><span class="line">        &lt;Link href=<span class="string">&quot;/&quot;</span>&gt;<span class="xml"><span class="tag">&lt;<span class="name">a</span>&gt;</span>è¿”å›é¦–é¡µ<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span>&lt;/Link&gt;</span><br><span class="line">    &lt;/&gt;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>æœ‰äº†ä¸¤ä¸ªé¡µé¢åï¼Œå¯ä»¥ç¼–å†™é¦–é¡µçš„ä»£ç ï¼Œå®ç°è·³è½¬äº†ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//index.js</span></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> Link <span class="keyword">from</span> <span class="string">&#x27;next/link&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Home = <span class="function">() =&gt;</span> (</span><br><span class="line">  &lt;&gt;</span><br><span class="line">    &lt;div&gt;æˆ‘æ˜¯é¦–é¡µ&lt;/div&gt;</span><br><span class="line">    &lt;div&gt;<span class="xml"><span class="tag">&lt;<span class="name">Link</span> <span class="attr">href</span>=<span class="string">&quot;/litterWangA&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">a</span>&gt;</span>å»litterWangAé¡µé¢<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span>&lt;/div&gt;</span><br><span class="line">    &lt;div&gt;<span class="xml"><span class="tag">&lt;<span class="name">Link</span> <span class="attr">href</span>=<span class="string">&quot;/litterWangB&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">a</span>&gt;</span>å»litterWangBé¡µé¢<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span>&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">  &lt;/&gt;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> Home</span><br></pre></td></tr></table></figure><p>ç”¨<code>&lt;Link&gt;</code>æ ‡ç­¾è¿›è¡Œè·³è½¬æ˜¯éå¸¸å®¹æ˜“çš„ï¼Œä½†æ˜¯åˆä¸€ä¸ªå°å‘éœ€è¦æ³¨æ„ä¸€ä¸‹ï¼Œå°±æ˜¯ä»–ä¸æ”¯æŒå…„å¼Ÿæ ‡ç­¾å¹¶åˆ—çš„æƒ…å†µã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> &lt;div&gt;</span><br><span class="line">  &lt;Link href=<span class="string">&quot;/litterWangA&quot;</span>&gt;</span><br><span class="line">    &lt;span&gt;å»litterWangAé¡µé¢&lt;/span&gt;</span><br><span class="line">    &lt;span&gt;å‰ç«¯åšå®¢&lt;/span&gt;</span><br><span class="line">  &lt;/Link&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure><p>å¦‚æœè¿™æ ·å†™ä¼šç›´æ¥æŠ¥é”™ï¼ŒæŠ¥é”™ä¿¡æ¯å¦‚ä¸‹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">client pings, but there&#39;s no entry for page: &#x2F;_error</span><br><span class="line">Warning: You&#39;re using a string directly inside &lt;Link&gt;. This usage has been deprecated. Please add an &lt;a&gt; tag as child of &lt;Link&gt;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯ä½ å¯ä»¥æŠŠè¿™ä¸¤ä¸ªæ ‡ç­¾å¤–è¾¹å¥—ä¸€ä¸ªçˆ¶æ ‡ç­¾ï¼Œå°±å¯ä»¥äº†ï¼Œæ¯”å¦‚ä¸‹é¢çš„ä»£ç å°±æ²¡æœ‰é”™è¯¯ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;Link href=<span class="string">&quot;/litterWangA&quot;</span>&gt;</span><br><span class="line">  &lt;a&gt;</span><br><span class="line">    &lt;span&gt;å»litterWangAé¡µé¢&lt;/span&gt;</span><br><span class="line">    &lt;span&gt;å‰ç«¯åšå®¢&lt;/span&gt;</span><br><span class="line">  &lt;/a&gt;</span><br><span class="line">&lt;/Link&gt;</span><br></pre></td></tr></table></figure><p>é€šè¿‡æ ‡ç­¾è·³è½¬éå¸¸çš„ç®€å•ï¼Œè·Ÿä½¿ç”¨<code>&lt;a&gt;</code>æ ‡ç­¾å‡ ä¹ä¸€æ ·ã€‚é‚£å†æ¥çœ‹çœ‹å¦‚ä½•ç”¨ç¼–ç¨‹çš„æ–¹å¼è¿›è¡Œè·³è½¬ã€‚</p><h2 id="Routeræ¨¡å—è¿›è¡Œè·³è½¬"><a href="#Routeræ¨¡å—è¿›è¡Œè·³è½¬" class="headerlink" title="Routeræ¨¡å—è¿›è¡Œè·³è½¬"></a>Routeræ¨¡å—è¿›è¡Œè·³è½¬</h2><p>åœ¨Nextæ¡†æ¶ä¸­è¿˜å¯ä»¥ä½¿ç”¨Routeræ¨¡å—è¿›è¡Œç¼–ç¨‹å¼çš„è·³è½¬ï¼Œä½¿ç”¨å‰ä¹Ÿéœ€è¦æˆ‘ä»¬å¼•å…¥Routerï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Router <span class="keyword">from</span> <span class="string">&#x27;next/router&#x27;</span></span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨<code>Index.js</code>é¡µé¢ä¸­åŠ å…¥ï¼Œç›´æ¥ä½¿ç”¨<code>Router</code>è¿›è¡Œè·³è½¬å°±å¯ä»¥äº†ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;</span><br><span class="line">   &lt;button onClick=&#123;<span class="function">()=&gt;</span>&#123;Router.push(<span class="string">&#x27;/litterWangA&#x27;</span>)&#125;&#125;&gt;å»litterWangAé¡µé¢&lt;/button&gt;</span><br><span class="line"> &lt;/div&gt;</span><br></pre></td></tr></table></figure><p>è¿™æ ·å†™åªæ˜¯ç®€å•ï¼Œä½†æ˜¯è¿˜æ˜¯è€¦åˆæ€§å¤ªé«˜ï¼Œè·Ÿ<code>Link</code>æ ‡ç­¾æ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œä½ å¯ä»¥ä¿®æ”¹ä¸€ä¸‹ä»£ç ï¼ŒæŠŠè·³è½¬æ”¾åˆ°ä¸€ä¸ªæ–¹æ³•é‡Œï¼Œç„¶åè°ƒç”¨æ–¹æ³•ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> Link <span class="keyword">from</span> <span class="string">&#x27;next/link&#x27;</span></span><br><span class="line"><span class="keyword">import</span> Router <span class="keyword">from</span> <span class="string">&#x27;next/router&#x27;</span></span><br><span class="line"><span class="keyword">const</span> Home = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">gotoA</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    Router.push(<span class="string">&#x27;/litterWangA&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span>(</span><br><span class="line">    &lt;&gt;</span><br><span class="line">      &lt;div&gt;æˆ‘æ˜¯é¦–é¡µ&lt;/div&gt;</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;Link href=<span class="string">&quot;/litterWangA&quot;</span>&gt;</span><br><span class="line">          &lt;a&gt;</span><br><span class="line">            &lt;span&gt;å»litterWangAé¡µé¢&lt;/span&gt;</span><br><span class="line">            &lt;span&gt;å‰ç«¯åšå®¢&lt;/span&gt;</span><br><span class="line">          &lt;/a&gt;</span><br><span class="line">        &lt;/Link&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;div&gt;<span class="xml"><span class="tag">&lt;<span class="name">Link</span> <span class="attr">href</span>=<span class="string">&quot;/litterWangB&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">a</span>&gt;</span>å»litterWangBé¡µé¢<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span>&lt;/div&gt;</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;button onClick=&#123;gotoA&#125;&gt;å»litterWangAé¡µé¢&lt;/button&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/&gt;</span><br><span class="line">  )</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> Home</span><br></pre></td></tr></table></figure><p>è¿™æ ·ä¹Ÿæ˜¯å¯ä»¥å®ç°è·³è½¬çš„ï¼Œè€Œä¸”è€¦åˆæ€§ä¹Ÿé™ä½äº†,æ‰€ä»¥ä¸ªäººæ›´å–œæ¬¢è¿™ç§è·³è½¬æ–¹å¼ã€‚Nextçš„ä¸¤ç§è·³è½¬æ–¹å¼ï¼Œç¬¬ä¸€ç§æ˜¯æ ‡ç­¾å¼è·³è½¬ï¼Œç¬¬äºŒç§æ˜¯ç¼–ç¨‹å¼è·³è½¬ã€‚</p><h1 id="è·¯ç”±-è·³è½¬æ—¶ç”¨queryä¼ é€’å’Œæ¥å—å‚æ•°"><a href="#è·¯ç”±-è·³è½¬æ—¶ç”¨queryä¼ é€’å’Œæ¥å—å‚æ•°" class="headerlink" title="è·¯ç”±-è·³è½¬æ—¶ç”¨queryä¼ é€’å’Œæ¥å—å‚æ•°"></a>è·¯ç”±-è·³è½¬æ—¶ç”¨queryä¼ é€’å’Œæ¥å—å‚æ•°</h1><p>é¡¹ç›®å¼€å‘ä¸­ä¸€èˆ¬éƒ½ä¸æ˜¯ç®€å•çš„é™æ€è·³è½¬ï¼Œè€Œæ˜¯éœ€è¦åŠ¨æ€è·³è½¬çš„ã€‚åŠ¨æ€è·³è½¬å°±æ˜¯è·³è½¬æ—¶éœ€è¦å¸¦ä¸€ä¸ªå‚æ•°æˆ–å‡ ä¸ªå‚æ•°è¿‡å»ï¼Œç„¶ååœ¨åˆ°è¾¾çš„é¡µé¢æ¥å—è¿™ä¸ªä¼ é€’çš„å‚æ•°ï¼Œå¹¶æ ¹æ®å‚æ•°ä¸åŒæ˜¾ç¤ºä¸åŒçš„å†…å®¹ã€‚æ¯”å¦‚æ–°é—»åˆ—è¡¨ï¼Œç„¶åç‚¹å‡»ä¸€ä¸ªè¦çœ‹çš„æ–°é—»å°±ä¼šè·³è½¬åˆ°å…·ä½“å†…å®¹ã€‚è¿™äº›ç±»ä¼¼è¿™æ ·çš„éœ€æ±‚éƒ½éƒ½æ˜¯é€šè¿‡ä¼ é€’å‚æ•°å®ç°çš„ã€‚</p><h1 id="åªèƒ½ç”¨queryä¼ é€’å‚æ•°"><a href="#åªèƒ½ç”¨queryä¼ é€’å‚æ•°" class="headerlink" title="åªèƒ½ç”¨queryä¼ é€’å‚æ•°"></a>åªèƒ½ç”¨queryä¼ é€’å‚æ•°</h1><p>ä½œä¸€ä¸ªâ€œæ‰¾å°å“¥å“¥â€çš„ä¾‹å­ï¼Œé€šè¿‡è¿™ä¸ªä¾‹å­æ¥é€šä¿—æ˜“æ‡‚çš„è®²è§£ä¸€ä¸‹è·¯ç”±å¸¦å‚æ•°çš„çŸ¥è¯†ã€‚åœ¨Next.jsä¸­åªèƒ½é€šè¿‡é€šè¿‡<code>queryï¼ˆ?id=1ï¼‰</code>æ¥ä¼ é€’å‚æ•°ï¼Œè€Œä¸èƒ½é€šè¿‡<code>(path:id)</code>çš„å½¢å¼ä¼ é€’å‚æ•°ã€‚</p><p>ç°åœ¨æˆ‘ä»¬æ”¹å†™ä¸€ä¸‹pagesæ–‡ä»¶å¤¹ä¸‹çš„index.jsæ–‡ä»¶ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> Link <span class="keyword">from</span> <span class="string">&#x27;next/link&#x27;</span></span><br><span class="line"><span class="keyword">import</span> Router <span class="keyword">from</span> <span class="string">&#x27;next/router&#x27;</span></span><br><span class="line"><span class="keyword">const</span> Home = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span>(</span><br><span class="line">    &lt;&gt;</span><br><span class="line">      &lt;div&gt;æˆ‘æ˜¯é¦–é¡µ&lt;/div&gt;</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;Link href=<span class="string">&quot;/xiaogege?name=å´å½¦ç¥–&quot;</span>&gt;<span class="xml"><span class="tag">&lt;<span class="name">a</span>&gt;</span>é€‰å´å½¦ç¥–<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span>&lt;<span class="regexp">/Link&gt;&lt;br/</span>&gt;</span><br><span class="line">        &lt;Link href=<span class="string">&quot;/xiaogege?name=å½­äºæ™&quot;</span>&gt;<span class="xml"><span class="tag">&lt;<span class="name">a</span>&gt;</span>é€‰å½­äºæ™<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span>&lt;/Link&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/&gt;</span><br><span class="line">  )</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> Home</span><br></pre></td></tr></table></figure><p>è¿™æ ·ç¼–å†™queryå‚æ•°å°±å¯ä»¥è¿›è¡Œä¼ é€’è¿‡å»äº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯è¦æ¥å—å‚æ•°äº†ã€‚</p><h2 id="æ¥æ”¶ä¼ é€’è¿‡æ¥çš„å‚æ•°"><a href="#æ¥æ”¶ä¼ é€’è¿‡æ¥çš„å‚æ•°" class="headerlink" title="æ¥æ”¶ä¼ é€’è¿‡æ¥çš„å‚æ•°"></a>æ¥æ”¶ä¼ é€’è¿‡æ¥çš„å‚æ•°</h2><p>ç°åœ¨è¿˜æ²¡æœ‰å°å“¥å“¥å¯¹åº”çš„é¡µé¢ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦åˆ›å»ºxiaogege.jsé¡µé¢ï¼Œå¹¶å†™ä¸‹ä¸‹é¢çš„ä»£ç ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; withRouter&#125; <span class="keyword">from</span> <span class="string">&#x27;next/router&#x27;</span></span><br><span class="line"><span class="keyword">import</span> Link <span class="keyword">from</span> <span class="string">&#x27;next/link&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> xiaogege = <span class="function">(<span class="params">&#123;router&#125;</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        &lt;&gt;</span><br><span class="line">            &lt;div&gt;&#123;router.query.name&#125;,æ¥ä¸ºæˆ‘ä»¬æœåŠ¡äº† .&lt;/div&gt;</span><br><span class="line">            &lt;Link href=<span class="string">&quot;/&quot;</span>&gt;<span class="xml"><span class="tag">&lt;<span class="name">a</span>&gt;</span>è¿”å›é¦–é¡µ<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span>&lt;/Link&gt;</span><br><span class="line">        &lt;/&gt;</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> withRouter(xiaogege)</span><br></pre></td></tr></table></figure><p><code>withRouter</code>æ˜¯Next.jsæ¡†æ¶çš„é«˜çº§ç»„ä»¶ï¼Œç”¨æ¥å¤„ç†è·¯ç”±ç”¨çš„ã€‚é€šè¿‡è¿™ç§æ–¹å¼å°±è·å¾—äº†å‚æ•°ï¼Œå¹¶æ˜¾ç¤ºåœ¨é¡µé¢ä¸Šäº†ã€‚</p><h1 id="ç¼–ç¨‹å¼è·³è½¬ä¼ é€’å‚æ•°"><a href="#ç¼–ç¨‹å¼è·³è½¬ä¼ é€’å‚æ•°" class="headerlink" title="ç¼–ç¨‹å¼è·³è½¬ä¼ é€’å‚æ•°"></a>ç¼–ç¨‹å¼è·³è½¬ä¼ é€’å‚æ•°</h1><p>å›äº†<code>&lt;Link&gt;</code>è¿™ç§æ ‡ç­¾å¼è·³è½¬ä¼ é€’å‚æ•°çš„å½¢å¼ï¼Œé‚£ç¼–ç¨‹å¼è·³è½¬å¦‚ä½•ä¼ é€’é‚£ï¼Œå…¶å®ä¹Ÿå¯ä»¥ç®€å•ä½¿ç”¨?åŠ å‚æ•°çš„å½¢å¼ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> &lt;div&gt;</span><br><span class="line">  &lt;button onClick=&#123;gotoxiaogege&#125;&gt;é€‰å´å½¦ç¥–&lt;/button&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"><span class="comment">// gotoxiaogege</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">gotoxiaogege</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    Router.push(<span class="string">&#x27;/xiaogege?name=å´å½¦ç¥–&#x27;</span>)</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>è¿™ç§å½¢å¼è·³è½¬å’Œä¼ é€’å‚æ•°æ˜¯å®Œå…¨æ²¡æœ‰é—®é¢˜çš„ï¼Œä½†æ˜¯ä¸å¤ªä¼˜é›…ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥å†™æˆObjectçš„å½¢å¼ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">gotoxiaogege</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">   Router.push(&#123;</span><br><span class="line">     pathname:<span class="string">&#x27;/xiaogege&#x27;</span>,</span><br><span class="line">     query:&#123;</span><br><span class="line">       name:<span class="string">&#x27;å´å½¦ç¥–&#x27;</span></span><br><span class="line">     &#125;</span><br><span class="line">   &#125;)</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p>å…¶å®<code>&lt;Link&gt;</code>æ ‡ç­¾ä¹Ÿå¯ä»¥å†™æˆè¿™ç§å½¢å¼ï¼Œæ¯”å¦‚æˆ‘ä»¬æŠŠç¬¬ä¸€ä¸ªä¿®æ”¹æˆè¿™ç§å½¢å¼.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Link href=&#123;&#123;<span class="attr">pathname</span>:<span class="string">&#x27;/xiaogege&#x27;</span>,<span class="attr">query</span>:&#123;<span class="attr">name</span>:<span class="string">&#x27;å½­äºæ™&#x27;</span>&#125;&#125;&#125;&gt;<span class="xml"><span class="tag">&lt;<span class="name">a</span>&gt;</span>é€‰å½­äºæ™<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span>&lt;<span class="regexp">/Link&gt;&lt;br/</span>&gt;</span><br></pre></td></tr></table></figure><p>åœ¨æµè§ˆå™¨ä¸­é¢„è§ˆä¸€ä¸‹ï¼Œå¦‚æœä¸€åˆ‡æ­£å¸¸æ˜¯å¯ä»¥é¡ºåˆ©è¿›è¡Œè·³è½¬ï¼Œå¹¶æ¥æ”¶åˆ°ä¼ é€’çš„å€¼ã€‚</p><h1 id="è·¯ç”±-å…­ä¸ªé’©å­äº‹ä»¶çš„è®²è§£"><a href="#è·¯ç”±-å…­ä¸ªé’©å­äº‹ä»¶çš„è®²è§£" class="headerlink" title="è·¯ç”±-å…­ä¸ªé’©å­äº‹ä»¶çš„è®²è§£"></a>è·¯ç”±-å…­ä¸ªé’©å­äº‹ä»¶çš„è®²è§£</h1><p>è·¯ç”±çš„é’©å­äº‹ä»¶ï¼Œä¹Ÿå°±æ˜¯å½“è·¯ç”±å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå¯ä»¥ç›‘å¬åˆ°è¿™äº›å˜åŒ–äº‹ä»¶ï¼Œæ‰§è¡Œå¯¹åº”çš„å‡½æ•°ã€‚å®ƒä¸€å…±æœ‰å…­ä¸ªé’©å­äº‹ä»¶ï¼Œè¿™èŠ‚è¯¾å°±å­¦ä¹ ä¸€ä¸‹ã€‚</p><h2 id="routerChangeStartè·¯ç”±å‘ç”Ÿå˜åŒ–æ—¶"><a href="#routerChangeStartè·¯ç”±å‘ç”Ÿå˜åŒ–æ—¶" class="headerlink" title="routerChangeStartè·¯ç”±å‘ç”Ÿå˜åŒ–æ—¶"></a>routerChangeStartè·¯ç”±å‘ç”Ÿå˜åŒ–æ—¶</h2><p>åœ¨ç›‘å¬è·¯ç”±å‘ç”Ÿå˜åŒ–æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ç”¨Routerç»„ä»¶ï¼Œç„¶åç”¨onæ–¹æ³•æ¥è¿›è¡Œç›‘å¬,åœ¨pagesæ–‡ä»¶å¤¹ä¸‹çš„index.jsï¼Œç„¶åå†™å…¥ä¸‹é¢çš„ç›‘å¬äº‹ä»¶ï¼Œè¿™é‡Œæˆ‘ä»¬åªæ‰“å°ä¸€å¥è¯ï¼Œå°±ä¸ä½œå…¶ä»–çš„äº‹æƒ…äº†ã€‚ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> Router.events.on(<span class="string">&#x27;routeChangeStart&#x27;</span>,<span class="function">(<span class="params">...args</span>)=&gt;</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;1.routeChangeStart-&gt;è·¯ç”±å¼€å§‹å˜åŒ–,å‚æ•°ä¸º:&#x27;</span>,...args)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ—¶è·¯ç”±å‘ç”Ÿå˜åŒ–æ—¶ï¼Œæ—¶é—´ç¬¬ä¸€æ—¶é—´è¢«ç›‘å¬åˆ°ï¼Œå¹¶æ‰§è¡Œäº†é‡Œè¾¹çš„æ–¹æ³•ã€‚</p><h2 id="routerChangeCompleteè·¯ç”±ç»“æŸå˜åŒ–æ—¶"><a href="#routerChangeCompleteè·¯ç”±ç»“æŸå˜åŒ–æ—¶" class="headerlink" title="routerChangeCompleteè·¯ç”±ç»“æŸå˜åŒ–æ—¶"></a>routerChangeCompleteè·¯ç”±ç»“æŸå˜åŒ–æ—¶</h2><p>è·¯ç”±å˜åŒ–å¼€å§‹æ—¶å¯ä»¥ç›‘å¬åˆ°ï¼Œé‚£ç»“æŸæ—¶ä¹Ÿæ—¶å¯ä»¥ç›‘å¬åˆ°çš„ï¼Œè¿™æ—¶å€™ç›‘å¬çš„äº‹ä»¶æ˜¯routerChangeCompleteã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Router.events.on(<span class="string">&#x27;routeChangeComplete&#x27;</span>,<span class="function">(<span class="params">...args</span>)=&gt;</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;routeChangeComplete-&gt;è·¯ç”±ç»“æŸå˜åŒ–,å‚æ•°ä¸º:&#x27;</span>,...args)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="beforeHistoryChangeæµè§ˆå™¨historyè§¦å‘å‰"><a href="#beforeHistoryChangeæµè§ˆå™¨historyè§¦å‘å‰" class="headerlink" title="beforeHistoryChangeæµè§ˆå™¨historyè§¦å‘å‰"></a>beforeHistoryChangeæµè§ˆå™¨historyè§¦å‘å‰</h2><p>historyå°±æ˜¯HTMLä¸­çš„APIï¼Œå¦‚æœè¿™ä¸ªä¸äº†è§£å¯ä»¥ç™¾åº¦äº†è§£ä¸€ä¸‹ï¼ŒNext.jsè·¯ç”±å˜åŒ–é»˜è®¤éƒ½æ˜¯é€šè¿‡historyè¿›è¡Œçš„ï¼Œæ‰€ä»¥æ¯æ¬¡éƒ½ä¼šè°ƒç”¨ã€‚ ä¸é€‚ç”¨historyçš„è¯ï¼Œä¹Ÿå¯ä»¥é€šè¿‡hash</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">  Router.events.on(<span class="string">&#x27;beforeHistoryChange&#x27;</span>,<span class="function">(<span class="params">...args</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;3,beforeHistoryChange-&gt;åœ¨æ”¹å˜æµè§ˆå™¨ historyä¹‹å‰è§¦å‘,å‚æ•°ä¸º:&#x27;</span>,...args)</span><br><span class="line">  &#125;)</span><br><span class="line">routeChangeErrorè·¯ç”±è·³è½¬å‘ç”Ÿé”™è¯¯æ—¶</span><br><span class="line"> Router.events.on(<span class="string">&#x27;routeChangeError&#x27;</span>,<span class="function">(<span class="params">...args</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;4,routeChangeError-&gt;è·³è½¬å‘ç”Ÿé”™è¯¯,å‚æ•°ä¸º:&#x27;</span>,...args)</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure><p>éœ€è¦æ³¨æ„çš„æ˜¯404æ‰¾ä¸åˆ°è·¯ç”±é¡µé¢ä¸ç®—é”™è¯¯ï¼Œè¿™ä¸ªæˆ‘ä»¬å°±ä¸æ¼”ç¤ºäº†ã€‚</p><h2 id="è½¬å˜æˆhashè·¯ç”±æ¨¡å¼"><a href="#è½¬å˜æˆhashè·¯ç”±æ¨¡å¼" class="headerlink" title="è½¬å˜æˆhashè·¯ç”±æ¨¡å¼"></a>è½¬å˜æˆhashè·¯ç”±æ¨¡å¼</h2><p>è¿˜æœ‰ä¸¤ç§äº‹ä»¶ï¼Œéƒ½æ˜¯é’ˆå¯¹hashçš„ï¼Œæ‰€ä»¥ç°åœ¨è¦è½¬å˜æˆhashæ¨¡å¼ã€‚hashæ¨¡å¼ä¸‹çš„ä¸¤ä¸ªäº‹ä»¶<code>hashChangeStart</code>å’Œ<code>hashChangeComplete</code>,å°±éƒ½åœ¨è¿™é‡Œè¿›è¡Œç¼–å†™äº†ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Router.events.on(<span class="string">&#x27;hashChangeStart&#x27;</span>,<span class="function">(<span class="params">...args</span>)=&gt;</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;5,hashChangeStart-&gt;hashè·³è½¬å¼€å§‹æ—¶æ‰§è¡Œ,å‚æ•°ä¸º:&#x27;</span>,...args)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">Router.events.on(<span class="string">&#x27;hashChangeComplete&#x27;</span>,<span class="function">(<span class="params">...args</span>)=&gt;</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;6,hashChangeComplete-&gt;hashè·³è½¬å®Œæˆæ—¶,å‚æ•°ä¸º:&#x27;</span>,...args)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>åœ¨ä¸‹é¢çš„jsxè¯­æ³•éƒ¨åˆ†ï¼Œå†å¢åŠ ä¸€ä¸ªé“¾æ¥,ä½¿ç”¨hashæ¥è¿›è¡Œè·³è½¬ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;</span><br><span class="line">    &lt;Link href=<span class="string">&quot;#litterWang&quot;</span>&gt;<span class="xml"><span class="tag">&lt;<span class="name">a</span>&gt;</span>é€‰litterWang<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span>&lt;/Link&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure><p>ä¸ºäº†æ–¹ä¾¿ä½ å­¦ä¹ ï¼Œæˆ‘è¿™é‡Œç»™å‡ºindex.jsçš„å…¨éƒ¨ä»£ç ï¼Œä½ å¯ä»¥åœ¨ç»ƒä¹ æ—¶è¿›è¡Œå‚è€ƒã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> Link <span class="keyword">from</span> <span class="string">&#x27;next/link&#x27;</span></span><br><span class="line"><span class="keyword">import</span> Router <span class="keyword">from</span> <span class="string">&#x27;next/router&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Home = <span class="function">() =&gt;</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">gotoxiaogege</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    Router.push(&#123;</span><br><span class="line">      pathname:<span class="string">&#x27;/xiaogege&#x27;</span>,</span><br><span class="line">      query:&#123;</span><br><span class="line">        name:<span class="string">&#x27;å´å½¦ç¥–&#x27;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  Router.events.on(<span class="string">&#x27;routeChangeStart&#x27;</span>,<span class="function">(<span class="params">...args</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;1.routeChangeStart-&gt;è·¯ç”±å¼€å§‹å˜åŒ–,å‚æ•°ä¸º:&#x27;</span>,...args)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  Router.events.on(<span class="string">&#x27;routeChangeComplete&#x27;</span>,<span class="function">(<span class="params">...args</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;2.routeChangeComplete-&gt;è·¯ç”±ç»“æŸå˜åŒ–,å‚æ•°ä¸º:&#x27;</span>,...args)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  Router.events.on(<span class="string">&#x27;beforeHistoryChange&#x27;</span>,<span class="function">(<span class="params">...args</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;3,beforeHistoryChange-&gt;åœ¨æ”¹å˜æµè§ˆå™¨ historyä¹‹å‰è§¦å‘,å‚æ•°ä¸º:&#x27;</span>,...args)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  Router.events.on(<span class="string">&#x27;routeChangeError&#x27;</span>,<span class="function">(<span class="params">...args</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;4,routeChangeError-&gt;è·³è½¬å‘ç”Ÿé”™è¯¯,å‚æ•°ä¸º:&#x27;</span>,...args)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  Router.events.on(<span class="string">&#x27;hashChangeStart&#x27;</span>,<span class="function">(<span class="params">...args</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;5,hashChangeStart-&gt;hashè·³è½¬å¼€å§‹æ—¶æ‰§è¡Œ,å‚æ•°ä¸º:&#x27;</span>,...args)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  Router.events.on(<span class="string">&#x27;hashChangeComplete&#x27;</span>,<span class="function">(<span class="params">...args</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;6,hashChangeComplete-&gt;hashè·³è½¬å®Œæˆæ—¶,å‚æ•°ä¸º:&#x27;</span>,...args)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span>(</span><br><span class="line">    &lt;&gt;</span><br><span class="line">      &lt;div&gt;æˆ‘æ˜¯é¦–é¡µ&lt;/div&gt;</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;Link href=&#123;&#123;<span class="attr">pathname</span>:<span class="string">&#x27;/xiaogege&#x27;</span>,<span class="attr">query</span>:&#123;<span class="attr">name</span>:<span class="string">&#x27;å½­äºæ™&#x27;</span>&#125;&#125;&#125;&gt;<span class="xml"><span class="tag">&lt;<span class="name">a</span>&gt;</span>é€‰å½­äºæ™<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span>&lt;<span class="regexp">/Link&gt;&lt;br/</span>&gt;</span><br><span class="line">        &lt;Link href=<span class="string">&quot;/xiaogege?name=å´å½¦ç¥–&quot;</span>&gt;<span class="xml"><span class="tag">&lt;<span class="name">a</span>&gt;</span>é€‰å´å½¦ç¥–<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span>&lt;/Link&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;button onClick=&#123;gotoxiaogege&#125;&gt;é€‰å´å½¦ç¥–&lt;/button&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">         &lt;Link href=<span class="string">&quot;#litterWang&quot;</span>&gt;<span class="xml"><span class="tag">&lt;<span class="name">a</span>&gt;</span>é€‰litterWang<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span>&lt;/Link&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/&gt;</span><br><span class="line">  )</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> Home</span><br></pre></td></tr></table></figure><p>è¿™èŠ‚ä¸»è¦å­¦ä¹ äº†è·¯ç”±çš„é’©å­äº‹ä»¶ï¼Œåˆ©ç”¨é’©å­äº‹ä»¶æ˜¯å¯ä»¥ä½œå¾ˆå¤šäº‹æƒ…çš„ï¼Œæ¯”å¦‚è½¬æ¢æ—¶çš„åŠ è½½åŠ¨ç”»ï¼Œå…³æ‰é¡µé¢çš„ä¸€äº›èµ„æºè®¡æ•°å™¨â€¦..ã€‚</p><h1 id="åœ¨getInitialPropsä¸­ç”¨Axiosè·å–è¿œç«¯æ•°æ®"><a href="#åœ¨getInitialPropsä¸­ç”¨Axiosè·å–è¿œç«¯æ•°æ®" class="headerlink" title="åœ¨getInitialPropsä¸­ç”¨Axiosè·å–è¿œç«¯æ•°æ®"></a>åœ¨getInitialPropsä¸­ç”¨Axiosè·å–è¿œç«¯æ•°æ®</h1><p>åœ¨Next.jsæ¡†æ¶ä¸­æä¾›äº†<code>getInitialProps</code>é™æ€æ–¹æ³•ç”¨æ¥è·å–è¿œç«¯æ•°æ®ï¼Œè¿™ä¸ªæ˜¯æ¡†æ¶çš„çº¦å®šï¼Œæ‰€ä»¥ä½ ä¹Ÿåªèƒ½åœ¨è¿™ä¸ªæ–¹æ³•é‡Œè·å–è¿œç«¯æ•°æ®ã€‚ä¸è¦å†è¯•å›¾åœ¨å£°æ˜å‘¨æœŸé‡Œè·å¾—ï¼Œè™½ç„¶ä¹Ÿå¯ä»¥åœ¨<code>ComponentDidMount</code>ä¸­è·å¾—ï¼Œä½†æ˜¯ç”¨äº†åˆ«äººçš„æ¡†æ¶ï¼Œå°±è¦éµå®ˆåˆ«äººçš„çº¦å®šã€‚</p><h2 id="å®‰è£…å’Œå¼•å…¥Axiosæ’ä»¶"><a href="#å®‰è£…å’Œå¼•å…¥Axiosæ’ä»¶" class="headerlink" title="å®‰è£…å’Œå¼•å…¥Axiosæ’ä»¶"></a>å®‰è£…å’Œå¼•å…¥Axiosæ’ä»¶</h2><p>Axiosæ˜¯ç›®å‰æœ€æˆ–çš„å‰ç«¯è·å–æ•°æ®çš„æ’ä»¶äº†ï¼Œä¹Ÿæ˜¯ç”±å¤§ç¥é¦–æ¨çš„æ•°æ®æ¥å£è¯·æ±‚æ’ä»¶.åœ¨è¯·æ±‚å‰éœ€è¦å…ˆå®‰è£…Axiosæ’ä»¶ã€‚</p><p>æ‰“å¼€ç»ˆç«¯ï¼Œç›´æ¥ä½¿ç”¨yarnå‘½ä»¤è¿›è¡Œå®‰è£…ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add axios</span><br></pre></td></tr></table></figure><p>å®‰è£…å®Œæˆåï¼Œåœ¨éœ€è¦çš„é¡µé¢ä¸­ç”¨importå¼•å…¥axiosï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br></pre></td></tr></table></figure><p>å¼•å…¥åï¼Œå°±å¯ä»¥ä½¿ç”¨getInitialPropsè¿›è¡Œè·å–åç«¯æ¥å£æ•°æ®äº†ã€‚</p><h2 id="getInitialPropsä¸­è·å–æ•°æ®"><a href="#getInitialPropsä¸­è·å–æ•°æ®" class="headerlink" title="getInitialPropsä¸­è·å–æ•°æ®"></a>getInitialPropsä¸­è·å–æ•°æ®</h2><p>åœ¨<code>xiaogege.js</code>é¡µé¢ä¸­ä½¿ç”¨<code>getInitialProps</code>ï¼Œå› ä¸ºæ˜¯è¿œç¨‹è·å–æ•°æ®ï¼Œæ‰€ä»¥æˆ‘ä»¬é‡‡ç”¨å¼‚æ­¥è¯·æ±‚çš„æ–¹å¼ã€‚æ•°æ®å­˜åœ¨äº†Easy Mockä¸­ï¼Œåœ°å€å¦‚ä¸‹ï¼š</p><p><a href="https://www.easy-mock.com/mock/5cfcce489dc7c36bd6da2c99/xiaogege/getList">https://www.easy-mock.com/mock/5cfcce489dc7c36bd6da2c99/xiaogege/getList</a><br>(ä½ å¯ä»¥è‡ªå·±ä½œä¸€ä¸ªæ•°æ®æºï¼Œå› ä¸ºè¿™ä¸ªå¯èƒ½ä¹Ÿä¸ç¨³å®šï¼Œä¸è¿‡åŠå¹´å†…åº”è¯¥æ˜¯å¯ä»¥çš„)</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">xiaogege.getInitialProps = <span class="keyword">async</span> ()=&gt;&#123;</span><br><span class="line">    <span class="keyword">const</span> promise =<span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve</span>)=&gt;</span>&#123;</span><br><span class="line">            axios(<span class="string">&#x27;https://www.easy-mock.com/mock/5cfcce489dc7c36bd6da2c99/xiaogege/getList&#x27;</span>).then(</span><br><span class="line">                (res)=&gt;&#123;</span><br><span class="line">                    <span class="built_in">console</span>.log(<span class="string">&#x27;è¿œç¨‹æ•°æ®ç»“æœï¼š&#x27;</span>,res)</span><br><span class="line">                    resolve(res.data.data)</span><br><span class="line">                &#125;</span><br><span class="line">            )</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">await</span> promise</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è·å¾—æ•°æ®åï¼Œæˆ‘ä»¬éœ€è¦æŠŠå¾—åˆ°çš„æ•°æ®ä¼ é€’ç»™é¡µé¢ç»„ä»¶ï¼Œç”¨{}æ˜¾ç¤ºå‡ºæ¥å°±å¯ä»¥äº†ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> xiaogege = <span class="function">(<span class="params">&#123;router,list&#125;</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        &lt;&gt;</span><br><span class="line">            &lt;div&gt;&#123;router.query.name&#125;,æ¥ä¸ºæˆ‘ä»¬æœåŠ¡äº† .&lt;br/&gt;&#123;list&#125;&lt;/div&gt;</span><br><span class="line">            &lt;Link href=<span class="string">&quot;/&quot;</span>&gt;<span class="xml"><span class="tag">&lt;<span class="name">a</span>&gt;</span>è¿”å›é¦–é¡µ<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span>&lt;/Link&gt;</span><br><span class="line">        &lt;/&gt;</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·æˆ‘ä»¬å°±åˆ©ç”¨Axiosä»è¿œç«¯è·å–äº†æ•°æ®ï¼Œxiaogege.jsçš„æ‰€æœ‰ä»£ç ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">import &#123; withRouter&#125; from &#39;next&#x2F;router&#39;</span><br><span class="line">import Link from &#39;next&#x2F;link&#39;</span><br><span class="line">import axios from &#39;axios&#39;</span><br><span class="line"></span><br><span class="line">const xiaogege &#x3D; (&#123;router,list&#125;)&#x3D;&gt;&#123;</span><br><span class="line">    return (</span><br><span class="line">        &lt;&gt;</span><br><span class="line">            &lt;div&gt;&#123;router.query.name&#125;,æ¥ä¸ºæˆ‘ä»¬æœåŠ¡äº† .&lt;br&#x2F;&gt;&#123;list&#125;&lt;&#x2F;div&gt;</span><br><span class="line">            &lt;Link href&#x3D;&quot;&#x2F;&quot;&gt;&lt;a&gt;è¿”å›é¦–é¡µ&lt;&#x2F;a&gt;&lt;&#x2F;Link&gt;</span><br><span class="line">        &lt;&#x2F;&gt;</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">xiaogege.getInitialProps &#x3D; async ()&#x3D;&gt;&#123;</span><br><span class="line">    const promise &#x3D;new Promise((resolve)&#x3D;&gt;&#123;</span><br><span class="line">            axios(&#39;https:&#x2F;&#x2F;www.easy-mock.com&#x2F;mock&#x2F;5cfcce489dc7c36bd6da2c99&#x2F;xiaogege&#x2F;getList&#39;).then(</span><br><span class="line">                (res)&#x3D;&gt;&#123;</span><br><span class="line">                    console.log(&#39;è¿œç¨‹æ•°æ®ç»“æœï¼š&#39;,res)</span><br><span class="line">                    resolve(res.data.data)</span><br><span class="line">                &#125;</span><br><span class="line">            )</span><br><span class="line">    &#125;)</span><br><span class="line">    return await promise</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default withRouter(xiaogege)</span><br></pre></td></tr></table></figure><p>è¿™èŠ‚è¯¾ä¸»è¦å­¦ä¹ äº†åœ¨Next.jsæ¡†æ¶ä¸‹åœ¨getInitialPropsæ–¹æ³•ä¸­åˆ©ç”¨Axiosæ¥è·å–è¿œç«¯æ•°æ®çš„çš„æ“ä½œï¼Œè¿™ä¸ªåœ¨å®é™…é¡¹ç›®ä¸­æ˜¯å¿…å¤‡æŠ€èƒ½ï¼Œæ‰€ä»¥éœ€è¦å¤šç»ƒä¹ å‡ éã€‚</p><h1 id="ä½¿ç”¨Style-JSXç¼–å†™é¡µé¢çš„CSSæ ·å¼"><a href="#ä½¿ç”¨Style-JSXç¼–å†™é¡µé¢çš„CSSæ ·å¼" class="headerlink" title="ä½¿ç”¨Style JSXç¼–å†™é¡µé¢çš„CSSæ ·å¼"></a>ä½¿ç”¨Style JSXç¼–å†™é¡µé¢çš„CSSæ ·å¼</h1><p>åœ¨Next.jsä¸­å¼•å…¥ä¸€ä¸ªCSSæ ·å¼æ˜¯ä¸å¯ä»¥ç”¨çš„ï¼Œå¦‚æœæƒ³ç”¨ï¼Œéœ€è¦ä½œé¢å¤–çš„é…ç½®ã€‚å› ä¸ºæ¡†æ¶ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªstyle jsxç‰¹æ€§ï¼Œä¹Ÿå°±æ˜¯æŠŠCSSç”¨JSXçš„è¯­æ³•å†™å‡ºæ¥ã€‚å¦‚æœä½ ä»¥å‰å­¦è¿‡Vueï¼Œé‚£è¿™ç§å†™æ³•ä½ æ˜¯éå¸¸ç†Ÿæ‚‰çš„ã€‚</p><h2 id="åˆè¯†Style-JSXè¯­æ³•-æŠŠå­—ä½“è®¾æˆè“è‰²"><a href="#åˆè¯†Style-JSXè¯­æ³•-æŠŠå­—ä½“è®¾æˆè“è‰²" class="headerlink" title="åˆè¯†Style JSXè¯­æ³• æŠŠå­—ä½“è®¾æˆè“è‰²"></a>åˆè¯†Style JSXè¯­æ³• æŠŠå­—ä½“è®¾æˆè“è‰²</h2><p>åœ¨pagesæ–‡ä»¶å¤¹ä¸‹ï¼Œæ–°å»ºä¸€ä¸ªlitterWang.jsæ–‡ä»¶ã€‚ç„¶åå†™å…¥ä¸‹é¢çš„ä»£ç ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//litterWang.js</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">litterWang</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        &lt;&gt;</span><br><span class="line">            &lt;div&gt;litterWangå…è´¹å‰ç«¯æ•™ç¨‹&lt;/div&gt;</span><br><span class="line">        &lt;/&gt;</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> litterWang</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ˜¯ä¸€ä¸ªæœ€ç®€å•çš„é¡µé¢ï¼Œåªåœ¨å±‚ä¸­å†™äº†ä¸€å¥è¯ã€‚è¿™æ—¶å€™æˆ‘ä»¬æƒ³æŠŠé¡µé¢ä¸­å­—çš„é¢œè‰²å˜æˆè“è‰²ï¼Œå°±å¯ä»¥ä½¿ç”¨Style JSXè¯­æ³•ã€‚ç›´æ¥åœ¨&lt;&gt;&lt;/&gt;ä¹‹é—´å†™ä¸‹å¦‚ä¸‹çš„ä»£ç :</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;style jsx&gt;</span><br><span class="line">    &#123;&#96;</span><br><span class="line">        div&#123;color:blue;&#125;</span><br><span class="line">    &#96;&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br></pre></td></tr></table></figure><p>ä¸»è¦æ‰€æœ‰çš„cssæ ·å¼éœ€è¦ç”¨{}è¿›è¡ŒåŒ…è£¹ï¼Œå¦åˆ™å°±ä¼šæŠ¥é”™ã€‚è¿™æ—¶å€™ä½ æ‰“å¼€æµè§ˆå™¨è¿›è¡Œé¢„è§ˆï¼Œå­—ä½“çš„é¢œè‰²å°±å˜æˆäº†è“è‰²ã€‚</p><h2 id="è‡ªåŠ¨åŠ éšæœºç±»å-ä¸ä¼šæ±¡æŸ“å…¨å±€CSS"><a href="#è‡ªåŠ¨åŠ éšæœºç±»å-ä¸ä¼šæ±¡æŸ“å…¨å±€CSS" class="headerlink" title="è‡ªåŠ¨åŠ éšæœºç±»å ä¸ä¼šæ±¡æŸ“å…¨å±€CSS"></a>è‡ªåŠ¨åŠ éšæœºç±»å ä¸ä¼šæ±¡æŸ“å…¨å±€CSS</h2><p>åŠ å…¥äº†Style jsxä»£ç åï¼ŒNext.jsä¼šè‡ªåŠ¨åŠ å…¥ä¸€ä¸ªéšæœºç±»åï¼Œè¿™æ ·å°±é˜²æ­¢äº†CSSçš„å…¨å±€æ±¡æŸ“ã€‚æ¯”å¦‚æˆ‘ä»¬æŠŠä»£ç å†™æˆä¸‹é¢è¿™æ ·ï¼Œç„¶ååœ¨æµè§ˆå™¨çš„æ§åˆ¶å°ä¸­è¿›è¡ŒæŸ¥çœ‹ï¼Œä½ ä¼šå‘ç°è‡ªåŠ¨ç»™æˆ‘ä»¬åŠ å…¥äº†ç±»åï¼Œç±»ä¼¼jsx-xxxxxxxxã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">litterWang</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        &lt;&gt;</span><br><span class="line">            &lt;div&gt;litterWangå…è´¹å‰ç«¯æ•™ç¨‹&lt;/div&gt;</span><br><span class="line">            &lt;div className=<span class="string">&quot;litterWang&quot;</span>&gt;litterWangå…è´¹å‰ç«¯æ•™ç¨‹&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">            &lt;style jsx&gt;</span><br><span class="line">                &#123;<span class="string">`</span></span><br><span class="line"><span class="string">                    div &#123; color:blue;&#125;</span></span><br><span class="line"><span class="string">                    .litterWang &#123;color:red;&#125;</span></span><br><span class="line"><span class="string">                `</span>&#125;</span><br><span class="line">            &lt;/style&gt;</span><br><span class="line">        &lt;/&gt;</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> litterWang</span><br></pre></td></tr></table></figure><h2 id="åŠ¨æ€æ˜¾ç¤ºæ ·å¼"><a href="#åŠ¨æ€æ˜¾ç¤ºæ ·å¼" class="headerlink" title="åŠ¨æ€æ˜¾ç¤ºæ ·å¼"></a>åŠ¨æ€æ˜¾ç¤ºæ ·å¼</h2><p>Next.jsä½¿ç”¨äº†Style jsx,æ‰€ä»¥å®šä¹‰åŠ¨æ€çš„CSSæ ·å¼å°±éå¸¸ç®€å•ï¼Œæ¯”å¦‚ç°åœ¨è¦ä½œä¸€ä¸ªæŒ‰é’®ï¼Œç‚¹å‡»ä¸€ä¸‹ï¼Œå­—ä½“é¢œè‰²å°±ç”±è“è‰²å˜æˆäº†çº¢è‰²ã€‚ä¸‹é¢æ˜¯å®ç°ä»£ç ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123;useState&#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">litterWang</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">//å…³é”®ä»£ç ----------start-------</span></span><br><span class="line">    <span class="keyword">const</span> [color,setColor] = useState(<span class="string">&#x27;blue&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> changeColor=<span class="function">()=&gt;</span>&#123;</span><br><span class="line"></span><br><span class="line">        setColor(color==<span class="string">&#x27;blue&#x27;</span>?<span class="string">&#x27;red&#x27;</span>:<span class="string">&#x27;blue&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">     <span class="comment">//å…³é”®ä»£ç ----------end-------</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        &lt;&gt;</span><br><span class="line">            &lt;div&gt;litterWangå…è´¹å‰ç«¯æ•™ç¨‹&lt;/div&gt;</span><br><span class="line">            &lt;div&gt;<span class="xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;changeColor&#125;</span>&gt;</span>æ”¹å˜é¢œè‰²<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span>&lt;/div&gt;</span><br><span class="line">            &lt;style jsx&gt;</span><br><span class="line">                &#123;<span class="string">`</span></span><br><span class="line"><span class="string">                    div &#123; color:<span class="subst">$&#123;color&#125;</span>;&#125;</span></span><br><span class="line"><span class="string">                `</span>&#125;</span><br><span class="line">            &lt;/style&gt;</span><br><span class="line">        &lt;/&gt;</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> litterWang</span><br></pre></td></tr></table></figure><h1 id="Lazy-Loadingå®ç°æ¨¡å—æ‡’åŠ è½½"><a href="#Lazy-Loadingå®ç°æ¨¡å—æ‡’åŠ è½½" class="headerlink" title="Lazy Loadingå®ç°æ¨¡å—æ‡’åŠ è½½"></a>Lazy Loadingå®ç°æ¨¡å—æ‡’åŠ è½½</h1><p>å½“é¡¹ç›®è¶Šæ¥è¶Šå¤§çš„æ—¶å€™ï¼Œæ¨¡å—çš„åŠ è½½æ˜¯éœ€è¦ç®¡ç†çš„ï¼Œå¦‚æœä¸ç®¡ç†ä¼šå‡ºç°é¦–æ¬¡æ‰“å¼€è¿‡æ…¢ï¼Œé¡µé¢é•¿æ—¶é—´æ²¡æœ‰ååº”ä¸€ç³»åˆ—é—®é¢˜ã€‚è¿™æ—¶å€™å¯ç”¨Next.jsæä¾›çš„LazyLoadingæ¥è§£å†³è¿™ç±»é—®é¢˜ã€‚è®©æ¨¡å—å’Œç»„ä»¶åªæœ‰åœ¨ç”¨åˆ°çš„æ—¶å€™åœ¨è¿›è¡ŒåŠ è½½ï¼Œä¸€èˆ¬æˆ‘æŠŠè¿™ç§ä¸œè¥¿å«åšâ€œæ‡’åŠ è½½â€.å®ƒä¸€èˆ¬åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼Œä¸€ç§æ˜¯æ‡’åŠ è½½ï¼ˆæˆ–è€…è¯´æ˜¯å¼‚æ­¥åŠ è½½ï¼‰æ¨¡å—ï¼Œå¦ä¸€ç§æ˜¯å¼‚æ­¥åŠ è½½ç»„ä»¶ã€‚</p><h2 id="æ‡’åŠ è½½æ¨¡å—"><a href="#æ‡’åŠ è½½æ¨¡å—" class="headerlink" title="æ‡’åŠ è½½æ¨¡å—"></a>æ‡’åŠ è½½æ¨¡å—</h2><p>è¿™é‡Œä½¿ç”¨ä¸€ä¸ªåœ¨å¼€å‘ä¸­å¸¸ç”¨çš„æ¨¡å—<code>Moment.js</code>ï¼Œå®ƒæ˜¯ä¸€ä¸ªJavaScriptæ—¥æœŸå¤„ç†ç±»åº“ï¼Œä½¿ç”¨å‰éœ€è¦å…ˆè¿›è¡Œå®‰è£…ï¼Œè¿™é‡Œä½¿ç”¨<code>yarn</code>æ¥è¿›è¡Œå®‰è£…ã€‚</p><p><code>yarn add momnet</code></p><p>ç„¶ååœ¨pagesæ–‡ä»¶å¤¹ä¸‹ï¼Œæ–°å»ºç«‹ä¸€ä¸ªtime.jsæ–‡ä»¶ï¼Œå¹¶ä½¿ç”¨åˆšæ‰çš„momentåº“æ¥æ ¼å¼åŒ–æ—¶é—´ï¼Œä»£ç å¦‚ä¸‹:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123;useState&#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> moment <span class="keyword">from</span> <span class="string">&#x27;moment&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Time</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> [nowTime,setTime] = useState(<span class="built_in">Date</span>.now())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> changeTime=<span class="function">()=&gt;</span>&#123;</span><br><span class="line">        setTime(moment(<span class="built_in">Date</span>.now()).format())</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        &lt;&gt;</span><br><span class="line">            &lt;div&gt;æ˜¾ç¤ºæ—¶é—´ä¸º:&#123;nowTime&#125;&lt;/div&gt;</span><br><span class="line">            &lt;div&gt;<span class="xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;changeTime&#125;</span>&gt;</span>æ”¹å˜æ—¶é—´æ ¼å¼<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span>&lt;/div&gt;</span><br><span class="line">        &lt;/&gt;</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> Time</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªçœ‹èµ·æ¥å¾ˆç®€å•å’Œæ¸…æ™°çš„æ¡ˆä¾‹ï¼Œç¼ºå­˜åœ¨ç€ä¸€ä¸ªæ½œåœ¨çš„é£é™©ï¼Œå°±æ˜¯å¦‚ä½•æœ‰åŠæ•°ä»¥ä¸Šé¡µé¢ä½¿ç”¨äº†è¿™ä¸ªmomnetçš„åº“ï¼Œé‚£å®ƒå°±ä¼šä»¥å…¬å…±åº“çš„å½¢å¼è¿›è¡Œæ‰“åŒ…å‘å¸ƒï¼Œå°±ç®—é¡¹ç›®ç¬¬ä¸€ä¸ªé¡µé¢ä¸ä½¿ç”¨momentä¹Ÿä¼šè¿›è¡ŒåŠ è½½ï¼Œè¿™å°±æ˜¯èµ„æºæµªè´¹ï¼Œå¯¹äºæˆ‘è¿™æ ·æœ‰ä»£ç æ´ç™–çš„è‰¯å¥½ç¨‹åºå‘˜æ˜¯ç»å¯¹ä¸å…è®¸çš„ã€‚ä¸‹é¢æˆ‘ä»¬å°±é€šè¿‡Lazy Loadingæ¥è¿›è¡Œæ”¹é€ ä»£ç ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123;useState&#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="comment">//åˆ é™¤import moment</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Time</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> [nowTime,setTime] = useState(<span class="built_in">Date</span>.now())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> changeTime= <span class="keyword">async</span> ()=&gt;&#123; <span class="comment">//æŠŠæ–¹æ³•å˜æˆå¼‚æ­¥æ¨¡å¼</span></span><br><span class="line">        <span class="keyword">const</span> moment = <span class="keyword">await</span> <span class="keyword">import</span>(<span class="string">&#x27;moment&#x27;</span>) <span class="comment">//ç­‰å¾…momentåŠ è½½å®Œæˆ</span></span><br><span class="line">        setTime(moment.default(<span class="built_in">Date</span>.now()).format()) <span class="comment">//æ³¨æ„ä½¿ç”¨defalut</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        &lt;&gt;</span><br><span class="line">            &lt;div&gt;æ˜¾ç¤ºæ—¶é—´ä¸º:&#123;nowTime&#125;&lt;/div&gt;</span><br><span class="line">            &lt;div&gt;<span class="xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;changeTime&#125;</span>&gt;</span>æ”¹å˜æ—¶é—´æ ¼å¼<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span>&lt;/div&gt;</span><br><span class="line">        &lt;/&gt;</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> Time</span><br></pre></td></tr></table></figure><p>è¿™æ—¶å€™å°±å°±æ˜¯æ‡’åŠ è½½äº†ï¼Œå¯ä»¥åœ¨æµè§ˆå™¨ä¸­æŒ‰F12ï¼Œçœ‹ä¸€ä¸‹Networkæ ‡ç­¾ï¼Œå½“æˆ‘ä»¬ç‚¹å‡»æŒ‰é’®æ—¶ï¼Œæ‰ä¼šåŠ è½½1.js,å®ƒå°±æ˜¯momnet.jsçš„å†…å®¹ã€‚</p><h2 id="æ‡’åŠ è½½è‡ªå®šä¹‰ç»„ä»¶"><a href="#æ‡’åŠ è½½è‡ªå®šä¹‰ç»„ä»¶" class="headerlink" title="æ‡’åŠ è½½è‡ªå®šä¹‰ç»„ä»¶"></a>æ‡’åŠ è½½è‡ªå®šä¹‰ç»„ä»¶</h2><p>æ‡’åŠ è½½ç»„ä»¶ä¹Ÿæ˜¯éå¸¸å®¹æ˜“çš„ï¼Œæˆ‘ä»¬å…ˆæ¥å†™ä¸€ä¸ªæœ€ç®€å•çš„ç»„ä»¶ï¼Œåœ¨componentsæ–‡ä»¶å¤¹ä¸‹å»ºç«‹ä¸€ä¸ªone.jsæ–‡ä»¶ï¼Œç„¶åç¼–å†™å¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> ()=&gt;<span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>Lazy Loading Component<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>æœ‰äº†è‡ªå®šä¹‰ç»„ä»¶åï¼Œå…ˆè¦åœ¨æ‡’åŠ è½½è¿™ä¸ªç»„ä»¶çš„æ–‡ä»¶ä¸­å¼•å…¥dynamic,æˆ‘ä»¬è¿™ä¸ªå°±åœ¨ä¸Šè¾¹æ–°å»ºçš„time.jsæ–‡ä»¶ä¸­ç¼–å†™äº†ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> dynamic <span class="keyword">from</span> <span class="string">&#x27;next/dynamic&#x27;</span></span><br></pre></td></tr></table></figure><p>å¼•å…¥åå°±å¯ä»¥æ‡’åŠ è½½è‡ªå®šä¹‰æ¨¡å—äº†ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123;useState&#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> dynamic <span class="keyword">from</span> <span class="string">&#x27;next/dynamic&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> One = dynamic(<span class="keyword">import</span>(<span class="string">&#x27;../components/one&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Time</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> [nowTime,setTime] = useState(<span class="built_in">Date</span>.now())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> changeTime= <span class="keyword">async</span> ()=&gt;&#123;</span><br><span class="line">        <span class="keyword">const</span> moment = <span class="keyword">await</span> <span class="keyword">import</span>(<span class="string">&#x27;moment&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        setTime(moment.default(<span class="built_in">Date</span>.now()).format())</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        &lt;&gt;</span><br><span class="line">            &lt;div&gt;æ˜¾ç¤ºæ—¶é—´ä¸º:&#123;nowTime&#125;&lt;/div&gt;</span><br><span class="line">            &lt;One/&gt;</span><br><span class="line">            &lt;div&gt;<span class="xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;changeTime&#125;</span>&gt;</span>æ”¹å˜æ—¶é—´æ ¼å¼<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span>&lt;/div&gt;</span><br><span class="line">        &lt;/&gt;</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> Time</span><br></pre></td></tr></table></figure><p>å†™å®Œä»£ç åï¼Œå¯ä»¥çœ‹åˆ°è‡ªå®šä¹‰ç»„ä»¶æ˜¯æ‡’åŠ è½½çš„ï¼Œåªæœ‰åœ¨jsxé‡Œç”¨åˆ°<code>&lt;One/&gt;</code>æ—¶ï¼Œæ‰ä¼šè¢«åŠ è½½è¿›æ¥ï¼Œå¦‚æœä¸ä½¿ç”¨å°±ä¸ä¼šè¢«åŠ è½½ã€‚</p><p>å½“æˆ‘ä»¬ä½œçš„åº”ç”¨å­˜åœ¨é¦–é¡µæ‰“å¼€è¿‡æ…¢å’ŒæŸä¸ªé¡µé¢åŠ è½½è¿‡æ…¢æ—¶ï¼Œå°±å¯ä»¥é‡‡ç”¨Lazy Loadingçš„å½¢å¼ï¼Œç”¨æ‡’åŠ è½½è§£å†³è¿™äº›é—®é¢˜ã€‚</p><h1 id="è‡ªå®šä¹‰Head-æ›´åŠ å‹å¥½çš„SEOæ“ä½œ"><a href="#è‡ªå®šä¹‰Head-æ›´åŠ å‹å¥½çš„SEOæ“ä½œ" class="headerlink" title="è‡ªå®šä¹‰Head æ›´åŠ å‹å¥½çš„SEOæ“ä½œ"></a>è‡ªå®šä¹‰Head æ›´åŠ å‹å¥½çš„SEOæ“ä½œ</h1><p>æ—¢ç„¶ç”¨äº†Next.jsæ¡†æ¶ï¼Œä½ å°±æ˜¯å¸Œæœ›æœåŠ¡ç«¯æ¸²æŸ“ï¼Œè¿›è¡ŒSEOæ“ä½œã€‚é‚£ä¸ºäº†æ›´å¥½çš„è¿›è¡ŒSEOä¼˜åŒ–ï¼Œå¯ä»¥è‡ªå·±å®šåˆ¶<code>&lt;Head&gt;</code>æ ‡ç­¾ï¼Œå®šä¹‰<code>&lt;Head&gt;</code>ä¸€èˆ¬æœ‰ä¸¤ç§æ–¹å¼ï¼Œè¿™èŠ‚è¯¾éƒ½å­¦ä¹ ä¸€ä¸‹ã€‚</p><h2 id="æ–¹æ³•1ï¼šåœ¨å„ä¸ªé¡µé¢åŠ ä¸Š-lt-Head-gt-æ ‡ç­¾"><a href="#æ–¹æ³•1ï¼šåœ¨å„ä¸ªé¡µé¢åŠ ä¸Š-lt-Head-gt-æ ‡ç­¾" class="headerlink" title="æ–¹æ³•1ï¼šåœ¨å„ä¸ªé¡µé¢åŠ ä¸Š&lt;Head&gt;æ ‡ç­¾"></a>æ–¹æ³•1ï¼šåœ¨å„ä¸ªé¡µé¢åŠ ä¸Š<code>&lt;Head&gt;</code>æ ‡ç­¾</h2><p>å…ˆåœ¨/pagesæ–‡ä»¶å¤¹ä¸‹é¢å»ºç«‹ä¸€ä¸ªheader.jsæ–‡ä»¶ï¼Œç„¶åå†™ä¸€ä¸ªæœ€ç®€å•çš„Hooksé¡µé¢ï¼Œä»£ç å¦‚ä¸‹:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Header</span>(<span class="params"></span>)</span>&#123; </span><br><span class="line">    <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>litterWang.com<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> Header</span><br></pre></td></tr></table></figure><p>å†™å®Œååˆ°æµè§ˆå™¨ä¸­é¢„è§ˆä¸€ä¸‹ï¼Œå¯ä»¥å‘ç°titleéƒ¨åˆ†å¹¶æ²¡æœ‰ä»»ä½•å†…å®¹ï¼Œæ˜¾ç¤ºçš„æ˜¯<code>localhost:3000/header</code>,æ¥ä¸‹æ¥å°±è‡ªå®šä¹‰ä¸‹<code>&lt;Head&gt;</code>ã€‚è‡ªå®šä¹‰éœ€è¦å…ˆè¿›è¡Œå¼•å…¥next/headã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Head <span class="keyword">from</span> <span class="string">&#x27;next/head&#x27;</span></span><br><span class="line">å¼•å…¥åä½ å°±å¯ä»¥å†™ä¸€äº›åˆ—çš„å¤´éƒ¨æ ‡ç­¾äº†ï¼Œå…¨éƒ¨ä»£ç å¦‚ä¸‹:</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> Head <span class="keyword">from</span> <span class="string">&#x27;next/head&#x27;</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Header</span>(<span class="params"></span>)</span>&#123; </span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        &lt;&gt;</span><br><span class="line">            &lt;Head&gt;</span><br><span class="line">                &lt;title&gt;litterWangæ˜¯æœ€èƒ–çš„ï¼&lt;/title&gt;</span><br><span class="line">                &lt;meta charSet=<span class="string">&#x27;utf-8&#x27;</span> /&gt;</span><br><span class="line">            &lt;/Head&gt;</span><br><span class="line">            &lt;div&gt;litterWang.com&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">        &lt;/&gt; </span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> Header</span><br></pre></td></tr></table></figure><p>è¿™æ—¶å€™å†æ‰“å¼€æµè§ˆå™¨é¢„è§ˆï¼Œä½ å‘ç°å·²ç»æœ‰äº†titleã€‚</p><h2 id="æ–¹æ³•2ï¼šå®šä¹‰å…¨å±€çš„"><a href="#æ–¹æ³•2ï¼šå®šä¹‰å…¨å±€çš„" class="headerlink" title="æ–¹æ³•2ï¼šå®šä¹‰å…¨å±€çš„"></a>æ–¹æ³•2ï¼šå®šä¹‰å…¨å±€çš„<Head></h2><p>è¿™ç§æ–¹æ³•ç›¸å½“äºè‡ªå®šä¹‰äº†ä¸€ä¸ªç»„ä»¶ï¼Œç„¶åæŠŠ<Head>åœ¨ç»„ä»¶é‡Œå®šä¹‰å¥½ï¼Œä»¥åæ¯ä¸ªé¡µé¢éƒ½ä½¿ç”¨è¿™ä¸ªç»„ä»¶,å…¶å®è¿™ç§æ–¹æ³•ç”¨å¤„ä¸å¤§ï¼Œä¹Ÿä¸çµæ´»ã€‚å› ä¸ºNext.jså·²ç»æŠŠ<code>&lt;Head&gt;</code>å°è£…å¥½äº†ï¼Œæœ¬èº«å°±æ˜¯ä¸€ä¸ªç»„ä»¶ï¼Œæˆ‘ä»¬å†æ¬¡å°è£…çš„æ„ä¹‰ä¸å¤§ã€‚</p><p>æ¯”å¦‚åœ¨componentsæ–‡ä»¶å¤¹ä¸‹é¢æ–°å»ºç«‹ä¸€ä¸ªmyheader.js,ç„¶åå†™å…¥ä¸‹é¢çš„ä»£ç :</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Head <span class="keyword">from</span> <span class="string">&#x27;next/head&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> MyHeader = <span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        &lt;&gt;</span><br><span class="line">            &lt;Head&gt;</span><br><span class="line">                &lt;title&gt; litterWang.com &lt;/title&gt;   </span><br><span class="line">            &lt;/Head&gt;</span><br><span class="line">        &lt;/&gt;</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> MyHeader</span><br></pre></td></tr></table></figure><p>è¿™æ—¶å€™æŠŠåˆšæ‰ç¼–å†™çš„header.jsé¡µé¢æ”¹å†™ä¸€ä¸‹ï¼Œå¼•å…¥è‡ªå®šä¹‰çš„myheaderï¼Œåœ¨é¡µé¢é‡Œè¿›è¡Œä½¿ç”¨ï¼Œæœ€ååœ¨æµè§ˆå™¨ä¸­é¢„è§ˆï¼Œä¹Ÿæ˜¯å¯ä»¥å¾—åˆ°titleçš„ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Myheader <span class="keyword">from</span> <span class="string">&#x27;../components/myheader&#x27;</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Header</span>(<span class="params"></span>)</span>&#123; </span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        &lt;&gt;</span><br><span class="line">            &lt;Myheader /&gt;</span><br><span class="line">            &lt;div&gt;litterWang.com&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">        &lt;/&gt; </span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> Header</span><br></pre></td></tr></table></figure><p>è¿™èŠ‚è¯¾è®²è§£äº†ä¸€ä¸‹Next.jsçš„<code>&lt;Head&gt;</code>æ ‡ç­¾å¦‚ä½•ä½¿ç”¨å’Œè‡ªå®šä¹‰ï¼Œè¿™ä¸ªåœ¨å·¥ä½œä¸­çš„æ¯ä¸ªé¡µé¢éƒ½ä¼šç”¨åˆ°ï¼Œæ‰€ä»¥ä½ ä¸€å®šè¦å­¦ä¼šå“¦ã€‚</p><h1 id="p11ï¼šNext-jsæ¡†æ¶ä¸‹ä½¿ç”¨Ant-Design-UI"><a href="#p11ï¼šNext-jsæ¡†æ¶ä¸‹ä½¿ç”¨Ant-Design-UI" class="headerlink" title="p11ï¼šNext.jsæ¡†æ¶ä¸‹ä½¿ç”¨Ant Design UI"></a>p11ï¼šNext.jsæ¡†æ¶ä¸‹ä½¿ç”¨Ant Design UI</h1><p>åœ¨Next.jsæ¡†æ¶ä¸‹ä½¿ç”¨ Ant Designï¼Œæ˜¯æœ€è¿‘å°ä¼™ä¼´ä»¬é—®æˆ‘æœ€å¤šçš„ä¸€ä¸ªé—®é¢˜ï¼Œæ‰€ä»¥å†³å®šå•ç‹¬æ‹¿å‡ºä¸€èŠ‚è¯¾æ¥è®²ä¸€ä¸‹ã€‚Ant Designæ˜¯ä¸€æ¬¾é˜¿é‡Œå¼€æºçš„å‰ç«¯ç»„ä»¶åº“ï¼Œæˆ‘åœ¨å·¥ä½œä¸­ä¹Ÿä¸€ç›´åœ¨ä½¿ç”¨ï¼Œæˆ‘è§‰çš„å®ƒæ˜¯ç›®å‰é˜¿é‡Œå¼€æºçš„å‰ç«¯é¡¹ç›®æ˜¯æœ€æˆåŠŸçš„,ä½¿ç”¨äººæ•°ä¹Ÿæ˜¯æœ€å¤šçš„ä¸€ä¸ªã€‚ä¸è¿‡å®ƒçš„åˆå¿ƒæ˜¯ç”¨æ¥æ­å»ºé¡¹ç›®çš„ä¸­åå°ç³»ç»Ÿï¼Œæ¯”å¦‚åå°çš„ç®¡ç†ç³»ç»Ÿã€‚ä»Reactçš„è§’åº¦æ¥è®²ï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªç»„ä»¶åº“ï¼Œé‡Œè¾¹å°è£…äº†å¼€å‘ä¸­æœ€å¸¸ç”¨çš„ä¸€äº›ç»„ä»¶ï¼Œè®©æˆ‘ä»¬å¯ä»¥é€šè¿‡ç®€å•çš„é…ç½®å°±å¯ä»¥ä½¿ç”¨ä»–ä»¬ã€‚</p><h2 id="è®©Next-jsæ”¯æŒCSSæ–‡ä»¶"><a href="#è®©Next-jsæ”¯æŒCSSæ–‡ä»¶" class="headerlink" title="è®©Next.jsæ”¯æŒCSSæ–‡ä»¶"></a>è®©Next.jsæ”¯æŒCSSæ–‡ä»¶</h2><p>Next.jsé»˜è®¤æ˜¯ä¸æ”¯æŒCSSæ–‡ä»¶çš„ï¼Œå®ƒç”¨çš„æ˜¯style jsxï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒæ˜¯ä¸æ”¯æŒç›´æ¥ç”¨importè¿›è¡Œå¼•å…¥cssçš„ã€‚</p><p>æ¯”å¦‚åœ¨æ ¹ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹staticï¼ˆå…¶å®æ­£å¸¸æƒ…å†µä¸‹ä½ åº”è¯¥å·²ç»æœ‰è¿™ä¸ªæ–‡ä»¶äº†ï¼‰ï¼Œç„¶ååœ¨æ–‡ä»¶å¤¹ä¸‹å»ºç«‹ä¸€ä¸ªtest.cssæ–‡ä»¶ï¼Œå†™å…¥ä¸€äº›CSS Styleã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">body&#123;</span><br><span class="line">    color:green;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åç”¨importåœ¨header.jsé‡Œå¼•å…¥ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;../static/test.css&#x27;</span></span><br></pre></td></tr></table></figure><p>å†™å®Œè¿™äº›ååˆ°æµè§ˆå™¨ä¸­è¿›è¡Œé¢„è§ˆï¼Œæ²¡æœ‰ä»»ä½•è¾“å‡ºç»“æœè€Œä¸”æŠ¥é”™äº†ã€‚è¿™è¯´æ˜Next.jsé»˜è®¤æ˜¯ä¸æ”¯æŒCSSæ ·å¼å¼•å…¥çš„ï¼Œè¦è¿›è¡Œä¸€äº›å¿…è¦çš„è®¾ç½®ï¼Œæ‰å¯ä»¥å®Œæˆã€‚</p><p>å¼€å§‹è¿›è¡Œé…ç½®ï¼Œè®©Next.jsæ”¯æŒCSSæ–‡ä»¶</p><p>å…ˆç”¨yarnå‘½ä»¤æ¥å®‰è£…@zeit/next-cssåŒ…ï¼Œå®ƒçš„ä¸»è¦åŠŸèƒ½å°±æ˜¯è®©Next.jså¯ä»¥åŠ è½½CSSæ–‡ä»¶ï¼Œæœ‰äº†è¿™ä¸ªåŒ…æ‰å¯ä»¥è¿›è¡Œé…ç½®ã€‚</p><p><code>yarn add @zeit/next-css</code></p><p>åŒ…å®‰è£…å¥½ä»¥åå°±å¯ä»¥è¿›è¡Œé…ç½®æ–‡ä»¶çš„ç¼–å†™äº†ï¼Œå»ºç«‹ä¸€ä¸ªnext.config.js.è¿™ä¸ªå°±æ˜¯Next.jsçš„æ€»é…ç½®æ–‡ä»¶ï¼ˆå¦‚æœæ„Ÿå…´è¶£å¯ä»¥è‡ªå­¦ä¸€ä¸‹ï¼‰ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> withCss = <span class="built_in">require</span>(<span class="string">&#x27;@zeit/next-css&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">typeof</span> <span class="built_in">require</span> !== <span class="string">&#x27;undefined&#x27;</span>)&#123;</span><br><span class="line">    <span class="built_in">require</span>.extensions[<span class="string">&#x27;.css&#x27;</span>]=<span class="function"><span class="params">file</span>=&gt;</span>&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = withCss(&#123;&#125;)</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹é…ç½®æ–‡ä»¶éœ€è¦é‡æ–°å¯ä¸€ä¸‹æœåŠ¡ï¼Œé‡å¯æœåŠ¡å¯ä»¥è®©é…ç½®ç”Ÿæ•ˆï¼Œè¿™æ—¶å€™ä½ åˆ°æµè§ˆå™¨ä¸­å¯ä»¥å‘ç°CSSæ–‡ä»¶å·²ç»ç”Ÿæ•ˆäº†ï¼Œå­—å˜æˆäº†ç»¿è‰²ã€‚</p><h2 id="æŒ‰éœ€åŠ è½½Ant-Design"><a href="#æŒ‰éœ€åŠ è½½Ant-Design" class="headerlink" title="æŒ‰éœ€åŠ è½½Ant Design"></a>æŒ‰éœ€åŠ è½½Ant Design</h2><p>åŠ è½½Ant Designåœ¨æˆ‘ä»¬æ‰“åŒ…çš„æ—¶å€™ä¼šæŠŠAnt Designçš„æ‰€æœ‰åŒ…éƒ½æ‰“åŒ…è¿›æ¥ï¼Œè¿™æ ·å°±ä¼šäº§ç”Ÿæ€§èƒ½é—®é¢˜ï¼Œè®©é¡¹ç›®åŠ è½½å˜çš„éå¸¸æ…¢ã€‚è¿™è‚¯å®šæ˜¯ä¸è¡Œçš„ï¼Œç°åœ¨çš„ç›®çš„æ˜¯åªåŠ è½½é¡¹ç›®ä¸­ç”¨åˆ°çš„æ¨¡å—ï¼Œè¿™å°±éœ€è¦æˆ‘ä»¬ç”¨åˆ°ä¸€ä¸ªbabel-plugin-importæ–‡ä»¶ã€‚</p><h2 id="å…ˆæ¥å®‰è£…Ant-Designåº“"><a href="#å…ˆæ¥å®‰è£…Ant-Designåº“" class="headerlink" title="** å…ˆæ¥å®‰è£…Ant Designåº“ **"></a>** å…ˆæ¥å®‰è£…Ant Designåº“ **</h2><p>ç›´æ¥ä½¿ç”¨yarnæ¥å®‰è£…å°±å¯ä»¥ã€‚</p><p><code>yarn add antd</code></p><h2 id="å®‰è£…å’Œé…ç½®babel-plugin-import-æ’ä»¶"><a href="#å®‰è£…å’Œé…ç½®babel-plugin-import-æ’ä»¶" class="headerlink" title="** å®‰è£…å’Œé…ç½®babel-plugin-import æ’ä»¶ **"></a>** å®‰è£…å’Œé…ç½®babel-plugin-import æ’ä»¶ **</h2><p>å…¶å®babel-plugin-importæˆ‘è®²Vue.jså’ŒWebpack.jsçš„æ—¶å€™éƒ½ä¸€æ¬¡è®²è¿‡è¿™ä¸ªæ’ä»¶ï¼Œè¿™é‡Œæˆ‘ä»¬å°±å†æ¥è®²ä¸€ä¸‹ï¼Œå…ˆè¿›è¡Œå®‰è£…ã€‚</p><p><code>yarn add babel-plugin-import</code><br>å®‰è£…å®Œæˆåï¼Œåœ¨é¡¹ç›®æ ¹ç›®å½•å»ºç«‹.babelrcæ–‡ä»¶ï¼Œç„¶åå†™å…¥å¦‚ä¸‹é…ç½®æ–‡ä»¶ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;presets&quot;</span>:[<span class="string">&quot;next/babel&quot;</span>],  <span class="comment">//Next.jsçš„æ€»é…ç½®æ–‡ä»¶ï¼Œç›¸å½“äºç»§æ‰¿äº†å®ƒæœ¬èº«çš„æ‰€æœ‰é…ç½®</span></span><br><span class="line">    <span class="string">&quot;plugins&quot;</span>:[     <span class="comment">//å¢åŠ æ–°çš„æ’ä»¶ï¼Œè¿™ä¸ªæ’ä»¶å°±æ˜¯è®©antdå¯ä»¥æŒ‰éœ€å¼•å…¥ï¼ŒåŒ…æ‹¬CSS</span></span><br><span class="line">        [</span><br><span class="line">            <span class="string">&quot;import&quot;</span>,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="string">&quot;libraryName&quot;</span>:<span class="string">&quot;antd&quot;</span>,</span><br><span class="line">                <span class="string">&quot;style&quot;</span>:<span class="string">&quot;css&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·é…ç½®å¥½äº†ä»¥åï¼Œwebpackå°±ä¸ä¼šé»˜è®¤æŠŠæ•´ä¸ªAnt Designçš„åŒ…éƒ½è¿›è¡Œæ‰“åŒ…åˆ°ç”Ÿäº§ç¯å¢ƒäº†ï¼Œè€Œæ˜¯æˆ‘ä»¬ä½¿ç”¨é‚£ä¸ªç»„ä»¶å°±æ‰“åŒ…é‚£ä¸ªç»„ä»¶,åŒæ ·CSSä¹Ÿæ˜¯æŒ‰éœ€æ‰“åŒ…çš„ã€‚</p><p>é€šè¿‡ä¸Šé¢çš„é…ç½®ï¼Œå°±å¯ä»¥æ„‰å¿«çš„åœ¨Next.jsä¸­ä½¿ç”¨Ant Desginï¼Œè®©é¡µé¢å˜çš„å¥½çœ‹èµ·æ¥ã€‚</p><p>å¯ä»¥åœ¨header.jsé‡Œï¼Œå¼•å…¥<Button>ç»„ä»¶ï¼Œå¹¶è¿›è¡Œä½¿ç”¨ï¼Œä»£ç å¦‚ä¸‹ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Myheader <span class="keyword">from</span> <span class="string">&#x27;../components/myheader&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;Button&#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;../static/test.css&#x27;</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Header</span>(<span class="params"></span>)</span>&#123; </span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        &lt;&gt;</span><br><span class="line">            &lt;Myheader /&gt;</span><br><span class="line">            &lt;div&gt;litterWang.com&lt;/div&gt;</span><br><span class="line">            &lt;div&gt;<span class="xml"><span class="tag">&lt;<span class="name">Button</span>&gt;</span>æˆ‘æ˜¯æŒ‰é’®<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span>&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">        &lt;/&gt; </span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> Header</span><br></pre></td></tr></table></figure><p>ç„¶ååˆ°æµè§ˆå™¨ä¸­æŸ¥çœ‹ä¸€ä¸‹ç»“æœï¼Œè¿™æ—¶å€™Ant Designå·²ç»èµ·ä½œç”¨äº†ï¼Œæˆ‘ä»¬ä¹Ÿå®Œæˆäº†åœ¨Next.jsä¸­ï¼Œä½¿ç”¨Ant Designçš„ç›®çš„ã€‚</p><h1 id="Next-jsç”Ÿäº§ç¯å¢ƒæ‰“åŒ…ï¼ˆå®Œç»“ï¼‰"><a href="#Next-jsç”Ÿäº§ç¯å¢ƒæ‰“åŒ…ï¼ˆå®Œç»“ï¼‰" class="headerlink" title="Next.jsç”Ÿäº§ç¯å¢ƒæ‰“åŒ…ï¼ˆå®Œç»“ï¼‰"></a>Next.jsç”Ÿäº§ç¯å¢ƒæ‰“åŒ…ï¼ˆå®Œç»“ï¼‰</h1><p>å¦‚ä½•è¿›è¡Œæ‰“åŒ…å’Œæ‰“åŒ…ä¸­çš„ä¸€äº›å‘ã€‚</p><p>å…¶å®Next.jså¤§æ‰“åŒ…æ—¶éå¸¸ç®€å•çš„ï¼Œåªè¦ä¸€ä¸ªå‘½ä»¤å°±å¯ä»¥æ‰“åŒ…æˆåŠŸã€‚ä½†æ˜¯å½“ä½ ä½¿ç”¨äº†Ant Desginåï¼Œåœ¨æ‰“åŒ…çš„æ—¶å€™ä¼šé‡åˆ°ä¸€äº›å‘ã€‚</p><p>æ‰“åŒ… ï¼šnext build</p><p>è¿è¡Œï¼šnext start -p 80</p><p>å…ˆæŠŠè¿™ä¸¤ä¸ªå‘½ä»¤é…ç½®åˆ°package.jsonæ–‡ä»¶é‡Œï¼Œæ¯”å¦‚é…ç½®æˆä¸‹é¢çš„æ ·å­ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">  <span class="string">&quot;dev&quot;</span>: <span class="string">&quot;next dev&quot;</span>,</span><br><span class="line">  <span class="string">&quot;build&quot;</span>: <span class="string">&quot;next build&quot;</span>,</span><br><span class="line">  <span class="string">&quot;start&quot;</span>: <span class="string">&quot;next start -p 80&quot;</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨ç»ˆç«¯é‡Œè¿è¡Œä¸€ä¸‹<code>yarn build</code>ï¼Œå¦‚æœè¿™æ—¶å€™æŠ¥é”™ï¼Œå…¶å®æ˜¯æˆ‘ä»¬åœ¨åŠ å…¥Ant Designçš„æ ·å¼æ—¶äº§ç”Ÿçš„ï¼Œè¿™ä¸ªå·²ç»åœ¨Ant Designçš„Githubä¸Šè¢«æå‡ºäº†ï¼Œä½†ç›®å‰è¿˜æ²¡æœ‰è¢«ä¿®æ”¹ï¼Œä½ å¯ä»¥æ”¹å®Œå…¨å±€å¼•å…¥CSSè§£å†³é—®é¢˜ã€‚</p><p>åœ¨pageç›®å½•ä¸‹ï¼Œæ–°å»ºä¸€ä¸ª_app.jsæ–‡ä»¶ï¼Œç„¶åå†™å…¥ä¸‹é¢çš„ä»£ç ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">&#x27;next/app&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;antd/dist/antd.css&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> App</span><br></pre></td></tr></table></figure><p>è¿™æ ·é…ç½®ä¸€ä¸‹ï¼Œå°±å¯ä»¥æ‰“åŒ…æˆåŠŸäº†ï¼Œç„¶åå†è¿è¡Œyarn startæ¥è¿è¡ŒæœåŠ¡å™¨ï¼Œçœ‹ä¸€ä¸‹æˆ‘ä»¬çš„headeré¡µé¢ï¼Œä¹Ÿæ˜¯æœ‰æ ·å¼çš„ã€‚è¯´æ˜æ‰“åŒ…å·²ç»æˆåŠŸäº†ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Next-jsç®€ä»‹&quot;&gt;&lt;a href=&quot;#Next-jsç®€ä»‹&quot; class=&quot;headerlink&quot; title=&quot;Next.jsç®€ä»‹&quot;&gt;&lt;/a&gt;Next.jsç®€ä»‹&lt;/h1&gt;&lt;div class=&quot;note default&quot;&gt;&lt;p&gt;Next.js æ˜¯ä¸€ä¸ªè½»é‡çº§çš„ </summary>
      
    
    
    
    <category term="reactå­¦ä¹ " scheme="https://hard-workingrookie.github.io/categories/react%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="react" scheme="https://hard-workingrookie.github.io/tags/react/"/>
    
    <category term="Next.js" scheme="https://hard-workingrookie.github.io/tags/Next-js/"/>
    
  </entry>
  
  <entry>
    <title>ç¬”è®°</title>
    <link href="https://hard-workingrookie.github.io/2020/08/27/%E7%AC%94%E8%AE%B0/"/>
    <id>https://hard-workingrookie.github.io/2020/08/27/%E7%AC%94%E8%AE%B0/</id>
    <published>2020-08-27T11:24:37.000Z</published>
    <updated>2020-12-28T10:23:01.134Z</updated>
    
    <content type="html"><![CDATA[<h1 id="babel-plugin-import"><a href="#babel-plugin-import" class="headerlink" title="babel-plugin-import"></a>babel-plugin-import</h1><p>webpack å°±ä¸ä¼šé»˜è®¤æŠŠæ•´ä¸ªçš„åŒ…éƒ½è¿›è¡Œæ‰“åŒ…åˆ°ç”Ÿäº§ç¯å¢ƒäº†ï¼Œè€Œæ˜¯æˆ‘ä»¬ä½¿ç”¨é‚£ä¸ªç»„ä»¶å°±æ‰“åŒ…é‚£ä¸ªç»„ä»¶,åŒæ · CSS ä¹Ÿæ˜¯æŒ‰éœ€æ‰“åŒ…çš„ã€‚</p><p>é…ç½®ä¸¾ä¾‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;presets&quot;</span>:[<span class="string">&quot;next/babel&quot;</span>],  <span class="comment">//Next.jsçš„æ€»é…ç½®æ–‡ä»¶ï¼Œç›¸å½“äºç»§æ‰¿äº†å®ƒæœ¬èº«çš„æ‰€æœ‰é…ç½®</span></span><br><span class="line">    <span class="string">&quot;plugins&quot;</span>:[     <span class="comment">//å¢åŠ æ–°çš„æ’ä»¶ï¼Œè¿™ä¸ªæ’ä»¶å°±æ˜¯è®©antdå¯ä»¥æŒ‰éœ€å¼•å…¥ï¼ŒåŒ…æ‹¬CSS</span></span><br><span class="line">        [</span><br><span class="line">            <span class="string">&quot;import&quot;</span>,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="string">&quot;libraryName&quot;</span>:<span class="string">&quot;antd&quot;</span>,</span><br><span class="line">                <span class="string">&quot;style&quot;</span>:<span class="string">&quot;css&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="next-js-å¼•å…¥-css"><a href="#next-js-å¼•å…¥-css" class="headerlink" title="next.js å¼•å…¥ css"></a>next.js å¼•å…¥ css</h1><p>å…ˆç”¨ yarn å‘½ä»¤æ¥å®‰è£…@zeit/next-css åŒ…ï¼Œå®ƒçš„ä¸»è¦åŠŸèƒ½å°±æ˜¯è®© Next.js å¯ä»¥åŠ è½½ CSS æ–‡ä»¶ï¼Œæœ‰äº†è¿™ä¸ªåŒ…æ‰å¯ä»¥è¿›è¡Œé…ç½®ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add @zeit/next-css</span><br></pre></td></tr></table></figure><p>åŒ…å®‰è£…å¥½ä»¥åå°±å¯ä»¥è¿›è¡Œé…ç½®æ–‡ä»¶çš„ç¼–å†™äº†ï¼Œå»ºç«‹ä¸€ä¸ª next.config.js.è¿™ä¸ªå°±æ˜¯ Next.js çš„æ€»é…ç½®æ–‡ä»¶ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> withCss = <span class="built_in">require</span>(<span class="string">&#x27;@zeit/next-css&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">typeof</span> <span class="built_in">require</span> !== <span class="string">&#x27;undefined&#x27;</span>)&#123;</span><br><span class="line">    <span class="built_in">require</span>.extensions[<span class="string">&#x27;.css&#x27;</span>]=<span class="function"><span class="params">file</span>=&gt;</span>&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = withCss(&#123;&#125;)</span><br></pre></td></tr></table></figure><p>è¿™æ®µä»£ç ä½ æœ‰å…´è¶£æ˜¯å¯ä»¥çœ‹çœ‹çš„ï¼Œå…¶å®æˆ‘å¯¹é…ç½®æ–‡ä»¶åŸºæœ¬ä¸è®°å¿†çš„ï¼Œå› ä¸ºé…ç½®æ–‡ä»¶å°±æ˜¯åˆ«äººè§„å®šçš„é…ç½®ï¼Œä½ å†™å°±å¥½ã€‚æ¯”å¦‚è¦ä½¿ç”¨ CSS å°±å¯ä»¥æŠŠä¸Šé¢è¿™æ®µä»£ç è¾“å…¥åˆ°æ”¾å…¥åˆ°é‡Œè¾¹çš„å°±å¥½äº†ã€‚</p><p>ä¿®æ”¹é…ç½®æ–‡ä»¶éœ€è¦é‡æ–°å¯ä¸€ä¸‹æœåŠ¡(<code>yarn dev </code>)ï¼Œé‡å¯æœåŠ¡å¯ä»¥è®©é…ç½®ç”Ÿæ•ˆï¼Œè¿™æ—¶å€™ä½ åˆ°æµè§ˆå™¨ä¸­å¯ä»¥å‘ç° CSS æ–‡ä»¶å·²ç»ç”Ÿæ•ˆäº†ã€‚</p><h1 id="1-markdown-è§£æç»„ä»¶"><a href="#1-markdown-è§£æç»„ä»¶" class="headerlink" title="1.markdown è§£æç»„ä»¶"></a>1.markdown è§£æç»„ä»¶</h1><p>react-markdown æ˜¯ react ä¸“ç”¨çš„ markdown è§£æç»„ä»¶</p><div class="note default"><p>github ç½‘å€ï¼š<a href="https://github.com/rexxars/react-markdown">https://github.com/rexxars/react-markdown</a></p></div><p>å¯ä»¥ç›´æ¥ä½¿ç”¨ yarn add æ¥è¿›è¡Œå®‰è£…ï¼Œä»£ç å¦‚ä¸‹:</p><p><code>yarn add react-markdown</code><br>å®‰è£…å¥½åï¼Œä½¿ç”¨ import è¿›è¡Œå¼•å…¥ï¼Œä»£ç å¦‚ä¸‹:</p><p><code>import ReactMarkdown from &#39;react-markdown&#39;</code></p><p>å‡†å¤‡ md ç›¸å…³æ•°æ®<br>å› ä¸ºç›®å‰è¿˜æ²¡æœ‰åç«¯ç¨‹åºï¼Œæ‰€ä»¥éœ€è¦ä¼ªé€ ä¸€ä¸ª md æ•°æ®ï¼Œè®© web é¡µé¢å¯ä»¥æ¸²æŸ“ã€‚</p><p>è¿™é‡Œå£°æ˜ä¸€ä¸ª markdown å˜é‡,å½“ç„¶å†…å®¹å…¨éƒ¨æ˜¯æˆ‘èƒ¡ä¹±å†™çš„ï¼Œä¸ºçš„å°±æ˜¯å¯ä»¥é¡ºåˆ©æ¸²æŸ“å‡ºæ¥ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> markdown=<span class="string">&#x27;# P01:è¯¾ç¨‹ä»‹ç»å’Œç¯å¢ƒæ­å»º\n&#x27;</span> +</span><br><span class="line">  <span class="string">&#x27;[ **M** ] arkdown + E [ **ditor** ] = **Mditor**  \n&#x27;</span> +</span><br><span class="line">  <span class="string">&#x27;&gt; Mditor æ˜¯ä¸€ä¸ªç®€æ´ã€æ˜“äºé›†æˆã€æ–¹ä¾¿æ‰©å±•ã€æœŸæœ›èˆ’æœçš„ç¼–å†™ markdown çš„ç¼–è¾‘å™¨ï¼Œä»…æ­¤è€Œå·²... \n\n&#x27;</span> +</span><br><span class="line">   <span class="string">&#x27;**è¿™æ˜¯åŠ ç²—çš„æ–‡å­—**\n\n&#x27;</span> +</span><br><span class="line">  <span class="string">&#x27;*è¿™æ˜¯å€¾æ–œçš„æ–‡å­—*`\n\n&#x27;</span> +</span><br><span class="line">  <span class="string">&#x27;***è¿™æ˜¯æ–œä½“åŠ ç²—çš„æ–‡å­—***\n\n&#x27;</span> +</span><br><span class="line">  <span class="string">&#x27;~~è¿™æ˜¯åŠ åˆ é™¤çº¿çš„æ–‡å­—~~ \n\n&#x27;</span>+</span><br><span class="line">  <span class="string">&#x27;\`console.log(111)\` \n\n&#x27;</span>+</span><br><span class="line">  <span class="string">&#x27;# p02:æ¥ä¸ªHello World åˆå§‹Vue3.0\n&#x27;</span> +</span><br><span class="line">  <span class="string">&#x27;&gt; aaaaaaaaa\n&#x27;</span> +</span><br><span class="line">  <span class="string">&#x27;&gt;&gt; bbbbbbbbb\n&#x27;</span> +</span><br><span class="line">  <span class="string">&#x27;&gt;&gt;&gt; cccccccccc\n&#x27;</span>+</span><br><span class="line">  <span class="string">&#x27;***\n\n\n&#x27;</span> +</span><br><span class="line">  <span class="string">&#x27;# p03:Vue3.0åŸºç¡€çŸ¥è¯†è®²è§£\n&#x27;</span> +</span><br><span class="line">  <span class="string">&#x27;&gt; aaaaaaaaa\n&#x27;</span> +</span><br><span class="line">  <span class="string">&#x27;&gt;&gt; bbbbbbbbb\n&#x27;</span> +</span><br><span class="line">  <span class="string">&#x27;&gt;&gt;&gt; cccccccccc\n\n&#x27;</span>+</span><br><span class="line">  <span class="string">&#x27;# p04:Vue3.0åŸºç¡€çŸ¥è¯†è®²è§£\n&#x27;</span> +</span><br><span class="line">  <span class="string">&#x27;&gt; aaaaaaaaa\n&#x27;</span> +</span><br><span class="line">  <span class="string">&#x27;&gt;&gt; bbbbbbbbb\n&#x27;</span> +</span><br><span class="line">  <span class="string">&#x27;&gt;&gt;&gt; cccccccccc\n\n&#x27;</span>+</span><br><span class="line">  <span class="string">&#x27;#5 p05:Vue3.0åŸºç¡€çŸ¥è¯†è®²è§£\n&#x27;</span> +</span><br><span class="line">  <span class="string">&#x27;&gt; aaaaaaaaa\n&#x27;</span> +</span><br><span class="line">  <span class="string">&#x27;&gt;&gt; bbbbbbbbb\n&#x27;</span> +</span><br><span class="line">  <span class="string">&#x27;&gt;&gt;&gt; cccccccccc\n\n&#x27;</span>+</span><br><span class="line">  <span class="string">&#x27;# p06:Vue3.0åŸºç¡€çŸ¥è¯†è®²è§£\n&#x27;</span> +</span><br><span class="line">  <span class="string">&#x27;&gt; aaaaaaaaa\n&#x27;</span> +</span><br><span class="line">  <span class="string">&#x27;&gt;&gt; bbbbbbbbb\n&#x27;</span> +</span><br><span class="line">  <span class="string">&#x27;&gt;&gt;&gt; cccccccccc\n\n&#x27;</span>+</span><br><span class="line">  <span class="string">&#x27;# p07:Vue3.0åŸºç¡€çŸ¥è¯†è®²è§£\n&#x27;</span> +</span><br><span class="line">  <span class="string">&#x27;&gt; aaaaaaaaa\n&#x27;</span> +</span><br><span class="line">  <span class="string">&#x27;&gt;&gt; bbbbbbbbb\n&#x27;</span> +</span><br><span class="line">  <span class="string">&#x27;&gt;&gt;&gt; cccccccccc\n\n&#x27;</span>+</span><br><span class="line">  <span class="string">&#x27;``` var a=11; ```&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨-react-markdown-æ¸²æŸ“-markdown"><a href="#ä½¿ç”¨-react-markdown-æ¸²æŸ“-markdown" class="headerlink" title="ä½¿ç”¨ react-markdown æ¸²æŸ“ markdown"></a>ä½¿ç”¨ react-markdown æ¸²æŸ“ markdown</h2><p>ç°åœ¨ç»„ä»¶å’Œ markdown æ–‡ä»¶éƒ½å‡†å¤‡å¥½äº†ï¼Œå¯ä»¥è¿›è¡Œæ¸²æŸ“äº†ã€‚ä»£ç å¦‚ä¸‹:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;div className=<span class="string">&quot;detailed-content&quot;</span> &gt;</span><br><span class="line">    &lt;ReactMarkdown</span><br><span class="line">      source=&#123;markdown&#125;</span><br><span class="line">      escapeHtml=&#123;<span class="literal">false</span>&#125;</span><br><span class="line">    /&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure><p>ç°åœ¨å¯ä»¥åˆ°æµè§ˆå™¨ä¸­é¢„è§ˆä¸€ä¸‹äº†ï¼Œå¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œåº”è¯¥å¯ä»¥æ­£å¸¸ä½¿ç”¨ markdown è¯­æ³•äº†ã€‚</p><h1 id="2-markdown-è§£æç»„ä»¶"><a href="#2-markdown-è§£æç»„ä»¶" class="headerlink" title="2.markdown è§£æç»„ä»¶"></a>2.markdown è§£æç»„ä»¶</h1><p>å‰é¢ä»‹ç´¹çš„ react-markdown,ä½†æ˜¯è¿™ä¸ªæ’ä»¶çš„é…ç½®é¡¹è¿˜æ˜¯å¤ªå°‘äº†ï¼Œç°åœ¨ä»‹ç»çš„æ˜¯ marked+highlight.jsã€‚è¿™ä¸ªæ–¹æ¡ˆæ˜¯æ¯”è¾ƒæˆç†Ÿçš„ï¼Œç›®å‰å…¬å¸çš„å¼€å‘æ–‡æ¡£ç¨‹åºå°±æ˜¯åŸºäºè¿™ä¸ªå¼€å‘çš„ã€‚</p><h2 id="å®‰è£…-marked-å’Œ-highlight"><a href="#å®‰è£…-marked-å’Œ-highlight" class="headerlink" title="å®‰è£… marked å’Œ highlight"></a>å®‰è£… marked å’Œ highlight</h2><p>è¿™ä¸¤ä¸ªæ¨¡å—éœ€è¦å…ˆå®‰è£…ï¼Œè¿™é‡Œæˆ‘ä»¬å°±ä½¿ç”¨ yarn æ¥è¿›è¡Œå®‰è£…ã€‚æ‰“å¼€ç»ˆç«¯ï¼Œè¿›å…¥åˆ° blog ç›®å½•ä¸‹ï¼Œç„¶åä½¿ç”¨ä¸‹é¢å‘½ä»¤è¿›è¡Œå®‰è£…ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add marked highlight.js</span><br></pre></td></tr></table></figure><p>æˆ‘ç›®å‰çš„ç‰ˆæœ¬æ˜¯ marked æ˜¯ 0.7.0,highlight æ˜¯ 9.15.10ã€‚å¦‚æœç‰ˆæœ¬æœ‰å˜åŒ–ï¼Œå¯¼è‡´ä»£ç æ²¡æ³•è¿è¡Œï¼Œå¯è‡ªè¡ŒæŸ¥çœ‹ API è¿›è¡Œä¿®æ”¹ã€‚</p><h2 id="å¼•å…¥æ¨¡å—"><a href="#å¼•å…¥æ¨¡å—" class="headerlink" title="å¼•å…¥æ¨¡å—"></a>å¼•å…¥æ¨¡å—</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> marked <span class="keyword">from</span> <span class="string">&#x27;marked&#x27;</span></span><br><span class="line"><span class="keyword">import</span> hljs <span class="keyword">from</span> <span class="string">&quot;highlight.js&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;highlight.js/styles/monokai-sublime.css&#x27;</span>;</span><br></pre></td></tr></table></figure><p>å¼•å…¥è®¾ç½®ä¸€ä¸‹ marked.setOptionsï¼Œé‡Œè¾¹çš„å±æ€§æ¯”è¾ƒå¤šï¼Œæˆ‘åœ¨è¿™é‡Œè¯¦ç»†çš„ä»‹ç»ä¸€ä¸‹ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> renderer = <span class="keyword">new</span> marked.Renderer();</span><br><span class="line"></span><br><span class="line">marked.setOptions(&#123;</span><br><span class="line">    renderer: renderer,</span><br><span class="line">    gfm: <span class="literal">true</span>,</span><br><span class="line">    pedantic: <span class="literal">false</span>,</span><br><span class="line">    sanitize: <span class="literal">false</span>,</span><br><span class="line">    tables: <span class="literal">true</span>,</span><br><span class="line">    breaks: <span class="literal">false</span>,</span><br><span class="line">    smartLists: <span class="literal">true</span>,</span><br><span class="line">    smartypants: <span class="literal">false</span>,</span><br><span class="line">    highlight: <span class="function"><span class="keyword">function</span> (<span class="params">code</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> hljs.highlightAuto(code).value;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> html = marked(props.article_content)</span><br></pre></td></tr></table></figure><ul><li><p>renderer: è¿™ä¸ªæ˜¯å¿…é¡»å¡«å†™çš„ï¼Œä½ å¯ä»¥é€šè¿‡è‡ªå®šä¹‰çš„ Renderer æ¸²æŸ“å‡ºè‡ªå®šä¹‰çš„æ ¼å¼</p></li><li><p>gfmï¼šå¯åŠ¨ç±»ä¼¼ Github æ ·å¼çš„ Markdown,å¡«å†™ true æˆ–è€… false</p></li><li><p>pedaticï¼šåªè§£æç¬¦åˆ Markdown å®šä¹‰çš„ï¼Œä¸ä¿®æ­£ Markdown çš„é”™è¯¯ã€‚å¡«å†™ true æˆ–è€… false</p></li><li><p>sanitize: åŸå§‹è¾“å‡ºï¼Œå¿½ç•¥ HTML æ ‡ç­¾ï¼Œè¿™ä¸ªä½œä¸ºä¸€ä¸ªå¼€å‘äººå‘˜ï¼Œä¸€å®šè¦å†™ flase</p></li><li><p>tablesï¼š æ”¯æŒ Github å½¢å¼çš„è¡¨æ ¼ï¼Œå¿…é¡»æ‰“å¼€ gfm é€‰é¡¹</p></li><li><p>breaks: æ”¯æŒ Github æ¢è¡Œç¬¦ï¼Œå¿…é¡»æ‰“å¼€ gfm é€‰é¡¹ï¼Œå¡«å†™ true æˆ–è€… false</p></li><li><p>smartListsï¼šä¼˜åŒ–åˆ—è¡¨è¾“å‡ºï¼Œè¿™ä¸ªå¡«å†™ ture ä¹‹åï¼Œä½ çš„æ ·å¼ä¼šå¥½çœ‹å¾ˆå¤šï¼Œæ‰€ä»¥å»ºè®®è®¾ç½®æˆ ture</p></li><li><p>highlight: é«˜äº®æ˜¾ç¤ºè§„åˆ™ ï¼Œè¿™é‡Œæˆ‘ä»¬å°†ä½¿ç”¨ highlight.js æ¥å®Œæˆ</p></li></ul><p>** å¢åŠ  Code çš„é«˜äº®æ˜¾ç¤º **</p><p>åœ¨è®¾ç½® setOptions å±æ€§æ—¶ï¼Œå¯ä»¥ç›´æ¥è®¾ç½®é«˜äº®æ˜¾ç¤ºï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">highlight: <span class="function"><span class="keyword">function</span> (<span class="params">code</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> hljs.highlightAuto(code).value;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>è®¾ç½®å®Œæˆåï¼Œä½ åœ¨æµè§ˆå™¨æ£€æŸ¥ä»£ç æ—¶å°±å¯ä»¥å‡ºç° hljs çš„æ ·å¼ï¼Œè¯´æ˜ä½ çš„æ•ˆæœåŠ æˆåŠŸäº†ï¼Œå®ç°äº†é«˜äº®æ˜¾ç¤ºä»£ç ã€‚</p><h1 id="1-markdown-ç›®å½•å¯¼èˆªâ€”â€”markdown-navbar"><a href="#1-markdown-ç›®å½•å¯¼èˆªâ€”â€”markdown-navbar" class="headerlink" title="1.markdown ç›®å½•å¯¼èˆªâ€”â€”markdown-navbar"></a>1.markdown ç›®å½•å¯¼èˆªâ€”â€”markdown-navbar</h1><p>markdown-navbar ç»„ä»¶æ˜¯ä¸€æ¬¾ç¬¬ä¸‰æ–¹æä¾›çš„ç»„ä»¶ï¼Œå› ä¸ºè¿™ä¸ªæ˜¯æ¯”è¾ƒå°ä¼—çš„éœ€æ±‚ï¼Œæ‰€ä»¥ä½¿ç”¨çš„äººå¹¶ä¸å¤šã€‚ç›®å‰åªæœ‰ 18star,è¿™ä¸ªæ˜¯å›½äººå¼€å‘çš„ã€‚</p><h2 id="markdown-navbar-çš„åŸºæœ¬å±æ€§ï¼š"><a href="#markdown-navbar-çš„åŸºæœ¬å±æ€§ï¼š" class="headerlink" title="markdown-navbar çš„åŸºæœ¬å±æ€§ï¼š"></a>markdown-navbar çš„åŸºæœ¬å±æ€§ï¼š</h2><ul><li>classNameï¼š å¯ä»¥ä¸ºå¯¼èˆªå®šä¹‰ä¸€ä¸ª class åç§°ï¼Œä»è€Œè¿›è¡Œ style æ ·å¼çš„å®šä¹‰ã€‚</li><li>sourceï¼šè¦è§£æçš„å†…å®¹ï¼Œä¹Ÿå°±æ˜¯ä½ çš„ Markdown å†…å®¹ã€‚</li><li>headingTopOffset:æç‚¹è·ç¦»é¡µé¢é¡¶éƒ¨çš„ä½ç½®ï¼Œé»˜è®¤å€¼æ˜¯ 0.</li><li>ordered: æ˜¾ç¤ºæ•°å­—ç¼–ç ï¼Œé»˜è®¤æ˜¯æ˜¾ç¤ºçš„ï¼Œä¹Ÿå°±æ˜¯ trueï¼Œè®¾ç½®ä¸º false å°±ä¸æ˜¾ç¤ºäº†ã€‚</li></ul><h2 id="markdown-navbar-çš„å®‰è£…å’Œä½¿ç”¨"><a href="#markdown-navbar-çš„å®‰è£…å’Œä½¿ç”¨" class="headerlink" title="markdown-navbar çš„å®‰è£…å’Œä½¿ç”¨"></a>markdown-navbar çš„å®‰è£…å’Œä½¿ç”¨</h2><p>ç”¨<code>npm install</code>è¿›è¡Œå®‰è£…ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><p><code>npm install --save markdown-navbar</code></p><p>ç”¨ yarn add è¿›è¡Œå®‰è£…ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><p><code>yarn add markdown-navbar</code></p><p>å®‰è£…å®Œæˆåï¼Œç›´æ¥åœ¨è¦ä½¿ç”¨çš„é¡µé¢ç”¨ import è¿›è¡Œå¼•å…¥,éœ€è¦æ³¨æ„çš„æ˜¯ä½ è¿˜éœ€è¦å¼•å…¥ cssã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> MarkNav <span class="keyword">from</span> <span class="string">&#x27;markdown-navbar&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;markdown-navbar/dist/navbar.css&#x27;</span>;</span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±å¼•å…¥æˆåŠŸäº†ï¼Œç°åœ¨å°±å¯ä»¥åˆ¶ä½œå¯¼èˆªäº†ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;div className=<span class="string">&quot;detailed-nav comm-box&quot;</span>&gt;</span><br><span class="line">  &lt;div className=<span class="string">&quot;nav-title&quot;</span>&gt;æ–‡ç« ç›®å½•&lt;/div&gt;</span><br><span class="line">  &lt;MarkNav</span><br><span class="line">    className=<span class="string">&quot;article-menu&quot;</span></span><br><span class="line">    source=&#123;markdown&#125;</span><br><span class="line">    ordered=&#123;<span class="literal">false</span>&#125;</span><br><span class="line">  /&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure><p>åœ¨æµè§ˆå™¨ä¸­é¢„è§ˆä¸€ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°æ•ˆæœäº†ã€‚ä½†ç°åœ¨æœ‰ä¸€ä¸ªéœ€æ±‚ï¼Œå°±æ˜¯è¿™ä¸ªå¯¼èˆªè¦ä¸€ç›´åœ¨é¡µé¢çš„å³ä¾§ã€‚æˆ‘ä»¬ç»å¸¸å«è¿™ä¸ªéœ€æ±‚ä¸ºå›ºé’‰ã€‚Ant Desgin ä¸­æä¾›äº†<strong>Affix</strong>.</p><p>å…ˆç”¨ import å¼•å…¥ Affix ç»„ä»¶ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;Row, Col ,Affix, Icon ,Breadcrumb  &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span></span><br></pre></td></tr></table></figure><p>å¼•å…¥ååœ¨éœ€è¦å›ºé’‰çš„å¤–å±‚åŠ ä¸Š Affix ç»„ä»¶å°±å¯ä»¥äº†ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;Affix offsetTop=&#123;<span class="number">5</span>&#125;&gt;</span><br><span class="line">  &lt;div className=<span class="string">&quot;detailed-nav comm-box&quot;</span>&gt;</span><br><span class="line">    &lt;div className=<span class="string">&quot;nav-title&quot;</span>&gt;æ–‡ç« ç›®å½•&lt;/div&gt;</span><br><span class="line">    &lt;MarkNav</span><br><span class="line">      className=<span class="string">&quot;article-menu&quot;</span></span><br><span class="line">      source=&#123;markdown&#125;</span><br><span class="line"></span><br><span class="line">      ordered=&#123;<span class="literal">false</span>&#125;</span><br><span class="line">    /&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/Affix&gt;</span><br></pre></td></tr></table></figure><p>å†™å®Œè¿™æ®µä»£ç ï¼Œåˆ°æµè§ˆå™¨ä¸­é¢„è§ˆä¸€ä¸‹ï¼Œå°±å¯ä»¥å®ç°å›ºé’‰çš„æ•ˆæœäº†ã€‚</p><h1 id="2-markdown-ç›®å½•å¯¼èˆªâ€”â€”tocify-tsx-æ–‡ä»¶"><a href="#2-markdown-ç›®å½•å¯¼èˆªâ€”â€”tocify-tsx-æ–‡ä»¶" class="headerlink" title="2. markdown ç›®å½•å¯¼èˆªâ€”â€”tocify.tsx æ–‡ä»¶"></a>2. markdown ç›®å½•å¯¼èˆªâ€”â€”tocify.tsx æ–‡ä»¶</h1><p>ä½ çš„ç¨‹åºä¸­ä½¿ç”¨äº† Ant DesignUI åº“ï¼Œå› ä¸ºå®ƒé‡Œè¾¹çš„å¯¼èˆªéƒ¨åˆ†ï¼Œä½¿ç”¨äº† antd çš„ Anchor ç»„ä»¶</p><p>å®‰è£… lodash æ¨¡å—ï¼Œè¿™ä¸ªå¯ä»¥ç›´æ¥ä½¿ç”¨ yarn add lodash æ¥å®‰è£…</p><p>ä¸Šé¢ä¸¤ä¸ªæ¡ä»¶æ»¡è¶³åï¼Œä½ å¯ä»¥æŠŠæ–‡ä»¶ tocify.tsx æ‹·è´åˆ°ä½ çš„é¡¹ç›®é‡Œäº†ï¼Œæˆ‘è¿™é‡Œæ”¾åˆ°äº†/blog/components æ–‡ä»¶å¤¹ä¸‹äº†ï¼ŒæŠŠå®ƒè§†ä¸ºä¸€ç§è‡ªå®šä¹‰ç»„ä»¶ã€‚</p><h2 id="tocify-tsx-æ–‡ä»¶"><a href="#tocify-tsx-æ–‡ä»¶" class="headerlink" title="tocify.tsx æ–‡ä»¶"></a>tocify.tsx æ–‡ä»¶</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Anchor &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; last &#125; <span class="keyword">from</span> <span class="string">&#x27;lodash&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; Link &#125; = Anchor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> interface TocItem &#123;</span><br><span class="line">  anchor: string;</span><br><span class="line">  level: number;</span><br><span class="line">  text: string;</span><br><span class="line">  children?: TocItem[];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> type TocItems = TocItem[]; <span class="comment">// TOCç›®å½•æ ‘ç»“æ„</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Tocify</span> </span>&#123;</span><br><span class="line">  tocItems: TocItems = [];</span><br><span class="line"></span><br><span class="line">  index: number = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">constructor</span>() &#123;</span><br><span class="line">    <span class="built_in">this</span>.tocItems = [];</span><br><span class="line">    <span class="built_in">this</span>.index = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  add(text: string, <span class="attr">level</span>: number) &#123;</span><br><span class="line">    <span class="keyword">const</span> anchor = <span class="string">`toc<span class="subst">$&#123;level&#125;</span><span class="subst">$&#123;++<span class="built_in">this</span>.index&#125;</span>`</span>;</span><br><span class="line">    <span class="keyword">const</span> item = &#123; anchor, level, text &#125;;</span><br><span class="line">    <span class="keyword">const</span> items = <span class="built_in">this</span>.tocItems;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (items.length === <span class="number">0</span>) &#123; <span class="comment">// ç¬¬ä¸€ä¸ª item ç›´æ¥ push</span></span><br><span class="line">      items.push(item);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">let</span> lastItem = last(items) <span class="keyword">as</span> TocItem; <span class="comment">// æœ€åä¸€ä¸ª item</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (item.level &gt; lastItem.level) &#123; <span class="comment">// item æ˜¯ lastItem çš„ children</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i = lastItem.level + <span class="number">1</span>; i &lt;= <span class="number">2</span>; i++) &#123;</span><br><span class="line">          <span class="keyword">const</span> &#123; children &#125; = lastItem;</span><br><span class="line">          <span class="keyword">if</span> (!children) &#123; <span class="comment">// å¦‚æœ children ä¸å­˜åœ¨</span></span><br><span class="line">            lastItem.children = [item];</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          lastItem = last(children) <span class="keyword">as</span> TocItem; <span class="comment">// é‡ç½® lastItem ä¸º children çš„æœ€åä¸€ä¸ª item</span></span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> (item.level &lt;= lastItem.level) &#123; <span class="comment">// item level å°äºæˆ–ç­‰äº lastItem level éƒ½è§†ä¸ºä¸ children åŒçº§</span></span><br><span class="line">            children.push(item);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123; <span class="comment">// ç½®äºæœ€é¡¶çº§</span></span><br><span class="line">        items.push(item);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> anchor;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  reset = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.tocItems = [];</span><br><span class="line">    <span class="built_in">this</span>.index = <span class="number">0</span>;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  renderToc(items: TocItem[]) &#123; <span class="comment">// é€’å½’ render</span></span><br><span class="line">    <span class="keyword">return</span> items.map(<span class="function"><span class="params">item</span> =&gt;</span> (</span><br><span class="line">      &lt;Link key=&#123;item.anchor&#125; href=&#123;<span class="string">`#<span class="subst">$&#123;item.anchor&#125;</span>`</span>&#125; title=&#123;item.text&#125;&gt;</span><br><span class="line">        &#123;item.children &amp;&amp; <span class="built_in">this</span>.renderToc(item.children)&#125;</span><br><span class="line">      &lt;/Link&gt;</span><br><span class="line">    ));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;Anchor affix showInkInFixed&gt;</span><br><span class="line">         &#123;<span class="built_in">this</span>.renderToc(<span class="built_in">this</span>.tocItems)&#125;</span><br><span class="line">      &lt;/Anchor&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å…¶å®è¿™ä¸ªæ–‡ä»¶ä¹Ÿå¾ˆç®€å•ï¼Œå¦‚æœ JavaScript åŸºç¡€æ²¡é—®é¢˜æ˜¯å®Œå…¨å¯ä»¥çœ‹æ˜ç™½çš„ã€‚</p><h2 id="ä½¿ç”¨-tocify-tsx-ç”Ÿæˆæ–‡ç« ç›®å½•"><a href="#ä½¿ç”¨-tocify-tsx-ç”Ÿæˆæ–‡ç« ç›®å½•" class="headerlink" title="ä½¿ç”¨ tocify.tsx ç”Ÿæˆæ–‡ç« ç›®å½•"></a>ä½¿ç”¨ tocify.tsx ç”Ÿæˆæ–‡ç« ç›®å½•</h2><p>æ¥ä¸‹æ¥å°±å¯ä»¥åˆ©ç”¨ tocify.tsx æ–‡ä»¶ç”Ÿæˆç›®å½•äº†ï¼Œåœ¨/blog/pages/detailed.js å¼•å…¥ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Tocify <span class="keyword">from</span> <span class="string">&#x27;../components/tocify.tsx&#x27;</span></span><br></pre></td></tr></table></figure><p>å¼•å…¥åï¼Œéœ€è¦å¯¹ marked çš„æ¸²æŸ“è¿›è¡Œè‡ªå®šä¹‰ï¼Œè¿™æ—¶å€™éœ€è¦è®¾ç½® renderer.headingï¼Œå°±æ˜¯å†™ä¸€ä¸ªæ–¹æ³•ä»¬é‡æ–°å®šä¹‰å¯¹#è¿™ç§æ ‡ç­¾çš„è§£æã€‚ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> tocify = <span class="keyword">new</span> Tocify()</span><br><span class="line">renderer.heading = <span class="function"><span class="keyword">function</span>(<span class="params">text, level, raw</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">const</span> anchor = tocify.add(text, level);</span><br><span class="line">      <span class="keyword">return</span> <span class="string">`&lt;a id=&quot;<span class="subst">$&#123;anchor&#125;</span>&quot; href=&quot;#<span class="subst">$&#123;anchor&#125;</span>&quot; class=&quot;anchor-fix&quot;&gt;&lt;h<span class="subst">$&#123;level&#125;</span>&gt;<span class="subst">$&#123;text&#125;</span>&lt;/h<span class="subst">$&#123;level&#125;</span>&gt;&lt;/a&gt;\n`</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">æœ€ååœ¨éœ€è¦æ˜¾ç¤ºæ–‡ç« å¯¼èˆªçš„åœ°æ–¹ï¼Œå†™ä¸‹é¢çš„ä»£ç :</span><br><span class="line"></span><br><span class="line">&lt;div className=<span class="string">&quot;toc-list&quot;</span>&gt;</span><br><span class="line">  &#123;tocify &amp;&amp; tocify.render()&#125;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="egg-js-è·¨åŸŸé—®é¢˜"><a href="#egg-js-è·¨åŸŸé—®é¢˜" class="headerlink" title="egg.js è·¨åŸŸé—®é¢˜"></a>egg.js è·¨åŸŸé—®é¢˜</h1><p><strong>egg-cors</strong>æ¨¡å—æ˜¯ä¸“é—¨ç”¨æ¥è§£å†³ egg.js è·¨åŸŸé—®é¢˜çš„ï¼Œåªè¦ç®€å•çš„é…ç½®å°±å¯ä»¥å®Œæˆè·¨åŸŸçš„è®¾ç½®ï¼Œä½†æ˜¯è·¨åŸŸä¸€å®šè¦è°¨æ…è®¾ç½®ï¼Œå¾ˆå¤šå®‰å…¨é—®é¢˜ï¼Œéƒ½æ˜¯é€šè¿‡è·¨åŸŸè¿›è¡Œæ”»å‡»çš„ã€‚</p><p>å®‰è£…æˆ‘ä»¬ä½¿ç”¨<code>yarn add</code>è¿›è¡Œå®‰è£…ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add egg-cors</span><br></pre></td></tr></table></figure><h2 id="é…ç½®-config-plugin-js-æ–‡ä»¶"><a href="#é…ç½®-config-plugin-js-æ–‡ä»¶" class="headerlink" title="é…ç½® config/plugin.js æ–‡ä»¶"></a>é…ç½® config/plugin.js æ–‡ä»¶</h2><p>åœ¨å®‰è£…å®Œæˆåéœ€è¦å¯¹/service/config/plugin.js æ–‡ä»¶è¿›è¡Œä¿®æ”¹ï¼ŒåŠ å…¥ egg-cors æ¨¡å—å³å¯ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">exports</span>.cors= &#123;</span><br><span class="line">    enable: <span class="literal">true</span>,</span><br><span class="line">    package: <span class="string">&#x27;egg-cors&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="é…ç½®-config-default-js"><a href="#é…ç½®-config-default-js" class="headerlink" title="é…ç½® config.default.js"></a>é…ç½® config.default.js</h2><p>åœ¨é…ç½®å®Œæˆ plugin.js æ–‡ä»¶ä»¥åï¼Œè¿˜éœ€è¦è®¾ç½® config.default.js æ–‡ä»¶ã€‚è¿™ä¸ªæ–‡ä»¶ä¸»è¦è®¾ç½®çš„æ˜¯å…è®¸ä»€ä¹ˆåŸŸåå’Œè¯·æ±‚æ–¹æ³•å¯ä»¥è¿›è¡Œè·¨åŸŸè®¿é—®ã€‚é…ç½®ä»£ç å¦‚ä¸‹ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ã€€ã€€config.security = &#123;</span><br><span class="line">ã€€ã€€ã€€ã€€csrf: &#123;</span><br><span class="line">ã€€ã€€ã€€ã€€ã€€ã€€enable: <span class="literal">false</span></span><br><span class="line">ã€€ã€€ã€€ã€€&#125;,</span><br><span class="line">ã€€ã€€ã€€ã€€domainWhiteList: [ <span class="string">&#x27;*&#x27;</span> ]</span><br><span class="line">ã€€ã€€&#125;;</span><br><span class="line"> config.cors = &#123;</span><br><span class="line">    origin: <span class="string">&#x27;*&#x27;</span>,</span><br><span class="line">    allowMethods: <span class="string">&#x27;GET,HEAD,PUT,POST,DELETE,PATCH,OPTIONS&#x27;</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ åªæƒ³è®©<code>http://localhost:3000</code> æ¥è¿›è¡Œæ¥å£æ–¹æ¡ˆï¼Œå°±å¯ä»¥è®¾ç½®æˆä¸‹é¢çš„ä»£ç ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">config.security = &#123;</span><br><span class="line">ã€€ã€€ã€€ã€€csrf: &#123;<span class="attr">enable</span>: <span class="literal">false</span>&#125;,</span><br><span class="line">ã€€ã€€ã€€ã€€domainWhiteList: [ <span class="string">&#x27;*&#x27;</span> ]</span><br><span class="line">ã€€ã€€&#125;;</span><br><span class="line">config.cors = &#123;</span><br><span class="line">  origin: <span class="string">&#x27;http://localhost:3000&#x27;</span>, <span class="comment">//åªå…è®¸è¿™ä¸ªåŸŸè¿›è¡Œè®¿é—®æ¥å£</span></span><br><span class="line">  credentials: <span class="literal">true</span>,   <span class="comment">// å¼€å¯è®¤è¯</span></span><br><span class="line">  allowMethods: <span class="string">&#x27;GET,HEAD,PUT,POST,DELETE,PATCH,OPTIONS&#x27;</span></span><br><span class="line">  &#125;;</span><br></pre></td></tr></table></figure><p>è®¾ç½®å®Œæˆåï¼Œå°±å¯ä»¥åœ¨æµè§ˆå™¨ä¸­è¿›è¡Œé¢„è§ˆäº†ï¼Œå¦‚æœèƒ½æ­£å¸¸è®¿é—®ï¼Œè¯´æ˜è·¨åŸŸè®¿é—®å·²ç»è®¾ç½®æˆåŠŸäº†ã€‚</p><h1 id="vscode-å¥½ç”¨æ’ä»¶"><a href="#vscode-å¥½ç”¨æ’ä»¶" class="headerlink" title="vscode å¥½ç”¨æ’ä»¶"></a>vscode å¥½ç”¨æ’ä»¶</h1><p><strong>px-to-vw</strong></p><p>åœ¨è®¾ç½®é‡Œé¢æœç´¢ px-to-vw å¯è®¾ç½®è®¾è®¡ç¨¿å¤§å°</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Px-to-viewport: Viewport-width</span><br><span class="line">The width <span class="keyword">of</span> the viewport</span><br><span class="line"></span><br><span class="line"><span class="number">350</span></span><br></pre></td></tr></table></figure><p><strong>é€‰ä¸­ css è¯­å¥æŒ‰ `ALT+Zâ€™å³å¯è½¬æ¢ä¸º vw</strong></p><p>æ­¤æ—¶</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">font-size: <span class="number">16</span>px;  <span class="comment">//ALT+Z</span></span><br></pre></td></tr></table></figure><p>å˜æˆ</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">font-size: <span class="number">4.444</span>vw;</span><br></pre></td></tr></table></figure><h1 id="Vue-çˆ¶è°ƒç”¨å­ç»„ä»¶æ–¹æ³•"><a href="#Vue-çˆ¶è°ƒç”¨å­ç»„ä»¶æ–¹æ³•" class="headerlink" title="Vue çˆ¶è°ƒç”¨å­ç»„ä»¶æ–¹æ³•"></a>Vue çˆ¶è°ƒç”¨å­ç»„ä»¶æ–¹æ³•</h1><h2 id="1-ä½¿ç”¨ref"><a href="#1-ä½¿ç”¨ref" class="headerlink" title="1.ä½¿ç”¨ref"></a>1.ä½¿ç”¨ref</h2><p>//çˆ¶ç»„ä»¶<br><template><br>  <div class="home"><br>    <HelloWorld ref="mychild"></HelloWorld><br>    &lt;div @click=â€clickParentâ€&gt;click me</div><br>  </div><br></template></p><script>  import HelloWorld from '@/components/HelloWorld.vue'  export default {    name: 'home',    components: {      HelloWorld    },    methods: {      clickParent() {        this.$refs.mychild.parentHandleclick("å“ˆå–½å“ˆå–½");      }    }  }</script><p>//å­ç»„ä»¶<br><template><br>  <div class="hello"><br>    <h1>æˆ‘æ˜¯å­ç»„ä»¶</h1><br>  </div><br></template></p><script>  export default {    name: 'HelloWorld',    created() {    },    methods: {      parentHandleclick(e) {        console.log(e)      }    }  }</script><h2 id="2-ä½¿ç”¨-emit"><a href="#2-ä½¿ç”¨-emit" class="headerlink" title="2.ä½¿ç”¨$emit"></a>2.ä½¿ç”¨$emit</h2><h3 id="å­ç»„ä»¶"><a href="#å­ç»„ä»¶" class="headerlink" title="å­ç»„ä»¶"></a>å­ç»„ä»¶</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"> &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;editBanner&quot;</span> @click=<span class="string">&quot;bannerClick&quot;</span>&gt;</span><br><span class="line">    &lt;span&gt;&#123;&#123;left&#125;&#125;&lt;/span&gt;</span><br><span class="line">    &lt;span&gt;<span class="xml"><span class="tag">&lt;<span class="name">slot</span> <span class="attr">name</span>=<span class="string">&#x27;right&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span>&lt;/span&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;script &gt;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  props: [<span class="string">&#x27;left&#x27;</span>],</span><br><span class="line">  methods:&#123;</span><br><span class="line">      bannerClick()&#123;</span><br><span class="line">          <span class="built_in">this</span>.$emit(<span class="string">&#x27;bannerClick&#x27;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h3 id="çˆ¶ç»„ä»¶"><a href="#çˆ¶ç»„ä»¶" class="headerlink" title="çˆ¶ç»„ä»¶"></a>çˆ¶ç»„ä»¶</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;editBanner left=<span class="string">&quot;å‡ºç”Ÿæ—¥æœŸ&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;dateView&quot;</span> @bannerClick=<span class="string">&quot;changeDateShow&quot;</span>&gt;</span><br><span class="line">  &lt;a slot=<span class="string">&quot;right&quot;</span>&gt;&#123;&#123;date&#125;&#125;&lt;/a&gt;</span><br><span class="line">&lt;/editBanner&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="this"><a href="#this" class="headerlink" title="this"></a>this</h1><p><strong>åŒ¿åå‡½æ•°çš„ this æ°¸è¿œæŒ‡å‘ window</strong><br><strong>this æ°¸è¿œæŒ‡å‘æœ€åè°ƒç”¨å®ƒçš„é‚£ä¸ªå¯¹è±¡</strong></p><h1 id="shuffle"><a href="#shuffle" class="headerlink" title="shuffle()"></a>shuffle()</h1><p><strong>shuffle()</strong> æ–¹æ³•å°†åºåˆ—çš„æ‰€æœ‰å…ƒç´ éšæœºæ’åºã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">import random</span><br><span class="line"></span><br><span class="line">random.shuffle (lst )</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;babel-plugin-import&quot;&gt;&lt;a href=&quot;#babel-plugin-import&quot; class=&quot;headerlink&quot; title=&quot;babel-plugin-import&quot;&gt;&lt;/a&gt;babel-plugin-import&lt;/h1&gt;&lt;p&gt;we</summary>
      
    
    
    
    <category term="ç¬”è®°" scheme="https://hard-workingrookie.github.io/categories/%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="ç¬”è®°" scheme="https://hard-workingrookie.github.io/tags/%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
</feed>
